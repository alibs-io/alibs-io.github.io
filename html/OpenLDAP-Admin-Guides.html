<!DOCTYPE html><html>
<head>
<title></title>
<style type="text/css">
<!--
.xflip {
    -moz-transform: scaleX(-1);
    -webkit-transform: scaleX(-1);
    -o-transform: scaleX(-1);
    transform: scaleX(-1);
    filter: fliph;
}
.yflip {
    -moz-transform: scaleY(-1);
    -webkit-transform: scaleY(-1);
    -o-transform: scaleY(-1);
    transform: scaleY(-1);
    filter: flipv;
}
.xyflip {
    -moz-transform: scaleX(-1) scaleY(-1);
    -webkit-transform: scaleX(-1) scaleY(-1);
    -o-transform: scaleX(-1) scaleY(-1);
    transform: scaleX(-1) scaleY(-1);
    filter: fliph + flipv;
}
-->
</style>
</head>
<body>
<a name=1></a><img src="../img/../img/OpenLDAP-Admin-Guide-1_1.png"/><br/>
<b>OpenLDAP Software 2.4 Administrator's Guide</b><br/>
<hr/>
<a name=2></a><hr/>
<a name=3></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
<b>Table of Contents</b><br/>
<a href="">Table&#160;of&#160;Contents.....................................................................................................................................1</a><br/>
<a href="OpenLDAP-Admin-Guides.html#15"><b>Preface..................................................................................................................................................................1</b></a><br/>
<a href="OpenLDAP-Admin-Guides.html#15">Copyright.................................................................................................................................................1<br/>Scope&#160;of&#160;this&#160;Document...........................................................................................................................1<br/>Acknowledgments....................................................................................................................................2<br/></a><a href="OpenLDAP-Admin-Guides.html#16">Amendments............................................................................................................................................2<br/>About&#160;this&#160;document................................................................................................................................3</a><br/>
<a href="OpenLDAP-Admin-Guides.html#17"><b>1.&#160;Introduction&#160;to&#160;OpenLDAP&#160;Directory&#160;Services...........................................................................................3</b></a><br/>
<a href="OpenLDAP-Admin-Guides.html#17">1.1.&#160;What&#160;is&#160;a&#160;directory&#160;service?..............................................................................................................3<br/>1.2.&#160;What&#160;is&#160;LDAP?.................................................................................................................................6<br/></a><a href="OpenLDAP-Admin-Guides.html#20">1.3.&#160;When&#160;should&#160;I&#160;use&#160;LDAP?...............................................................................................................6<br/>1.4.&#160;When&#160;should&#160;I&#160;not&#160;use&#160;LDAP?.........................................................................................................6<br/>1.5.&#160;How&#160;does&#160;LDAP&#160;work?....................................................................................................................7<br/></a><a href="OpenLDAP-Admin-Guides.html#21">1.6.&#160;What&#160;about&#160;X.500?...........................................................................................................................7<br/>1.7.&#160;What&#160;is&#160;the&#160;difference&#160;between&#160;LDAPv2&#160;and&#160;LDAPv3?.................................................................7<br/>1.8.&#160;LDAP&#160;vs&#160;RDBMS............................................................................................................................9<br/></a><a href="OpenLDAP-Admin-Guides.html#23">1.9.&#160;What&#160;is&#160;slapd&#160;and&#160;what&#160;can&#160;it&#160;do?...................................................................................................11</a><br/>
<a href="OpenLDAP-Admin-Guides.html#25"><b>2.&#160;A&#160;Quick-Start&#160;Guide.....................................................................................................................................15</b></a><br/>
<a href="OpenLDAP-Admin-Guides.html#29"><b>3.&#160;The&#160;Big&#160;Picture&#160;-&#160;Configuration&#160;Choices....................................................................................................15</b></a><br/>
<a href="OpenLDAP-Admin-Guides.html#29">3.1.&#160;Local&#160;Directory&#160;Service..................................................................................................................15<br/>3.2.&#160;Local&#160;Directory&#160;Service&#160;with&#160;Referrals..........................................................................................15<br/>3.3.&#160;Replicated&#160;Directory&#160;Service..........................................................................................................16<br/></a><a href="OpenLDAP-Admin-Guides.html#30">3.4.&#160;Distributed&#160;Local&#160;Directory&#160;Service...............................................................................................17</a><br/>
<a href="OpenLDAP-Admin-Guides.html#31"><b>4.&#160;Building&#160;and&#160;Installing&#160;OpenLDAP&#160;Software............................................................................................17</b></a><br/>
<a href="OpenLDAP-Admin-Guides.html#31">4.1.&#160;Obtaining&#160;and&#160;Extracting&#160;the&#160;Software...........................................................................................17<br/>4.2.&#160;Prerequisite&#160;software.......................................................................................................................17</a><br/>
<a href="OpenLDAP-Admin-Guides.html#31">4.2.1.&#160;Transport&#160;Layer&#160;Security.......................................................................................................18<br/></a><a href="OpenLDAP-Admin-Guides.html#32">4.2.2.&#160;Simple&#160;Authentication&#160;and&#160;Security&#160;Layer...........................................................................18<br/>4.2.3.&#160;Kerberos&#160;Authentication&#160;Service...........................................................................................18<br/>4.2.4.&#160;Database&#160;Software.................................................................................................................19<br/></a><a href="OpenLDAP-Admin-Guides.html#207">4.2.5.&#160;Threads..................................................................................................................................19<br/></a><a href="OpenLDAP-Admin-Guides.html#149">4.2.6.&#160;TCP&#160;Wrappers.......................................................................................................................19</a><br/>
<a href="OpenLDAP-Admin-Guides.html#33">4.3.&#160;Running&#160;configure..........................................................................................................................20<br/></a><a href="OpenLDAP-Admin-Guides.html#34">4.4.&#160;Building&#160;the&#160;Software.....................................................................................................................20<br/>4.5.&#160;Testing&#160;the&#160;Software.......................................................................................................................20<br/>4.6.&#160;Installing&#160;the&#160;Software....................................................................................................................23</a><br/>
<a href="OpenLDAP-Admin-Guides.html#37"><b>5.&#160;Configuring&#160;slapd..........................................................................................................................................23</b></a><br/>
<a href="OpenLDAP-Admin-Guides.html#37">5.1.&#160;Configuration&#160;Layout......................................................................................................................25<br/></a><a href="OpenLDAP-Admin-Guides.html#39">5.2.&#160;Configuration&#160;Directives.................................................................................................................26</a><br/>
<a href="OpenLDAP-Admin-Guides.html#40">5.2.1.&#160;cn=config...............................................................................................................................27<br/></a><a href="OpenLDAP-Admin-Guides.html#41">5.2.2.&#160;cn=module.............................................................................................................................28<br/></a><a href="OpenLDAP-Admin-Guides.html#42">5.2.3.&#160;cn=schema.............................................................................................................................29</a><br/>
i<br/>
<hr/>
<a name=4></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
<b>Table of Contents</b><br/>
<a href="OpenLDAP-Admin-Guides.html#37"><b>5.&#160;Configuring&#160;slapd</b></a><br/>
<a href="OpenLDAP-Admin-Guides.html#43">5.2.4.&#160;Backend-specific&#160;Directives..................................................................................................29<br/>5.2.5.&#160;Database-specific&#160;Directives.................................................................................................34<br/></a><a href="OpenLDAP-Admin-Guides.html#65">5.2.6.&#160;BDB&#160;and&#160;HDB&#160;Database&#160;Directives.....................................................................................38</a><br/>
<a href="OpenLDAP-Admin-Guides.html#52">5.3.&#160;Configuration&#160;Example...................................................................................................................40<br/></a><a href="OpenLDAP-Admin-Guides.html#54">5.4.&#160;Converting&#160;old&#160;style&#160;slapd.conf(5)&#160;file&#160;to&#160;cn=config&#160;format..........................................................43</a><br/>
<a href="OpenLDAP-Admin-Guides.html#57"><b>6.&#160;The&#160;slapd&#160;Configuration&#160;File.......................................................................................................................43</b></a><br/>
<a href="OpenLDAP-Admin-Guides.html#57">6.1.&#160;Configuration&#160;File&#160;Format..............................................................................................................44<br/></a><a href="OpenLDAP-Admin-Guides.html#58">6.2.&#160;Configuration&#160;File&#160;Directives.........................................................................................................44</a><br/>
<a href="OpenLDAP-Admin-Guides.html#58">6.2.1.&#160;Global&#160;Directives...................................................................................................................46<br/></a><a href="OpenLDAP-Admin-Guides.html#60">6.2.2.&#160;General&#160;Backend&#160;Directives..................................................................................................47<br/></a><a href="OpenLDAP-Admin-Guides.html#61">6.2.3.&#160;General&#160;Database&#160;Directives.................................................................................................51<br/></a><a href="OpenLDAP-Admin-Guides.html#65">6.2.4.&#160;BDB&#160;and&#160;HDB&#160;Database&#160;Directives.....................................................................................51</a><br/>
<a href="OpenLDAP-Admin-Guides.html#65">6.3.&#160;Configuration&#160;File&#160;Example............................................................................................................53</a><br/>
<a href="OpenLDAP-Admin-Guides.html#67"><b>7.&#160;Running&#160;slapd................................................................................................................................................53</b></a><br/>
<a href="OpenLDAP-Admin-Guides.html#67">7.1.&#160;Command-Line&#160;Options.................................................................................................................55<br/></a><a href="OpenLDAP-Admin-Guides.html#69">7.2.&#160;Starting&#160;slapd..................................................................................................................................55<br/>7.3.&#160;Stopping&#160;slapd.................................................................................................................................57</a><br/>
<a href="OpenLDAP-Admin-Guides.html#71"><b>8.&#160;Access&#160;Control...............................................................................................................................................57</b></a><br/>
<a href="OpenLDAP-Admin-Guides.html#93">8.1.&#160;Introduction.....................................................................................................................................57<br/></a><a href="OpenLDAP-Admin-Guides.html#71">8.2.&#160;Access&#160;Control&#160;via&#160;Static&#160;Configuration.........................................................................................58</a><br/>
<a href="OpenLDAP-Admin-Guides.html#77">8.2.1.&#160;What&#160;to&#160;control&#160;access&#160;to.......................................................................................................59<br/></a><a href="OpenLDAP-Admin-Guides.html#78">8.2.2.&#160;Who&#160;to&#160;grant&#160;access&#160;to...........................................................................................................60<br/></a><a href="OpenLDAP-Admin-Guides.html#79">8.2.3.&#160;The&#160;access&#160;to&#160;grant................................................................................................................60<br/>8.2.4.&#160;Access&#160;Control&#160;Evaluation....................................................................................................61<br/></a><a href="OpenLDAP-Admin-Guides.html#80">8.2.5.&#160;Access&#160;Control&#160;Examples......................................................................................................62</a><br/>
<a href="OpenLDAP-Admin-Guides.html#76">8.3.&#160;Access&#160;Control&#160;via&#160;Dynamic&#160;Configuration...................................................................................63</a><br/>
<a href="OpenLDAP-Admin-Guides.html#77">8.3.1.&#160;What&#160;to&#160;control&#160;access&#160;to.......................................................................................................64<br/></a><a href="OpenLDAP-Admin-Guides.html#78">8.3.2.&#160;Who&#160;to&#160;grant&#160;access&#160;to...........................................................................................................65<br/></a><a href="OpenLDAP-Admin-Guides.html#79">8.3.3.&#160;The&#160;access&#160;to&#160;grant................................................................................................................65<br/>8.3.4.&#160;Access&#160;Control&#160;Evaluation....................................................................................................66<br/></a><a href="OpenLDAP-Admin-Guides.html#80">8.3.5.&#160;Access&#160;Control&#160;Examples......................................................................................................67<br/></a><a href="OpenLDAP-Admin-Guides.html#81">8.3.6.&#160;Access&#160;Control&#160;Ordering.......................................................................................................68</a><br/>
<a href="OpenLDAP-Admin-Guides.html#82">8.4.&#160;Access&#160;Control&#160;Common&#160;Examples...............................................................................................68</a><br/>
<a href="OpenLDAP-Admin-Guides.html#82">8.4.1.&#160;Basic&#160;ACLs............................................................................................................................69<br/></a><a href="OpenLDAP-Admin-Guides.html#83">8.4.2.&#160;Matching&#160;Anonymous&#160;and&#160;Authenticated&#160;users....................................................................69<br/>8.4.3.&#160;Controlling&#160;rootdn&#160;access......................................................................................................70<br/></a><a href="OpenLDAP-Admin-Guides.html#84">8.4.4.&#160;Managing&#160;access&#160;with&#160;Groups...............................................................................................71<br/></a><a href="OpenLDAP-Admin-Guides.html#85">8.4.5.&#160;Granting&#160;access&#160;to&#160;a&#160;subset&#160;of&#160;attributes...............................................................................71<br/>8.4.6.&#160;Allowing&#160;a&#160;user&#160;write&#160;to&#160;all&#160;entries&#160;below&#160;theirs...................................................................72<br/></a><a href="OpenLDAP-Admin-Guides.html#86">8.4.7.&#160;Allowing&#160;entry&#160;creation.........................................................................................................73<br/></a><a href="OpenLDAP-Admin-Guides.html#87">8.4.8.&#160;Tips&#160;for&#160;using&#160;regular&#160;expressions&#160;in&#160;Access&#160;Control...........................................................74<br/></a><a href="OpenLDAP-Admin-Guides.html#88">8.4.9.&#160;Granting&#160;and&#160;Denying&#160;access&#160;based&#160;on&#160;security&#160;strength&#160;factors&#160;(ssf).................................74<br/>8.4.10.&#160;When&#160;things&#160;aren't&#160;working&#160;as&#160;expected.............................................................................75</a><br/>
<a href="OpenLDAP-Admin-Guides.html#89">8.5.&#160;Sets&#160;-&#160;Granting&#160;rights&#160;based&#160;on&#160;relationships..................................................................................75</a><br/>
ii<br/>
<hr/>
<a name=5></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
<b>Table of Contents</b><br/>
<a href="OpenLDAP-Admin-Guides.html#71"><b>8.&#160;Access&#160;Control</b></a><br/>
<a href="OpenLDAP-Admin-Guides.html#89">8.5.1.&#160;Groups&#160;of&#160;Groups..................................................................................................................76<br/></a><a href="OpenLDAP-Admin-Guides.html#90">8.5.2.&#160;Group&#160;ACLs&#160;without&#160;DN&#160;syntax...........................................................................................77<br/></a><a href="OpenLDAP-Admin-Guides.html#91">8.5.3.&#160;Following&#160;references.............................................................................................................79</a><br/>
<a href="OpenLDAP-Admin-Guides.html#93"><b>9.&#160;Limits</b></a><b>.............................................................................................................................................................79</b><br/>
<a href="OpenLDAP-Admin-Guides.html#93">9.1.&#160;Introduction.....................................................................................................................................79<br/>9.2.&#160;Soft&#160;and&#160;Hard&#160;limits........................................................................................................................79<br/>9.3.&#160;Global&#160;Limits..................................................................................................................................80<br/></a><a href="OpenLDAP-Admin-Guides.html#94">9.4.&#160;Per-Database&#160;Limits........................................................................................................................80</a><br/>
<a href="OpenLDAP-Admin-Guides.html#94">9.4.1.&#160;Specify&#160;who&#160;the&#160;limits&#160;apply&#160;to.............................................................................................80<br/>9.4.2.&#160;Specify&#160;time&#160;limits.................................................................................................................81<br/></a><a href="OpenLDAP-Admin-Guides.html#95">9.4.3.&#160;Specifying&#160;size&#160;limits............................................................................................................81<br/>9.4.4.&#160;Size&#160;limits&#160;and&#160;Paged&#160;Results................................................................................................81</a><br/>
<a href="OpenLDAP-Admin-Guides.html#95">9.5.&#160;Example&#160;Limit&#160;Configurations</a>.......................................................................................................81<br/>
<a href="OpenLDAP-Admin-Guides.html#95">9.5.1.&#160;Simple&#160;Global&#160;Limits............................................................................................................82<br/></a><a href="OpenLDAP-Admin-Guides.html#96">9.5.2.&#160;Global&#160;Hard&#160;and&#160;Soft&#160;Limits.................................................................................................82<br/>9.5.3.&#160;Giving&#160;specific&#160;users&#160;larger&#160;limits.........................................................................................82<br/>9.5.4.&#160;Limiting&#160;who&#160;can&#160;do&#160;paged&#160;searches....................................................................................82</a><br/>
<a href="OpenLDAP-Admin-Guides.html#140">9.6.&#160;Further&#160;Information.........................................................................................................................83</a><br/>
<a href="OpenLDAP-Admin-Guides.html#97"><b>10.&#160;Database&#160;Creation&#160;and&#160;Maintenance&#160;Tools..............................................................................................83</b></a><br/>
<a href="OpenLDAP-Admin-Guides.html#97">10.1.&#160;Creating&#160;a&#160;database&#160;over&#160;LDAP....................................................................................................84<br/></a><a href="OpenLDAP-Admin-Guides.html#98">10.2.&#160;Creating&#160;a&#160;database&#160;off-line..........................................................................................................85</a><br/>
<a href="OpenLDAP-Admin-Guides.html#99">10.2.1.&#160;The&#160;slapadd&#160;program...........................................................................................................86<br/></a><a href="OpenLDAP-Admin-Guides.html#100">10.2.2.&#160;The&#160;slapindex&#160;program........................................................................................................86<br/>10.2.3.&#160;The&#160;slapcat&#160;program............................................................................................................86</a><br/>
<a href="OpenLDAP-Admin-Guides.html#100">10.3.&#160;The&#160;LDIF&#160;text&#160;entry&#160;format...........................................................................................................89</a><br/>
<a href="OpenLDAP-Admin-Guides.html#204"><b>11.&#160;Backends......................................................................................................................................................89</b></a><br/>
<a href="OpenLDAP-Admin-Guides.html#103">11.1.&#160;Berkeley&#160;DB&#160;Backends.................................................................................................................89</a><br/>
<a href="OpenLDAP-Admin-Guides.html#140">11.1.1.&#160;Overview.............................................................................................................................89<br/></a><a href="OpenLDAP-Admin-Guides.html#103">11.1.2.&#160;back-bdb/back-hdb&#160;Configuration.......................................................................................89<br/></a><a href="OpenLDAP-Admin-Guides.html#140">11.1.3.&#160;Further&#160;Information.............................................................................................................89</a><br/>
<a href="OpenLDAP-Admin-Guides.html#103">11.2.&#160;LDAP............................................................................................................................................89</a><br/>
<a href="OpenLDAP-Admin-Guides.html#140">11.2.1.&#160;Overview.............................................................................................................................90<br/></a><a href="OpenLDAP-Admin-Guides.html#104">11.2.2.&#160;back-ldap&#160;Configuration......................................................................................................91<br/></a><a href="OpenLDAP-Admin-Guides.html#140">11.2.3.&#160;Further&#160;Information.............................................................................................................91</a><br/>
<a href="OpenLDAP-Admin-Guides.html#105">11.3.&#160;LDIF..............................................................................................................................................91</a><br/>
<a href="OpenLDAP-Admin-Guides.html#140">11.3.1.&#160;Overview.............................................................................................................................91<br/></a><a href="OpenLDAP-Admin-Guides.html#105">11.3.2.&#160;back-ldif&#160;Configuration.......................................................................................................92<br/></a><a href="OpenLDAP-Admin-Guides.html#140">11.3.3.&#160;Further&#160;Information.............................................................................................................92</a><br/>
<a href="OpenLDAP-Admin-Guides.html#106">11.4.&#160;LMDB...........................................................................................................................................92</a><br/>
<a href="OpenLDAP-Admin-Guides.html#140">11.4.1.&#160;Overview.............................................................................................................................92<br/></a><a href="OpenLDAP-Admin-Guides.html#106">11.4.2.&#160;back-mdb&#160;Configuration......................................................................................................92<br/></a><a href="OpenLDAP-Admin-Guides.html#140">11.4.3.&#160;Further&#160;Information.............................................................................................................92</a><br/>
<a href="OpenLDAP-Admin-Guides.html#106">11.5.&#160;Metadirectory................................................................................................................................93</a><br/>
<a href="OpenLDAP-Admin-Guides.html#140">11.5.1.&#160;Overview.............................................................................................................................93</a><br/>
iii<br/>
<hr/>
<a name=6></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
<b>Table of Contents</b><br/>
<a href="OpenLDAP-Admin-Guides.html#204"><b>11.&#160;Backends</b></a><br/>
<a href="OpenLDAP-Admin-Guides.html#107">11.5.2.&#160;back-meta&#160;Configuration.....................................................................................................93<br/></a><a href="OpenLDAP-Admin-Guides.html#140">11.5.3.&#160;Further&#160;Information.............................................................................................................93</a><br/>
<a href="OpenLDAP-Admin-Guides.html#107">11.6.&#160;Monitor.........................................................................................................................................93</a><br/>
<a href="OpenLDAP-Admin-Guides.html#140">11.6.1.&#160;Overview.............................................................................................................................93<br/></a><a href="OpenLDAP-Admin-Guides.html#107">11.6.2.&#160;back-monitor&#160;Configuration................................................................................................94<br/></a><a href="OpenLDAP-Admin-Guides.html#140">11.6.3.&#160;Further&#160;Information.............................................................................................................94</a><br/>
<a href="OpenLDAP-Admin-Guides.html#108">11.7.&#160;Null</a>...............................................................................................................................................94<br/>
<a href="OpenLDAP-Admin-Guides.html#140">11.7.1.&#160;Overview.............................................................................................................................95<br/></a><a href="OpenLDAP-Admin-Guides.html#109">11.7.2.&#160;back-null&#160;Configuration......................................................................................................95<br/></a><a href="OpenLDAP-Admin-Guides.html#140">11.7.3.&#160;Further&#160;Information.............................................................................................................95</a><br/>
<a href="OpenLDAP-Admin-Guides.html#240">11.8.&#160;Passwd..........................................................................................................................................95</a><br/>
<a href="OpenLDAP-Admin-Guides.html#140">11.8.1.&#160;Overview.............................................................................................................................95<br/></a><a href="OpenLDAP-Admin-Guides.html#109">11.8.2.&#160;back-passwd&#160;Configuration.................................................................................................96<br/></a><a href="OpenLDAP-Admin-Guides.html#140">11.8.3.&#160;Further&#160;Information.............................................................................................................96</a><br/>
<a href="OpenLDAP-Admin-Guides.html#110">11.9.&#160;Perl/Shell.......................................................................................................................................96</a><br/>
<a href="OpenLDAP-Admin-Guides.html#140">11.9.1.&#160;Overview.............................................................................................................................96<br/></a><a href="OpenLDAP-Admin-Guides.html#110">11.9.2.&#160;back-perl/back-shell&#160;Configuration.....................................................................................96<br/></a><a href="OpenLDAP-Admin-Guides.html#140">11.9.3.&#160;Further&#160;Information.............................................................................................................96</a><br/>
<a href="OpenLDAP-Admin-Guides.html#110">11.10.&#160;Relay...........................................................................................................................................97</a><br/>
<a href="OpenLDAP-Admin-Guides.html#140">11.10.1.&#160;Overview...........................................................................................................................97<br/></a><a href="OpenLDAP-Admin-Guides.html#111">11.10.2.&#160;back-relay&#160;Configuration...................................................................................................97<br/></a><a href="OpenLDAP-Admin-Guides.html#140">11.10.3.&#160;Further&#160;Information...........................................................................................................97</a><br/>
<a href="OpenLDAP-Admin-Guides.html#111">11.11.&#160;SQL.............................................................................................................................................97</a><br/>
<a href="OpenLDAP-Admin-Guides.html#140">11.11.1.&#160;Overview...........................................................................................................................97<br/></a><a href="OpenLDAP-Admin-Guides.html#111">11.11.2.&#160;back-sql&#160;Configuration......................................................................................................99<br/></a><a href="OpenLDAP-Admin-Guides.html#140">11.11.3.&#160;Further&#160;Information.........................................................................................................101</a><br/>
<a href="OpenLDAP-Admin-Guides.html#239"><b>12.&#160;Overlays.....................................................................................................................................................102</b></a><br/>
<a href="OpenLDAP-Admin-Guides.html#116">12.1.&#160;Access&#160;Logging...........................................................................................................................102</a><br/>
<a href="OpenLDAP-Admin-Guides.html#140">12.1.1.&#160;Overview...........................................................................................................................102<br/></a><a href="OpenLDAP-Admin-Guides.html#116">12.1.2.&#160;Access&#160;Logging&#160;Configuration..........................................................................................103<br/></a><a href="OpenLDAP-Admin-Guides.html#140">12.1.3.&#160;Further&#160;Information...........................................................................................................103</a><br/>
<a href="OpenLDAP-Admin-Guides.html#117">12.2.&#160;Audit&#160;Logging.............................................................................................................................103</a><br/>
<a href="OpenLDAP-Admin-Guides.html#140">12.2.1.&#160;Overview...........................................................................................................................104<br/></a><a href="OpenLDAP-Admin-Guides.html#118">12.2.2.&#160;Audit&#160;Logging&#160;Configuration............................................................................................104<br/></a><a href="OpenLDAP-Admin-Guides.html#140">12.2.3.&#160;Further&#160;Information...........................................................................................................104</a><br/>
<a href="OpenLDAP-Admin-Guides.html#118">12.3.&#160;Chaining......................................................................................................................................105</a><br/>
<a href="OpenLDAP-Admin-Guides.html#140">12.3.1.&#160;Overview...........................................................................................................................105<br/></a><a href="OpenLDAP-Admin-Guides.html#119">12.3.2.&#160;Chaining&#160;Configuration.....................................................................................................106<br/></a><a href="OpenLDAP-Admin-Guides.html#120">12.3.3.&#160;Handling&#160;Chaining&#160;Errors.................................................................................................106<br/>12.3.4.&#160;Read-Back&#160;of&#160;Chained&#160;Modifications...............................................................................106<br/></a><a href="OpenLDAP-Admin-Guides.html#140">12.3.5.&#160;Further&#160;Information...........................................................................................................106</a><br/>
<a href="OpenLDAP-Admin-Guides.html#120">12.4.&#160;Constraints..................................................................................................................................106</a><br/>
<a href="OpenLDAP-Admin-Guides.html#140">12.4.1.&#160;Overview...........................................................................................................................106<br/></a><a href="OpenLDAP-Admin-Guides.html#120">12.4.2.&#160;Constraint&#160;Configuration...................................................................................................107<br/></a><a href="OpenLDAP-Admin-Guides.html#140">12.4.3.&#160;Further&#160;Information...........................................................................................................107</a><br/>
<a href="OpenLDAP-Admin-Guides.html#121">12.5.&#160;Dynamic&#160;Directory&#160;Services.......................................................................................................107</a><br/>
iv<br/>
<hr/>
<a name=7></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
<b>Table of Contents</b><br/>
<a href="OpenLDAP-Admin-Guides.html#239"><b>12.&#160;Overlays</b></a><br/>
<a href="OpenLDAP-Admin-Guides.html#140">12.5.1.&#160;Overview...........................................................................................................................107<br/></a><a href="OpenLDAP-Admin-Guides.html#121">12.5.2.&#160;Dynamic&#160;Directory&#160;Service&#160;Configuration........................................................................108<br/></a><a href="OpenLDAP-Admin-Guides.html#140">12.5.3.&#160;Further&#160;Information...........................................................................................................109</a><br/>
<a href="OpenLDAP-Admin-Guides.html#123">12.6.&#160;Dynamic&#160;Groups.........................................................................................................................109</a><br/>
<a href="OpenLDAP-Admin-Guides.html#140">12.6.1.&#160;Overview...........................................................................................................................109<br/></a><a href="OpenLDAP-Admin-Guides.html#123">12.6.2.&#160;Dynamic&#160;Group&#160;Configuration..........................................................................................109</a><br/>
<a href="OpenLDAP-Admin-Guides.html#123">12.7.&#160;Dynamic&#160;Lists.............................................................................................................................109</a><br/>
<a href="OpenLDAP-Admin-Guides.html#140">12.7.1.&#160;Overview...........................................................................................................................109<br/></a><a href="OpenLDAP-Admin-Guides.html#123">12.7.2.&#160;Dynamic&#160;List&#160;Configuration..............................................................................................111<br/></a><a href="OpenLDAP-Admin-Guides.html#140">12.7.3.&#160;Further&#160;Information...........................................................................................................111</a><br/>
<a href="OpenLDAP-Admin-Guides.html#125">12.8.&#160;Reverse&#160;Group&#160;Membership&#160;Maintenance..................................................................................111</a><br/>
<a href="OpenLDAP-Admin-Guides.html#140">12.8.1.&#160;Overview...........................................................................................................................111<br/></a><a href="OpenLDAP-Admin-Guides.html#125">12.8.2.&#160;Member&#160;Of&#160;Configuration.................................................................................................112<br/></a><a href="OpenLDAP-Admin-Guides.html#140">12.8.3.&#160;Further&#160;Information...........................................................................................................112</a><br/>
<a href="OpenLDAP-Admin-Guides.html#126">12.9.&#160;The&#160;Proxy&#160;Cache&#160;Engine............................................................................................................112</a><br/>
<a href="OpenLDAP-Admin-Guides.html#140">12.9.1.&#160;Overview...........................................................................................................................113<br/></a><a href="OpenLDAP-Admin-Guides.html#127">12.9.2.&#160;Proxy&#160;Cache&#160;Configuration...............................................................................................115<br/></a><a href="OpenLDAP-Admin-Guides.html#140">12.9.3.&#160;Further&#160;Information...........................................................................................................115</a><br/>
<a href="OpenLDAP-Admin-Guides.html#129">12.10.&#160;Password&#160;Policies</a>.....................................................................................................................115<br/>
<a href="OpenLDAP-Admin-Guides.html#140">12.10.1.&#160;Overview.........................................................................................................................116<br/></a><a href="OpenLDAP-Admin-Guides.html#130">12.10.2.&#160;Password&#160;Policy&#160;Configuration.......................................................................................117<br/></a><a href="OpenLDAP-Admin-Guides.html#140">12.10.3.&#160;Further&#160;Information.........................................................................................................117</a><br/>
<a href="OpenLDAP-Admin-Guides.html#131">12.11.&#160;Referential&#160;Integrity..................................................................................................................118</a><br/>
<a href="OpenLDAP-Admin-Guides.html#140">12.11.1.&#160;Overview.........................................................................................................................118<br/></a><a href="OpenLDAP-Admin-Guides.html#132">12.11.2.&#160;Referential&#160;Integrity&#160;Configuration.................................................................................119<br/></a><a href="OpenLDAP-Admin-Guides.html#140">12.11.3.&#160;Further&#160;Information.........................................................................................................119</a><br/>
<a href="OpenLDAP-Admin-Guides.html#133">12.12.&#160;Return&#160;Code..............................................................................................................................119</a><br/>
<a href="OpenLDAP-Admin-Guides.html#140">12.12.1.&#160;Overview.........................................................................................................................119<br/></a><a href="OpenLDAP-Admin-Guides.html#133">12.12.2.&#160;Return&#160;Code&#160;Configuration.............................................................................................120<br/></a><a href="OpenLDAP-Admin-Guides.html#140">12.12.3.&#160;Further&#160;Information.........................................................................................................120</a><br/>
<a href="OpenLDAP-Admin-Guides.html#134">12.13.&#160;Rewrite/Remap.........................................................................................................................120</a><br/>
<a href="OpenLDAP-Admin-Guides.html#140">12.13.1.&#160;Overview.........................................................................................................................120<br/></a><a href="OpenLDAP-Admin-Guides.html#134">12.13.2.&#160;Rewrite/Remap&#160;Configuration........................................................................................120<br/></a><a href="OpenLDAP-Admin-Guides.html#140">12.13.3.&#160;Further&#160;Information.........................................................................................................120</a><br/>
<a href="OpenLDAP-Admin-Guides.html#134">12.14.&#160;Sync&#160;Provider............................................................................................................................121</a><br/>
<a href="OpenLDAP-Admin-Guides.html#140">12.14.1.&#160;Overview.........................................................................................................................121<br/></a><a href="OpenLDAP-Admin-Guides.html#135">12.14.2.&#160;Sync&#160;Provider&#160;Configuration...........................................................................................121<br/></a><a href="OpenLDAP-Admin-Guides.html#140">12.14.3.&#160;Further&#160;Information.........................................................................................................121</a><br/>
<a href="OpenLDAP-Admin-Guides.html#135">12.15.&#160;Translucent&#160;Proxy.....................................................................................................................121</a><br/>
<a href="OpenLDAP-Admin-Guides.html#140">12.15.1.&#160;Overview.........................................................................................................................121<br/></a><a href="OpenLDAP-Admin-Guides.html#135">12.15.2.&#160;Translucent&#160;Proxy&#160;Configuration....................................................................................123<br/></a><a href="OpenLDAP-Admin-Guides.html#140">12.15.3.&#160;Further&#160;Information.........................................................................................................123</a><br/>
<a href="OpenLDAP-Admin-Guides.html#137">12.16.&#160;Attribute&#160;Uniqueness................................................................................................................123</a><br/>
<a href="OpenLDAP-Admin-Guides.html#140">12.16.1.&#160;Overview.........................................................................................................................123<br/></a><a href="OpenLDAP-Admin-Guides.html#137">12.16.2.&#160;Attribute&#160;Uniqueness&#160;Configuration...............................................................................124<br/></a><a href="OpenLDAP-Admin-Guides.html#140">12.16.3.&#160;Further&#160;Information.........................................................................................................125</a><br/>
<a href="OpenLDAP-Admin-Guides.html#139">12.17.&#160;Value&#160;Sorting............................................................................................................................125</a><br/>
v<br/>
<hr/>
<a name=8></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
<b>Table of Contents</b><br/>
<a href="OpenLDAP-Admin-Guides.html#239"><b>12.&#160;Overlays</b></a><br/>
<a href="OpenLDAP-Admin-Guides.html#140">12.17.1.&#160;Overview.........................................................................................................................125<br/></a><a href="OpenLDAP-Admin-Guides.html#139">12.17.2.&#160;Value&#160;Sorting&#160;Configuration...........................................................................................126<br/></a><a href="OpenLDAP-Admin-Guides.html#140">12.17.3.&#160;Further&#160;Information.........................................................................................................126</a><br/>
<a href="OpenLDAP-Admin-Guides.html#140">12.18.&#160;Overlay&#160;Stacking.......................................................................................................................126</a><br/>
<a href="OpenLDAP-Admin-Guides.html#140">12.18.1.&#160;Overview.........................................................................................................................126<br/>12.18.2.&#160;Example&#160;Scenarios..........................................................................................................127</a><br/>
<a href="OpenLDAP-Admin-Guides.html#141"><b>13.&#160;Schema&#160;Specification................................................................................................................................127</b></a><br/>
<a href="OpenLDAP-Admin-Guides.html#141">13.1.&#160;Distributed&#160;Schema&#160;Files............................................................................................................127<br/>13.2.&#160;Extending&#160;Schema......................................................................................................................128</a><br/>
<a href="OpenLDAP-Admin-Guides.html#142">13.2.1.&#160;Object&#160;Identifiers...............................................................................................................129<br/></a><a href="OpenLDAP-Admin-Guides.html#143">13.2.2.&#160;Naming&#160;Elements..............................................................................................................129<br/>13.2.3.&#160;Local&#160;schema&#160;file...............................................................................................................129<br/>13.2.4.&#160;Attribute&#160;Type&#160;Specification.............................................................................................132<br/></a><a href="OpenLDAP-Admin-Guides.html#146">13.2.5.&#160;Object&#160;Class&#160;Specification.................................................................................................133<br/></a><a href="OpenLDAP-Admin-Guides.html#147">13.2.6.&#160;OID&#160;Macros.......................................................................................................................135</a><br/>
<a href="OpenLDAP-Admin-Guides.html#149"><b>14.&#160;Security&#160;Considerations............................................................................................................................135</b></a><br/>
<a href="OpenLDAP-Admin-Guides.html#149">14.1.&#160;Network&#160;Security........................................................................................................................135</a><br/>
<a href="OpenLDAP-Admin-Guides.html#149">14.1.1.&#160;Selective&#160;Listening............................................................................................................135<br/>14.1.2.&#160;IP&#160;Firewall.........................................................................................................................135<br/>14.1.3.&#160;TCP&#160;Wrappers...................................................................................................................136</a><br/>
<a href="OpenLDAP-Admin-Guides.html#150">14.2.&#160;Data&#160;Integrity&#160;and&#160;Confidentiality&#160;Protection.............................................................................136</a><br/>
<a href="OpenLDAP-Admin-Guides.html#150">14.2.1.&#160;Security&#160;Strength&#160;Factors..................................................................................................136</a><br/>
<a href="OpenLDAP-Admin-Guides.html#150">14.3.&#160;Authentication&#160;Methods..............................................................................................................136</a><br/>
<a href="OpenLDAP-Admin-Guides.html#150">14.3.1.&#160;&#34;simple&#34;&#160;method................................................................................................................137<br/></a><a href="OpenLDAP-Admin-Guides.html#151">14.3.2.&#160;SASL&#160;method....................................................................................................................137</a><br/>
<a href="OpenLDAP-Admin-Guides.html#151">14.4.&#160;Password&#160;Storage........................................................................................................................138</a><br/>
<a href="OpenLDAP-Admin-Guides.html#152">14.4.1.&#160;SSHA&#160;password&#160;storage&#160;scheme.......................................................................................138<br/>14.4.2.&#160;CRYPT&#160;password&#160;storage&#160;scheme....................................................................................138<br/>14.4.3.&#160;MD5&#160;password&#160;storage&#160;scheme.........................................................................................138<br/>14.4.4.&#160;SMD5&#160;password&#160;storage&#160;scheme.......................................................................................139<br/></a><a href="OpenLDAP-Admin-Guides.html#153">14.4.5.&#160;SHA&#160;password&#160;storage&#160;scheme.........................................................................................139<br/>14.4.6.&#160;SASL&#160;password&#160;storage&#160;scheme........................................................................................139</a><br/>
<a href="OpenLDAP-Admin-Guides.html#153">14.5.&#160;Pass-Through&#160;authentication.......................................................................................................139</a><br/>
<a href="OpenLDAP-Admin-Guides.html#153">14.5.1.&#160;Configuring&#160;slapd&#160;to&#160;use&#160;an&#160;authentication&#160;provider.........................................................140<br/></a><a href="OpenLDAP-Admin-Guides.html#154">14.5.2.&#160;Configuring&#160;saslauthd........................................................................................................140<br/>14.5.3.&#160;Testing&#160;pass-through&#160;authentication..................................................................................143</a><br/>
<a href="OpenLDAP-Admin-Guides.html#157"><b>15.&#160;Using&#160;SASL................................................................................................................................................143</b></a><br/>
<a href="OpenLDAP-Admin-Guides.html#157">15.1.&#160;SASL&#160;Security&#160;Considerations...................................................................................................144<br/></a><a href="OpenLDAP-Admin-Guides.html#158">15.2.&#160;SASL&#160;Authentication..................................................................................................................144</a><br/>
<a href="OpenLDAP-Admin-Guides.html#158">15.2.1.&#160;GSSAPI.............................................................................................................................145<br/></a><a href="OpenLDAP-Admin-Guides.html#159">15.2.2.&#160;KERBEROS_V4...............................................................................................................146<br/></a><a href="OpenLDAP-Admin-Guides.html#160">15.2.3.&#160;DIGEST-MD5...................................................................................................................147<br/></a><a href="OpenLDAP-Admin-Guides.html#161">15.2.4.&#160;EXTERNAL......................................................................................................................147<br/>15.2.5.&#160;Mapping&#160;Authentication&#160;Identities....................................................................................148</a><br/>
vi<br/>
<hr/>
<a name=9></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
<b>Table of Contents</b><br/>
<a href="OpenLDAP-Admin-Guides.html#157"><b>15.&#160;Using&#160;SASL</b></a><br/>
<a href="OpenLDAP-Admin-Guides.html#162">15.2.6.&#160;Direct&#160;Mapping..................................................................................................................149<br/></a><a href="OpenLDAP-Admin-Guides.html#163">15.2.7.&#160;Search-based&#160;mappings.....................................................................................................150</a><br/>
<a href="OpenLDAP-Admin-Guides.html#164">15.3.&#160;SASL&#160;Proxy&#160;Authorization.........................................................................................................151</a><br/>
<a href="OpenLDAP-Admin-Guides.html#165">15.3.1.&#160;Uses&#160;of&#160;Proxy&#160;Authorization.............................................................................................151<br/>15.3.2.&#160;SASL&#160;Authorization&#160;Identities..........................................................................................152<br/></a><a href="OpenLDAP-Admin-Guides.html#166">15.3.3.&#160;Proxy&#160;Authorization&#160;Rules................................................................................................155</a><br/>
<a href="OpenLDAP-Admin-Guides.html#169"><b>16.&#160;Using&#160;TLS..................................................................................................................................................155</b></a><br/>
<a href="OpenLDAP-Admin-Guides.html#169">16.1.&#160;TLS&#160;Certificates..........................................................................................................................155</a><br/>
<a href="OpenLDAP-Admin-Guides.html#169">16.1.1.&#160;Server&#160;Certificates.............................................................................................................155<br/>16.1.2.&#160;Client&#160;Certificates..............................................................................................................155</a><br/>
<a href="OpenLDAP-Admin-Guides.html#169">16.2.&#160;TLS&#160;Configuration......................................................................................................................155</a><br/>
<a href="OpenLDAP-Admin-Guides.html#169">16.2.1.&#160;Server&#160;Configuration.........................................................................................................158<br/></a><a href="OpenLDAP-Admin-Guides.html#172">16.2.2.&#160;Client&#160;Configuration..........................................................................................................161</a><br/>
<a href="OpenLDAP-Admin-Guides.html#175"><b>17.&#160;Constructing&#160;a&#160;Distributed&#160;Directory&#160;Service........................................................................................161</b></a><br/>
<a href="OpenLDAP-Admin-Guides.html#175">17.1.&#160;Subordinate&#160;Knowledge&#160;Information..........................................................................................161<br/>17.2.&#160;Superior&#160;Knowledge&#160;Information...............................................................................................162<br/></a><a href="OpenLDAP-Admin-Guides.html#176">17.3.&#160;The&#160;ManageDsaIT&#160;Control.........................................................................................................163</a><br/>
<a href="OpenLDAP-Admin-Guides.html#177"><b>18.&#160;Replication.................................................................................................................................................163</b></a><br/>
<a href="OpenLDAP-Admin-Guides.html#177">18.1.&#160;Replication&#160;Technology..............................................................................................................163</a><br/>
<a href="OpenLDAP-Admin-Guides.html#177">18.1.1.&#160;LDAP&#160;Sync&#160;Replication....................................................................................................167</a><br/>
<a href="OpenLDAP-Admin-Guides.html#181">18.2.&#160;Deployment&#160;Alternatives............................................................................................................167</a><br/>
<a href="OpenLDAP-Admin-Guides.html#181">18.2.1.&#160;Delta-syncrepl&#160;replication.................................................................................................167<br/>18.2.2.&#160;N-Way&#160;Multi-Master&#160;replication.......................................................................................168<br/></a><a href="OpenLDAP-Admin-Guides.html#182">18.2.3.&#160;MirrorMode&#160;replication.....................................................................................................169<br/></a><a href="OpenLDAP-Admin-Guides.html#183">18.2.4.&#160;Syncrepl&#160;Proxy&#160;Mode........................................................................................................170</a><br/>
<a href="OpenLDAP-Admin-Guides.html#184">18.3.&#160;Configuring&#160;the&#160;different&#160;replication&#160;types.................................................................................170</a><br/>
<a href="OpenLDAP-Admin-Guides.html#184">18.3.1.&#160;Syncrepl.............................................................................................................................172<br/></a><a href="OpenLDAP-Admin-Guides.html#186">18.3.2.&#160;Delta-syncrepl...................................................................................................................174<br/></a><a href="OpenLDAP-Admin-Guides.html#188">18.3.3.&#160;N-Way&#160;Multi-Master.........................................................................................................175<br/></a><a href="OpenLDAP-Admin-Guides.html#189">18.3.4.&#160;MirrorMode.......................................................................................................................177<br/></a><a href="OpenLDAP-Admin-Guides.html#191">18.3.5.&#160;Syncrepl&#160;Proxy..................................................................................................................183</a><br/>
<a href="OpenLDAP-Admin-Guides.html#197"><b>19.&#160;Maintenance..............................................................................................................................................183</b></a><br/>
<a href="OpenLDAP-Admin-Guides.html#197">19.1.&#160;Directory&#160;Backups......................................................................................................................183<br/>19.2.&#160;Berkeley&#160;DB&#160;Logs.......................................................................................................................185<br/></a><a href="OpenLDAP-Admin-Guides.html#199">19.3.&#160;Checkpointing.............................................................................................................................185<br/>19.4.&#160;Migration</a>....................................................................................................................................187<br/>
<a href="OpenLDAP-Admin-Guides.html#201"><b>20.&#160;Monitoring.................................................................................................................................................187</b></a><br/>
<a href="OpenLDAP-Admin-Guides.html#201">20.1.&#160;Monitor&#160;configuration&#160;via&#160;cn=config(5).....................................................................................187<br/>20.2.&#160;Monitor&#160;configuration&#160;via&#160;slapd.conf(5).....................................................................................188<br/></a><a href="OpenLDAP-Admin-Guides.html#202">20.3.&#160;Accessing&#160;Monitoring&#160;Information.............................................................................................189<br/></a><a href="OpenLDAP-Admin-Guides.html#203">20.4.&#160;Monitor&#160;Information...................................................................................................................190</a><br/>
<a href="OpenLDAP-Admin-Guides.html#204">20.4.1.&#160;Backends...........................................................................................................................191</a><br/>
vii<br/>
<hr/>
<a name=10></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
<b>Table of Contents</b><br/>
<a href="OpenLDAP-Admin-Guides.html#201"><b>20.&#160;Monitoring</b></a><br/>
<a href="OpenLDAP-Admin-Guides.html#205">20.4.2.&#160;Connections.......................................................................................................................191<br/>20.4.3.&#160;Databases...........................................................................................................................192<br/></a><a href="OpenLDAP-Admin-Guides.html#206">20.4.4.&#160;Listener..............................................................................................................................192<br/>20.4.5.&#160;Log.....................................................................................................................................192<br/>20.4.6.&#160;Operations.........................................................................................................................193<br/></a><a href="OpenLDAP-Admin-Guides.html#239">20.4.7.&#160;Overlays.............................................................................................................................193<br/></a><a href="OpenLDAP-Admin-Guides.html#207">20.4.8.&#160;SASL.................................................................................................................................193<br/>20.4.9.&#160;Statistics.............................................................................................................................193<br/>20.4.10.&#160;Threads............................................................................................................................194<br/></a><a href="OpenLDAP-Admin-Guides.html#208">20.4.11.&#160;Time.................................................................................................................................194<br/>20.4.12.&#160;TLS..................................................................................................................................194<br/>20.4.13.&#160;Waiters.............................................................................................................................195</a><br/>
<a href="OpenLDAP-Admin-Guides.html#209"><b>21.&#160;Tuning........................................................................................................................................................195</b></a><br/>
<a href="OpenLDAP-Admin-Guides.html#209">21.1.&#160;Performance&#160;Factors...................................................................................................................195</a><br/>
<a href="OpenLDAP-Admin-Guides.html#209">21.1.1.&#160;Memory.............................................................................................................................195<br/>21.1.2.&#160;Disks..................................................................................................................................195<br/>21.1.3.&#160;Network&#160;Topology............................................................................................................195<br/>21.1.4.&#160;Directory&#160;Layout&#160;Design...................................................................................................196<br/></a><a href="OpenLDAP-Admin-Guides.html#210">21.1.5.&#160;Expected&#160;Usage.................................................................................................................196</a><br/>
<a href="OpenLDAP-Admin-Guides.html#210">21.2.&#160;Indexes........................................................................................................................................196</a><br/>
<a href="OpenLDAP-Admin-Guides.html#210">21.2.1.&#160;Understanding&#160;how&#160;a&#160;search&#160;works...................................................................................196<br/>21.2.2.&#160;What&#160;to&#160;index....................................................................................................................196<br/>21.2.3.&#160;Presence&#160;indexing..............................................................................................................196</a><br/>
<a href="OpenLDAP-Admin-Guides.html#210">21.3.&#160;Logging.......................................................................................................................................197</a><br/>
<a href="OpenLDAP-Admin-Guides.html#211">21.3.1.&#160;What&#160;log&#160;level&#160;to&#160;use.........................................................................................................197<br/>21.3.2.&#160;What&#160;to&#160;watch&#160;out&#160;for........................................................................................................197<br/>21.3.3.&#160;Improving&#160;throughput........................................................................................................197</a><br/>
<a href="OpenLDAP-Admin-Guides.html#211">21.4.&#160;Caching.......................................................................................................................................198</a><br/>
<a href="OpenLDAP-Admin-Guides.html#212">21.4.1.&#160;Berkeley&#160;DB&#160;Cache...........................................................................................................200<br/></a><a href="OpenLDAP-Admin-Guides.html#214">21.4.2.&#160;slapd(8)&#160;Entry&#160;Cache&#160;(cachesize)......................................................................................200<br/>21.4.3.&#160;IDL&#160;Cache&#160;(idlcachesize)..................................................................................................200</a><br/>
<a href="OpenLDAP-Admin-Guides.html#214">21.5.&#160;slapd(8)&#160;Threads..........................................................................................................................201</a><br/>
<a href="OpenLDAP-Admin-Guides.html#215"><b>22.&#160;Troubleshooting........................................................................................................................................201</b></a><br/>
<a href="OpenLDAP-Admin-Guides.html#215">22.1.&#160;User&#160;or&#160;Software&#160;errors?.............................................................................................................201<br/>22.2.&#160;Checklist</a>.....................................................................................................................................201<br/><a href="OpenLDAP-Admin-Guides.html#215">22.3.&#160;OpenLDAP&#160;Bugs........................................................................................................................202<br/></a><a href="OpenLDAP-Admin-Guides.html#216">22.4.&#160;3rd&#160;party&#160;software&#160;error..............................................................................................................202<br/>22.5.&#160;How&#160;to&#160;contact&#160;the&#160;OpenLDAP&#160;Project......................................................................................202<br/>22.6.&#160;How&#160;to&#160;present&#160;your&#160;problem</a>.....................................................................................................202<br/><a href="OpenLDAP-Admin-Guides.html#216">22.7.&#160;Debugging&#160;slapd(8).....................................................................................................................202<br/>22.8.&#160;Commercial&#160;Support...................................................................................................................203</a><br/>
<a href="OpenLDAP-Admin-Guides.html#217"><b>A.&#160;Changes&#160;Since&#160;Previous&#160;Release...............................................................................................................203</b></a><br/>
<a href="OpenLDAP-Admin-Guides.html#217">A.1.&#160;New&#160;Guide&#160;Sections.....................................................................................................................203<br/>A.2.&#160;New&#160;Features&#160;and&#160;Enhancements&#160;in&#160;2.4......................................................................................203</a><br/>
viii<br/>
<hr/>
<a name=11></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
<b>Table of Contents</b><br/>
<a href="OpenLDAP-Admin-Guides.html#217"><b>A.&#160;Changes&#160;Since&#160;Previous&#160;Release</b></a><br/>
<a href="OpenLDAP-Admin-Guides.html#217">A.2.1.&#160;Better&#160;cn=config&#160;functionality............................................................................................204<br/></a><a href="OpenLDAP-Admin-Guides.html#218">A.2.2.&#160;Better&#160;cn=schema&#160;functionality..........................................................................................204<br/>A.2.3.&#160;More&#160;sophisticated&#160;Syncrepl&#160;configurations......................................................................204<br/>A.2.4.&#160;N-Way&#160;Multimaster&#160;Replication........................................................................................204<br/>A.2.5.&#160;Replicating&#160;slapd&#160;Configuration&#160;(syncrepl&#160;and&#160;cn=config)...............................................204<br/>A.2.6.&#160;Push-Mode&#160;Replication......................................................................................................205<br/></a><a href="OpenLDAP-Admin-Guides.html#219">A.2.7.&#160;More&#160;extensive&#160;TLS&#160;configuration&#160;control........................................................................205<br/>A.2.8.&#160;Performance&#160;enhancements................................................................................................205<br/>A.2.9.&#160;New&#160;overlays......................................................................................................................205<br/>A.2.10.&#160;New&#160;features&#160;in&#160;existing&#160;Overlays....................................................................................206<br/></a><a href="OpenLDAP-Admin-Guides.html#220">A.2.11.&#160;New&#160;features&#160;in&#160;slapd.......................................................................................................206<br/>A.2.12.&#160;New&#160;features&#160;in&#160;libldap.....................................................................................................206<br/>A.2.13.&#160;New&#160;clients,&#160;tools&#160;and&#160;tool&#160;enhancements........................................................................206<br/>A.2.14.&#160;New&#160;build&#160;options.............................................................................................................206</a><br/>
<a href="OpenLDAP-Admin-Guides.html#220">A.3.&#160;Obsolete&#160;Features&#160;Removed&#160;From&#160;2.4.........................................................................................206</a><br/>
<a href="OpenLDAP-Admin-Guides.html#220">A.3.1.&#160;Slurpd.................................................................................................................................206<br/>A.3.2.&#160;back-ldbm...........................................................................................................................207</a><br/>
<a href="OpenLDAP-Admin-Guides.html#221"><b>B.&#160;Upgrading&#160;from&#160;2.3.x.................................................................................................................................207</b></a><br/>
<a href="OpenLDAP-Admin-Guides.html#221">B.1.&#160;cn=config&#160;olc*&#160;attributes..............................................................................................................207<br/>B.2.&#160;ACLs:&#160;searches&#160;require&#160;privileges&#160;on&#160;the&#160;search&#160;base.................................................................209</a><br/>
<a href="OpenLDAP-Admin-Guides.html#223"><b>C.&#160;Common&#160;errors&#160;encountered&#160;when&#160;using&#160;OpenLDAP&#160;Software..........................................................209</b></a><br/>
<a href="OpenLDAP-Admin-Guides.html#223">C.1.&#160;Common&#160;causes&#160;of&#160;LDAP&#160;errors.................................................................................................209</a><br/>
<a href="OpenLDAP-Admin-Guides.html#223">C.1.1.&#160;ldap_*:&#160;Can't&#160;contact&#160;LDAP&#160;server....................................................................................209<br/>C.1.2.&#160;ldap_*:&#160;No&#160;such&#160;object.......................................................................................................210<br/></a><a href="OpenLDAP-Admin-Guides.html#224">C.1.3.&#160;ldap_*:&#160;Can't&#160;chase&#160;referral................................................................................................210<br/>C.1.4.&#160;ldap_*:&#160;server&#160;is&#160;unwilling&#160;to&#160;perform................................................................................211<br/></a><a href="OpenLDAP-Admin-Guides.html#225">C.1.5.&#160;ldap_*:&#160;Insufficient&#160;access..................................................................................................211<br/>C.1.6.&#160;ldap_*:&#160;Invalid&#160;DN&#160;syntax..................................................................................................211<br/>C.1.7.&#160;ldap_*:&#160;Referral&#160;hop&#160;limit&#160;exceeded...................................................................................211<br/>C.1.8.&#160;ldap_*:&#160;operations&#160;error......................................................................................................211<br/>C.1.9.&#160;ldap_*:&#160;other&#160;error..............................................................................................................211<br/>C.1.10.&#160;ldap_add/modify:&#160;Invalid&#160;syntax......................................................................................212<br/></a><a href="OpenLDAP-Admin-Guides.html#226">C.1.11.&#160;ldap_add/modify:&#160;Object&#160;class&#160;violation..........................................................................213<br/></a><a href="OpenLDAP-Admin-Guides.html#227">C.1.12.&#160;ldap_add:&#160;No&#160;such&#160;object..................................................................................................213<br/>C.1.13.&#160;ldap&#160;add:&#160;invalid&#160;structural&#160;object&#160;class&#160;chain..................................................................214<br/></a><a href="OpenLDAP-Admin-Guides.html#228">C.1.14.&#160;ldap_add:&#160;no&#160;structuralObjectClass&#160;operational&#160;attribute.................................................214<br/>C.1.15.&#160;ldap_add/modify/rename:&#160;Naming&#160;violation....................................................................215<br/></a><a href="OpenLDAP-Admin-Guides.html#229">C.1.16.&#160;ldap_add/delete/modify/rename:&#160;no&#160;global&#160;superior&#160;knowledge......................................215<br/>C.1.17.&#160;ldap_bind:&#160;Insufficient&#160;access...........................................................................................215<br/>C.1.18.&#160;ldap_bind:&#160;Invalid&#160;credentials...........................................................................................216<br/></a><a href="OpenLDAP-Admin-Guides.html#230">C.1.19.&#160;ldap_bind:&#160;Protocol&#160;error..................................................................................................216<br/>C.1.20.&#160;ldap_modify:&#160;cannot&#160;modify&#160;object&#160;class.........................................................................216<br/>C.1.21.&#160;ldap_sasl_interactive_bind_s:&#160;..........................................................................................216<br/>C.1.22.&#160;ldap_sasl_interactive_bind_s:&#160;No&#160;such&#160;Object.................................................................216<br/>C.1.23.&#160;ldap_sasl_interactive_bind_s:&#160;No&#160;such&#160;attribute..............................................................217</a><br/>
ix<br/>
<hr/>
<a name=12></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
<b>Table of Contents</b><br/>
<a href="OpenLDAP-Admin-Guides.html#223"><b>C.&#160;Common&#160;errors&#160;encountered&#160;when&#160;using&#160;OpenLDAP&#160;Software</b></a><br/>
<a href="OpenLDAP-Admin-Guides.html#231">C.1.24.&#160;ldap_sasl_interactive_bind_s:&#160;Unknown&#160;authentication&#160;method.....................................217<br/>C.1.25.&#160;ldap_sasl_interactive_bind_s:&#160;Local&#160;error&#160;(82)................................................................217<br/>C.1.26.&#160;ldap_search:&#160;Partial&#160;results&#160;and&#160;referral&#160;received.............................................................217<br/>C.1.27.&#160;ldap_start_tls:&#160;Operations&#160;error........................................................................................217</a><br/>
<a href="OpenLDAP-Admin-Guides.html#231">C.2.&#160;Other&#160;Errors..................................................................................................................................217</a><br/>
<a href="OpenLDAP-Admin-Guides.html#231">C.2.1.&#160;ber_get_next&#160;on&#160;fd&#160;X&#160;failed&#160;errno=34&#160;(Numerical&#160;result&#160;out&#160;of&#160;range)..............................217<br/>C.2.2.&#160;ber_get_next&#160;on&#160;fd&#160;X&#160;failed&#160;errno=11&#160;(Resource&#160;temporarily&#160;unavailable).......................218<br/></a><a href="OpenLDAP-Admin-Guides.html#232">C.2.3.&#160;daemon:&#160;socket()&#160;failed&#160;errno=97&#160;(Address&#160;family&#160;not&#160;supported)....................................218<br/>C.2.4.&#160;GSSAPI:&#160;gss_acquire_cred:&#160;Miscellaneous&#160;failure;&#160;Permission&#160;denied;...........................218<br/>C.2.5.&#160;access&#160;from&#160;unknown&#160;denied..............................................................................................219<br/></a><a href="OpenLDAP-Admin-Guides.html#233">C.2.6.&#160;ldap_read:&#160;want=#&#160;error=Resource&#160;temporarily&#160;unavailable.............................................219<br/>C.2.7.&#160;`make&#160;test'&#160;fails...................................................................................................................220<br/></a><a href="OpenLDAP-Admin-Guides.html#234">C.2.8.&#160;ldap_*:&#160;Internal&#160;(implementation&#160;specific)&#160;error&#160;(80)&#160;-&#160;additional&#160;info:&#160;entry&#160;index</a><br/>
<a href="OpenLDAP-Admin-Guides.html#234">&#160;delete&#160;failed............................................................................................................................220</a><br/>
<a href="OpenLDAP-Admin-Guides.html#234">C.2.9.&#160;ldap_sasl_interactive_bind_s:&#160;Can't&#160;contact&#160;LDAP&#160;server&#160;(-1)..........................................221</a><br/>
<a href="OpenLDAP-Admin-Guides.html#235"><b>D.&#160;Recommended&#160;OpenLDAP&#160;Software&#160;Dependency&#160;Versions.................................................................221</b></a><br/>
<a href="OpenLDAP-Admin-Guides.html#235">D.1.&#160;Dependency&#160;Versions..................................................................................................................223</a><br/>
<a href="OpenLDAP-Admin-Guides.html#237"><b>E.&#160;Real&#160;World&#160;OpenLDAP&#160;Deployments&#160;and&#160;Examples</b></a><b>............................................................................225</b><br/>
<a href="OpenLDAP-Admin-Guides.html#239"><b>F.&#160;OpenLDAP&#160;Software&#160;Contributions.........................................................................................................225</b></a><br/>
<a href="OpenLDAP-Admin-Guides.html#239">F.1.&#160;Client&#160;APIs</a>...................................................................................................................................225<br/>
<a href="OpenLDAP-Admin-Guides.html#239">F.1.1.&#160;ldapc++................................................................................................................................225<br/>F.1.2.&#160;ldaptcl..................................................................................................................................225</a><br/>
<a href="OpenLDAP-Admin-Guides.html#239">F.2.&#160;Overlays........................................................................................................................................225</a><br/>
<a href="OpenLDAP-Admin-Guides.html#239">F.2.1.&#160;acl........................................................................................................................................225<br/>F.2.2.&#160;addpartial.............................................................................................................................225<br/>F.2.3.&#160;allop.....................................................................................................................................225<br/>F.2.4.&#160;autogroup.............................................................................................................................225<br/>F.2.5.&#160;comp_match........................................................................................................................225<br/>F.2.6.&#160;denyop.................................................................................................................................225<br/>F.2.7.&#160;dsaschema...........................................................................................................................226<br/></a><a href="OpenLDAP-Admin-Guides.html#240">F.2.8.&#160;lastmod................................................................................................................................226<br/>F.2.9.&#160;nops.....................................................................................................................................226<br/>F.2.10.&#160;nssov..................................................................................................................................226<br/>F.2.11.&#160;passwd...............................................................................................................................226<br/>F.2.12.&#160;proxyOld...........................................................................................................................226<br/>F.2.13.&#160;smbk5pwd.........................................................................................................................226<br/>F.2.14.&#160;trace...................................................................................................................................226<br/>F.2.15.&#160;usn.....................................................................................................................................226</a><br/>
<a href="OpenLDAP-Admin-Guides.html#240">F.3.&#160;Tools.............................................................................................................................................226</a><br/>
<a href="OpenLDAP-Admin-Guides.html#240">F.3.1.&#160;Statistic&#160;Logging.................................................................................................................226</a><br/>
<a href="OpenLDAP-Admin-Guides.html#240">F.4.&#160;SLAPI&#160;Plugins..............................................................................................................................227</a><br/>
<a href="OpenLDAP-Admin-Guides.html#241">F.4.1.&#160;addrdnvalues.......................................................................................................................229</a><br/>
x<br/>
<hr/>
<a name=13></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
<b>Table of Contents</b><br/>
<a href="OpenLDAP-Admin-Guides.html#243"><b>G.&#160;Configuration&#160;File&#160;Examples....................................................................................................................229</b></a><br/>
<a href="OpenLDAP-Admin-Guides.html#243">G.1.&#160;slapd.conf.....................................................................................................................................229<br/>G.2.&#160;ldap.conf.......................................................................................................................................229<br/>G.3.&#160;a-n-other.conf...............................................................................................................................231</a><br/>
<a href="OpenLDAP-Admin-Guides.html#245"><b>H.&#160;LDAP&#160;Result&#160;Codes...................................................................................................................................231</b></a><br/>
<a href="OpenLDAP-Admin-Guides.html#245">H.1.&#160;Non-Error&#160;Result&#160;Codes...............................................................................................................231<br/>H.2.&#160;Result&#160;Codes................................................................................................................................231<br/>H.3.&#160;success&#160;(0)....................................................................................................................................231<br/>H.4.&#160;operationsError&#160;(1).......................................................................................................................231<br/>H.5.&#160;protocolError&#160;(2)..........................................................................................................................232<br/></a><a href="OpenLDAP-Admin-Guides.html#246">H.6.&#160;timeLimitExceeded&#160;(3)................................................................................................................232<br/>H.7.&#160;sizeLimitExceeded&#160;(4).................................................................................................................232<br/>H.8.&#160;compareFalse&#160;(5)..........................................................................................................................232<br/>H.9.&#160;compareTrue&#160;(6)...........................................................................................................................232<br/>H.10.&#160;authMethodNotSupported&#160;(7)....................................................................................................232<br/>H.11.&#160;strongerAuthRequired&#160;(8)..........................................................................................................232<br/>H.12.&#160;referral&#160;(10)................................................................................................................................232<br/>H.13.&#160;adminLimitExceeded&#160;(11)..........................................................................................................233<br/></a><a href="OpenLDAP-Admin-Guides.html#247">H.14.&#160;unavailableCriticalExtension&#160;(12)..............................................................................................233<br/>H.15.&#160;confidentialityRequired&#160;(13)......................................................................................................233<br/>H.16.&#160;saslBindInProgress&#160;(14).............................................................................................................233<br/>H.17.&#160;noSuchAttribute&#160;(16)..................................................................................................................233<br/>H.18.&#160;undefinedAttributeType&#160;(17).....................................................................................................233<br/>H.19.&#160;inappropriateMatching&#160;(18).......................................................................................................233<br/>H.20.&#160;constraintViolation&#160;(19).............................................................................................................233<br/>H.21.&#160;attributeOrValueExists&#160;(20).......................................................................................................233<br/>H.22.&#160;invalidAttributeSyntax&#160;(21).......................................................................................................233<br/>H.23.&#160;noSuchObject&#160;(32).....................................................................................................................234<br/></a><a href="OpenLDAP-Admin-Guides.html#248">H.24.&#160;aliasProblem&#160;(33).......................................................................................................................234<br/>H.25.&#160;invalidDNSyntax&#160;(34)................................................................................................................234<br/>H.26.&#160;aliasDereferencingProblem&#160;(36)................................................................................................234<br/>H.27.&#160;inappropriateAuthentication&#160;(48)...............................................................................................234<br/>H.28.&#160;invalidCredentials&#160;(49)...............................................................................................................234<br/>H.29.&#160;insufficientAccessRights&#160;(50)....................................................................................................234<br/>H.30.&#160;busy&#160;(51)....................................................................................................................................234<br/>H.31.&#160;unavailable&#160;(52)..........................................................................................................................234<br/>H.32.&#160;unwillingToPerform&#160;(53)...........................................................................................................234<br/>H.33.&#160;loopDetect&#160;(54)..........................................................................................................................235<br/></a><a href="OpenLDAP-Admin-Guides.html#249">H.34.&#160;namingViolation&#160;(64).................................................................................................................235<br/>H.35.&#160;objectClassViolation&#160;(65)..........................................................................................................235<br/>H.36.&#160;notAllowedOnNonLeaf&#160;(66)......................................................................................................235<br/>H.37.&#160;notAllowedOnRDN&#160;(67)............................................................................................................235<br/>H.38.&#160;entryAlreadyExists&#160;(68).............................................................................................................235<br/>H.39.&#160;objectClassModsProhibited&#160;(69)................................................................................................235<br/>H.40.&#160;affectsMultipleDSAs&#160;(71)..........................................................................................................235<br/>H.41.&#160;other&#160;(80)....................................................................................................................................237</a><br/>
xi<br/>
<hr/>
<a name=14></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
<b>Table of Contents</b><br/>
<a href="OpenLDAP-Admin-Guides.html#251"><b>I.&#160;Glossary........................................................................................................................................................237</b></a><br/>
<a href="OpenLDAP-Admin-Guides.html#251">I.1.&#160;Terms.............................................................................................................................................240<br/></a><a href="OpenLDAP-Admin-Guides.html#254">I.2.&#160;Related&#160;Organizations....................................................................................................................240<br/>I.3.&#160;Related&#160;Products............................................................................................................................241<br/></a><a href="OpenLDAP-Admin-Guides.html#255">I.4.&#160;References</a>.....................................................................................................................................245<br/>
<a href="OpenLDAP-Admin-Guides.html#259"><b>J.&#160;Generic&#160;configure&#160;Instructions..................................................................................................................249</b></a><br/>
<a href="OpenLDAP-Admin-Guides.html#263"><b>K.&#160;OpenLDAP&#160;Software&#160;Copyright&#160;Notices.................................................................................................249</b></a><br/>
<a href="OpenLDAP-Admin-Guides.html#263">K.1.&#160;OpenLDAP&#160;Copyright&#160;Notice......................................................................................................249<br/>K.2.&#160;Additional&#160;Copyright&#160;Notices......................................................................................................250<br/></a><a href="OpenLDAP-Admin-Guides.html#264">K.3.&#160;University&#160;of&#160;Michigan&#160;Copyright&#160;Notice...................................................................................251</a><br/>
<a href="OpenLDAP-Admin-Guides.html#265"><b>L.&#160;OpenLDAP&#160;Public&#160;License.......................................................................................................................title</b></a><br/>
xii<br/>
<hr/>
<a name=15></a><b>Preface</b><br/>
<b>Copyright</b><br/>
<a href="http://www.openldap.org/foundation/">Copyright 1998-2012, The OpenLDAP Foundation,</a><i>&#160;All Rights Reserved</i>.<br/>
<a href="http://www.umich.edu/">Copyright 1992-1996, Regents of the University of Michigan,</a><i>&#160;All Rights Reserved</i>.<br/>
This document is considered a part of OpenLDAP Software. This document is subject to terms of conditions<br/><a href="OpenLDAP-Admin-Guides.html#263">set forth in OpenLDAP Software Copyright Notices and the OpenLDAP Public License. Complete copies of<br/></a>the notices and associated license can be found in Appendix K and L, respectively.<br/>
Portions of OpenLDAP Software and this document may be copyright by other parties and/or subject to<br/>additional restrictions. Individual source files should be consulted for additional copyright notices.<br/>
<b>Scope of this Document</b><br/>
<a href="http://www.openldap.org/software/">This document provides a guide for installing OpenLDAP Software 2.4 (http://www.openldap.org/software/)<br/></a>on UNIX (and UNIX-like) systems. The document is aimed at experienced system administrators with basic<br/>understanding of LDAP-based directory services.<br/>
This document is meant to be used in conjunction with other OpenLDAP information resources provided with<br/><a href="http://www.OpenLDAP.org/">the software package and on the project's site (http://www.OpenLDAP.org/) on the World Wide Web. The site<br/></a>makes available a number of resources.<br/>
OpenLDAP Resources<br/>
<b>Resource</b><br/>
<b>URL</b><br/>
Document Catalog<br/>
<a href="http://www.OpenLDAP.org/doc/">http://www.OpenLDAP.org/doc/</a><br/>
Frequently Asked Questions&#160;<a href="http://www.OpenLDAP.org/faq/">http://www.OpenLDAP.org/faq/</a><br/>
Issue Tracking System<br/>
<a href="http://www.OpenLDAP.org/its/">http://www.OpenLDAP.org/its/</a><br/>
Mailing Lists<br/>
<a href="http://www.OpenLDAP.org/lists/">http://www.OpenLDAP.org/lists/</a><br/>
Manual Pages<br/>
<a href="http://www.OpenLDAP.org/software/man.cgi">http://www.OpenLDAP.org/software/man.cgi</a><br/>
Software Pages<br/>
<a href="http://www.OpenLDAP.org/software/">http://www.OpenLDAP.org/software/</a><br/>
Support Pages<br/>
<a href="http://www.OpenLDAP.org/support/">http://www.OpenLDAP.org/support/</a><br/>
This document is not a complete reference for OpenLDAP software; the manual pages are the definitive<br/>documentation. For best results, you should use the manual pages that were installed on your system with<br/>your version of OpenLDAP software so that you're looking at documentation that matches the code. While the<br/>OpenLDAP web site also provides the manual pages for convenience, you can not assume that they corresond<br/>to the particular version you're running.<br/>
<b>Acknowledgments</b><br/>
<a href="http://www.openldap.org/project/">The OpenLDAP Project is comprised of a team of volunteers. This document would not be possible without<br/></a>their contribution of time and energy.<br/>
1<br/>
<hr/>
<a name=16></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
<a href="http://www.umich.edu/~dirsvcs/ldap/ldap.html">The OpenLDAP Project would also like to thank the University of Michigan LDAP Team for building the<br/></a>foundation of LDAP software and information to which OpenLDAP Software is built upon. This document is<br/><a href="http://www.umich.edu/~dirsvcs/ldap/doc/guides/slapd/guide.pdf">based upon University of Michigan document: The SLAPD and SLURPD Administrators Guide.</a><br/>
<b>Amendments</b><br/>
<a href="http://www.openldap.org/">Suggested enhancements and corrections to this document should be submitted using the OpenLDAP Issue<br/></a><a href="http://www.openldap.org/its/">Tracking System (http://www.openldap.org/its/).</a><br/>
<b>About this document</b><br/>
This document was produced using the Simple Document Format (SDF) documentation system<br/><a href="http://search.cpan.org/src/IANC/sdf-2.001/doc/catalog.html">(http://search.cpan.org/src/IANC/sdf-2.001/doc/catalog.html) developed by</a><i>&#160;Ian Clatworthy</i>. Tools for SDF are<br/><a href="http://cpan.org/">available from CPAN (http://search.cpan.org/search?query=SDF&amp;mode=dist).</a><br/>
2<br/>
<hr/>
<a name=17></a><b>1. Introduction to OpenLDAP Directory Services</b><br/>
<a href="http://www.openldap.org/">This document describes how to build, configure, and operate OpenLDAP Software to provide directory<br/></a>services. This includes details on how to configure and run the Standalone LDAP Daemon,<i>&#160;slapd</i>(8). It is<br/>intended for new and experienced administrators alike. This section provides a basic introduction to directory<br/>services and, in particular, the directory services provided by<i>&#160;slapd</i>(8). This introduction is only intended to<br/>provide enough information so one might get started learning about LDAP, X.500, and directory services.<br/>
<b>1.1. What is a directory service?</b><br/>
A directory is a specialized database specifically designed for searching and browsing, in additional to<br/>supporting basic lookup and update functions.<br/>
<b>Note:</b>&#160;A directory is defined by some as merely a database optimized for read access. This definition, at best,<br/>is overly simplistic.<br/>
Directories tend to contain descriptive, attribute-based information and support sophisticated filtering<br/>capabilities. Directories generally do not support complicated transaction or roll-back schemes found in<br/>database management systems designed for handling high-volume complex updates. Directory updates are<br/>typically simple all-or-nothing changes, if they are allowed at all. Directories are generally tuned to give quick<br/>response to high-volume lookup or search operations. They may have the ability to replicate information<br/>widely in order to increase availability and reliability, while reducing response time. When directory<br/>information is replicated, temporary inconsistencies between the replicas may be okay, as long as<br/>inconsistencies are resolved in a timely manner.<br/>
There are many different ways to provide a directory service. Different methods allow different kinds of<br/>information to be stored in the directory, place different requirements on how that information can be<br/>referenced, queried and updated, how it is protected from unauthorized access, etc. Some directory services<br/>are<i>&#160;local</i>, providing service to a restricted context (e.g., the finger service on a single machine). Other services<br/>are global, providing service to a much broader context (e.g., the entire Internet). Global services are usually<br/><i>distributed</i>, meaning that the data they contain is spread across many machines, all of which cooperate to<br/>provide the directory service. Typically a global service defines a uniform<i>&#160;namespace</i>&#160;which gives the same<br/>view of the data no matter where you are in relation to the data itself.<br/>
A web directory, such as provided by the<i>&#160;Open Directory Project</i><a href="http://dmoz.org">&#160;&lt;http://dmoz.org&gt;, is a good example of a<br/></a>directory service. These services catalog web pages and are specifically designed to support browsing and<br/>searching.<br/>
While some consider the Internet Domain Name System (DNS) is an example of a globally distributed<br/>directory service, DNS is not browseable nor searchable. It is more properly described as a globally<br/>distributed<i>&#160;lookup</i>&#160;service.<br/>
<b>1.2. What is LDAP?</b><br/>
LDAP stands for Lightweight Directory Access Protocol. As the name suggests, it is a lightweight protocol<br/>for accessing directory services, specifically X.500-based directory services. LDAP runs over TCP/IP or other<br/><a href="http://www.ietf.org/">connection oriented transfer services. LDAP is an IETF Standard Track protocol and is specified in<br/></a><a href="http://www.rfc-editor.org/rfc/rfc4510.txt">&#34;Lightweight Directory Access Protocol (LDAP) Technical Specification Road Map&#34; RFC4510.</a><br/>
3<br/>
<hr/>
<a name=18></a><img src="../img/OpenLDAP-Admin-Guide-18_1.png"/><br/>
OpenLDAP Software 2.4 Administrator's Guide<br/>
This section gives an overview of LDAP from a user's perspective.<br/>
<i>What kind of information can be stored in the directory?</i>&#160;The LDAP information model is based on<i>&#160;entries</i>.<br/>An entry is a collection of attributes that has a globally-unique Distinguished Name (DN). The DN is used to<br/>refer to the entry unambiguously. Each of the entry's attributes has a<i>&#160;type</i>&#160;and one or more<i>&#160;values</i>. The types<br/>are typically mnemonic strings, like &#34;cn&#34; for common name, or &#34;mail&#34; for email address. The syntax of<br/>values depend on the attribute type. For example, a&#160;cn&#160;attribute might contain the value&#160;Babs Jensen. A<br/>mail&#160;attribute might contain the value &#34;babs@example.com&#34;. A&#160;jpegPhoto&#160;attribute would contain a<br/>photograph in the JPEG (binary) format.<br/>
<i>How is the information arranged?</i>&#160;In LDAP, directory entries are arranged in a hierarchical tree-like structure.<br/>Traditionally, this structure reflected the geographic and/or organizational boundaries. Entries representing<br/>countries appear at the top of the tree. Below them are entries representing states and national organizations.<br/>Below them might be entries representing organizational units, people, printers, documents, or just about<br/>anything else you can think of. Figure 1.1 shows an example LDAP directory tree using traditional naming.<br/>
Figure 1.1: LDAP directory tree (traditional naming)<br/>
The tree may also be arranged based upon Internet domain names. This naming approach is becoming<br/>increasing popular as it allows for directory services to be located using the<i>&#160;DNS</i>. Figure 1.2 shows an<br/>example LDAP directory tree using domain-based naming.<br/>
4<br/>
<hr/>
<a name=19></a><img src="../img/OpenLDAP-Admin-Guide-19_1.png"/><br/>
OpenLDAP Software 2.4 Administrator's Guide<br/>
Figure 1.2: LDAP directory tree (Internet naming)<br/>
In addition, LDAP allows you to control which attributes are required and allowed in an entry through the use<br/>of a special attribute called&#160;objectClass. The values of the&#160;objectClass&#160;attribute determine the<br/><i>schema</i>&#160;rules the entry must obey.<br/>
<i>How is the information referenced?</i>&#160;An entry is referenced by its distinguished name, which is constructed by<br/>taking the name of the entry itself (called the Relative Distinguished Name or RDN) and concatenating the<br/>names of its ancestor entries. For example, the entry for Barbara Jensen in the Internet naming example above<br/>has an RDN of&#160;uid=babs&#160;and a DN of&#160;uid=babs,ou=People,dc=example,dc=com. The full DN<br/><a href="http://www.rfc-editor.org/rfc/rfc4514.txt">format is described in RFC4514, &#34;LDAP: String Representation of Distinguished Names.&#34;</a><br/>
<i>How is the information accessed?</i>&#160;LDAP defines operations for interrogating and updating the directory.<br/>Operations are provided for adding and deleting an entry from the directory, changing an existing entry, and<br/>changing the name of an entry. Most of the time, though, LDAP is used to search for information in the<br/>directory. The LDAP search operation allows some portion of the directory to be searched for entries that<br/>match some criteria specified by a search filter. Information can be requested from each entry that matches the<br/>criteria.<br/>
For example, you might want to search the entire directory subtree at and below&#160;dc=example,dc=com&#160;for<br/>people with the name&#160;Barbara Jensen, retrieving the email address of each entry found. LDAP lets you<br/>do this easily. Or you might want to search the entries directly below the&#160;st=California,c=US&#160;entry for<br/>organizations with the string&#160;Acme&#160;in their name, and that have a fax number. LDAP lets you do this too. The<br/>next section describes in more detail what you can do with LDAP and how it might be useful to you.<br/>
<i>How is the information protected from unauthorized access?</i>&#160;Some directory services provide no protection,<br/>allowing anyone to see the information. LDAP provides a mechanism for a client to authenticate, or prove its<br/>identity to a directory server, paving the way for rich access control to protect the information the server<br/>contains. LDAP also supports data security (integrity and confidentiality) services.<br/>
5<br/>
<hr/>
<a name=20></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
<b>1.3. When should I use LDAP?</b><br/>
This is a very good question. In general, you should use a Directory server when you require data to be<br/>centrally managed, stored and accessible via standards based methods.<br/>
Some common examples found throughout the industry are, but not limited to:<br/>
Machine Authentication<br/>
&#160;<br/>
User Authentication<br/>
&#160;<br/>
User/System Groups<br/>
&#160;<br/>
Address book<br/>
&#160;<br/>
Organization Representation<br/>
&#160;<br/>
Asset Tracking<br/>
&#160;<br/>
Telephony Information Store<br/>
&#160;<br/>
User resource management<br/>
&#160;<br/>
E-mail address lookups<br/>
&#160;<br/>
Application Configuration store<br/>
&#160;<br/>
PBX Configuration store<br/>
&#160;<br/>
etc.....<br/>
&#160;<br/>
<a href="OpenLDAP-Admin-Guides.html#141">There are various Distributed Schema Files that are standards based, but you can always create your own<br/>Schema Specification.</a><br/>
There are always new ways to use a Directory and apply LDAP principles to address certain problems,<br/>therefore there is no simple answer to this question.<br/>
If in doubt, join the general LDAP forum for non-commercial discussions and information relating to LDAP<br/><a href="http://www.umich.edu/~dirsvcs/ldap/mailinglist.html">at: http://www.umich.edu/~dirsvcs/ldap/mailinglist.html and ask</a><br/>
<b>1.4. When should I not use LDAP?</b><br/>
When you start finding yourself bending the directory to do what you require, maybe a redesign is needed. Or<br/>if you only require one application to use and manipulate your data (for discussion of LDAP vs RDBMS,<br/><a href="OpenLDAP-Admin-Guides.html#21">please read the LDAP vs RDBMS section).</a><br/>
It will become obvious when LDAP is the right tool for the job.<br/>
<b>1.5. How does LDAP work?</b><br/>
LDAP utilizes a<i>&#160;client-server model</i>. One or more LDAP servers contain the data making up the directory<br/>information tree (DIT). The client connects to servers and asks it a question. The server responds with an<br/>answer and/or with a pointer to where the client can get additional information (typically, another LDAP<br/>server). No matter which LDAP server a client connects to, it sees the same view of the directory; a name<br/>presented to one LDAP server references the same entry it would at another LDAP server. This is an<br/>important feature of a global directory service.<br/>
6<br/>
<hr/>
<a name=21></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
<b>1.6. What about X.500?</b><br/>
Technically, LDAP is a directory access protocol to an X.500 directory service, the OSI directory service.<br/>Initially, LDAP clients accessed gateways to the X.500 directory service. This gateway ran LDAP between<br/>the client and gateway and X.500's Directory Access Protocol (DAP) between the gateway and the X.500<br/>server. DAP is a heavyweight protocol that operates over a full OSI protocol stack and requires a significant<br/>amount of computing resources. LDAP is designed to operate over TCP/IP and provides most of the<br/>functionality of DAP at a much lower cost.<br/>
While LDAP is still used to access X.500 directory service via gateways, LDAP is now more commonly<br/>directly implemented in X.500 servers.<br/>
The Standalone LDAP Daemon, or<i>&#160;slapd</i>(8), can be viewed as a<i>&#160;lightweight</i>&#160;X.500 directory server. That is, it<br/>does not implement the X.500's DAP nor does it support the complete X.500 models.<br/>
If you are already running a X.500 DAP service and you want to continue to do so, you can probably stop<br/>reading this guide. This guide is all about running LDAP via<i>&#160;slapd</i>(8), without running X.500 DAP. If you are<br/>not running X.500 DAP, want to stop running X.500 DAP, or have no immediate plans to run X.500 DAP,<br/>read on.<br/>
It is possible to replicate data from an LDAP directory server to a X.500 DAP DSA. This requires an<br/>LDAP/DAP gateway. OpenLDAP Software does not include such a gateway.<br/>
<b>1.7. What is the difference between LDAPv2 and LDAPv3?</b><br/>
LDAPv3 was developed in the late 1990's to replace LDAPv2. LDAPv3 adds the following features to LDAP:<br/>
Strong authentication and data security services via SASL<br/>
&#160;<br/>
Certificate authentication and data security services via TLS (SSL)<br/>
&#160;<br/>
Internationalization through the use of Unicode<br/>
&#160;<br/>
Referrals and Continuations<br/>
&#160;<br/>
Schema Discovery<br/>
&#160;<br/>
Extensibility (controls, extended operations, and more)<br/>
&#160;<br/>
<a href="http://www.rfc-editor.org/rfc/rfc3494.txt">LDAPv2 is historic (RFC3494). As most</a><i>&#160;so-called</i>&#160;LDAPv2 implementations (including<i>&#160;slapd</i>(8)) do not<br/>conform to the LDAPv2 technical specification, interoperability amongst implementations claiming LDAPv2<br/>support is limited. As LDAPv2 differs significantly from LDAPv3, deploying both LDAPv2 and LDAPv3<br/>simultaneously is quite problematic. LDAPv2 should be avoided. LDAPv2 is disabled by default.<br/>
<b>1.8. LDAP vs RDBMS</b><br/>
This question is raised many times, in different forms. The most common, however, is:<i>&#160;Why doesn't<br/>OpenLDAP drop Berkeley DB and use a relational database management system (RDBMS) instead?</i>&#160;In<br/>general, expecting that the sophisticated algorithms implemented by commercial-grade RDBMS would make<br/><i>OpenLDAP</i>&#160;be faster or somehow better and, at the same time, permitting sharing of data with other<br/>applications.<br/>
The short answer is that use of an embedded database and custom indexing system allows OpenLDAP to<br/>provide greater performance and scalability without loss of reliability. OpenLDAP uses Berkeley DB<br/>
7<br/>
<hr/>
<a name=22></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
concurrent / transactional database software. This is the same software used by leading commercial directory<br/>software.<br/>
Now for the long answer. We are all confronted all the time with the choice RDBMSes vs. directories. It is a<br/>hard choice and no simple answer exists.<br/>
It is tempting to think that having a RDBMS backend to the directory solves all problems. However, it is a<br/>pig. This is because the data models are very different. Representing directory data with a relational database<br/>is going to require splitting data into multiple tables.<br/>
Think for a moment about the person objectclass. Its definition requires attribute types objectclass, sn and cn<br/>and allows attribute types userPassword, telephoneNumber, seeAlso and description. All of these attributes<br/>are multivalued, so a normalization requires putting each attribute type in a separate table.<br/>
Now you have to decide on appropriate keys for those tables. The primary key might be a combination of the<br/>DN, but this becomes rather inefficient on most database implementations.<br/>
The big problem now is that accessing data from one entry requires seeking on different disk areas. On some<br/>applications this may be OK but in many applications performance suffers.<br/>
The only attribute types that can be put in the main table entry are those that are mandatory and single-value.<br/>You may add also the optional single-valued attributes and set them to NULL or something if not present.<br/>
But wait, the entry can have multiple objectclasses and they are organized in an inheritance hierarchy. An<br/>entry of objectclass organizationalPerson now has the attributes from person plus a few others and some<br/>formerly optional attribute types are now mandatory.<br/>
What to do? Should we have different tables for the different objectclasses? This way the person would have<br/>an entry on the person table, another on organizationalPerson, etc. Or should we get rid of person and put<br/>everything on the second table?<br/>
But what do we do with a filter like (cn=*) where cn is an attribute type that appears in many, many<br/>objectclasses. Should we search all possible tables for matching entries? Not very attractive.<br/>
Once this point is reached, three approaches come to mind. One is to do full normalization so that each<br/>attribute type, no matter what, has its own separate table. The simplistic approach where the DN is part of the<br/>primary key is extremely wasteful, and calls for an approach where the entry has a unique numeric id that is<br/>used instead for the keys and a main table that maps DNs to ids. The approach, anyway, is very inefficient<br/>when several attribute types from one or more entries are requested. Such a database, though cumbersomely,<br/>can be managed from SQL applications.<br/>
The second approach is to put the whole entry as a blob in a table shared by all entries regardless of the<br/>objectclass and have additional tables that act as indices for the first table. Index tables are not database<br/>indices, but are fully managed by the LDAP server-side implementation. However, the database becomes<br/>unusable from SQL. And, thus, a fully fledged database system provides little or no advantage. The full<br/>generality of the database is unneeded. Much better to use something light and fast, like Berkeley DB.<br/>
A completely different way to see this is to give up any hopes of implementing the directory data model. In<br/>this case, LDAP is used as an access protocol to data that provides only superficially the directory data model.<br/>For instance, it may be read only or, where updates are allowed, restrictions are applied, such as making<br/>single-value attribute types that would allow for multiple values. Or the impossibility to add new objectclasses<br/>
8<br/>
<hr/>
<a name=23></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
to an existing entry or remove one of those present. The restrictions span the range from allowed restrictions<br/>(that might be elsewhere the result of access control) to outright violations of the data model. It can be,<br/>however, a method to provide LDAP access to preexisting data that is used by other applications. But in the<br/>understanding that we don't really have a &#34;directory&#34;.<br/>
Existing commercial LDAP server implementations that use a relational database are either from the first kind<br/>or the third. I don't know of any implementation that uses a relational database to do inefficiently what BDB<br/>does efficiently. For those who are interested in &#34;third way&#34; (exposing EXISTING data from RDBMS as<br/>LDAP tree, having some limitations compared to classic LDAP model, but making it possible to interoperate<br/>between LDAP and SQL applications):<br/>
OpenLDAP includes back-sql - the backend that makes it possible. It uses ODBC + additional<br/>metainformation about translating LDAP queries to SQL queries in your RDBMS schema, providing different<br/>levels of access - from read-only to full access depending on RDBMS you use, and your schema.<br/>
For more information on concept and limitations, see<i>&#160;slapd-sql</i><a href="OpenLDAP-Admin-Guides.html#204">(5) man page, or the Backends section. There<br/></a>are also several examples for several RDBMSes in&#160;back-sql/rdbms_depend/*&#160;subdirectories.<br/>
<b>1.9. What is slapd and what can it do?</b><br/>
<i>slapd</i>(8) is an LDAP directory server that runs on many different platforms. You can use it to provide a<br/>directory service of your very own. Your directory can contain pretty much anything you want to put in it.<br/>You can connect it to the global LDAP directory service, or run a service all by yourself. Some of slapd's<br/>more interesting features and capabilities include:<br/>
<b>LDAPv3</b>:<i>&#160;slapd</i>&#160;implements version 3 of Lightweight Directory Access Protocol.<i>&#160;slapd</i>&#160;supports LDAP over<br/>both IPv4 and IPv6 and Unix IPC.<br/>
<b>Simple Authentication and Security Layer</b>:<i>&#160;slapd</i>&#160;supports strong authentication and data security (integrity<br/>and confidentiality) services through the use of SASL.<i>&#160;slapd</i><a href="http://asg.web.cmu.edu/sasl/sasl-library.html">'s SASL implementation utilizes Cyrus SASL<br/></a>software which supports a number of mechanisms including DIGEST-MD5, EXTERNAL, and GSSAPI.<br/>
<b>Transport Layer Security</b>:<i>&#160;slapd</i>&#160;supports certificate-based authentication and data security (integrity and<br/>confidentiality) services through the use of TLS (or SSL).<i>&#160;slapd</i><a href="http://www.openssl.org/">'s TLS implementation can utilize OpenSSL,<br/></a><a href="http://www.gnu.org/software/gnutls/">GnuTLS, or MozNSS software.</a><br/>
<b>Topology control</b>:<i>&#160;slapd</i>&#160;can be configured to restrict access at the socket layer based upon network topology<br/>information. This feature utilizes<i>&#160;TCP wrappers</i>.<br/>
<b>Access control</b>:<i>&#160;slapd</i>&#160;provides a rich and powerful access control facility, allowing you to control access to<br/>the information in your database(s). You can control access to entries based on LDAP authorization<br/>information, IP address, domain name and other criteria.<i>&#160;slapd</i>&#160;supports both<i>&#160;static</i>&#160;and<i>&#160;dynamic</i>&#160;access<br/>control information.<br/>
<b>Internationalization</b>:<i>&#160;slapd</i>&#160;supports Unicode and language tags.<br/>
<b>Choice of database backends</b>:<i>&#160;slapd</i>&#160;comes with a variety of different database backends you can choose<br/>from. They include BDB, a high-performance transactional database backend; HDB, a hierarchical<br/>high-performance transactional backend;<i>&#160;SHELL</i>, a backend interface to arbitrary shell scripts; and PASSWD,<br/>a simple backend interface to the<i>&#160;passwd</i><a href="http://www.oracle.com/">(5) file. The BDB and HDB backends utilize Oracle Berkeley DB.</a><br/>
9<br/>
<hr/>
<a name=24></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
<b>Multiple database instances</b>:<i>&#160;slapd</i>&#160;can be configured to serve multiple databases at the same time. This<br/>means that a single<i>&#160;slapd</i>&#160;server can respond to requests for many logically different portions of the LDAP<br/>tree, using the same or different database backends.<br/>
<b>Generic modules API</b>: If you require even more customization,<i>&#160;slapd</i>&#160;lets you write your own modules<br/>easily.<i>&#160;slapd</i>&#160;consists of two distinct parts: a front end that handles protocol communication with LDAP<br/>clients; and modules which handle specific tasks such as database operations. Because these two pieces<br/>communicate via a well-defined C API, you can write your own customized modules which extend<i>&#160;slapd</i>&#160;in<br/>numerous ways. Also, a number of<i>&#160;programmable database</i>&#160;modules are provided. These allow you to expose<br/>external data sources to<i>&#160;slapd</i><a href="http://www.perl.org/">&#160;using popular programming languages (Perl,</a><i>&#160;shell</i>, and SQL).<br/>
<b>Threads</b>:<i>&#160;slapd</i>&#160;is threaded for high performance. A single multi-threaded<i>&#160;slapd</i>&#160;process handles all incoming<br/>requests using a pool of threads. This reduces the amount of system overhead required while providing high<br/>performance.<br/>
<b>Replication</b>:<i>&#160;slapd</i>&#160;can be configured to maintain shadow copies of directory information. This<br/><i>single-master/multiple-slave</i>&#160;replication scheme is vital in high-volume environments where a single<i>&#160;slapd<br/></i>installation just doesn't provide the necessary availability or reliability. For extremely demanding<br/>environments where a single point of failure is not acceptable,<i>&#160;multi-master</i>&#160;replication is also available.<i>&#160;slapd<br/></i>includes support for<i>&#160;LDAP Sync</i>-based replication.<br/>
<b>Proxy Cache</b>:<i>&#160;slapd</i>&#160;can be configured as a caching LDAP proxy service.<br/>
<b>Configuration</b>:<i>&#160;slapd</i>&#160;is highly configurable through a single configuration file which allows you to change<br/>just about everything you'd ever want to change. Configuration options have reasonable defaults, making your<br/>job much easier. Configuration can also be performed dynamically using LDAP itself, which greatly improves<br/>manageability.<br/>
10<br/>
<hr/>
<a name=25></a><b>2. A Quick-Start Guide</b><br/>
The following is a quick start guide to OpenLDAP Software 2.4, including the Standalone LDAP Daemon,<br/><i>slapd</i>(8).<br/>
<a href="http://www.openldap.org/software/">It is meant to walk you through the basic steps needed to install and configure OpenLDAP Software. It should<br/></a>be used in conjunction with the other chapters of this document, manual pages, and other materials provided<br/>with the distribution (e.g. the&#160;INSTALL<a href="http://www.openldap.org/">&#160;document) or on the OpenLDAP web site<br/></a><a href="http://www.OpenLDAP.org">(http://www.OpenLDAP.org), in particular the OpenLDAP Software FAQ<br/></a><a href="http://www.OpenLDAP.org/faq/?file=2">(http://www.OpenLDAP.org/faq/?file=2).</a><br/>
If you intend to run OpenLDAP Software seriously, you should review all of this document before attempting<br/>to install the software.<br/>
<b>Note:</b>&#160;This quick start guide does not use strong authentication nor any integrity or confidential protection<br/>services. These services are described in other chapters of the OpenLDAP Administrator's Guide.<br/>
<b>Get the software</b><br/>
1.&#160;<br/>
You can obtain a copy of the software by following the instructions on the OpenLDAP Software<br/><a href="http://www.openldap.org/software/download/">download page (http://www.openldap.org/software/download/). It is recommended that new users<br/></a>start with the latest<i>&#160;release</i>.<br/>
<b>Unpack the distribution</b><br/>
2.&#160;<br/>
Pick a directory for the source to live under, change directory to there, and unpack the distribution<br/>using the following commands:<br/>gunzip -c openldap-VERSION.tgz | tar xvfB -<br/>then relocate yourself into the distribution directory:<br/>cd openldap-VERSION<br/>You'll have to replace&#160;VERSION&#160;with the version name of the release.<br/>
<b>Review documentation</b><br/>
3.&#160;<br/>
You should now review the&#160;COPYRIGHT,&#160;LICENSE,&#160;README&#160;and&#160;INSTALL&#160;documents provided<br/>with the distribution. The&#160;COPYRIGHT&#160;and&#160;LICENSE&#160;provide information on acceptable use,<br/>copying, and limitation of warranty of OpenLDAP Software.<br/>
<a href="OpenLDAP-Admin-Guides.html#31">You should also review other chapters of this document. In particular, the Building and Installing<br/>OpenLDAP Software chapter of this document provides detailed information on prerequisite software<br/></a>and installation procedures.<br/>
<b>Run&#160;</b><br/>
4.&#160;<br/>
<b>configure</b><br/>
You will need to run the provided&#160;configure&#160;script to<i>&#160;configure</i>&#160;the distribution for building on<br/>your system. The&#160;configure&#160;script accepts many command line options that enable or disable<br/>optional software features. Usually the defaults are okay, but you may want to change them. To get a<br/>complete list of options that&#160;configure&#160;accepts, use the&#160;--help&#160;option:<br/>./configure --help<br/>However, given that you are using this guide, we'll assume you are brave enough to just let<br/>configure&#160;determine what's best:<br/>
11<br/>
<hr/>
<a name=26></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
./configure<br/>Assuming&#160;configure&#160;doesn't dislike your system, you can proceed with building the software. If<br/>configure&#160;did complain, well, you'll likely need to go to the Software FAQ<i>&#160;Installation</i>&#160;section<br/><a href="http://www.openldap.org/faq/?file=8">(http://www.openldap.org/faq/?file=8) and/or actually read the Building and Installing OpenLDAP<br/></a><a href="OpenLDAP-Admin-Guides.html#31">Software chapter of this document.</a><br/>
<b>Build the software</b><br/>
5.&#160;<br/>
.<br/>
The next step is to build the software. This step has two parts, first we construct dependencies and<br/>then we compile the software:<br/>make depend<br/>
make<br/>Both makes should complete without error.<br/>
<b>Test the build</b><br/>
6.&#160;<br/>
.<br/>
To ensure a correct build, you should run the test suite (it only takes a few minutes):<br/>make test<br/>Tests which apply to your configuration will run and they should pass. Some tests, such as the<br/>replication test, may be skipped.<br/>
<b>Install the software</b><br/>
7.&#160;<br/>
.<br/>
You are now ready to install the software; this usually requires<i>&#160;super-user</i>&#160;privileges:<br/>su root -c 'make install'<br/>Everything should now be installed under&#160;/usr/local&#160;(or whatever installation prefix was used by<br/>configure).<br/>
<b>Edit the configuration file</b><br/>
8.&#160;<br/>
.<br/>
Use your favorite editor to edit the provided<i>&#160;slapd.conf</i>(5) example (usually installed as<br/>/usr/local/etc/openldap/slapd.conf) to contain a BDB database definition of the form:<br/>database bdb<br/>
suffix &#34;dc=&lt;MY-DOMAIN&gt;,dc=&lt;COM&gt;&#34;<br/>
rootdn &#34;cn=Manager,dc=&lt;MY-DOMAIN&gt;,dc=&lt;COM&gt;&#34;<br/>
rootpw secret<br/>
directory /usr/local/var/openldap-data<br/>Be sure to replace&#160;&lt;MY-DOMAIN&gt;&#160;and&#160;&lt;COM&gt;&#160;with the appropriate domain components of your<br/>domain name. For example, for&#160;example.com, use:<br/>database bdb<br/>
suffix &#34;dc=example,dc=com&#34;<br/>
rootdn &#34;cn=Manager,dc=example,dc=com&#34;<br/>
rootpw secret<br/>
directory /usr/local/var/openldap-data<br/>If your domain contains additional components, such as&#160;eng.uni.edu.eu, use:<br/>database bdb<br/>
suffix &#34;dc=eng,dc=uni,dc=edu,dc=eu&#34;<br/>
rootdn &#34;cn=Manager,dc=eng,dc=uni,dc=edu,dc=eu&#34;<br/>
rootpw secret<br/>
directory /usr/local/var/openldap-data<br/>Details regarding configuring<i>&#160;slapd</i>(8) can be found in the<i>&#160;slapd.conf</i><a href="OpenLDAP-Admin-Guides.html#57">(5) manual page and the The<br/>slapd Configuration File chapter of this document. Note that the specified directory must exist prior to<br/></a>starting<i>&#160;slapd</i>(8).<br/>
12<br/>
<hr/>
<a name=27></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
<b>Start SLAPD</b><br/>
9.&#160;<br/>
.<br/>
You are now ready to start the Standalone LDAP Daemon,<i>&#160;slapd</i>(8), by running the command:<br/>su root -c /usr/local/libexec/slapd<br/>To check to see if the server is running and configured correctly, you can run a search against it with<br/><i>ldapsearch</i>(1). By default,<i>&#160;ldapsearch</i>&#160;is installed as&#160;/usr/local/bin/ldapsearch:<br/>ldapsearch -x -b '' -s base '(objectclass=*)' namingContexts<br/>Note the use of single quotes around command parameters to prevent special characters from being<br/>interpreted by the shell. This should return:<br/>dn:<br/>
namingContexts: dc=example,dc=com<br/>Details regarding running<i>&#160;slapd</i>(8) can be found in the<i>&#160;slapd</i><a href="OpenLDAP-Admin-Guides.html#67">(8) manual page and the Running slapd<br/></a>chapter of this document.<br/>
<b>Add initial entries to your directory</b><br/>
10.&#160;<br/>
.<br/>
You can use<i>&#160;ldapadd</i>(1) to add entries to your LDAP directory.<i>&#160;ldapadd</i>&#160;expects input in LDIF form.<br/>We'll do it in two steps:<br/>
create an LDIF file<br/>
1.&#160;<br/>
run ldapadd<br/>
2.&#160;<br/>
Use your favorite editor and create an LDIF file that contains:<br/>dn: dc=&lt;MY-DOMAIN&gt;,dc=&lt;COM&gt;<br/>
objectclass: dcObject<br/>
objectclass: organization<br/>
o: &lt;MY ORGANIZATION&gt;<br/>
dc: &lt;MY-DOMAIN&gt;<br/>
dn: cn=Manager,dc=&lt;MY-DOMAIN&gt;,dc=&lt;COM&gt;<br/>
objectclass: organizationalRole<br/>
cn: Manager<br/>Be sure to replace&#160;&lt;MY-DOMAIN&gt;&#160;and&#160;&lt;COM&gt;&#160;with the appropriate domain components of your<br/>domain name.&#160;&lt;MY ORGANIZATION&gt;&#160;should be replaced with the name of your organization.<br/>When you cut and paste, be sure to trim any leading and trailing whitespace from the example.<br/>dn: dc=example,dc=com<br/>
objectclass: dcObject<br/>
objectclass: organization<br/>
o: Example Company<br/>
dc: example<br/>
dn: cn=Manager,dc=example,dc=com<br/>
objectclass: organizationalRole<br/>
cn: Manager<br/>Now, you may run<i>&#160;ldapadd</i>(1) to insert these entries into your directory.<br/>ldapadd -x -D &#34;cn=Manager,dc=&lt;MY-DOMAIN&gt;,dc=&lt;COM&gt;&#34; -W -f<br/>
example.ldif<br/>Be sure to replace&#160;&lt;MY-DOMAIN&gt;&#160;and&#160;&lt;COM&gt;&#160;with the appropriate domain components of your<br/>domain name. You will be prompted for the &#34;secret&#34; specified in&#160;slapd.conf. For example, for<br/>example.com, use:<br/>ldapadd -x -D &#34;cn=Manager,dc=example,dc=com&#34; -W -f example.ldif<br/>where&#160;example.ldif&#160;is the file you created above.<br/>
<a href="OpenLDAP-Admin-Guides.html#97">Additional information regarding directory creation can be found in the Database Creation and</a><br/>
13<br/>
<hr/>
<a name=28></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
<a href="OpenLDAP-Admin-Guides.html#97">Maintenance Tools chapter of this document.</a><br/>
<b>See if it works</b><br/>
11.&#160;<br/>
.<br/>
Now we're ready to verify the added entries are in your directory. You can use any LDAP client to do<br/>this, but our example uses the<i>&#160;ldapsearch</i>(1) tool. Remember to replace&#160;dc=example,dc=com<br/>with the correct values for your site:<br/>ldapsearch -x -b 'dc=example,dc=com' '(objectclass=*)'<br/>This command will search for and retrieve every entry in the database.<br/>
You are now ready to add more entries using<i>&#160;ldapadd</i>(1) or another LDAP client, experiment with various<br/>configuration options, backend arrangements, etc..<br/>
Note that by default, the<i>&#160;slapd</i>(8) database grants<i>&#160;read access to everybody</i>&#160;excepting the<i>&#160;super-user</i>&#160;(as<br/>specified by the&#160;rootdn&#160;configuration directive). It is highly recommended that you establish controls to<br/><a href="OpenLDAP-Admin-Guides.html#71">restrict access to authorized users. Access controls are discussed in the Access Control chapter. You are also<br/></a><a href="OpenLDAP-Admin-Guides.html#149">encouraged to read the Security Considerations, Using SASL and Using TLS sections.</a><br/>
The following chapters provide more detailed information on making, installing, and running<i>&#160;slapd</i>(8).<br/>
14<br/>
<hr/>
<a name=29></a><img src="../img/OpenLDAP-Admin-Guide-29_1.png"/><br/>
<img src="../img/OpenLDAP-Admin-Guide-29_2.png"/><br/>
<b>3. The Big Picture - Configuration Choices</b><br/>
This section gives a brief overview of various LDAP directory configurations, and how your Standalone<br/>LDAP Daemon<i>&#160;slapd</i>(8) fits in with the rest of the world.<br/>
<b>3.1. Local Directory Service</b><br/>
In this configuration, you run a<i>&#160;slapd</i>(8) instance which provides directory service for your local domain only.<br/>It does not interact with other directory servers in any way. This configuration is shown in Figure 3.1.<br/>
Figure 3.1: Local service configuration.<br/>
Use this configuration if you are just starting out (it's the one the quick-start guide makes for you) or if you<br/>want to provide a local service and are not interested in connecting to the rest of the world. It's easy to<br/>upgrade to another configuration later if you want.<br/>
<b>3.2. Local Directory Service with Referrals</b><br/>
In this configuration, you run a<i>&#160;slapd</i>(8) instance which provides directory service for your local domain and<br/>configure it to return referrals to other servers capable of handling requests. You may run this service (or<br/>services) yourself or use one provided to you. This configuration is shown in Figure 3.2.<br/>
Figure 3.2: Local service with referrals<br/>
Use this configuration if you want to provide local service and participate in the Global Directory, or you<br/>want to delegate responsibility for<i>&#160;subordinate</i>&#160;entries to another server.<br/>
<b>3.3. Replicated Directory Service</b><br/>
slapd(8) includes support for<i>&#160;LDAP Sync</i>-based replication, called<i>&#160;syncrepl</i>, which may be used to maintain<br/>shadow copies of directory information on multiple directory servers. In its most basic configuration, the<br/><i>master</i>&#160;is a syncrepl provider and one or more<i>&#160;slave</i>&#160;(or<i>&#160;shadow</i>) are syncrepl consumers. An example<br/>
15<br/>
<hr/>
<a name=30></a><img src="../img/OpenLDAP-Admin-Guide-30_1.png"/><br/>
OpenLDAP Software 2.4 Administrator's Guide<br/>
master-slave configuration is shown in figure 3.3. Multi-Master configurations are also supported.<br/>
Figure 3.3: Replicated Directory Services<br/>
This configuration can be used in conjunction with either of the first two configurations in situations where a<br/>single<i>&#160;slapd</i>(8) instance does not provide the required reliability or availability.<br/>
<b>3.4. Distributed Local Directory Service</b><br/>
In this configuration, the local service is partitioned into smaller services, each of which may be replicated,<br/>and<i>&#160;glued</i>&#160;together with<i>&#160;superior</i>&#160;and<i>&#160;subordinate</i>&#160;referrals.<br/>
16<br/>
<hr/>
<a name=31></a><b>4. Building and Installing OpenLDAP Software</b><br/>
<a href="http://www.openldap.org/">This chapter details how to build and install the OpenLDAP Software package including</a><i>&#160;slapd</i>(8), the<br/>Standalone LDAP Daemon. Building and installing OpenLDAP Software requires several steps: installing<br/>prerequisite software, configuring OpenLDAP Software itself, making, and finally installing. The following<br/>sections describe this process in detail.<br/>
<b>4.1. Obtaining and Extracting the Software</b><br/>
You can obtain OpenLDAP Software from the project's download page at<br/><a href="http://www.openldap.org/software/download/">http://www.openldap.org/software/download/ or directly from the project's FTP service at<br/></a><a href="ftp://ftp.openldap.org/pub/OpenLDAP/">ftp://ftp.openldap.org/pub/OpenLDAP/.</a><br/>
The project makes available two series of packages for<i>&#160;general use</i>. The project makes<i>&#160;releases</i>&#160;as new<br/>features and bug fixes come available. Though the project takes steps to improve stability of these releases, it<br/>is common for problems to arise only after<i>&#160;release</i>. The<i>&#160;stable</i>&#160;release is the latest<i>&#160;release</i>&#160;which has<br/>demonstrated stability through general use.<br/>
Users of OpenLDAP Software can choose, depending on their desire for the<i>&#160;latest features</i>&#160;versus<br/><i>demonstrated stability</i>, the most appropriate series to install.<br/>
After downloading OpenLDAP Software, you need to extract the distribution from the compressed archive<br/>file and change your working directory to the top directory of the distribution:<br/>
gunzip -c openldap-VERSION.tgz | tar xf -<br/>
cd openldap-VERSION<br/>
You'll have to replace&#160;VERSION&#160;with the version name of the release.<br/>
You should now review the&#160;COPYRIGHT,&#160;LICENSE,&#160;README&#160;and&#160;INSTALL&#160;documents provided with the<br/>distribution. The&#160;COPYRIGHT&#160;and&#160;LICENSE&#160;provide information on acceptable use, copying, and limitation<br/>of warranty of OpenLDAP Software. The&#160;README&#160;and&#160;INSTALL&#160;documents provide detailed information on<br/>prerequisite software and installation procedures.<br/>
<b>4.2. Prerequisite software</b><br/>
OpenLDAP Software relies upon a number of software packages distributed by third parties. Depending on<br/>the features you intend to use, you may have to download and install a number of additional software<br/>packages. This section details commonly needed third party software packages you might have to install.<br/>However, for an up-to-date prerequisite information, the&#160;README&#160;document should be consulted. Note that<br/>some of these third party packages may depend on additional software packages. Install each package per the<br/>installation instructions provided with it.<br/>
<b>4.2.1. Transport Layer Security</b><br/>
<a href="http://www.openssl.org/">OpenLDAP clients and servers require installation of OpenSSL, GnuTLS, or MozNSS TLS libraries to<br/></a>provide Transport Layer Security services. Though some operating systems may provide these libraries as part<br/>of the base system or as an optional software component, OpenSSL, GnuTLS, and Mozilla NSS often require<br/>separate installation.<br/>
17<br/>
<hr/>
<a name=32></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
<a href="http://www.openssl.org/">OpenSSL is available from http://www.openssl.org/. GnuTLS is available from<br/></a><a href="http://www.gnu.org/software/gnutls/">http://www.gnu.org/software/gnutls/. Mozilla NSS is available from http://developer.mozilla.org/en/NSS.</a><br/>
OpenLDAP Software will not be fully LDAPv3 compliant unless OpenLDAP's&#160;configure&#160;detects a usable<br/>TLS library.<br/>
<b>4.2.2. Simple Authentication and Security Layer</b><br/>
<a href="http://asg.web.cmu.edu/sasl/sasl-library.html">OpenLDAP clients and servers require installation of Cyrus SASL libraries to provide Simple Authentication<br/></a>and Security Layer services. Though some operating systems may provide this library as part of the base<br/>system or as an optional software component, Cyrus SASL often requires separate installation.<br/>
<a href="http://asg.web.cmu.edu/sasl/sasl-library.html">Cyrus SASL is available from http://asg.web.cmu.edu/sasl/sasl-library.html. Cyrus SASL will make use of<br/></a>OpenSSL and Kerberos/GSSAPI libraries if preinstalled.<br/>
OpenLDAP Software will not be fully LDAPv3 compliant unless OpenLDAP's configure detects a usable<br/>Cyrus SASL installation.<br/>
<b>4.2.3. Kerberos Authentication Service</b><br/>
OpenLDAP clients and servers support Kerberos authentication services. In particular, OpenLDAP supports<br/>the Kerberos V GSS-API SASL authentication mechanism known as the GSSAPI mechanism. This feature<br/><a href="http://www.pdc.kth.se/heimdal/">requires, in addition to Cyrus SASL libraries, either Heimdal or MIT Kerberos V libraries.</a><br/>
<a href="http://www.pdc.kth.se/heimdal/">Heimdal Kerberos is available from http://www.pdc.kth.se/heimdal/. MIT Kerberos is available from<br/></a><a href="http://web.mit.edu/kerberos/www/">http://web.mit.edu/kerberos/www/.</a><br/>
Use of strong authentication services, such as those provided by Kerberos, is highly recommended.<br/>
<b>4.2.4. Database Software</b><br/>
OpenLDAP's<i>&#160;slapd</i>(8) MDB primary database backend uses the LMDB software included with the<br/>OpenLDAP source. There is no need to download any additional software to have<i>&#160;MDB</i>&#160;support.<br/>
OpenLDAP's<i>&#160;slapd</i><a href="http://www.oracle.com/">(8) BDB and HDB deprecated database backends require Oracle Corporation Berkeley<br/></a><a href="http://www.oracle.com/database/berkeley-db/db/index.html">DB. If not available at configure time, you will not be able to build</a><i>&#160;slapd</i>(8) with these primary database<br/>backends.<br/>
<a href="http://www.oracle.com/database/berkeley-db/db/index.html">Your operating system may provide a supported version of Berkeley DB in the base system or as an optional<br/></a>software component. If not, you'll have to obtain and install it yourself.<br/>
<a href="http://www.oracle.com/database/berkeley-db/db/index.html">Berkeley DB is available from Oracle Corporation's Berkeley DB download page<br/></a><a href="http://www.oracle.com/technology/software/products/berkeley-db/index.html">http://www.oracle.com/technology/software/products/berkeley-db/index.html.</a><br/>
There are several versions available. Generally, the most recent release (with published patches) is<br/>recommended. This package is required if you wish to use the deprecated BDB or HDB database backends.<br/>
<b>Note:</b>&#160;Berkeley DB version 6.0.20 and later uses a software license that is incompatible with LDAP<br/>technology and should not be used with OpenLDAP.<br/>
18<br/>
<hr/>
<a name=33></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
<b>Note:</b><a href="OpenLDAP-Admin-Guides.html#235">&#160;Please see Recommended OpenLDAP Software Dependency Versions for more information.</a><br/>
<b>4.2.5. Threads</b><br/>
OpenLDAP is designed to take advantage of threads. OpenLDAP supports POSIX<i>&#160;pthreads</i>, Mach<i>&#160;CThreads</i>,<br/>and a number of other varieties.&#160;configure&#160;will complain if it cannot find a suitable thread subsystem. If<br/>this occurs, please consult the&#160;Software|Installation|Platform Hints&#160;section of the<br/><a href="http://www.openldap.org/faq/">OpenLDAP FAQ http://www.openldap.org/faq/.</a><br/>
<b>4.2.6. TCP Wrappers</b><br/>
<i>slapd</i>(8) supports TCP Wrappers (IP level access control filters) if preinstalled. Use of TCP Wrappers or other<br/>IP-level access filters (such as those provided by an IP-level firewall) is recommended for servers containing<br/>non-public information.<br/>
<b>4.3. Running configure</b><br/>
Now you should probably run the&#160;configure&#160;script with the&#160;--help&#160;option. This will give you a list of<br/>options that you can change when building OpenLDAP. Many of the features of OpenLDAP can be enabled<br/>or disabled using this method.<br/>
&#160; &#160; &#160; &#160; ./configure --help<br/>
The&#160;configure&#160;script also looks for certain variables on the command line and in the environment. These<br/>include:<br/>
Table 4.1: Variables<br/>
<b>Variable</b><br/>
<b>Description</b><br/>
CC<br/>
Specify alternative C Compiler<br/>
CFLAGS<br/>
Specify additional compiler flags<br/>
CPPFLAGS&#160;Specify C Preprocessor flags<br/>
LDFLAGS<br/>
Specify linker flags<br/>
LIBS<br/>
Specify additional libraries<br/>
Now run the configure script with any desired configuration options or variables.<br/>
&#160; &#160; &#160; &#160; ./configure [options] [variable=value ...]<br/>
As an example, let's assume that we want to install OpenLDAP with BDB backend and TCP Wrappers<br/>support. By default, BDB is enabled and TCP Wrappers is not. So, we just need to specify<br/>--enable-wrappers&#160;to include TCP Wrappers support:<br/>
&#160; &#160; &#160; &#160; ./configure --enable-wrappers<br/>
However, this will fail to locate dependent software not installed in system directories. For example, if TCP<br/>Wrappers headers and libraries are installed in&#160;/usr/local/include&#160;and&#160;/usr/local/lib<br/>respectively, the&#160;configure&#160;script should typically be called as follows:<br/>
19<br/>
<hr/>
<a name=34></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
&#160; &#160; &#160; &#160; ./configure --enable-wrappers \<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; CPPFLAGS=&#34;-I/usr/local/include&#34; \<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; LDFLAGS=&#34;-L/usr/local/lib -Wl,-rpath,/usr/local/lib&#34;<br/>
The&#160;configure&#160;script will normally auto-detect appropriate settings. If you have problems at this stage,<br/>consult any platform specific hints and check your&#160;configure&#160;options, if any.<br/>
<b>4.4. Building the Software</b><br/>
Once you have run the&#160;configure&#160;script the last line of output should be:<br/>
&#160; &#160; &#160; &#160; Please &#34;make depend&#34; to build dependencies<br/>
If the last line of output does not match,&#160;configure&#160;has failed, and you will need to review its output to<br/>determine what went wrong. You should not proceed until&#160;configure&#160;completes successfully.<br/>
To build dependencies, run:<br/>
&#160; &#160; &#160; &#160; make depend<br/>
Now build the software, this step will actually compile OpenLDAP.<br/>
&#160; &#160; &#160; &#160; make<br/>
You should examine the output of this command carefully to make sure everything is built correctly. Note that<br/>this command builds the LDAP libraries and associated clients as well as<i>&#160;slapd</i>(8).<br/>
<b>4.5. Testing the Software</b><br/>
Once the software has been properly configured and successfully made, you should run the test suite to verify<br/>the build.<br/>
&#160; &#160; &#160; &#160; make test<br/>
Tests which apply to your configuration will run and they should pass. Some tests, such as the replication test,<br/>may be skipped if not supported by your configuration.<br/>
<b>4.6. Installing the Software</b><br/>
Once you have successfully tested the software, you are ready to install it. You will need to have write<br/>permission to the installation directories you specified when you ran configure. By default OpenLDAP<br/>Software is installed in&#160;/usr/local. If you changed this setting with the&#160;--prefix&#160;configure option, it<br/>will be installed in the location you provided.<br/>
Typically, the installation requires<i>&#160;super-user</i>&#160;privileges. From the top level OpenLDAP source directory,<br/>type:<br/>
&#160; &#160; &#160; &#160; su root -c 'make install'<br/>
and enter the appropriate password when requested.<br/>
20<br/>
<hr/>
<a name=35></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
You should examine the output of this command carefully to make sure everything is installed correctly. You<br/>will find the configuration files for<i>&#160;slapd</i>(8) in&#160;/usr/local/etc/openldap&#160;by default. See the chapter<br/><a href="OpenLDAP-Admin-Guides.html#37">Configuring slapd for additional information.</a><br/>
21<br/>
<hr/>
<a name=36></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
22<br/>
<hr/>
<a name=37></a><b>5. Configuring slapd</b><br/>
Once the software has been built and installed, you are ready to configure<i>&#160;slapd</i>(8) for use at your site.<br/>
OpenLDAP 2.3 and later have transitioned to using a dynamic runtime configuration engine,<i>&#160;slapd-config</i>(5).<br/><i>slapd-config</i>(5)<br/>
is fully LDAP-enabled<br/>
&#160;<br/>
is managed using the standard LDAP operations<br/>
&#160;<br/>
stores its configuration data in an LDIF database, generally in the<br/>
&#160;<br/>
/usr/local/etc/openldap/slapd.d&#160;directory.<br/>allows all of slapd's configuration options to be changed on the fly, generally without requiring a<br/>
&#160;<br/>
server restart for the changes to take effect.<br/>
This chapter describes the general format of the<i>&#160;slapd-config</i>(5) configuration system, followed by a detailed<br/>description of commonly used settings.<br/>
The older style<i>&#160;slapd.conf</i>(5) file is still supported, but its use is deprecated and support for it will be<br/>withdrawn in a future OpenLDAP release. Configuring<i>&#160;slapd</i>(8) via<i>&#160;slapd.conf</i>(5) is described in the next<br/>chapter.<br/>
Refer to<i>&#160;slapd</i>(8) for information on how to have slapd automatically convert from<i>&#160;slapd.conf</i>(5) to<br/><i>slapd-config</i>(5).<br/>
<b>Note:</b>&#160;Although the<i>&#160;slapd-config</i>(5) system stores its configuration as (text-based) LDIF files, you should<br/><i>never</i>&#160;edit any of the LDIF files directly. Configuration changes should be performed via LDAP operations,<br/>e.g.<i>&#160;ldapadd</i>(1),<i>&#160;ldapdelete</i>(1), or<i>&#160;ldapmodify</i>(1).<br/>
<b>Note:</b>&#160;You will need to continue to use the older<i>&#160;slapd.conf</i>(5) configuration system if your OpenLDAP<br/>installation requires the use of one or more backends or overlays that have not been updated to use the<br/><i>slapd-config</i>(5) system. As of OpenLDAP 2.4.33, all of the official backends have been updated. There may<br/>be additional contributed or experimental overlays that also have not been updated.<br/>
<b>5.1. Configuration Layout</b><br/>
The slapd configuration is stored as a special LDAP directory with a predefined schema and DIT. There are<br/>specific objectClasses used to carry global configuration options, schema definitions, backend and database<br/>definitions, and assorted other items. A sample config tree is shown in Figure 5.1.<br/>
23<br/>
<hr/>
<a name=38></a><img src="../img/OpenLDAP-Admin-Guide-38_1.png"/><br/>
OpenLDAP Software 2.4 Administrator's Guide<br/>
Figure 5.1: Sample configuration tree.<br/>
Other objects may be part of the configuration but were omitted from the illustration for clarity.<br/>
The<i>&#160;slapd-config</i>&#160;configuration tree has a very specific structure. The root of the tree is named&#160;cn=config<br/>and contains global configuration settings. Additional settings are contained in separate child entries:<br/>
Dynamically loaded modules<br/>
&#160;<br/>
These may only be used if the&#160;--enable-modules&#160;option was used to configure the software.<br/>Schema definitions<br/>
&#160;<br/>
The&#160;cn=schema,cn=config&#160;entry contains the system schema (all the schema that is hard-coded<br/>in slapd).<br/>Child entries of&#160;cn=schema,cn=config&#160;contain user schema as loaded from config files or added<br/>at runtime.<br/>Backend-specific configuration<br/>
&#160;<br/>
Database-specific configuration<br/>
&#160;<br/>
Overlays are defined in children of the Database entry.<br/>Databases and Overlays may also have other miscellaneous children.<br/>
The usual rules for LDIF files apply to the configuration information: Comment lines beginning with a '#'<br/>character are ignored. If a line begins with a single space, it is considered a continuation of the previous line<br/>(even if the previous line is a comment) and the single leading space is removed. Entries are separated by<br/>blank lines.<br/>
The general layout of the config LDIF is as follows:<br/>
&#160; &#160; &#160; &#160; # global configuration settings<br/>
&#160; &#160; &#160; &#160; dn: cn=config<br/>
&#160; &#160; &#160; &#160; objectClass: olcGlobal<br/>
&#160; &#160; &#160; &#160; cn: config<br/>
&#160; &#160; &#160; &#160; &lt;global config settings&gt;<br/>
&#160; &#160; &#160; &#160; # schema definitions<br/>
&#160; &#160; &#160; &#160; dn: cn=schema,cn=config<br/>
&#160; &#160; &#160; &#160; objectClass: olcSchemaConfig<br/>
&#160; &#160; &#160; &#160; cn: schema<br/>
24<br/>
<hr/>
<a name=39></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
&#160; &#160; &#160; &#160; &lt;system schema&gt;<br/>
&#160; &#160; &#160; &#160; dn: cn={X}core,cn=schema,cn=config<br/>
&#160; &#160; &#160; &#160; objectClass: olcSchemaConfig<br/>
&#160; &#160; &#160; &#160; cn: {X}core<br/>
&#160; &#160; &#160; &#160; &lt;core schema&gt;<br/>
&#160; &#160; &#160; &#160; # additional user-specified schema<br/>
&#160; &#160; &#160; &#160; ...<br/>
&#160; &#160; &#160; &#160; # backend definitions<br/>
&#160; &#160; &#160; &#160; dn: olcBackend=&lt;typeA&gt;,cn=config<br/>
&#160; &#160; &#160; &#160; objectClass: olcBackendConfig<br/>
&#160; &#160; &#160; &#160; olcBackend: &lt;typeA&gt;<br/>
&#160; &#160; &#160; &#160; &lt;backend-specific settings&gt;<br/>
&#160; &#160; &#160; &#160; # database definitions<br/>
&#160; &#160; &#160; &#160; dn: olcDatabase={X}&lt;typeA&gt;,cn=config<br/>
&#160; &#160; &#160; &#160; objectClass: olcDatabaseConfig<br/>
&#160; &#160; &#160; &#160; olcDatabase: {X}&lt;typeA&gt;<br/>
&#160; &#160; &#160; &#160; &lt;database-specific settings&gt;<br/>
&#160; &#160; &#160; &#160; # subsequent definitions and settings<br/>
&#160; &#160; &#160; &#160; ...<br/>
Some of the entries listed above have a numeric index&#160;&#34;{X}&#34;&#160;in their names. While most configuration<br/>settings have an inherent ordering dependency (i.e., one setting must take effect before a subsequent one may<br/>be set), LDAP databases are inherently unordered. The numeric index is used to enforce a consistent ordering<br/>in the configuration database, so that all ordering dependencies are preserved. In most cases the index does<br/>not have to be provided; it will be automatically generated based on the order in which entries are created.<br/>
Configuration directives are specified as values of individual attributes. Most of the attributes and<br/>objectClasses used in the slapd configuration have a prefix of&#160;&#34;olc&#34;&#160;(OpenLDAP Configuration) in their<br/>names. Generally there is a one-to-one correspondence between the attributes and the old-style&#160;slapd.conf<br/>configuration keywords, using the keyword as the attribute name, with the &#34;olc&#34; prefix attached.<br/>
A configuration directive may take arguments. If so, the arguments are separated by whitespace. If an<br/>argument contains whitespace, the argument should be enclosed in double quotes&#160;&#34;like this&#34;. In the<br/>descriptions that follow, arguments that should be replaced by actual text are shown in brackets&#160;&lt;&gt;.<br/>
The distribution contains an example configuration file that will be installed in the<br/>/usr/local/etc/openldap&#160;directory. A number of files containing schema definitions (attribute types<br/>and object classes) are also provided in the&#160;/usr/local/etc/openldap/schema&#160;directory.<br/>
<b>5.2. Configuration Directives</b><br/>
This section details commonly used configuration directives. For a complete list, see the<i>&#160;slapd-config</i>(5)<br/>manual page. This section will treat the configuration directives in a top-down order, starting with the global<br/>directives in the&#160;cn=config&#160;entry. Each directive will be described along with its default value (if any) and<br/>an example of its use.<br/>
25<br/>
<hr/>
<a name=40></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
<b>5.2.1. cn=config</b><br/>
Directives contained in this entry generally apply to the server as a whole. Most of them are system or<br/>connection oriented, not database related. This entry must have the&#160;olcGlobal&#160;objectClass.<br/>
<b>5.2.1.1. olcIdleTimeout: &lt;integer&gt;</b><br/>
Specify the number of seconds to wait before forcibly closing an idle client connection. A value of 0, the<br/>default, disables this feature.<br/>
<b>5.2.1.2. olcLogLevel: &lt;level&gt;</b><br/>
This directive specifies the level at which debugging statements and operation statistics should be syslogged<br/>(currently logged to the<i>&#160;syslogd</i>(8)&#160;LOG_LOCAL4&#160;facility). You must have configured OpenLDAP<br/>--enable-debug&#160;(the default) for this to work (except for the two statistics levels, which are always<br/>enabled). Log levels may be specified as integers or by keyword. Multiple log levels may be used and the<br/>levels are additive. To display what levels correspond to what kind of debugging, invoke slapd with&#160;-d?&#160;or<br/>consult the table below. The possible values for &lt;level&gt; are:<br/>
Table 5.1: Debugging Levels<br/>
<b>Level&#160;Keyword</b><br/>
<b>Description</b><br/>
-1&#160;any<br/>
enable all debugging<br/>
0<br/>
no debugging<br/>
1&#160;(0x1 trace)<br/>
trace function calls<br/>
2&#160;(0x2 packets)<br/>
debug packet handling<br/>
4&#160;(0x4 args)<br/>
heavy trace debugging<br/>
8&#160;(0x8 conns)<br/>
connection management<br/>
16&#160;(0x10 BER)<br/>
print out packets sent and received<br/>
32&#160;(0x20 filter)<br/>
search filter processing<br/>
64&#160;(0x40 config)<br/>
configuration processing<br/>
128&#160;(0x80 ACL)<br/>
access control list processing<br/>
256&#160;(0x100 stats)<br/>
stats log connections/operations/results<br/>
512&#160;(0x200 stats2)&#160;stats log entries sent<br/>
1024&#160;(0x400 shell)<br/>
print communication with shell backends<br/>
2048&#160;(0x800 parse)<br/>
print entry parsing debugging<br/>
16384&#160;(0x4000 sync)&#160;syncrepl consumer processing<br/>
32768&#160;(0x8000 none)&#160;only messages that get logged whatever log level is set<br/>
The desired log level can be input as a single integer that combines the (ORed) desired levels, both in decimal<br/>or in hexadecimal notation, as a list of integers (that are ORed internally), or as a list of the names that are<br/>shown between brackets, such that<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; olcLogLevel 129<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; olcLogLevel 0x81<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; olcLogLevel 128 1<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; olcLogLevel 0x80 0x1<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; olcLogLevel acl trace<br/>
26<br/>
<hr/>
<a name=41></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
are equivalent.<br/>
Examples:<br/>
&#160;olcLogLevel -1<br/>
This will cause lots and lots of debugging information to be logged.<br/>
&#160;olcLogLevel conns filter<br/>
Just log the connection and search filter processing.<br/>
&#160;olcLogLevel none<br/>
Log those messages that are logged regardless of the configured loglevel. This differs from setting the log<br/>level to 0, when no logging occurs. At least the&#160;None&#160;level is required to have high priority messages logged.<br/>
Default:<br/>
&#160;olcLogLevel stats<br/>
Basic stats logging is configured by default. However, if no olcLogLevel is defined, no logging occurs<br/>(equivalent to a 0 level).<br/>
<b>5.2.1.3. olcReferral &lt;URI&gt;</b><br/>
This directive specifies the referral to pass back when slapd cannot find a local database to handle a request.<br/>
Example:<br/>
&#160; &#160; &#160; &#160; olcReferral: ldap://root.openldap.org<br/>
This will refer non-local queries to the global root LDAP server at the OpenLDAP Project. Smart LDAP<br/>clients can re-ask their query at that server, but note that most of these clients are only going to know how to<br/>handle simple LDAP URLs that contain a host part and optionally a distinguished name part.<br/>
<b>5.2.1.4. Sample Entry</b><br/>
dn: cn=config<br/>
objectClass: olcGlobal<br/>
cn: config<br/>
olcIdleTimeout: 30<br/>
olcLogLevel: Stats<br/>
olcReferral: ldap://root.openldap.org<br/>
<b>5.2.2. cn=module</b><br/>
If support for dynamically loaded modules was enabled when configuring slapd,&#160;cn=module&#160;entries may be<br/>used to specify sets of modules to load. Module entries must have the&#160;olcModuleList&#160;objectClass.<br/>
27<br/>
<hr/>
<a name=42></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
<b>5.2.2.1. olcModuleLoad: &lt;filename&gt;</b><br/>
Specify the name of a dynamically loadable module to load. The filename may be an absolute path name or a<br/>simple filename. Non-absolute names are searched for in the directories specified by the&#160;olcModulePath<br/>directive.<br/>
<b>5.2.2.2. olcModulePath: &lt;pathspec&gt;</b><br/>
Specify a list of directories to search for loadable modules. Typically the path is colon-separated but this<br/>depends on the operating system.<br/>
<b>5.2.2.3. Sample Entries</b><br/>
dn: cn=module{0},cn=config<br/>
objectClass: olcModuleList<br/>
cn: module{0}<br/>
olcModuleLoad: /usr/local/lib/smbk5pwd.la<br/>
dn: cn=module{1},cn=config<br/>
objectClass: olcModuleList<br/>
cn: module{1}<br/>
olcModulePath: /usr/local/lib:/usr/local/lib/slapd<br/>
olcModuleLoad: accesslog.la<br/>
olcModuleLoad: pcache.la<br/>
<b>5.2.3. cn=schema</b><br/>
The cn=schema entry holds all of the schema definitions that are hard-coded in slapd. As such, the values in<br/>this entry are generated by slapd so no schema values need to be provided in the config file. The entry must<br/>still be defined though, to serve as a base for the user-defined schema to add in underneath. Schema entries<br/>must have the&#160;olcSchemaConfig&#160;objectClass.<br/>
<a href="http://www.rfc-editor.org/rfc/rfc4512.txt"><b>5.2.3.1. olcAttributeTypes: &lt;RFC4512 Attribute Type Description&gt;</b></a><br/>
<a href="OpenLDAP-Admin-Guides.html#141">This directive defines an attribute type. Please see the Schema Specification chapter for information regarding<br/></a>how to use this directive.<br/>
<a href="http://www.rfc-editor.org/rfc/rfc4512.txt"><b>5.2.3.2. olcObjectClasses: &lt;RFC4512 Object Class Description&gt;</b></a><br/>
<a href="OpenLDAP-Admin-Guides.html#141">This directive defines an object class. Please see the Schema Specification chapter for information regarding<br/></a>how to use this directive.<br/>
<b>5.2.3.3. Sample Entries</b><br/>
dn: cn=schema,cn=config<br/>
objectClass: olcSchemaConfig<br/>
cn: schema<br/>
dn: cn=test,cn=schema,cn=config<br/>
objectClass: olcSchemaConfig<br/>
cn: test<br/>
olcAttributeTypes: ( 1.1.1<br/>
&#160; NAME 'testAttr'<br/>
&#160; EQUALITY integerMatch<br/>
28<br/>
<hr/>
<a name=43></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
&#160; SYNTAX 1.3.6.1.4.1.1466.115.121.1.27 )<br/>
olcAttributeTypes: ( 1.1.2 NAME 'testTwo' EQUALITY caseIgnoreMatch<br/>
&#160; SUBSTR caseIgnoreSubstringsMatch SYNTAX 1.3.6.1.4.1.1466.115.121.1.44 )<br/>
olcObjectClasses: ( 1.1.3 NAME 'testObject'<br/>
&#160; MAY ( testAttr $ testTwo ) AUXILIARY )<br/>
<b>5.2.4. Backend-specific Directives</b><br/>
Backend directives apply to all database instances of the same type and, depending on the directive, may be<br/>overridden by database directives. Backend entries must have the&#160;olcBackendConfig&#160;objectClass.<br/>
<b>5.2.4.1. olcBackend: &lt;type&gt;</b><br/>
This directive names a backend-specific configuration entry.&#160;&lt;type&gt;&#160;should be one of the supported backend<br/>types listed in Table 5.2.<br/>
Table 5.2: Database Backends<br/>
<b>Types</b><br/>
<b>Description</b><br/>
bdb<br/>
Berkeley DB transactional backend<br/>
config<br/>
Slapd configuration backend<br/>
dnssrv<br/>
DNS SRV backend<br/>
hdb<br/>
Hierarchical variant of bdb backend<br/>
ldap<br/>
Lightweight Directory Access Protocol (Proxy) backend<br/>
ldif<br/>
Lightweight Data Interchange Format backend<br/>
meta<br/>
Meta Directory backend<br/>
monitor&#160;Monitor backend<br/>
passwd<br/>
Provides read-only access to<i>&#160;passwd</i>(5)<br/>
perl<br/>
Perl Programmable backend<br/>
shell<br/>
Shell (extern program) backend<br/>
sql<br/>
SQL Programmable backend<br/>
Example:<br/>
&#160; &#160; &#160; &#160; olcBackend: bdb<br/>
There are no other directives defined for this entry. Specific backend types may define additional attributes for<br/>their particular use but so far none have ever been defined. As such, these directives usually do not appear in<br/>any actual configurations.<br/>
<b>5.2.4.2. Sample Entry</b><br/>
&#160;dn: olcBackend=bdb,cn=config<br/>
&#160;objectClass: olcBackendConfig<br/>
&#160;olcBackend: bdb<br/>
<b>5.2.5. Database-specific Directives</b><br/>
Directives in this section are supported by every type of database. Database entries must have the<br/>olcDatabaseConfig&#160;objectClass.<br/>
29<br/>
<hr/>
<a name=44></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
<b>5.2.5.1. olcDatabase: [{&lt;index&gt;}]&lt;type&gt;</b><br/>
This directive names a specific database instance. The numeric {&lt;index&gt;} may be provided to distinguish<br/>multiple databases of the same type. Usually the index can be omitted, and slapd will generate it<br/>automatically.&#160;&lt;type&gt;&#160;should be one of the supported backend types listed in Table 5.2 or the&#160;frontend<br/>type.<br/>
The&#160;frontend&#160;is a special database that is used to hold database-level options that should be applied to all<br/>the other databases. Subsequent database definitions may also override some frontend settings.<br/>
The&#160;config&#160;database is also special; both the&#160;config&#160;and the&#160;frontend&#160;databases are always created<br/>implicitly even if they are not explicitly configured, and they are created before any other databases.<br/>
Example:<br/>
&#160; &#160; &#160; &#160; olcDatabase: bdb<br/>
This marks the beginning of a new BDB database instance.<br/>
<b>5.2.5.2. olcAccess: to &lt;what&gt; [ by &lt;who&gt; [&lt;accesslevel&gt;] [&lt;control&gt;] ]+</b><br/>
This directive grants access (specified by &lt;accesslevel&gt;) to a set of entries and/or attributes (specified by<br/><a href="OpenLDAP-Admin-Guides.html#71">&lt;what&gt;) by one or more requestors (specified by &lt;who&gt;). See the Access Control section of this guide for<br/></a>basic usage.<br/>
<b>Note:</b>&#160;If no&#160;olcAccess&#160;directives are specified, the default access control policy,&#160;to * by * read,<br/>allows all users (both authenticated and anonymous) read access.<br/>
<b>Note:</b>&#160;Access controls defined in the frontend are appended to all other databases' controls.<br/>
<b>5.2.5.3. olcReadonly { TRUE | FALSE }</b><br/>
This directive puts the database into &#34;read-only&#34; mode. Any attempts to modify the database will return an<br/>&#34;unwilling to perform&#34; error.<br/>
Default:<br/>
&#160; &#160; &#160; &#160; olcReadonly: FALSE<br/>
<b>5.2.5.4. olcRootDN: &lt;DN&gt;</b><br/>
This directive specifies the DN that is not subject to access control or administrative limit restrictions for<br/>operations on this database. The DN need not refer to an entry in this database or even in the directory. The<br/>DN may refer to a SASL identity.<br/>
Entry-based Example:<br/>
&#160; &#160; &#160; &#160; olcRootDN: &#34;cn=Manager,dc=example,dc=com&#34;<br/>
SASL-based Example:<br/>
30<br/>
<hr/>
<a name=45></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
&#160; &#160; &#160; &#160; olcRootDN: &#34;uid=root,cn=example.com,cn=digest-md5,cn=auth&#34;<br/>
<a href="OpenLDAP-Admin-Guides.html#158">See the SASL Authentication section for information on SASL authentication identities.</a><br/>
<b>5.2.5.5. olcRootPW: &lt;password&gt;</b><br/>
This directive can be used to specify a password for the DN for the rootdn (when the rootdn is set to a DN<br/>within the database).<br/>
Example:<br/>
&#160; &#160; &#160; &#160; olcRootPW: secret<br/>
<a href="http://www.rfc-editor.org/rfc/rfc2307.txt">It is also permissible to provide a hash of the password in RFC2307 form.</a><i>&#160;slappasswd</i>(8) may be used to<br/>generate the password hash.<br/>
Example:<br/>
&#160; &#160; &#160; &#160; olcRootPW: {SSHA}ZKKuqbEKJfKSXhUbHG3fG8MDn9j1v4QN<br/>
The hash was generated using the command&#160;slappasswd -s secret.<br/>
<b>5.2.5.6. olcSizeLimit: &lt;integer&gt;</b><br/>
This directive specifies the maximum number of entries to return from a search operation.<br/>
Default:<br/>
&#160; &#160; &#160; &#160; olcSizeLimit: 500<br/>
<a href="OpenLDAP-Admin-Guides.html#93">See the Limits section of this guide and slapd-config(5) for more details.</a><br/>
<b>5.2.5.7. olcSuffix: &lt;dn suffix&gt;</b><br/>
This directive specifies the DN suffix of queries that will be passed to this backend database. Multiple suffix<br/>lines can be given, and usually at least one is required for each database definition. (Some backend types, such<br/>as&#160;frontend&#160;and&#160;monitor&#160;use a hard-coded suffix which may not be overridden in the configuration.)<br/>
Example:<br/>
&#160; &#160; &#160; &#160; olcSuffix: &#34;dc=example,dc=com&#34;<br/>
Queries with a DN ending in &#34;dc=example,dc=com&#34; will be passed to this backend.<br/>
<b>Note:</b>&#160;When the backend to pass a query to is selected, slapd looks at the suffix value(s) in each database<br/>definition in the order in which they were configured. Thus, if one database suffix is a prefix of another, it<br/>must appear after it in the configuration.<br/>
31<br/>
<hr/>
<a name=46></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
<b>5.2.5.8. olcSyncrepl</b><br/>
&#160; &#160; &#160; &#160; olcSyncrepl: rid=&lt;replica ID&gt;<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; provider=ldap[s]://&lt;hostname&gt;[:port]<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; [type=refreshOnly|refreshAndPersist]<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; [interval=dd:hh:mm:ss]<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; [retry=[&lt;retry interval&gt; &lt;# of retries&gt;]+]<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; searchbase=&lt;base DN&gt;<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; [filter=&lt;filter str&gt;]<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; [scope=sub|one|base]<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; [attrs=&lt;attr list&gt;]<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; [attrsonly]<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; [sizelimit=&lt;limit&gt;]<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; [timelimit=&lt;limit&gt;]<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; [schemachecking=on|off]<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; [bindmethod=simple|sasl]<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; [binddn=&lt;DN&gt;]<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; [saslmech=&lt;mech&gt;]<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; [authcid=&lt;identity&gt;]<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; [authzid=&lt;identity&gt;]<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; [credentials=&lt;passwd&gt;]<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; [realm=&lt;realm&gt;]<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; [secprops=&lt;properties&gt;]<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; [starttls=yes|critical]<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; [tls_cert=&lt;file&gt;]<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; [tls_key=&lt;file&gt;]<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; [tls_cacert=&lt;file&gt;]<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; [tls_cacertdir=&lt;path&gt;]<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; [tls_reqcert=never|allow|try|demand]<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; [tls_ciphersuite=&lt;ciphers&gt;]<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; [tls_crlcheck=none|peer|all]<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; [logbase=&lt;base DN&gt;]<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; [logfilter=&lt;filter str&gt;]<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; [syncdata=default|accesslog|changelog]<br/>
This directive specifies the current database as a replica of the master content by establishing the current<br/><i>slapd</i>(8) as a replication consumer site running a syncrepl replication engine. The master database is located at<br/>the replication provider site specified by the&#160;provider&#160;parameter. The replica database is kept up-to-date<br/><a href="http://www.rfc-editor.org/rfc/rfc4533.txt">with the master content using the LDAP Content Synchronization protocol. See RFC4533 for more<br/></a>information on the protocol.<br/>
The&#160;rid&#160;parameter is used for identification of the current&#160;syncrepl&#160;directive within the replication<br/>consumer server, where&#160;&lt;replica ID&gt;&#160;uniquely identifies the syncrepl specification described by the<br/>current&#160;syncrepl&#160;directive.&#160;&lt;replica ID&gt;&#160;is non-negative and is no more than three decimal digits in<br/>length.<br/>
The&#160;provider&#160;parameter specifies the replication provider site containing the master content as an LDAP<br/>URI. The&#160;provider&#160;parameter specifies a scheme, a host and optionally a port where the provider slapd<br/>instance can be found. Either a domain name or IP address may be used for &lt;hostname&gt;. Examples are<br/>ldap://provider.example.com:389&#160;or&#160;ldaps://192.168.1.1:636. If &lt;port&gt; is not given,<br/>the standard LDAP port number (389 or 636) is used. Note that the syncrepl uses a consumer-initiated<br/>protocol, and hence its specification is located at the consumer site, whereas the&#160;replica&#160;specification is<br/>located at the provider site.&#160;syncrepl&#160;and&#160;replica&#160;directives define two independent replication<br/>mechanisms. They do not represent the replication peers of each other.<br/>
32<br/>
<hr/>
<a name=47></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
The content of the syncrepl replica is defined using a search specification as its result set. The consumer slapd<br/>will send search requests to the provider slapd according to the search specification. The search specification<br/>includes&#160;searchbase,&#160;scope,&#160;filter,&#160;attrs,&#160;attrsonly,&#160;sizelimit, and&#160;timelimit<br/>parameters as in the normal search specification. The&#160;searchbase&#160;parameter has no default value and must<br/>always be specified. The&#160;scope&#160;defaults to&#160;sub, the&#160;filter&#160;defaults to&#160;(objectclass=*),&#160;attrs<br/>defaults to&#160;&#34;*,+&#34;&#160;to replicate all user and operational attributes, and&#160;attrsonly&#160;is unset by default. Both<br/>sizelimit&#160;and&#160;timelimit&#160;default to &#34;unlimited&#34;, and only positive integers or &#34;unlimited&#34; may be<br/>specified.<br/>
The LDAP Content Synchronization protocol has two operation types:&#160;refreshOnly&#160;and<br/>refreshAndPersist. The operation type is specified by the&#160;type&#160;parameter. In the&#160;refreshOnly<br/>operation, the next synchronization search operation is periodically rescheduled at an interval time after each<br/>synchronization operation finishes. The interval is specified by the&#160;interval&#160;parameter. It is set to one day<br/>by default. In the&#160;refreshAndPersist&#160;operation, a synchronization search remains persistent in the<br/>provider<i>&#160;slapd</i>&#160;instance. Further updates to the master replica will generate&#160;searchResultEntry&#160;to the<br/>consumer slapd as the search responses to the persistent synchronization search.<br/>
If an error occurs during replication, the consumer will attempt to reconnect according to the retry parameter<br/>which is a list of the &lt;retry interval&gt; and &lt;# of retries&gt; pairs. For example, retry=&#34;60 10 300 3&#34; lets the<br/>consumer retry every 60 seconds for the first 10 times and then retry every 300 seconds for the next three<br/>times before stop retrying. + in &lt;# of retries&gt; means indefinite number of retries until success.<br/>
The schema checking can be enforced at the LDAP Sync consumer site by turning on the<br/>schemachecking&#160;parameter. If it is turned on, every replicated entry will be checked for its schema as the<br/>entry is stored into the replica content. Every entry in the replica should contain those attributes required by<br/>the schema definition. If it is turned off, entries will be stored without checking schema conformance. The<br/>default is off.<br/>
The&#160;binddn&#160;parameter gives the DN to bind as for the syncrepl searches to the provider slapd. It should be a<br/>DN which has read access to the replication content in the master database.<br/>
The&#160;bindmethod&#160;is&#160;simple&#160;or&#160;sasl, depending on whether simple password-based authentication or<br/>SASL authentication is to be used when connecting to the provider<i>&#160;slapd</i>&#160;instance.<br/>
Simple authentication should not be used unless adequate data integrity and confidentiality protections are in<br/>place (e.g. TLS or IPsec). Simple authentication requires specification of&#160;binddn&#160;and&#160;credentials<br/>parameters.<br/>
SASL authentication is generally recommended. SASL authentication requires specification of a mechanism<br/>using the&#160;saslmech&#160;parameter. Depending on the mechanism, an authentication identity and/or credentials<br/>can be specified using&#160;authcid&#160;and&#160;credentials, respectively. The&#160;authzid&#160;parameter may be used to<br/>specify an authorization identity.<br/>
The&#160;realm&#160;parameter specifies a realm which a certain mechanisms authenticate the identity within. The<br/>secprops&#160;parameter specifies Cyrus SASL security properties.<br/>
The&#160;starttls&#160;parameter specifies use of the StartTLS extended operation to establish a TLS session before<br/>authenticating to the provider. If the&#160;critical&#160;argument is supplied, the session will be aborted if the<br/>StartTLS request fails. Otherwise the syncrepl session continues without TLS. Note that the main slapd TLS<br/>settings are not used by the syncrepl engine; by default the TLS parameters from a<i>&#160;ldap.conf</i>(5) configuration<br/>file will be used. TLS settings may be specified here, in which case any<i>&#160;ldap.conf</i>(5) settings will be<br/>
33<br/>
<hr/>
<a name=48></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
completely ignored.<br/>
Rather than replicating whole entries, the consumer can query logs of data modifications. This mode of<br/>operation is referred to as<i>&#160;delta syncrepl</i>. In addition to the above parameters, the&#160;logbase&#160;and&#160;logfilter<br/>parameters must be set appropriately for the log that will be used. The&#160;syncdata&#160;parameter must be set to<br/>either&#160;&#34;accesslog&#34;&#160;if the log conforms to the<i>&#160;slapo-accesslog</i>(5) log format, or&#160;&#34;changelog&#34;&#160;if the log<br/>conforms to the obsolete<i>&#160;changelog</i>&#160;format. If the&#160;syncdata&#160;parameter is omitted or set to&#160;&#34;default&#34;<br/>then the log parameters are ignored.<br/>
The<i>&#160;syncrepl</i>&#160;replication mechanism is supported by the<i>&#160;bdb</i>&#160;and<i>&#160;hdb</i>&#160;backends.<br/>
<a href="OpenLDAP-Admin-Guides.html#177">See the LDAP Sync Replication chapter of this guide for more information on how to use this directive.</a><br/>
<b>5.2.5.9. olcTimeLimit: &lt;integer&gt;</b><br/>
This directive specifies the maximum number of seconds (in real time) slapd will spend answering a search<br/>request. If a request is not finished in this time, a result indicating an exceeded timelimit will be returned.<br/>
Default:<br/>
&#160; &#160; &#160; &#160; olcTimeLimit: 3600<br/>
<a href="OpenLDAP-Admin-Guides.html#93">See the Limits section of this guide and slapd-config(5) for more details.</a><br/>
<b>5.2.5.10. olcUpdateref: &lt;URL&gt;</b><br/>
This directive is only applicable in a slave slapd. It specifies the URL to return to clients which submit update<br/>requests upon the replica. If specified multiple times, each URL is provided.<br/>
Example:<br/>
&#160; &#160; &#160; &#160; olcUpdateref: &#160; ldap://master.example.net<br/>
<b>5.2.5.11. Sample Entries</b><br/>
dn: olcDatabase=frontend,cn=config<br/>
objectClass: olcDatabaseConfig<br/>
objectClass: olcFrontendConfig<br/>
olcDatabase: frontend<br/>
olcReadOnly: FALSE<br/>
dn: olcDatabase=config,cn=config<br/>
objectClass: olcDatabaseConfig<br/>
olcDatabase: config<br/>
olcRootDN: cn=Manager,dc=example,dc=com<br/>
<b>5.2.6. BDB and HDB Database Directives</b><br/>
Directives in this category apply to both the BDB and the HDB database. They are used in an olcDatabase<br/>entry in addition to the generic database directives defined above. For a complete reference of BDB/HDB<br/>configuration directives, see<i>&#160;slapd-bdb</i>(5). In addition to the&#160;olcDatabaseConfig&#160;objectClass, BDB and<br/>HDB database entries must have the&#160;olcBdbConfig&#160;and&#160;olcHdbConfig&#160;objectClass, respectively.<br/>
34<br/>
<hr/>
<a name=49></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
<b>5.2.6.1. olcDbDirectory: &lt;directory&gt;</b><br/>
This directive specifies the directory where the BDB files containing the database and associated indices live.<br/>
Default:<br/>
&#160; &#160; &#160; &#160; olcDbDirectory: /usr/local/var/openldap-data<br/>
<b>5.2.6.2. olcDbCachesize: &lt;integer&gt;</b><br/>
This directive specifies the size in entries of the in-memory cache maintained by the BDB backend database<br/>instance.<br/>
Default:<br/>
&#160; &#160; &#160; &#160; olcDbCachesize: 1000<br/>
<b>5.2.6.3. olcDbCheckpoint: &lt;kbyte&gt; &lt;min&gt;</b><br/>
This directive specifies how often to checkpoint the BDB transaction log. A checkpoint operation flushes the<br/>database buffers to disk and writes a checkpoint record in the log. The checkpoint will occur if either &lt;kbyte&gt;<br/>data has been written or &lt;min&gt; minutes have passed since the last checkpoint. Both arguments default to zero,<br/>in which case they are ignored. When the &lt;min&gt; argument is non-zero, an internal task will run every &lt;min&gt;<br/>minutes to perform the checkpoint. See the Berkeley DB reference guide for more details.<br/>
Example:<br/>
&#160; &#160; &#160; &#160; olcDbCheckpoint: 1024 10<br/>
<b>5.2.6.4. olcDbConfig: &lt;DB_CONFIG setting&gt;</b><br/>
This attribute specifies a configuration directive to be placed in the&#160;DB_CONFIG&#160;file of the database<br/>directory. At server startup time, if no such file exists yet, the&#160;DB_CONFIG&#160;file will be created and the<br/>settings in this attribute will be written to it. If the file exists, its contents will be read and displayed in this<br/>attribute. The attribute is multi-valued, to accommodate multiple configuration directives. No default is<br/>provided, but it is essential to use proper settings here to get the best server performance.<br/>
Any changes made to this attribute will be written to the&#160;DB_CONFIG&#160;file and will cause the database<br/>environment to be reset so the changes can take immediate effect. If the environment cache is large and has<br/>not been recently checkpointed, this reset operation may take a long time. It may be advisable to manually<br/>perform a single checkpoint using the Berkeley DB<i>&#160;db_checkpoint</i>&#160;utility before using LDAP Modify to<br/>change this attribute.<br/>
Example:<br/>
&#160; &#160; &#160; &#160; olcDbConfig: set_cachesize 0 10485760 0<br/>
&#160; &#160; &#160; &#160; olcDbConfig: set_lg_bsize 2097512<br/>
&#160; &#160; &#160; &#160; olcDbConfig: set_lg_dir /var/tmp/bdb-log<br/>
&#160; &#160; &#160; &#160; olcDbConfig: set_flags DB_LOG_AUTOREMOVE<br/>
In this example, the BDB cache is set to 10MB, the BDB transaction log buffer size is set to 2MB, and the<br/>transaction log files are to be stored in the /var/tmp/bdb-log directory. Also a flag is set to tell BDB to delete<br/>
35<br/>
<hr/>
<a name=50></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
transaction log files as soon as their contents have been checkpointed and they are no longer needed. Without<br/>this setting the transaction log files will continue to accumulate until some other cleanup procedure removes<br/>them. See the Berkeley DB documentation for the&#160;db_archive&#160;command for details. For a complete list of<br/>Berkeley DB flags please see -<br/><a href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/env_set_flags.html">http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/env_set_flags.html</a><br/>
Ideally the BDB cache must be at least as large as the working set of the database, the log buffer size should<br/>be large enough to accommodate most transactions without overflowing, and the log directory must be on a<br/>separate physical disk from the main database files. And both the database directory and the log directory<br/>should be separate from disks used for regular system activities such as the root, boot, or swap filesystems.<br/>See the FAQ-o-Matic and the Berkeley DB documentation for more details.<br/>
<b>5.2.6.5. olcDbNosync: { TRUE | FALSE }</b><br/>
This option causes on-disk database contents to not be immediately synchronized with in memory changes<br/>upon change. Setting this option to&#160;TRUE&#160;may improve performance at the expense of data integrity. This<br/>directive has the same effect as using<br/>
&#160; &#160; &#160; &#160; olcDbConfig: set_flags DB_TXN_NOSYNC<br/>
<b>5.2.6.6. olcDbIDLcacheSize: &lt;integer&gt;</b><br/>
Specify the size of the in-memory index cache, in index slots. The default is zero. A larger value will speed up<br/>frequent searches of indexed entries. The optimal size will depend on the data and search characteristics of the<br/>database, but using a number three times the entry cache size is a good starting point.<br/>
Example:<br/>
&#160; &#160; &#160; &#160; olcDbIDLcacheSize: 3000<br/>
<b>5.2.6.7. olcDbIndex: {&lt;attrlist&gt; | default} [pres,eq,approx,sub,none]</b><br/>
This directive specifies the indices to maintain for the given attribute. If only an&#160;&lt;attrlist&gt;&#160;is given, the<br/>default indices are maintained. The index keywords correspond to the common types of matches that may be<br/>used in an LDAP search filter.<br/>
Example:<br/>
&#160; &#160; &#160; &#160; olcDbIndex: default pres,eq<br/>
&#160; &#160; &#160; &#160; olcDbIndex: uid<br/>
&#160; &#160; &#160; &#160; olcDbIndex: cn,sn pres,eq,sub<br/>
&#160; &#160; &#160; &#160; olcDbIndex: objectClass eq<br/>
The first line sets the default set of indices to maintain to present and equality. The second line causes the<br/>default (pres,eq) set of indices to be maintained for the&#160;uid&#160;attribute type. The third line causes present,<br/>equality, and substring indices to be maintained for&#160;cn&#160;and&#160;sn&#160;attribute types. The fourth line causes an<br/>equality index for the&#160;objectClass&#160;attribute type.<br/>
There is no index keyword for inequality matches. Generally these matches do not use an index. However,<br/>some attributes do support indexing for inequality matches, based on the equality index.<br/>
36<br/>
<hr/>
<a name=51></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
A substring index can be more explicitly specified as&#160;subinitial,&#160;subany, or&#160;subfinal, corresponding<br/>to the three possible components of a substring match filter. A subinitial index only indexes substrings that<br/>appear at the beginning of an attribute value. A subfinal index only indexes substrings that appear at the end<br/>of an attribute value, while subany indexes substrings that occur anywhere in a value.<br/>
Note that by default, setting an index for an attribute also affects every subtype of that attribute. E.g., setting<br/>an equality index on the&#160;name&#160;attribute causes&#160;cn,&#160;sn, and every other attribute that inherits from&#160;name&#160;to be<br/>indexed.<br/>
By default, no indices are maintained. It is generally advised that minimally an equality index upon<br/>objectClass be maintained.<br/>
&#160; &#160; &#160; &#160; olcDbindex: objectClass eq<br/>
Additional indices should be configured corresponding to the most common searches that are used on the<br/>database. Presence indexing should not be configured for an attribute unless the attribute occurs very rarely in<br/>the database, and presence searches on the attribute occur very frequently during normal use of the directory.<br/>Most applications don't use presence searches, so usually presence indexing is not very useful.<br/>
If this setting is changed while slapd is running, an internal task will be run to generate the changed index<br/>data. All server operations can continue as normal while the indexer does its work. If slapd is stopped before<br/>the index task completes, indexing will have to be manually completed using the slapindex tool.<br/>
<b>5.2.6.8. olcDbLinearIndex: { TRUE | FALSE }</b><br/>
If this setting is&#160;TRUE&#160;slapindex will index one attribute at a time. The default settings is&#160;FALSE&#160;in which<br/>case all indexed attributes of an entry are processed at the same time. When enabled, each indexed attribute is<br/>processed individually, using multiple passes through the entire database. This option improves slapindex<br/>performance when the database size exceeds the BDB cache size. When the BDB cache is large enough, this<br/>option is not needed and will decrease performance. Also by default, slapadd performs full indexing and so a<br/>separate slapindex run is not needed. With this option, slapadd does no indexing and slapindex must be used.<br/>
<b>5.2.6.9. olcDbMode: { &lt;octal&gt; | &lt;symbolic&gt; }</b><br/>
This directive specifies the file protection mode that newly created database index files should have. This can<br/>be in the form&#160;0600&#160;or&#160;-rw-------<br/>
Default:<br/>
&#160; &#160; &#160; &#160; olcDbMode: 0600<br/>
<b>5.2.6.10. olcDbSearchStack: &lt;integer&gt;</b><br/>
Specify the depth of the stack used for search filter evaluation. Search filters are evaluated on a stack to<br/>accommodate nested&#160;AND&#160;/&#160;OR&#160;clauses. An individual stack is allocated for each server thread. The depth of<br/>the stack determines how complex a filter can be evaluated without requiring any additional memory<br/>allocation. Filters that are nested deeper than the search stack depth will cause a separate stack to be allocated<br/>for that particular search operation. These separate allocations can have a major negative impact on server<br/>performance, but specifying too much stack will also consume a great deal of memory. Each search uses<br/>512K bytes per level on a 32-bit machine, or 1024K bytes per level on a 64-bit machine. The default stack<br/>depth is 16, thus 8MB or 16MB per thread is used on 32 and 64 bit machines, respectively. Also the 512KB<br/>
37<br/>
<hr/>
<a name=52></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
size of a single stack slot is set by a compile-time constant which may be changed if needed; the code must be<br/>recompiled for the change to take effect.<br/>
Default:<br/>
&#160; &#160; &#160; &#160; olcDbSearchStack: 16<br/>
<b>5.2.6.11. olcDbShmKey: &lt;integer&gt;</b><br/>
Specify a key for a shared memory BDB environment. By default the BDB environment uses memory<br/>mapped files. If a non-zero value is specified, it will be used as the key to identify a shared memory region<br/>that will house the environment.<br/>
Example:<br/>
&#160; &#160; &#160; &#160; olcDbShmKey: 42<br/>
<b>5.2.6.12. Sample Entry</b><br/>
dn: olcDatabase=hdb,cn=config<br/>
objectClass: olcDatabaseConfig<br/>
objectClass: olcHdbConfig<br/>
olcDatabase: hdb<br/>
olcSuffix: &#34;dc=example,dc=com&#34;<br/>
olcDbDirectory: /usr/local/var/openldap-data<br/>
olcDbCacheSize: 1000<br/>
olcDbCheckpoint: 1024 10<br/>
olcDbConfig: set_cachesize 0 10485760 0<br/>
olcDbConfig: set_lg_bsize 2097152<br/>
olcDbConfig: set_lg_dir /var/tmp/bdb-log<br/>
olcDbConfig: set_flags DB_LOG_AUTOREMOVE<br/>
olcDbIDLcacheSize: 3000<br/>
olcDbIndex: objectClass eq<br/>
<b>5.3. Configuration Example</b><br/>
The following is an example configuration, interspersed with explanatory text. It defines two databases to<br/>handle different parts of the X.500 tree; both are BDB database instances. The line numbers shown are<br/>provided for reference only and are not included in the actual file. First, the global configuration section:<br/>
&#160; 1. &#160; &#160;# example config file - global configuration entry<br/>
&#160; 2. &#160; &#160;dn: cn=config<br/>
&#160; 3. &#160; &#160;objectClass: olcGlobal<br/>
&#160; 4. &#160; &#160;cn: config<br/>
&#160; 5. &#160; &#160;olcReferral: ldap://root.openldap.org<br/>
&#160; 6.<br/>
Line 1 is a comment. Lines 2-4 identify this as the global configuration entry. The&#160;olcReferral:&#160;directive<br/>on line 5 means that queries not local to one of the databases defined below will be referred to the LDAP<br/>server running on the standard port (389) at the host&#160;root.openldap.org. Line 6 is a blank line,<br/>indicating the end of this entry.<br/>
&#160; 7. &#160; &#160;# internal schema<br/>
&#160; 8. &#160; &#160;dn: cn=schema,cn=config<br/>
&#160; 9. &#160; &#160;objectClass: olcSchemaConfig<br/>
38<br/>
<hr/>
<a name=53></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
&#160;10. &#160; &#160;cn: schema<br/>
&#160;11.<br/>
Line 7 is a comment. Lines 8-10 identify this as the root of the schema subtree. The actual schema definitions<br/>in this entry are hardcoded into slapd so no additional attributes are specified here. Line 11 is a blank line,<br/>indicating the end of this entry.<br/>
&#160;12. &#160; &#160;# include the core schema<br/>
&#160;13. &#160; &#160;include: file:///usr/local/etc/openldap/schema/core.ldif<br/>
&#160;14.<br/>
Line 12 is a comment. Line 13 is an LDIF include directive which accesses the<i>&#160;core</i>&#160;schema definitions in<br/>LDIF format. Line 14 is a blank line.<br/>
Next comes the database definitions. The first database is the special&#160;frontend&#160;database whose settings are<br/>applied globally to all the other databases.<br/>
&#160;15. &#160; &#160;# global database parameters<br/>
&#160;16. &#160; &#160;dn: olcDatabase=frontend,cn=config<br/>
&#160;17. &#160; &#160;objectClass: olcDatabaseConfig<br/>
&#160;18. &#160; &#160;olcDatabase: frontend<br/>
&#160;19. &#160; &#160;olcAccess: to * by * read<br/>
&#160;20.<br/>
Line 15 is a comment. Lines 16-18 identify this entry as the global database entry. Line 19 is a global access<br/>control. It applies to all entries (after any applicable database-specific access controls). Line 20 is a blank line.<br/>
The next entry defines the config backend.<br/>
&#160;21. &#160; &#160;# set a rootpw for the config database so we can bind.<br/>
&#160;22. &#160; &#160;# deny access to everyone else.<br/>
&#160;23. &#160; &#160;dn: olcDatabase=config,cn=config<br/>
&#160;24. &#160; &#160;objectClass: olcDatabaseConfig<br/>
&#160;25. &#160; &#160;olcDatabase: config<br/>
&#160;26. &#160; &#160;olcRootPW: {SSHA}XKYnrjvGT3wZFQrDD5040US592LxsdLy<br/>
&#160;27. &#160; &#160;olcAccess: to * by * none<br/>
&#160;28.<br/>
Lines 21-22 are comments. Lines 23-25 identify this entry as the config database entry. Line 26 defines the<br/><i>super-user</i>&#160;password for this database. (The DN defaults to<i>&#160;&#34;cn=config&#34;</i>.) Line 27 denies all access to this<br/>database, so only the super-user will be able to access it. (This is already the default access on the config<br/>database. It is just listed here for illustration, and to reiterate that unless a means to authenticate as the<br/>super-user is explicitly configured, the config database will be inaccessible.)<br/>
Line 28 is a blank line.<br/>
The next entry defines a BDB backend that will handle queries for things in the &#34;dc=example,dc=com&#34;<br/>portion of the tree. Indices are to be maintained for several attributes, and the&#160;userPassword&#160;attribute is to<br/>be protected from unauthorized access.<br/>
&#160;29. &#160; &#160;# BDB definition for example.com<br/>
&#160;30. &#160; &#160;dn: olcDatabase=bdb,cn=config<br/>
&#160;31. &#160; &#160;objectClass: olcDatabaseConfig<br/>
&#160;32. &#160; &#160;objectClass: olcBdbConfig<br/>
&#160;33. &#160; &#160;olcDatabase: bdb<br/>
39<br/>
<hr/>
<a name=54></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
&#160;34. &#160; &#160;olcSuffix: dc=example,dc=com<br/>
&#160;35. &#160; &#160;olcDbDirectory: /usr/local/var/openldap-data<br/>
&#160;36. &#160; &#160;olcRootDN: cn=Manager,dc=example,dc=com<br/>
&#160;37. &#160; &#160;olcRootPW: secret<br/>
&#160;38. &#160; &#160;olcDbIndex: uid pres,eq<br/>
&#160;39. &#160; &#160;olcDbIndex: cn,sn pres,eq,approx,sub<br/>
&#160;40. &#160; &#160;olcDbIndex: objectClass eq<br/>
&#160;41. &#160; &#160;olcAccess: to attrs=userPassword<br/>
&#160;42. &#160; &#160; &#160;by self write<br/>
&#160;43. &#160; &#160; &#160;by anonymous auth<br/>
&#160;44. &#160; &#160; &#160;by dn.base=&#34;cn=Admin,dc=example,dc=com&#34; write<br/>
&#160;45. &#160; &#160; &#160;by * none<br/>
&#160;46. &#160; &#160;olcAccess: to *<br/>
&#160;47. &#160; &#160; &#160;by self write<br/>
&#160;48. &#160; &#160; &#160;by dn.base=&#34;cn=Admin,dc=example,dc=com&#34; write<br/>
&#160;49. &#160; &#160; &#160;by * read<br/>
&#160;50.<br/>
Line 29 is a comment. Lines 30-33 identify this entry as a BDB database configuration entry. Line 34<br/>specifies the DN suffix for queries to pass to this database. Line 35 specifies the directory in which the<br/>database files will live.<br/>
Lines 36 and 37 identify the database<i>&#160;super-user</i>&#160;entry and associated password. This entry is not subject to<br/>access control or size or time limit restrictions.<br/>
Lines 38 through 40 indicate the indices to maintain for various attributes.<br/>
Lines 41 through 49 specify access control for entries in this database. For all applicable entries, the<br/>userPassword&#160;attribute is writable by the entry itself and by the &#34;admin&#34; entry. It may be used for<br/>authentication/authorization purposes, but is otherwise not readable. All other attributes are writable by the<br/>entry and the &#34;admin&#34; entry, but may be read by all users (authenticated or not).<br/>
Line 50 is a blank line, indicating the end of this entry.<br/>
The next entry defines another BDB database. This one handles queries involving the<br/>dc=example,dc=net&#160;subtree but is managed by the same entity as the first database. Note that without<br/>line 60, the read access would be allowed due to the global access rule at line 19.<br/>
&#160;51. &#160; &#160;# BDB definition for example.net<br/>
&#160;52. &#160; &#160;dn: olcDatabase=bdb,cn=config<br/>
&#160;53. &#160; &#160;objectClass: olcDatabaseConfig<br/>
&#160;54. &#160; &#160;objectClass: olcBdbConfig<br/>
&#160;55. &#160; &#160;olcDatabase: bdb<br/>
&#160;56. &#160; &#160;olcSuffix: &#34;dc=example,dc=net&#34;<br/>
&#160;57. &#160; &#160;olcDbDirectory: /usr/local/var/openldap-data-net<br/>
&#160;58. &#160; &#160;olcRootDN: &#34;cn=Manager,dc=example,dc=com&#34;<br/>
&#160;59. &#160; &#160;olcDbIndex: objectClass eq<br/>
&#160;60. &#160; &#160;olcAccess: to * by users read<br/>
<b>5.4. Converting old style<i>&#160;slapd.conf</i></b><b>(5) file to<i>&#160;cn=config</i></b><b>&#160;format</b><br/>
Before converting to the<i>&#160;cn=config</i>&#160;format you should make sure that the config backend is properly<br/>configured in your existing config file. While the config backend is always present inside slapd, by default it<br/>is only accessible by its rootDN, and there are no default credentials assigned so unless you explicitly<br/>configure a means to authenticate to it, it will be unusable.<br/>
40<br/>
<hr/>
<a name=55></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
If you do not already have a&#160;database config&#160;section, add something like this to the end of<br/>slapd.conf<br/>
&#160;database config<br/>
&#160;rootpw VerySecret<br/>
<b>Note:</b>&#160;Since the config backend can be used to load arbitrary code into the slapd process, it is extremely<br/>important to carefully guard whatever credentials are used to access it. Since simple passwords are vulnerable<br/>to password guessing attacks, it is usually better to omit the rootpw and only use SASL authentication for the<br/>config rootDN.<br/>
An existing<i>&#160;slapd.conf</i>(5) file can be converted to the new format using<i>&#160;slaptest</i>(8) or any of the slap tools:<br/>
&#160; &#160; &#160; &#160; slaptest -f /usr/local/etc/openldap/slapd.conf -F /usr/local/etc/openldap/slapd.d<br/>
Test that you can access entries under&#160;cn=config&#160;using the default<i>&#160;rootdn</i>&#160;and the<i>&#160;rootpw</i>&#160;configured<br/>above:<br/>
&#160; &#160; &#160; &#160; ldapsearch -x -D cn=config -w VerySecret -b cn=config<br/>
You can then discard the old<i>&#160;slapd.conf</i>(5) file. Make sure to launch<i>&#160;slapd</i>(8) with the<i>&#160;-F</i>&#160;option to specify the<br/>configuration directory if you are not using the default directory path.<br/>
<b>Note:</b>&#160;When converting from the slapd.conf format to slapd.d format, any included files will also be integrated<br/>into the resulting configuration database.<br/>
41<br/>
<hr/>
<a name=56></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
42<br/>
<hr/>
<a name=57></a><b>6. The slapd Configuration File</b><br/>
This chapter describes configuring<i>&#160;slapd</i>(8) via the<i>&#160;slapd.conf</i>(5) configuration file.<i>&#160;slapd.conf</i>(5) has been<br/>deprecated and should only be used if your site requires one of the backends that hasn't yet been updated to<br/>work with the newer<i>&#160;slapd-config</i>(5) system. Configuring<i>&#160;slapd</i>(8) via<i>&#160;slapd-config</i>(5) is described in the<br/>previous chapter.<br/>
The<i>&#160;slapd.conf</i>(5) file is normally installed in the&#160;/usr/local/etc/openldap&#160;directory. An alternate<br/>configuration file location can be specified via a command-line option to<i>&#160;slapd</i>(8).<br/>
<b>6.1. Configuration File Format</b><br/>
The<i>&#160;slapd.conf</i>(5) file consists of three types of configuration information: global, backend specific, and<br/>database specific. Global information is specified first, followed by information associated with a particular<br/>backend type, which is then followed by information associated with a particular database instance. Global<br/>directives can be overridden in backend and/or database directives, and backend directives can be overridden<br/>by database directives.<br/>
Blank lines and comment lines beginning with a '#' character are ignored. If a line begins with whitespace, it<br/>is considered a continuation of the previous line (even if the previous line is a comment).<br/>
The general format of slapd.conf is as follows:<br/>
&#160; &#160; &#160; &#160; # global configuration directives<br/>
&#160; &#160; &#160; &#160; &lt;global config directives&gt;<br/>
&#160; &#160; &#160; &#160; # backend definition<br/>
&#160; &#160; &#160; &#160; backend &lt;typeA&gt;<br/>
&#160; &#160; &#160; &#160; &lt;backend-specific directives&gt;<br/>
&#160; &#160; &#160; &#160; # first database definition &amp; config directives<br/>
&#160; &#160; &#160; &#160; database &lt;typeA&gt;<br/>
&#160; &#160; &#160; &#160; &lt;database-specific directives&gt;<br/>
&#160; &#160; &#160; &#160; # second database definition &amp; config directives<br/>
&#160; &#160; &#160; &#160; database &lt;typeB&gt;<br/>
&#160; &#160; &#160; &#160; &lt;database-specific directives&gt;<br/>
&#160; &#160; &#160; &#160; # second database definition &amp; config directives<br/>
&#160; &#160; &#160; &#160; database &lt;typeA&gt;<br/>
&#160; &#160; &#160; &#160; &lt;database-specific directives&gt;<br/>
&#160; &#160; &#160; &#160; # subsequent backend &amp; database definitions &amp; config directives<br/>
&#160; &#160; &#160; &#160; ...<br/>
A configuration directive may take arguments. If so, they are separated by whitespace. If an argument<br/>contains whitespace, the argument should be enclosed in double quotes&#160;&#34;like this&#34;. If an argument<br/>contains a double quote or a backslash character `\', the character should be preceded by a backslash character<br/>`\'.<br/>
The distribution contains an example configuration file that will be installed in the<br/>/usr/local/etc/openldap&#160;directory. A number of files containing schema definitions (attribute types<br/>and object classes) are also provided in the&#160;/usr/local/etc/openldap/schema&#160;directory.<br/>
43<br/>
<hr/>
<a name=58></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
<b>6.2. Configuration File Directives</b><br/>
This section details commonly used configuration directives. For a complete list, see the<i>&#160;slapd.conf</i>(5) manual<br/>page. This section separates the configuration file directives into global, backend-specific and data-specific<br/>categories, describing each directive and its default value (if any), and giving an example of its use.<br/>
<b>6.2.1. Global Directives</b><br/>
Directives described in this section apply to all backends and databases unless specifically overridden in a<br/>backend or database definition. Arguments that should be replaced by actual text are shown in brackets&#160;&lt;&gt;.<br/>
<b>6.2.1.1. access to &lt;what&gt; [ by &lt;who&gt; [&lt;accesslevel&gt;] [&lt;control&gt;] ]+</b><br/>
This directive grants access (specified by &lt;accesslevel&gt;) to a set of entries and/or attributes (specified by<br/><a href="OpenLDAP-Admin-Guides.html#71">&lt;what&gt;) by one or more requestors (specified by &lt;who&gt;). See the Access Control section of this guide for<br/></a>basic usage.<br/>
<b>Note:</b>&#160;If no&#160;access&#160;directives are specified, the default access control policy,&#160;access to * by *<br/>read, allows all both authenticated and anonymous users read access.<br/>
<a href="http://www.rfc-editor.org/rfc/rfc4512.txt"><b>6.2.1.2. attributetype &lt;RFC4512 Attribute Type Description&gt;</b></a><br/>
<a href="OpenLDAP-Admin-Guides.html#141">This directive defines an attribute type. Please see the Schema Specification chapter for information regarding<br/></a>how to use this directive.<br/>
<b>6.2.1.3. idletimeout &lt;integer&gt;</b><br/>
Specify the number of seconds to wait before forcibly closing an idle client connection. An idletimeout of 0,<br/>the default, disables this feature.<br/>
<b>6.2.1.4. include &lt;filename&gt;</b><br/>
This directive specifies that slapd should read additional configuration information from the given file before<br/>continuing with the next line of the current file. The included file should follow the normal slapd config file<br/>format. The file is commonly used to include files containing schema specifications.<br/>
<b>Note:</b>&#160;You should be careful when using this directive - there is no small limit on the number of nested<br/>include directives, and no loop detection is done.<br/>
<b>6.2.1.5. loglevel &lt;level&gt;</b><br/>
This directive specifies the level at which debugging statements and operation statistics should be syslogged<br/>(currently logged to the<i>&#160;syslogd</i>(8)&#160;LOG_LOCAL4&#160;facility). You must have configured OpenLDAP<br/>--enable-debug&#160;(the default) for this to work (except for the two statistics levels, which are always<br/>enabled). Log levels may be specified as integers or by keyword. Multiple log levels may be used and the<br/>levels are additive. To display what numbers correspond to what kind of debugging, invoke slapd with&#160;-d?&#160;or<br/>consult the table below. The possible values for &lt;integer&gt; are:<br/>
Table 6.1: Debugging Levels<br/>
44<br/>
<hr/>
<a name=59></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
<b>Level&#160;Keyword</b><br/>
<b>Description</b><br/>
-1&#160;any<br/>
enable all debugging<br/>
0<br/>
no debugging<br/>
1&#160;(0x1 trace)<br/>
trace function calls<br/>
2&#160;(0x2 packets)<br/>
debug packet handling<br/>
4&#160;(0x4 args)<br/>
heavy trace debugging<br/>
8&#160;(0x8 conns)<br/>
connection management<br/>
16&#160;(0x10 BER)<br/>
print out packets sent and received<br/>
32&#160;(0x20 filter)<br/>
search filter processing<br/>
64&#160;(0x40 config)<br/>
configuration processing<br/>
128&#160;(0x80 ACL)<br/>
access control list processing<br/>
256&#160;(0x100 stats)<br/>
stats log connections/operations/results<br/>
512&#160;(0x200 stats2)&#160;stats log entries sent<br/>
1024&#160;(0x400 shell)<br/>
print communication with shell backends<br/>
2048&#160;(0x800 parse)<br/>
print entry parsing debugging<br/>
16384&#160;(0x4000 sync)&#160;syncrepl consumer processing<br/>
32768&#160;(0x8000 none)&#160;only messages that get logged whatever log level is set<br/>
The desired log level can be input as a single integer that combines the (ORed) desired levels, both in decimal<br/>or in hexadecimal notation, as a list of integers (that are ORed internally), or as a list of the names that are<br/>shown between brackets, such that<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; loglevel 129<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; loglevel 0x81<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; loglevel 128 1<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; loglevel 0x80 0x1<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; loglevel acl trace<br/>
are equivalent.<br/>
Examples:<br/>
&#160;loglevel -1<br/>
This will cause lots and lots of debugging information to be logged.<br/>
&#160;loglevel conns filter<br/>
Just log the connection and search filter processing.<br/>
&#160;loglevel none<br/>
Log those messages that are logged regardless of the configured loglevel. This differs from setting the log<br/>level to 0, when no logging occurs. At least the&#160;None&#160;level is required to have high priority messages logged.<br/>
Default:<br/>
&#160;loglevel stats<br/>
45<br/>
<hr/>
<a name=60></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
Basic stats logging is configured by default. However, if no loglevel is defined, no logging occurs (equivalent<br/>to a 0 level).<br/>
<a href="http://www.rfc-editor.org/rfc/rfc4512.txt"><b>6.2.1.6. objectclass &lt;RFC4512 Object Class Description&gt;</b></a><br/>
<a href="OpenLDAP-Admin-Guides.html#141">This directive defines an object class. Please see the Schema Specification chapter for information regarding<br/></a>how to use this directive.<br/>
<b>6.2.1.7. referral &lt;URI&gt;</b><br/>
This directive specifies the referral to pass back when slapd cannot find a local database to handle a request.<br/>
Example:<br/>
&#160; &#160; &#160; &#160; referral ldap://root.openldap.org<br/>
This will refer non-local queries to the global root LDAP server at the OpenLDAP Project. Smart LDAP<br/>clients can re-ask their query at that server, but note that most of these clients are only going to know how to<br/>handle simple LDAP URLs that contain a host part and optionally a distinguished name part.<br/>
<b>6.2.1.8. sizelimit &lt;integer&gt;</b><br/>
This directive specifies the maximum number of entries to return from a search operation.<br/>
Default:<br/>
&#160; &#160; &#160; &#160; sizelimit 500<br/>
<a href="OpenLDAP-Admin-Guides.html#93">See the Limits section of this guide and slapd.conf(5) for more details.</a><br/>
<b>6.2.1.9. timelimit &lt;integer&gt;</b><br/>
This directive specifies the maximum number of seconds (in real time) slapd will spend answering a search<br/>request. If a request is not finished in this time, a result indicating an exceeded timelimit will be returned.<br/>
Default:<br/>
&#160; &#160; &#160; &#160; timelimit 3600<br/>
<a href="OpenLDAP-Admin-Guides.html#93">See the Limits section of this guide and slapd.conf(5) for more details.</a><br/>
<b>6.2.2. General Backend Directives</b><br/>
Directives in this section apply only to the backend in which they are defined. They are supported by every<br/>type of backend. Backend directives apply to all databases instances of the same type and, depending on the<br/>directive, may be overridden by database directives.<br/>
<b>6.2.2.1. backend &lt;type&gt;</b><br/>
This directive marks the beginning of a backend declaration.&#160;&lt;type&gt;&#160;should be one of the supported backend<br/>types listed in Table 6.2.<br/>
46<br/>
<hr/>
<a name=61></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
Table 6.2: Database Backends<br/>
<b>Types</b><br/>
<b>Description</b><br/>
bdb<br/>
Berkeley DB transactional backend<br/>
dnssrv<br/>
DNS SRV backend<br/>
hdb<br/>
Hierarchical variant of bdb backend<br/>
ldap<br/>
Lightweight Directory Access Protocol (Proxy) backend<br/>
meta<br/>
Meta Directory backend<br/>
monitor&#160;Monitor backend<br/>
passwd<br/>
Provides read-only access to<i>&#160;passwd</i>(5)<br/>
perl<br/>
Perl Programmable backend<br/>
shell<br/>
Shell (extern program) backend<br/>
sql<br/>
SQL Programmable backend<br/>
Example:<br/>
&#160; &#160; &#160; &#160; backend bdb<br/>
This marks the beginning of a new BDB backend definition.<br/>
<b>6.2.3. General Database Directives</b><br/>
Directives in this section apply only to the database in which they are defined. They are supported by every<br/>type of database.<br/>
<b>6.2.3.1. database &lt;type&gt;</b><br/>
This directive marks the beginning of a database instance declaration.&#160;&lt;type&gt;&#160;should be one of the<br/>supported backend types listed in Table 6.2.<br/>
Example:<br/>
&#160; &#160; &#160; &#160; database bdb<br/>
This marks the beginning of a new BDB database instance declaration.<br/>
<b>6.2.3.2. limits &lt;who&gt; &lt;limit&gt; [&lt;limit&gt; [...]]</b><br/>
Specify time and size limits based on who initiated an operation.<br/>
<a href="OpenLDAP-Admin-Guides.html#93">See the Limits section of this guide and slapd.conf(5) for more details.</a><br/>
<b>6.2.3.3. readonly { on | off }</b><br/>
This directive puts the database into &#34;read-only&#34; mode. Any attempts to modify the database will return an<br/>&#34;unwilling to perform&#34; error.<br/>
Default:<br/>
&#160; &#160; &#160; &#160; readonly off<br/>
47<br/>
<hr/>
<a name=62></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
<b>6.2.3.4. rootdn &lt;DN&gt;</b><br/>
This directive specifies the DN that is not subject to access control or administrative limit restrictions for<br/>operations on this database. The DN need not refer to an entry in this database or even in the directory. The<br/>DN may refer to a SASL identity.<br/>
Entry-based Example:<br/>
&#160; &#160; &#160; &#160; rootdn &#34;cn=Manager,dc=example,dc=com&#34;<br/>
SASL-based Example:<br/>
&#160; &#160; &#160; &#160; rootdn &#34;uid=root,cn=example.com,cn=digest-md5,cn=auth&#34;<br/>
<a href="OpenLDAP-Admin-Guides.html#158">See the SASL Authentication section for information on SASL authentication identities.</a><br/>
<b>6.2.3.5. rootpw &lt;password&gt;</b><br/>
This directive can be used to specifies a password for the DN for the rootdn (when the rootdn is set to a DN<br/>within the database).<br/>
Example:<br/>
&#160; &#160; &#160; &#160; rootpw secret<br/>
<a href="http://www.rfc-editor.org/rfc/rfc2307.txt">It is also permissible to provide hash of the password in RFC2307 form.</a><i>&#160;slappasswd</i>(8) may be used to<br/>generate the password hash.<br/>
Example:<br/>
&#160; &#160; &#160; &#160; rootpw {SSHA}ZKKuqbEKJfKSXhUbHG3fG8MDn9j1v4QN<br/>
The hash was generated using the command&#160;slappasswd -s secret.<br/>
<b>6.2.3.6. suffix &lt;dn suffix&gt;</b><br/>
This directive specifies the DN suffix of queries that will be passed to this backend database. Multiple suffix<br/>lines can be given, and at least one is required for each database definition.<br/>
Example:<br/>
&#160; &#160; &#160; &#160; suffix &#34;dc=example,dc=com&#34;<br/>
Queries with a DN ending in &#34;dc=example,dc=com&#34; will be passed to this backend.<br/>
<b>Note:</b>&#160;When the backend to pass a query to is selected, slapd looks at the suffix line(s) in each database<br/>definition in the order they appear in the file. Thus, if one database suffix is a prefix of another, it must appear<br/>after it in the config file.<br/>
48<br/>
<hr/>
<a name=63></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
<b>6.2.3.7. syncrepl</b><br/>
&#160; &#160; &#160; &#160; syncrepl rid=&lt;replica ID&gt;<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; provider=ldap[s]://&lt;hostname&gt;[:port]<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; [type=refreshOnly|refreshAndPersist]<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; [interval=dd:hh:mm:ss]<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; [retry=[&lt;retry interval&gt; &lt;# of retries&gt;]+]<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; searchbase=&lt;base DN&gt;<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; [filter=&lt;filter str&gt;]<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; [scope=sub|one|base]<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; [attrs=&lt;attr list&gt;]<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; [attrsonly]<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; [sizelimit=&lt;limit&gt;]<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; [timelimit=&lt;limit&gt;]<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; [schemachecking=on|off]<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; [bindmethod=simple|sasl]<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; [binddn=&lt;DN&gt;]<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; [saslmech=&lt;mech&gt;]<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; [authcid=&lt;identity&gt;]<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; [authzid=&lt;identity&gt;]<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; [credentials=&lt;passwd&gt;]<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; [realm=&lt;realm&gt;]<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; [secprops=&lt;properties&gt;]<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; [starttls=yes|critical]<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; [tls_cert=&lt;file&gt;]<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; [tls_key=&lt;file&gt;]<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; [tls_cacert=&lt;file&gt;]<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; [tls_cacertdir=&lt;path&gt;]<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; [tls_reqcert=never|allow|try|demand]<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; [tls_ciphersuite=&lt;ciphers&gt;]<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; [tls_crlcheck=none|peer|all]<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; [logbase=&lt;base DN&gt;]<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; [logfilter=&lt;filter str&gt;]<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; [syncdata=default|accesslog|changelog]<br/>
This directive specifies the current database as a replica of the master content by establishing the current<br/><i>slapd</i>(8) as a replication consumer site running a syncrepl replication engine. The master database is located at<br/>the replication provider site specified by the&#160;provider&#160;parameter. The replica database is kept up-to-date<br/><a href="http://www.rfc-editor.org/rfc/rfc4533.txt">with the master content using the LDAP Content Synchronization protocol. See RFC4533 for more<br/></a>information on the protocol.<br/>
The&#160;rid&#160;parameter is used for identification of the current&#160;syncrepl&#160;directive within the replication<br/>consumer server, where&#160;&lt;replica ID&gt;&#160;uniquely identifies the syncrepl specification described by the<br/>current&#160;syncrepl&#160;directive.&#160;&lt;replica ID&gt;&#160;is non-negative and is no more than three decimal digits in<br/>length.<br/>
The&#160;provider&#160;parameter specifies the replication provider site containing the master content as an LDAP<br/>URI. The&#160;provider&#160;parameter specifies a scheme, a host and optionally a port where the provider slapd<br/>instance can be found. Either a domain name or IP address may be used for &lt;hostname&gt;. Examples are<br/>ldap://provider.example.com:389&#160;or&#160;ldaps://192.168.1.1:636. If &lt;port&gt; is not given,<br/>the standard LDAP port number (389 or 636) is used. Note that the syncrepl uses a consumer-initiated<br/>protocol, and hence its specification is located at the consumer site, whereas the&#160;replica&#160;specification is<br/>located at the provider site.&#160;syncrepl&#160;and&#160;replica&#160;directives define two independent replication<br/>mechanisms. They do not represent the replication peers of each other.<br/>
49<br/>
<hr/>
<a name=64></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
The content of the syncrepl replica is defined using a search specification as its result set. The consumer slapd<br/>will send search requests to the provider slapd according to the search specification. The search specification<br/>includes&#160;searchbase,&#160;scope,&#160;filter,&#160;attrs,&#160;attrsonly,&#160;sizelimit, and&#160;timelimit<br/>parameters as in the normal search specification. The&#160;searchbase&#160;parameter has no default value and must<br/>always be specified. The&#160;scope&#160;defaults to&#160;sub, the&#160;filter&#160;defaults to&#160;(objectclass=*),&#160;attrs<br/>defaults to&#160;&#34;*,+&#34;&#160;to replicate all user and operational attributes, and&#160;attrsonly&#160;is unset by default. Both<br/>sizelimit&#160;and&#160;timelimit&#160;default to &#34;unlimited&#34;, and only positive integers or &#34;unlimited&#34; may be<br/>specified.<br/>
The LDAP Content Synchronization protocol has two operation types:&#160;refreshOnly&#160;and<br/>refreshAndPersist. The operation type is specified by the&#160;type&#160;parameter. In the&#160;refreshOnly<br/>operation, the next synchronization search operation is periodically rescheduled at an interval time after each<br/>synchronization operation finishes. The interval is specified by the&#160;interval&#160;parameter. It is set to one day<br/>by default. In the&#160;refreshAndPersist&#160;operation, a synchronization search remains persistent in the<br/>provider<i>&#160;slapd</i>&#160;instance. Further updates to the master replica will generate&#160;searchResultEntry&#160;to the<br/>consumer slapd as the search responses to the persistent synchronization search.<br/>
If an error occurs during replication, the consumer will attempt to reconnect according to the retry parameter<br/>which is a list of the &lt;retry interval&gt; and &lt;# of retries&gt; pairs. For example, retry=&#34;60 10 300 3&#34; lets the<br/>consumer retry every 60 seconds for the first 10 times and then retry every 300 seconds for the next three<br/>times before stop retrying. + in &lt;# of retries&gt; means indefinite number of retries until success.<br/>
The schema checking can be enforced at the LDAP Sync consumer site by turning on the<br/>schemachecking&#160;parameter. If it is turned on, every replicated entry will be checked for its schema as the<br/>entry is stored into the replica content. Every entry in the replica should contain those attributes required by<br/>the schema definition. If it is turned off, entries will be stored without checking schema conformance. The<br/>default is off.<br/>
The&#160;binddn&#160;parameter gives the DN to bind as for the syncrepl searches to the provider slapd. It should be a<br/>DN which has read access to the replication content in the master database.<br/>
The&#160;bindmethod&#160;is&#160;simple&#160;or&#160;sasl, depending on whether simple password-based authentication or<br/>SASL authentication is to be used when connecting to the provider<i>&#160;slapd</i>&#160;instance.<br/>
Simple authentication should not be used unless adequate data integrity and confidentiality protections are in<br/>place (e.g. TLS or IPsec). Simple authentication requires specification of&#160;binddn&#160;and&#160;credentials<br/>parameters.<br/>
SASL authentication is generally recommended. SASL authentication requires specification of a mechanism<br/>using the&#160;saslmech&#160;parameter. Depending on the mechanism, an authentication identity and/or credentials<br/>can be specified using&#160;authcid&#160;and&#160;credentials, respectively. The&#160;authzid&#160;parameter may be used to<br/>specify an authorization identity.<br/>
The&#160;realm&#160;parameter specifies a realm which a certain mechanisms authenticate the identity within. The<br/>secprops&#160;parameter specifies Cyrus SASL security properties.<br/>
The&#160;starttls&#160;parameter specifies use of the StartTLS extended operation to establish a TLS session before<br/>authenticating to the provider. If the&#160;critical&#160;argument is supplied, the session will be aborted if the<br/>StartTLS request fails. Otherwise the syncrepl session continues without TLS. Note that the main slapd TLS<br/>settings are not used by the syncrepl engine; by default the TLS parameters from a<i>&#160;ldap.conf</i>(5) configuration<br/>file will be used. TLS settings may be specified here, in which case any<i>&#160;ldap.conf</i>(5) settings will be<br/>
50<br/>
<hr/>
<a name=65></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
completely ignored.<br/>
Rather than replicating whole entries, the consumer can query logs of data modifications. This mode of<br/>operation is referred to as<i>&#160;delta syncrepl</i>. In addition to the above parameters, the&#160;logbase&#160;and&#160;logfilter<br/>parameters must be set appropriately for the log that will be used. The&#160;syncdata&#160;parameter must be set to<br/>either&#160;&#34;accesslog&#34;&#160;if the log conforms to the<i>&#160;slapo-accesslog</i>(5) log format, or&#160;&#34;changelog&#34;&#160;if the log<br/>conforms to the obsolete<i>&#160;changelog</i>&#160;format. If the&#160;syncdata&#160;parameter is omitted or set to&#160;&#34;default&#34;<br/>then the log parameters are ignored.<br/>
The<i>&#160;syncrepl</i>&#160;replication mechanism is supported by the<i>&#160;bdb</i>&#160;and<i>&#160;hdb</i>&#160;backends.<br/>
<a href="OpenLDAP-Admin-Guides.html#177">See the LDAP Sync Replication chapter of this guide for more information on how to use this directive.</a><br/>
<b>6.2.3.8. updateref &lt;URL&gt;</b><br/>
This directive is only applicable in a<i>&#160;slave</i>&#160;(or<i>&#160;shadow</i>)<i>&#160;slapd</i>(8) instance. It specifies the URL to return to<br/>clients which submit update requests upon the replica. If specified multiple times, each URL is provided.<br/>
Example:<br/>
&#160; &#160; &#160; &#160; updateref &#160; &#160; &#160; ldap://master.example.net<br/>
<b>6.2.4. BDB and HDB Database Directives</b><br/>
Directives in this category only apply to both the BDB and the HDB database. That is, they must follow a<br/>&#34;database bdb&#34; or &#34;database hdb&#34; line and come before any subsequent &#34;backend&#34; or &#34;database&#34; line. For a<br/>complete reference of BDB/HDB configuration directives, see<i>&#160;slapd-bdb</i>(5).<br/>
<b>6.2.4.1. directory &lt;directory&gt;</b><br/>
This directive specifies the directory where the BDB files containing the database and associated indices live.<br/>
Default:<br/>
&#160; &#160; &#160; &#160; directory /usr/local/var/openldap-data<br/>
<b>6.3. Configuration File Example</b><br/>
The following is an example configuration file, interspersed with explanatory text. It defines two databases to<br/>handle different parts of the X.500 tree; both are BDB database instances. The line numbers shown are<br/>provided for reference only and are not included in the actual file. First, the global configuration section:<br/>
&#160; 1. &#160; &#160;# example config file - global configuration section<br/>
&#160; 2. &#160; &#160;include /usr/local/etc/schema/core.schema<br/>
&#160; 3. &#160; &#160;referral ldap://root.openldap.org<br/>
&#160; 4. &#160; &#160;access to * by * read<br/>
Line 1 is a comment. Line 2 includes another config file which contains<i>&#160;core</i>&#160;schema definitions. The<br/>referral&#160;directive on line 3 means that queries not local to one of the databases defined below will be<br/>referred to the LDAP server running on the standard port (389) at the host&#160;root.openldap.org.<br/>
51<br/>
<hr/>
<a name=66></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
Line 4 is a global access control. It applies to all entries (after any applicable database-specific access<br/>controls).<br/>
The next section of the configuration file defines a BDB backend that will handle queries for things in the<br/>&#34;dc=example,dc=com&#34; portion of the tree. The database is to be replicated to two slave slapds, one on truelies,<br/>the other on judgmentday. Indices are to be maintained for several attributes, and the&#160;userPassword<br/>attribute is to be protected from unauthorized access.<br/>
&#160; 5. &#160; &#160;# BDB definition for the example.com<br/>
&#160; 6. &#160; &#160;database bdb<br/>
&#160; 7. &#160; &#160;suffix &#34;dc=example,dc=com&#34;<br/>
&#160; 8. &#160; &#160;directory /usr/local/var/openldap-data<br/>
&#160; 9. &#160; &#160;rootdn &#34;cn=Manager,dc=example,dc=com&#34;<br/>
&#160;10. &#160; &#160;rootpw secret<br/>
&#160;11. &#160; &#160;# indexed attribute definitions<br/>
&#160;12. &#160; &#160;index uid pres,eq<br/>
&#160;13. &#160; &#160;index cn,sn pres,eq,approx,sub<br/>
&#160;14. &#160; &#160;index objectClass eq<br/>
&#160;15. &#160; &#160;# database access control definitions<br/>
&#160;16. &#160; &#160;access to attrs=userPassword<br/>
&#160;17. &#160; &#160; &#160; &#160;by self write<br/>
&#160;18. &#160; &#160; &#160; &#160;by anonymous auth<br/>
&#160;19. &#160; &#160; &#160; &#160;by dn.base=&#34;cn=Admin,dc=example,dc=com&#34; write<br/>
&#160;20. &#160; &#160; &#160; &#160;by * none<br/>
&#160;21. &#160; &#160;access to *<br/>
&#160;22. &#160; &#160; &#160; &#160;by self write<br/>
&#160;23. &#160; &#160; &#160; &#160;by dn.base=&#34;cn=Admin,dc=example,dc=com&#34; write<br/>
&#160;24. &#160; &#160; &#160; &#160;by * read<br/>
Line 5 is a comment. The start of the database definition is marked by the database keyword on line 6. Line 7<br/>specifies the DN suffix for queries to pass to this database. Line 8 specifies the directory in which the database<br/>files will live.<br/>
Lines 9 and 10 identify the database<i>&#160;super-user</i>&#160;entry and associated password. This entry is not subject to<br/>access control or size or time limit restrictions.<br/>
Lines 12 through 14 indicate the indices to maintain for various attributes.<br/>
Lines 16 through 24 specify access control for entries in this database. For all applicable entries, the<br/>userPassword&#160;attribute is writable by the entry itself and by the &#34;admin&#34; entry. It may be used for<br/>authentication/authorization purposes, but is otherwise not readable. All other attributes are writable by the<br/>entry and the &#34;admin&#34; entry, but may be read by all users (authenticated or not).<br/>
The next section of the example configuration file defines another BDB database. This one handles queries<br/>involving the&#160;dc=example,dc=net&#160;subtree but is managed by the same entity as the first database. Note<br/>that without line 39, the read access would be allowed due to the global access rule at line 4.<br/>
&#160;33. &#160; &#160;# BDB definition for example.net<br/>
&#160;34. &#160; &#160;database bdb<br/>
&#160;35. &#160; &#160;suffix &#34;dc=example,dc=net&#34;<br/>
&#160;36. &#160; &#160;directory /usr/local/var/openldap-data-net<br/>
&#160;37. &#160; &#160;rootdn &#34;cn=Manager,dc=example,dc=com&#34;<br/>
&#160;38. &#160; &#160;index objectClass eq<br/>
&#160;39. &#160; &#160;access to * by users read<br/>
52<br/>
<hr/>
<a name=67></a><b>7. Running slapd</b><br/>
<i>slapd</i>(8) is designed to be run as a standalone service. This allows the server to take advantage of caching,<br/>manage concurrency issues with underlying databases, and conserve system resources. Running from<i>&#160;inetd</i>(8)<br/>is<i>&#160;NOT</i>&#160;an option.<br/>
<b>7.1. Command-Line Options</b><br/>
<i>slapd</i>(8) supports a number of command-line options as detailed in the manual page. This section details a few<br/>commonly used options.<br/>
&#160; &#160; &#160; &#160; -f &lt;filename&gt;<br/>
This option specifies an alternate configuration file for slapd. The default is normally<br/>/usr/local/etc/openldap/slapd.conf.<br/>
&#160; &#160; &#160; &#160; -F &lt;slapd-config-directory&gt;<br/>
Specifies the slapd configuration directory. The default is&#160;/usr/local/etc/openldap/slapd.d.<br/>
If both&#160;-f&#160;and&#160;-F&#160;are specified, the config file will be read and converted to config directory format and<br/>written to the specified directory. If neither option is specified, slapd will attempt to read the default config<br/>directory before trying to use the default config file. If a valid config directory exists then the default config<br/>file is ignored. All of the slap tools that use the config options observe this same behavior.<br/>
&#160; &#160; &#160; &#160; -h &lt;URLs&gt;<br/>
This option specifies alternative listener configurations. The default is&#160;ldap:///&#160;which implies LDAP over<br/>TCP on all interfaces on the default LDAP port 389. You can specify specific host-port pairs or other protocol<br/>schemes (such as&#160;ldaps://&#160;or&#160;ldapi://).<br/>
<b>URL</b><br/>
<b>Protocol</b><br/>
<b>Transport</b><br/>
ldap:///<br/>
LDAP<br/>
TCP port 389<br/>
ldaps:///&#160;LDAP over SSL&#160;TCP port 636<br/>
ldapi:///&#160;LDAP<br/>
IPC (Unix-domain socket)<br/>
For example,&#160;-h &#34;ldaps:// ldap://127.0.0.1:666&#34;&#160;will create two listeners: one for the<br/>(non-standard)&#160;ldaps://&#160;scheme on all interfaces on the default&#160;ldaps://&#160;port 636, and one for the<br/>standard&#160;ldap://&#160;scheme on the&#160;localhost&#160;(<i>loopback</i>) interface on port 666. Hosts may be specified<br/>using using hostnames or IPv4 or IPv6 addresses. Port values must be numeric.<br/>
For LDAP over IPC, the pathname of the Unix-domain socket can be encoded in the URL. Note that directory<br/>separators must be URL-encoded, like any other characters that are special to URLs. Thus the socket<br/>/usr/local/var/ldapi&#160;must be encoded as<br/>
&#160; &#160; &#160; &#160; ldapi://%2Fusr%2Flocal%2Fvar%2Fldapi<br/>
ldapi: is described in detail in<i>&#160;Using LDAP Over IPC Mechanisms</i><a href="http://tools.ietf.org/html/draft-chu-ldap-ldapi-00">&#160;[Chu-LDAPI]</a><br/>
Note that the ldapi:/// transport is not widely implemented: non-OpenLDAP clients may not be able to use it.<br/>
53<br/>
<hr/>
<a name=68></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
&#160; &#160; &#160; &#160; -n &lt;service-name&gt;<br/>
This option specifies the service name used for logging and other purposes. The default service name is<br/>slapd.<br/>
&#160; &#160; &#160; &#160; -l &lt;syslog-local-user&gt;<br/>
This option specifies the local user for the<i>&#160;syslog</i>(8) facility. Values can be&#160;LOCAL0,&#160;LOCAL1,&#160;LOCAL2, ...,<br/>and&#160;LOCAL7. The default is&#160;LOCAL4. This option may not be supported on all systems.<br/>
&#160; &#160; &#160; &#160; -u user -g group<br/>
These options specify the user and group, respectively, to run as.&#160;user&#160;can be either a user name or uid.<br/>group&#160;can be either a group name or gid.<br/>
&#160; &#160; &#160; &#160; -r directory<br/>
This option specifies a run-time directory. slapd will<i>&#160;chroot</i>(2) to this directory after opening listeners but<br/>before reading any configuration files or initializing any backends.<br/>
&#160; &#160; &#160; &#160; -d &lt;level&gt; | ?<br/>
This option sets the slapd debug level to &lt;level&gt;. When level is a `?' character, the various debugging levels<br/>are printed and slapd exits, regardless of any other options you give it. Current debugging levels are<br/>
Table 7.1: Debugging Levels<br/>
<b>Level&#160;Keyword</b><br/>
<b>Description</b><br/>
-1&#160;any<br/>
enable all debugging<br/>
0<br/>
no debugging<br/>
1&#160;(0x1 trace)<br/>
trace function calls<br/>
2&#160;(0x2 packets)<br/>
debug packet handling<br/>
4&#160;(0x4 args)<br/>
heavy trace debugging<br/>
8&#160;(0x8 conns)<br/>
connection management<br/>
16&#160;(0x10 BER)<br/>
print out packets sent and received<br/>
32&#160;(0x20 filter)<br/>
search filter processing<br/>
64&#160;(0x40 config)<br/>
configuration processing<br/>
128&#160;(0x80 ACL)<br/>
access control list processing<br/>
256&#160;(0x100 stats)<br/>
stats log connections/operations/results<br/>
512&#160;(0x200 stats2)&#160;stats log entries sent<br/>
1024&#160;(0x400 shell)<br/>
print communication with shell backends<br/>
2048&#160;(0x800 parse)<br/>
print entry parsing debugging<br/>
16384&#160;(0x4000 sync)&#160;syncrepl consumer processing<br/>
32768&#160;(0x8000 none)&#160;only messages that get logged whatever log level is set<br/>
You may enable multiple levels by specifying the debug option once for each desired level. Or, since<br/>debugging levels are additive, you can do the math yourself. That is, if you want to trace function calls and<br/>watch the config file being processed, you could set level to the sum of those two levels (in this case,&#160;-d 65).<br/>Or, you can let slapd do the math, (e.g.&#160;-d 1 -d 64). Consult&#160;&lt;ldap_log.h&gt;&#160;for more details.<br/>
54<br/>
<hr/>
<a name=69></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
<b>Note:</b>&#160;slapd must have been compiled with&#160;--enable-debug&#160;defined for any debugging information<br/>beyond the two stats levels to be available (the default).<br/>
<b>7.2. Starting slapd</b><br/>
In general, slapd is run like this:<br/>
&#160; &#160; &#160; &#160; /usr/local/libexec/slapd [&lt;option&gt;]*<br/>
where&#160;/usr/local/libexec&#160;is determined by&#160;configure&#160;and &lt;option&gt; is one of the options described<br/>above (or in<i>&#160;slapd</i>(8)). Unless you have specified a debugging level (including level&#160;0), slapd will<br/>automatically fork and detach itself from its controlling terminal and run in the background.<br/>
<b>7.3. Stopping slapd</b><br/>
To kill off<i>&#160;slapd</i>(8) safely, you should give a command like this<br/>
&#160; &#160; &#160; &#160; kill -INT `cat /usr/local/var/slapd.pid`<br/>
where&#160;/usr/local/var&#160;is determined by&#160;configure.<br/>
Killing slapd by a more drastic method may cause information loss or database corruption.<br/>
55<br/>
<hr/>
<a name=70></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
56<br/>
<hr/>
<a name=71></a><b>8. Access Control</b><br/>
<b>8.1. Introduction</b><br/>
As the directory gets populated with more and more data of varying sensitivity, controlling the kinds of access<br/>granted to the directory becomes more and more critical. For instance, the directory may contain data of a<br/>confidential nature that you may need to protect by contract or by law. Or, if using the directory to control<br/>access to other services, inappropriate access to the directory may create avenues of attack to your sites<br/>security that result in devastating damage to your assets.<br/>
<a href="OpenLDAP-Admin-Guides.html#57">Access to your directory can be configured via two methods, the first using The slapd Configuration File and<br/></a>the second using the<i>&#160;slapd-config</i><a href="OpenLDAP-Admin-Guides.html#37">(5) format (Configuring slapd).</a><br/>
The default access control policy is allow read by all clients. Regardless of what access control policy is<br/>defined, the<i>&#160;rootdn</i>&#160;is always allowed full rights (i.e. auth, search, compare, read and write) on everything and<br/>anything.<br/>
As a consequence, it's useless (and results in a performance penalty) to explicitly list the<i>&#160;rootdn</i>&#160;among the<br/><i>&lt;by&gt;</i>&#160;clauses.<br/>
The following sections will describe Access Control Lists in greater depth and follow with some examples<br/>and recommendations. See<i>&#160;slapd.access</i>(5) for complete details.<br/>
<b>8.2. Access Control via Static Configuration</b><br/>
Access to entries and attributes is controlled by the access configuration file directive. The general form of an<br/>access line is:<br/>
&#160; &#160; &lt;access directive&gt; ::= access to &lt;what&gt;<br/>
&#160; &#160; &#160; &#160; [by &lt;who&gt; [&lt;access&gt;] [&lt;control&gt;] ]+<br/>
&#160; &#160; &lt;what&gt; ::= * |<br/>
&#160; &#160; &#160; &#160; [dn[.&lt;basic-style&gt;]=&lt;regex&gt; | dn.&lt;scope-style&gt;=&lt;DN&gt;]<br/>
&#160; &#160; &#160; &#160; [filter=&lt;ldapfilter&gt;] [attrs=&lt;attrlist&gt;]<br/>
&#160; &#160; &lt;basic-style&gt; ::= regex | exact<br/>
&#160; &#160; &lt;scope-style&gt; ::= base | one | subtree | children<br/>
&#160; &#160; &lt;attrlist&gt; ::= &lt;attr&gt; [val[.&lt;basic-style&gt;]=&lt;regex&gt;] | &lt;attr&gt; , &lt;attrlist&gt;<br/>
&#160; &#160; &lt;attr&gt; ::= &lt;attrname&gt; | entry | children<br/>
&#160; &#160; &lt;who&gt; ::= * | [anonymous | users | self<br/>
&#160; &#160; &#160; &#160; &#160; &#160; | dn[.&lt;basic-style&gt;]=&lt;regex&gt; | dn.&lt;scope-style&gt;=&lt;DN&gt;]<br/>
&#160; &#160; &#160; &#160; [dnattr=&lt;attrname&gt;]<br/>
&#160; &#160; &#160; &#160; [group[/&lt;objectclass&gt;[/&lt;attrname&gt;][.&lt;basic-style&gt;]]=&lt;regex&gt;]<br/>
&#160; &#160; &#160; &#160; [peername[.&lt;basic-style&gt;]=&lt;regex&gt;]<br/>
&#160; &#160; &#160; &#160; [sockname[.&lt;basic-style&gt;]=&lt;regex&gt;]<br/>
&#160; &#160; &#160; &#160; [domain[.&lt;basic-style&gt;]=&lt;regex&gt;]<br/>
&#160; &#160; &#160; &#160; [sockurl[.&lt;basic-style&gt;]=&lt;regex&gt;]<br/>
&#160; &#160; &#160; &#160; [set=&lt;setspec&gt;]<br/>
&#160; &#160; &#160; &#160; [aci=&lt;attrname&gt;]<br/>
&#160; &#160; &lt;access&gt; ::= [self]{&lt;level&gt;|&lt;priv&gt;}<br/>
&#160; &#160; &lt;level&gt; ::= none | disclose | auth | compare | search | read | write | manage<br/>
&#160; &#160; &lt;priv&gt; ::= {=|+|-}{m|w|r|s|c|x|d|0}+<br/>
&#160; &#160; &lt;control&gt; ::= [stop | continue | break]<br/>
57<br/>
<hr/>
<a name=72></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
where the &lt;what&gt; part selects the entries and/or attributes to which the access applies, the&#160;&lt;who&gt;&#160;part<br/>specifies which entities are granted access, and the&#160;&lt;access&gt;&#160;part specifies the access granted. Multiple<br/>&lt;who&gt; &lt;access&gt; &lt;control&gt;&#160;triplets are supported, allowing many entities to be granted different<br/>access to the same set of entries and attributes. Not all of these access control options are described here; for<br/>more details see the<i>&#160;slapd.access</i>(5) man page.<br/>
<b>8.2.1. What to control access to</b><br/>
The &lt;what&gt; part of an access specification determines the entries and attributes to which the access control<br/>applies. Entries are commonly selected in two ways: by DN and by filter. The following qualifiers select<br/>entries by DN:<br/>
&#160; &#160; to *<br/>
&#160; &#160; to dn[.&lt;basic-style&gt;]=&lt;regex&gt;<br/>
&#160; &#160; to dn.&lt;scope-style&gt;=&lt;DN&gt;<br/>
The first form is used to select all entries. The second form may be used to select entries by matching a<br/>regular expression against the target entry's<i>&#160;normalized DN</i>. (The second form is not discussed further in this<br/>document.) The third form is used to select entries which are within the requested scope of DN. The &lt;DN&gt; is<br/><a href="http://www.rfc-editor.org/rfc/rfc4514.txt">a string representation of the Distinguished Name, as described in RFC4514.</a><br/>
The scope can be either&#160;base,&#160;one,&#160;subtree, or&#160;children. Where&#160;base&#160;matches only the entry with<br/>provided DN,&#160;one&#160;matches the entries whose parent is the provided DN,&#160;subtree&#160;matches all entries in the<br/>subtree whose root is the provided DN, and&#160;children&#160;matches all entries under the DN (but not the entry<br/>named by the DN).<br/>
For example, if the directory contained entries named:<br/>
&#160; &#160; 0: o=suffix<br/>
&#160; &#160; 1: cn=Manager,o=suffix<br/>
&#160; &#160; 2: ou=people,o=suffix<br/>
&#160; &#160; 3: uid=kdz,ou=people,o=suffix<br/>
&#160; &#160; 4: cn=addresses,uid=kdz,ou=people,o=suffix<br/>
&#160; &#160; 5: uid=hyc,ou=people,o=suffix<br/>
Then:<br/>
dn.base=&#34;ou=people,o=suffix&#34;&#160;match 2;<br/>dn.one=&#34;ou=people,o=suffix&#34;&#160;match 3, and 5;<br/>dn.subtree=&#34;ou=people,o=suffix&#34;&#160;match 2, 3, 4, and 5; and<br/>dn.children=&#34;ou=people,o=suffix&#34;&#160;match 3, 4, and 5.<br/>
Entries may also be selected using a filter:<br/>
&#160; &#160; to filter=&lt;ldap filter&gt;<br/>
<a href="http://www.rfc-editor.org/rfc/rfc4515.txt">where &lt;ldap filter&gt; is a string representation of an LDAP search filter, as described in RFC4515. For<br/></a>example:<br/>
&#160; &#160; to filter=(objectClass=person)<br/>
Note that entries may be selected by both DN and filter by including both qualifiers in the &lt;what&gt; clause.<br/>
58<br/>
<hr/>
<a name=73></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
&#160; &#160; to dn.one=&#34;ou=people,o=suffix&#34; filter=(objectClass=person)<br/>
Attributes within an entry are selected by including a comma-separated list of attribute names in the &lt;what&gt;<br/>selector:<br/>
&#160; &#160; attrs=&lt;attribute list&gt;<br/>
A specific value of an attribute is selected by using a single attribute name and also using a value selector:<br/>
&#160; &#160; attrs=&lt;attribute&gt; val[.&lt;style&gt;]=&lt;regex&gt;<br/>
There are two special<i>&#160;pseudo</i>&#160;attributes&#160;entry&#160;and&#160;children. To read (and hence return) a target entry, the<br/>subject must have&#160;read&#160;access to the target's<i>&#160;entry</i>&#160;attribute. To perform a search, the subject must have<br/>search&#160;access to the search base's<i>&#160;entry</i>&#160;attribute. To add or delete an entry, the subject must have&#160;write<br/>access to the entry's&#160;entry&#160;attribute AND must have&#160;write&#160;access to the entry's parent's&#160;children<br/>attribute. To rename an entry, the subject must have&#160;write&#160;access to entry's&#160;entry&#160;attribute AND have<br/>write&#160;access to both the old parent's and new parent's&#160;children&#160;attributes. The complete examples at the<br/>end of this section should help clear things up.<br/>
Lastly, there is a special entry selector&#160;&#34;*&#34;&#160;that is used to select any entry. It is used when no other&#160;&lt;what&gt;<br/>selector has been provided. It's equivalent to &#34;dn=.*&#34;<br/>
<b>8.2.2. Who to grant access to</b><br/>
The &lt;who&gt; part identifies the entity or entities being granted access. Note that access is granted to &#34;entities&#34;<br/>not &#34;entries.&#34; The following table summarizes entity specifiers:<br/>
Table 6.3: Access Entity Specifiers<br/>
<b>Specifier</b><br/>
<b>Entities</b><br/>
*<br/>
All, including anonymous and authenticated users<br/>
anonymous<br/>
Anonymous (non-authenticated) users<br/>
users<br/>
Authenticated users<br/>
self<br/>
User associated with target entry<br/>
dn[.&lt;basic-style&gt;]=&lt;regex&gt;&#160;Users matching a regular expression<br/>
dn.&lt;scope-style&gt;=&lt;DN&gt;<br/>
Users within scope of a DN<br/>
The DN specifier behaves much like &lt;what&gt; clause DN specifiers.<br/>
Other control factors are also supported. For example, a&#160;&lt;who&gt;&#160;can be restricted by an entry listed in a<br/>DN-valued attribute in the entry to which the access applies:<br/>
&#160; &#160; dnattr=&lt;dn-valued attribute name&gt;<br/>
The dnattr specification is used to give access to an entry whose DN is listed in an attribute of the entry (e.g.,<br/>give access to a group entry to whoever is listed as the owner of the group entry).<br/>
Some factors may not be appropriate in all environments (or any). For example, the domain factor relies on IP<br/>to domain name lookups. As these can easily be spoofed, the domain factor should be avoided.<br/>
59<br/>
<hr/>
<a name=74></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
<b>8.2.3. The access to grant</b><br/>
The kind of &lt;access&gt; granted can be one of the following:<br/>
Table 6.4: Access Levels<br/>
<b>Level</b><br/>
<b>Privileges&#160;Description</b><br/>
none =<br/>
0&#160;no access<br/>
disclose =<br/>
d&#160;needed for information disclosure on error<br/>
auth =<br/>
dx&#160;needed to authenticate (bind)<br/>
compare =<br/>
cdx&#160;needed to compare<br/>
search =<br/>
scdx&#160;needed to apply search filters<br/>
read =<br/>
rscdx&#160;needed to read search results<br/>
write =<br/>
wrscdx&#160;needed to modify/rename<br/>
manage =<br/>
mwrscdx&#160;needed to manage<br/>
Each level implies all lower levels of access. So, for example, granting someone&#160;write&#160;access to an entry<br/>also grants them&#160;read,&#160;search,&#160;compare,&#160;auth&#160;and&#160;disclose&#160;access. However, one may use the<br/>privileges specifier to grant specific permissions.<br/>
<b>8.2.4. Access Control Evaluation</b><br/>
When evaluating whether some requester should be given access to an entry and/or attribute, slapd compares<br/>the entry and/or attribute to the&#160;&lt;what&gt;&#160;selectors given in the configuration file. For each entry, access<br/>controls provided in the database which holds the entry (or the global access directives if not held in any<br/>database) apply first, followed by the global access directives. However, when dealing with an access list,<br/>because the global access list is effectively appended to each per-database list, if the resulting list is<br/>non-empty then the access list will end with an implicit&#160;access to * by * none&#160;directive. If there are<br/>no access directives applicable to a backend, then a default read is used.<br/>
Within this priority, access directives are examined in the order in which they appear in the config file. Slapd<br/>stops with the first&#160;&lt;what&gt;&#160;selector that matches the entry and/or attribute. The corresponding access<br/>directive is the one slapd will use to evaluate access.<br/>
Next, slapd compares the entity requesting access to the&#160;&lt;who&gt;&#160;selectors within the access directive selected<br/>above in the order in which they appear. It stops with the first&#160;&lt;who&gt;&#160;selector that matches the requester. This<br/>determines the access the entity requesting access has to the entry and/or attribute.<br/>
Finally, slapd compares the access granted in the selected&#160;&lt;access&gt;&#160;clause to the access requested by the<br/>client. If it allows greater or equal access, access is granted. Otherwise, access is denied.<br/>
The order of evaluation of access directives makes their placement in the configuration file important. If one<br/>access directive is more specific than another in terms of the entries it selects, it should appear first in the<br/>config file. Similarly, if one&#160;&lt;who&gt;&#160;selector is more specific than another it should come first in the access<br/>directive. The access control examples given below should help make this clear.<br/>
60<br/>
<hr/>
<a name=75></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
<b>8.2.5. Access Control Examples</b><br/>
The access control facility described above is quite powerful. This section shows some examples of its use for<br/>descriptive purposes.<br/>
A simple example:<br/>
&#160; &#160; access to * by * read<br/>
This access directive grants read access to everyone.<br/>
&#160; &#160; access to *<br/>
&#160; &#160; &#160; &#160; by self write<br/>
&#160; &#160; &#160; &#160; by anonymous auth<br/>
&#160; &#160; &#160; &#160; by * read<br/>
This directive allows the user to modify their entry, allows anonymous to authentication against these entries,<br/>and allows all others to read these entries. Note that only the first&#160;by &lt;who&gt;&#160;clause which matches applies.<br/>Hence, the anonymous users are granted&#160;auth, not&#160;read. The last clause could just as well have been &#34;by<br/>users read&#34;.<br/>
It is often desirable to restrict operations based upon the level of protection in place. The following shows<br/>how security strength factors (SSF) can be used.<br/>
&#160; &#160; access to *<br/>
&#160; &#160; &#160; &#160; by ssf=128 self write<br/>
&#160; &#160; &#160; &#160; by ssf=64 anonymous auth<br/>
&#160; &#160; &#160; &#160; by ssf=64 users read<br/>
This directive allows users to modify their own entries if security protections have of strength 128 or better<br/>have been established, allows authentication access to anonymous users, and read access when 64 or better<br/>security protections have been established. If client has not establish sufficient security protections, the<br/>implicit&#160;by * none&#160;clause would be applied.<br/>
The following example shows the use of a style specifiers to select the entries by DN in two access directives<br/>where ordering is significant.<br/>
&#160; &#160; access to dn.children=&#34;dc=example,dc=com&#34;<br/>
&#160; &#160; &#160; &#160; &#160;by * search<br/>
&#160; &#160; access to dn.children=&#34;dc=com&#34;<br/>
&#160; &#160; &#160; &#160; &#160;by * read<br/>
Read access is granted to entries under the&#160;dc=com&#160;subtree, except for those entries under the<br/>dc=example,dc=com&#160;subtree, to which search access is granted. No access is granted to&#160;dc=com&#160;as<br/>neither access directive matches this DN. If the order of these access directives was reversed, the trailing<br/>directive would never be reached, since all entries under&#160;dc=example,dc=com&#160;are also under&#160;dc=com<br/>entries.<br/>
Also note that if no&#160;access to&#160;directive matches or no&#160;by &lt;who&gt;&#160;clause,<b>&#160;access is denied</b>. That is, every<br/>access to&#160;directive ends with an implicit&#160;by * none&#160;clause. When dealing with an access list, because<br/>the global access list is effectively appended to each per-database list, if the resulting list is non-empty then<br/>the access list will end with an implicit&#160;access to * by * none&#160;directive. If there are no access<br/>directives applicable to a backend, then a default read is used.<br/>
61<br/>
<hr/>
<a name=76></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
The next example again shows the importance of ordering, both of the access directives and the&#160;by &lt;who&gt;<br/>clauses. It also shows the use of an attribute selector to grant access to a specific attribute and various&#160;&lt;who&gt;<br/>selectors.<br/>
&#160; &#160; access to dn.subtree=&#34;dc=example,dc=com&#34; attrs=homePhone<br/>
&#160; &#160; &#160; &#160; by self write<br/>
&#160; &#160; &#160; &#160; by dn.children=&#34;dc=example,dc=com&#34; search<br/>
&#160; &#160; &#160; &#160; by peername.regex=IP:10\..+ read<br/>
&#160; &#160; access to dn.subtree=&#34;dc=example,dc=com&#34;<br/>
&#160; &#160; &#160; &#160; by self write<br/>
&#160; &#160; &#160; &#160; by dn.children=&#34;dc=example,dc=com&#34; search<br/>
&#160; &#160; &#160; &#160; by anonymous auth<br/>
This example applies to entries in the &#34;dc=example,dc=com&#34; subtree. To all attributes except<br/>homePhone, an entry can write to itself, entries under&#160;example.com&#160;entries can search by them, anybody<br/>else has no access (implicit&#160;by * none) excepting for authentication/authorization (which is always done<br/>anonymously). The&#160;homePhone&#160;attribute is writable by the entry, searchable by entries under<br/>example.com, readable by clients connecting from network 10, and otherwise not readable (implicit&#160;by *<br/>none). All other access is denied by the implicit&#160;access to * by * none.<br/>
Sometimes it is useful to permit a particular DN to add or remove itself from an attribute. For example, if you<br/>would like to create a group and allow people to add and remove only their own DN from the member<br/>attribute, you could accomplish it with an access directive like this:<br/>
&#160; &#160; access to attrs=member,entry<br/>
&#160; &#160; &#160; &#160; &#160;by dnattr=member selfwrite<br/>
The dnattr&#160;&lt;who&gt;&#160;selector says that the access applies to entries listed in the&#160;member&#160;attribute. The<br/>selfwrite&#160;access selector says that such members can only add or delete their own DN from the attribute,<br/>not other values. The addition of the entry attribute is required because access to the entry is required to access<br/>any of the entry's attributes.<br/>
<b>8.3. Access Control via Dynamic Configuration</b><br/>
Access to slapd entries and attributes is controlled by the olcAccess attribute, whose values are a sequence of<br/>access directives. The general form of the olcAccess configuration is:<br/>
&#160; &#160; olcAccess: &lt;access directive&gt;<br/>
&#160; &#160; &lt;access directive&gt; ::= to &lt;what&gt;<br/>
&#160; &#160; &#160; &#160; [by &lt;who&gt; [&lt;access&gt;] [&lt;control&gt;] ]+<br/>
&#160; &#160; &lt;what&gt; ::= * |<br/>
&#160; &#160; &#160; &#160; [dn[.&lt;basic-style&gt;]=&lt;regex&gt; | dn.&lt;scope-style&gt;=&lt;DN&gt;]<br/>
&#160; &#160; &#160; &#160; [filter=&lt;ldapfilter&gt;] [attrs=&lt;attrlist&gt;]<br/>
&#160; &#160; &lt;basic-style&gt; ::= regex | exact<br/>
&#160; &#160; &lt;scope-style&gt; ::= base | one | subtree | children<br/>
&#160; &#160; &lt;attrlist&gt; ::= &lt;attr&gt; [val[.&lt;basic-style&gt;]=&lt;regex&gt;] | &lt;attr&gt; , &lt;attrlist&gt;<br/>
&#160; &#160; &lt;attr&gt; ::= &lt;attrname&gt; | entry | children<br/>
&#160; &#160; &lt;who&gt; ::= * | [anonymous | users | self<br/>
&#160; &#160; &#160; &#160; &#160; &#160; | dn[.&lt;basic-style&gt;]=&lt;regex&gt; | dn.&lt;scope-style&gt;=&lt;DN&gt;]<br/>
&#160; &#160; &#160; &#160; [dnattr=&lt;attrname&gt;]<br/>
&#160; &#160; &#160; &#160; [group[/&lt;objectclass&gt;[/&lt;attrname&gt;][.&lt;basic-style&gt;]]=&lt;regex&gt;]<br/>
&#160; &#160; &#160; &#160; [peername[.&lt;basic-style&gt;]=&lt;regex&gt;]<br/>
&#160; &#160; &#160; &#160; [sockname[.&lt;basic-style&gt;]=&lt;regex&gt;]<br/>
&#160; &#160; &#160; &#160; [domain[.&lt;basic-style&gt;]=&lt;regex&gt;]<br/>
&#160; &#160; &#160; &#160; [sockurl[.&lt;basic-style&gt;]=&lt;regex&gt;]<br/>
62<br/>
<hr/>
<a name=77></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
&#160; &#160; &#160; &#160; [set=&lt;setspec&gt;]<br/>
&#160; &#160; &#160; &#160; [aci=&lt;attrname&gt;]<br/>
&#160; &#160; &lt;access&gt; ::= [self]{&lt;level&gt;|&lt;priv&gt;}<br/>
&#160; &#160; &lt;level&gt; ::= none | disclose | auth | compare | search | read | write | manage<br/>
&#160; &#160; &lt;priv&gt; ::= {=|+|-}{m|w|r|s|c|x|d|0}+<br/>
&#160; &#160; &lt;control&gt; ::= [stop | continue | break]<br/>
where the &lt;what&gt; part selects the entries and/or attributes to which the access applies, the&#160;&lt;who&gt;&#160;part<br/>specifies which entities are granted access, and the&#160;&lt;access&gt;&#160;part specifies the access granted. Multiple<br/>&lt;who&gt; &lt;access&gt; &lt;control&gt;&#160;triplets are supported, allowing many entities to be granted different<br/>access to the same set of entries and attributes. Not all of these access control options are described here; for<br/>more details see the<i>&#160;slapd.access</i>(5) man page.<br/>
<b>8.3.1. What to control access to</b><br/>
The &lt;what&gt; part of an access specification determines the entries and attributes to which the access control<br/>applies. Entries are commonly selected in two ways: by DN and by filter. The following qualifiers select<br/>entries by DN:<br/>
&#160; &#160; to *<br/>
&#160; &#160; to dn[.&lt;basic-style&gt;]=&lt;regex&gt;<br/>
&#160; &#160; to dn.&lt;scope-style&gt;=&lt;DN&gt;<br/>
The first form is used to select all entries. The second form may be used to select entries by matching a<br/>regular expression against the target entry's<i>&#160;normalized DN</i>. (The second form is not discussed further in this<br/>document.) The third form is used to select entries which are within the requested scope of DN. The &lt;DN&gt; is<br/><a href="http://www.rfc-editor.org/rfc/rfc4514.txt">a string representation of the Distinguished Name, as described in RFC4514.</a><br/>
The scope can be either&#160;base,&#160;one,&#160;subtree, or&#160;children. Where&#160;base&#160;matches only the entry with<br/>provided DN,&#160;one&#160;matches the entries whose parent is the provided DN,&#160;subtree&#160;matches all entries in the<br/>subtree whose root is the provided DN, and&#160;children&#160;matches all entries under the DN (but not the entry<br/>named by the DN).<br/>
For example, if the directory contained entries named:<br/>
&#160; &#160; 0: o=suffix<br/>
&#160; &#160; 1: cn=Manager,o=suffix<br/>
&#160; &#160; 2: ou=people,o=suffix<br/>
&#160; &#160; 3: uid=kdz,ou=people,o=suffix<br/>
&#160; &#160; 4: cn=addresses,uid=kdz,ou=people,o=suffix<br/>
&#160; &#160; 5: uid=hyc,ou=people,o=suffix<br/>
Then:<br/>
dn.base=&#34;ou=people,o=suffix&#34;&#160;match 2;<br/>dn.one=&#34;ou=people,o=suffix&#34;&#160;match 3, and 5;<br/>dn.subtree=&#34;ou=people,o=suffix&#34;&#160;match 2, 3, 4, and 5; and<br/>dn.children=&#34;ou=people,o=suffix&#34;&#160;match 3, 4, and 5.<br/>
Entries may also be selected using a filter:<br/>
&#160; &#160; to filter=&lt;ldap filter&gt;<br/>
63<br/>
<hr/>
<a name=78></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
<a href="http://www.rfc-editor.org/rfc/rfc4515.txt">where &lt;ldap filter&gt; is a string representation of an LDAP search filter, as described in RFC4515. For<br/></a>example:<br/>
&#160; &#160; to filter=(objectClass=person)<br/>
Note that entries may be selected by both DN and filter by including both qualifiers in the &lt;what&gt; clause.<br/>
&#160; &#160; to dn.one=&#34;ou=people,o=suffix&#34; filter=(objectClass=person)<br/>
Attributes within an entry are selected by including a comma-separated list of attribute names in the &lt;what&gt;<br/>selector:<br/>
&#160; &#160; attrs=&lt;attribute list&gt;<br/>
A specific value of an attribute is selected by using a single attribute name and also using a value selector:<br/>
&#160; &#160; attrs=&lt;attribute&gt; val[.&lt;style&gt;]=&lt;regex&gt;<br/>
There are two special<i>&#160;pseudo</i>&#160;attributes&#160;entry&#160;and&#160;children. To read (and hence return) a target entry, the<br/>subject must have&#160;read&#160;access to the target's<i>&#160;entry</i>&#160;attribute. To perform a search, the subject must have<br/>search&#160;access to the search base's<i>&#160;entry</i>&#160;attribute. To add or delete an entry, the subject must have&#160;write<br/>access to the entry's&#160;entry&#160;attribute AND must have&#160;write&#160;access to the entry's parent's&#160;children<br/>attribute. To rename an entry, the subject must have&#160;write&#160;access to entry's&#160;entry&#160;attribute AND have<br/>write&#160;access to both the old parent's and new parent's&#160;children&#160;attributes. The complete examples at the<br/>end of this section should help clear things up.<br/>
Lastly, there is a special entry selector&#160;&#34;*&#34;&#160;that is used to select any entry. It is used when no other&#160;&lt;what&gt;<br/>selector has been provided. It's equivalent to &#34;dn=.*&#34;<br/>
<b>8.3.2. Who to grant access to</b><br/>
The &lt;who&gt; part identifies the entity or entities being granted access. Note that access is granted to &#34;entities&#34;<br/>not &#34;entries.&#34; The following table summarizes entity specifiers:<br/>
Table 5.3: Access Entity Specifiers<br/>
<b>Specifier</b><br/>
<b>Entities</b><br/>
*<br/>
All, including anonymous and authenticated users<br/>
anonymous<br/>
Anonymous (non-authenticated) users<br/>
users<br/>
Authenticated users<br/>
self<br/>
User associated with target entry<br/>
dn[.&lt;basic-style&gt;]=&lt;regex&gt;&#160;Users matching a regular expression<br/>
dn.&lt;scope-style&gt;=&lt;DN&gt;<br/>
Users within scope of a DN<br/>
The DN specifier behaves much like &lt;what&gt; clause DN specifiers.<br/>
Other control factors are also supported. For example, a&#160;&lt;who&gt;&#160;can be restricted by an entry listed in a<br/>DN-valued attribute in the entry to which the access applies:<br/>
&#160; &#160; dnattr=&lt;dn-valued attribute name&gt;<br/>
64<br/>
<hr/>
<a name=79></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
The dnattr specification is used to give access to an entry whose DN is listed in an attribute of the entry (e.g.,<br/>give access to a group entry to whoever is listed as the owner of the group entry).<br/>
Some factors may not be appropriate in all environments (or any). For example, the domain factor relies on IP<br/>to domain name lookups. As these can easily be spoofed, the domain factor should be avoided.<br/>
<b>8.3.3. The access to grant</b><br/>
The kind of &lt;access&gt; granted can be one of the following:<br/>
Table 5.4: Access Levels<br/>
<b>Level</b><br/>
<b>Privileges&#160;Description</b><br/>
none<br/>
=0&#160;no access<br/>
disclose<br/>
=d&#160;needed for information disclosure on error<br/>
auth<br/>
=dx&#160;needed to authenticate (bind)<br/>
compare<br/>
=cdx&#160;needed to compare<br/>
search<br/>
=scdx&#160;needed to apply search filters<br/>
read<br/>
=rscdx&#160;needed to read search results<br/>
write<br/>
=wrscdx&#160;needed to modify/rename<br/>
manage<br/>
=mwrscdx&#160;needed to manage<br/>
Each level implies all lower levels of access. So, for example, granting someone&#160;write&#160;access to an entry<br/>also grants them&#160;read,&#160;search,&#160;compare,&#160;auth&#160;and&#160;disclose&#160;access. However, one may use the<br/>privileges specifier to grant specific permissions.<br/>
<b>8.3.4. Access Control Evaluation</b><br/>
When evaluating whether some requester should be given access to an entry and/or attribute, slapd compares<br/>the entry and/or attribute to the&#160;&lt;what&gt;&#160;selectors given in the configuration. For each entry, access controls<br/>provided in the database which holds the entry (or the global access directives if not held in any database)<br/>apply first, followed by the global access directives (which are held in the&#160;frontend&#160;database definition).<br/>However, when dealing with an access list, because the global access list is effectively appended to each<br/>per-database list, if the resulting list is non-empty then the access list will end with an implicit&#160;access to<br/>* by * none&#160;directive. If there are no access directives applicable to a backend, then a default read is used.<br/>
Within this priority, access directives are examined in the order in which they appear in the configuration<br/>attribute. Slapd stops with the first&#160;&lt;what&gt;&#160;selector that matches the entry and/or attribute. The<br/>corresponding access directive is the one slapd will use to evaluate access.<br/>
Next, slapd compares the entity requesting access to the&#160;&lt;who&gt;&#160;selectors within the access directive selected<br/>above in the order in which they appear. It stops with the first&#160;&lt;who&gt;&#160;selector that matches the requester. This<br/>determines the access the entity requesting access has to the entry and/or attribute.<br/>
Finally, slapd compares the access granted in the selected&#160;&lt;access&gt;&#160;clause to the access requested by the<br/>client. If it allows greater or equal access, access is granted. Otherwise, access is denied.<br/>
The order of evaluation of access directives makes their placement in the configuration file important. If one<br/>access directive is more specific than another in terms of the entries it selects, it should appear first in the<br/>
65<br/>
<hr/>
<a name=80></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
configuration. Similarly, if one&#160;&lt;who&gt;&#160;selector is more specific than another it should come first in the access<br/>directive. The access control examples given below should help make this clear.<br/>
<b>8.3.5. Access Control Examples</b><br/>
The access control facility described above is quite powerful. This section shows some examples of its use for<br/>descriptive purposes.<br/>
A simple example:<br/>
&#160; &#160; olcAccess: to * by * read<br/>
This access directive grants read access to everyone.<br/>
&#160; &#160; olcAccess: to *<br/>
&#160; &#160; &#160; &#160; by self write<br/>
&#160; &#160; &#160; &#160; by anonymous auth<br/>
&#160; &#160; &#160; &#160; by * read<br/>
This directive allows the user to modify their entry, allows anonymous to authenticate against these entries,<br/>and allows all others to read these entries. Note that only the first&#160;by &lt;who&gt;&#160;clause which matches applies.<br/>Hence, the anonymous users are granted&#160;auth, not&#160;read. The last clause could just as well have been &#34;by<br/>users read&#34;.<br/>
It is often desirable to restrict operations based upon the level of protection in place. The following shows<br/>how security strength factors (SSF) can be used.<br/>
&#160; &#160; olcAccess: to *<br/>
&#160; &#160; &#160; &#160; by ssf=128 self write<br/>
&#160; &#160; &#160; &#160; by ssf=64 anonymous auth<br/>
&#160; &#160; &#160; &#160; by ssf=64 users read<br/>
This directive allows users to modify their own entries if security protections of strength 128 or better have<br/>been established, allows authentication access to anonymous users, and read access when strength 64 or better<br/>security protections have been established. If the client has not establish sufficient security protections, the<br/>implicit&#160;by * none&#160;clause would be applied.<br/>
The following example shows the use of style specifiers to select the entries by DN in two access directives<br/>where ordering is significant.<br/>
&#160; &#160; olcAccess: to dn.children=&#34;dc=example,dc=com&#34;<br/>
&#160; &#160; &#160; &#160; &#160;by * search<br/>
&#160; &#160; olcAccess: to dn.children=&#34;dc=com&#34;<br/>
&#160; &#160; &#160; &#160; &#160;by * read<br/>
Read access is granted to entries under the&#160;dc=com&#160;subtree, except for those entries under the<br/>dc=example,dc=com&#160;subtree, to which search access is granted. No access is granted to&#160;dc=com&#160;as<br/>neither access directive matches this DN. If the order of these access directives was reversed, the trailing<br/>directive would never be reached, since all entries under&#160;dc=example,dc=com&#160;are also under&#160;dc=com<br/>entries.<br/>
Also note that if no&#160;olcAccess: to&#160;directive matches or no&#160;by &lt;who&gt;&#160;clause,<b>&#160;access is denied</b>. When<br/>dealing with an access list, because the global access list is effectively appended to each per-database list, if<br/>
66<br/>
<hr/>
<a name=81></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
the resulting list is non-empty then the access list will end with an implicit&#160;access to * by * none<br/>directive. If there are no access directives applicable to a backend, then a default read is used.<br/>
The next example again shows the importance of ordering, both of the access directives and the&#160;by &lt;who&gt;<br/>clauses. It also shows the use of an attribute selector to grant access to a specific attribute and various&#160;&lt;who&gt;<br/>selectors.<br/>
&#160; &#160; olcAccess: to dn.subtree=&#34;dc=example,dc=com&#34; attrs=homePhone<br/>
&#160; &#160; &#160; &#160; by self write<br/>
&#160; &#160; &#160; &#160; by dn.children=dc=example,dc=com&#34; search<br/>
&#160; &#160; &#160; &#160; by peername.regex=IP:10\..+ read<br/>
&#160; &#160; olcAccess: to dn.subtree=&#34;dc=example,dc=com&#34;<br/>
&#160; &#160; &#160; &#160; by self write<br/>
&#160; &#160; &#160; &#160; by dn.children=&#34;dc=example,dc=com&#34; search<br/>
&#160; &#160; &#160; &#160; by anonymous auth<br/>
This example applies to entries in the &#34;dc=example,dc=com&#34; subtree. To all attributes except<br/>homePhone, an entry can write to itself, entries under&#160;example.com&#160;entries can search by them, anybody<br/>else has no access (implicit&#160;by * none) excepting for authentication/authorization (which is always done<br/>anonymously). The&#160;homePhone&#160;attribute is writable by the entry, searchable by entries under<br/>example.com, readable by clients connecting from network 10, and otherwise not readable (implicit&#160;by *<br/>none). All other access is denied by the implicit&#160;access to * by * none.<br/>
Sometimes it is useful to permit a particular DN to add or remove itself from an attribute. For example, if you<br/>would like to create a group and allow people to add and remove only their own DN from the member<br/>attribute, you could accomplish it with an access directive like this:<br/>
&#160; &#160; olcAccess: to attrs=member,entry<br/>
&#160; &#160; &#160; &#160; &#160;by dnattr=member selfwrite<br/>
The dnattr&#160;&lt;who&gt;&#160;selector says that the access applies to entries listed in the&#160;member&#160;attribute. The<br/>selfwrite&#160;access selector says that such members can only add or delete their own DN from the attribute,<br/>not other values. The addition of the entry attribute is required because access to the entry is required to access<br/>any of the entry's attributes.<br/>
<b>8.3.6. Access Control Ordering</b><br/>
Since the ordering of&#160;olcAccess&#160;directives is essential to their proper evaluation, but LDAP attributes<br/>normally do not preserve the ordering of their values, OpenLDAP uses a custom schema extension to<br/>maintain a fixed ordering of these values. This ordering is maintained by prepending a&#160;&#34;{X}&#34;&#160;numeric index<br/>to each value, similarly to the approach used for ordering the configuration entries. These index tags are<br/>maintained automatically by slapd and do not need to be specified when originally defining the values. For<br/>example, when you create the settings<br/>
&#160; &#160; olcAccess: to attrs=member,entry<br/>
&#160; &#160; &#160; &#160; &#160;by dnattr=member selfwrite<br/>
&#160; &#160; olcAccess: to dn.children=&#34;dc=example,dc=com&#34;<br/>
&#160; &#160; &#160; &#160; &#160;by * search<br/>
&#160; &#160; olcAccess: to dn.children=&#34;dc=com&#34;<br/>
&#160; &#160; &#160; &#160; &#160;by * read<br/>
when you read them back using slapcat or ldapsearch they will contain<br/>
67<br/>
<hr/>
<a name=82></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
&#160; &#160; olcAccess: {0}to attrs=member,entry<br/>
&#160; &#160; &#160; &#160; &#160;by dnattr=member selfwrite<br/>
&#160; &#160; olcAccess: {1}to dn.children=&#34;dc=example,dc=com&#34;<br/>
&#160; &#160; &#160; &#160; &#160;by * search<br/>
&#160; &#160; olcAccess: {2}to dn.children=&#34;dc=com&#34;<br/>
&#160; &#160; &#160; &#160; &#160;by * read<br/>
The numeric index may be used to specify a particular value to change when using ldapmodify to edit the<br/>access rules. This index can be used instead of (or in addition to) the actual access value. Using this numeric<br/>index is very helpful when multiple access rules are being managed.<br/>
For example, if we needed to change the second rule above to grant write access instead of search, we could<br/>try this LDIF:<br/>
&#160; &#160; changetype: modify<br/>
&#160; &#160; delete: olcAccess<br/>
&#160; &#160; olcAccess: to dn.children=&#34;dc=example,dc=com&#34; by * search<br/>
&#160; &#160; -<br/>
&#160; &#160; add: olcAccess<br/>
&#160; &#160; olcAccess: to dn.children=&#34;dc=example,dc=com&#34; by * write<br/>
&#160; &#160; -<br/>
But this example<b>&#160;will not</b>&#160;guarantee that the existing values remain in their original order, so it will most<br/>likely yield a broken security configuration. Instead, the numeric index should be used:<br/>
&#160; &#160; changetype: modify<br/>
&#160; &#160; delete: olcAccess<br/>
&#160; &#160; olcAccess: {1}<br/>
&#160; &#160; -<br/>
&#160; &#160; add: olcAccess<br/>
&#160; &#160; olcAccess: {1}to dn.children=&#34;dc=example,dc=com&#34; by * write<br/>
&#160; &#160; -<br/>
This example deletes whatever rule is in value #1 of the&#160;olcAccess&#160;attribute (regardless of its value) and<br/>adds a new value that is explicitly inserted as value #1. The result will be<br/>
&#160; &#160; olcAccess: {0}to attrs=member,entry<br/>
&#160; &#160; &#160; &#160; &#160;by dnattr=member selfwrite<br/>
&#160; &#160; olcAccess: {1}to dn.children=&#34;dc=example,dc=com&#34;<br/>
&#160; &#160; &#160; &#160; &#160;by * write<br/>
&#160; &#160; olcAccess: {2}to dn.children=&#34;dc=com&#34;<br/>
&#160; &#160; &#160; &#160; &#160;by * read<br/>
which is exactly what was intended.<br/>
<b>8.4. Access Control Common Examples</b><br/>
<b>8.4.1. Basic ACLs</b><br/>
Generally one should start with some basic ACLs such as:<br/>
&#160; &#160; access to attr=userPassword<br/>
&#160; &#160; &#160; &#160; by self =xw<br/>
&#160; &#160; &#160; &#160; by anonymous auth<br/>
&#160; &#160; &#160; &#160; by * none<br/>
68<br/>
<hr/>
<a name=83></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
&#160; &#160; &#160; access to *<br/>
&#160; &#160; &#160; &#160; by self write<br/>
&#160; &#160; &#160; &#160; by users read<br/>
&#160; &#160; &#160; &#160; by * none<br/>
The first ACL allows users to update (but not read) their passwords, anonymous users to authenticate against<br/>this attribute, and (implicitly) denying all access to others.<br/>
The second ACL allows users full access to their entry, authenticated users read access to anything, and<br/>(implicitly) denying all access to others (in this case, anonymous users).<br/>
<b>8.4.2. Matching Anonymous and Authenticated users</b><br/>
An anonymous user has a empty DN. While the<i>&#160;dn.exact=&#34;&#34;</i>&#160;or<i>&#160;dn.regex=&#34;^$&#34;</i>&#160;could be used,<i>&#160;slapd</i>(8)) offers<br/>an anonymous shorthand which should be used instead.<br/>
&#160; &#160; access to *<br/>
&#160; &#160; &#160; by anonymous none<br/>
&#160; &#160; &#160; by * read<br/>
denies all access to anonymous users while granting others read.<br/>
Authenticated users have a subject DN. While<i>&#160;dn.regex=&#34;.+&#34;</i>&#160;will match any authenticated user, OpenLDAP<br/>provides the users short hand which should be used instead.<br/>
&#160; &#160; access to *<br/>
&#160; &#160; &#160; by users read<br/>
&#160; &#160; &#160; by * none<br/>
This ACL grants read permissions to authenticated users while denying others (i.e.: anonymous users).<br/>
<b>8.4.3. Controlling rootdn access</b><br/>
You could specify the<i>&#160;rootdn</i>&#160;in<i>&#160;slapd.conf</i>(5) or<i>&#160;slapd.d</i>&#160;without specifying a<i>&#160;rootpw</i>. Then you have to add<br/>an actual directory entry with the same dn, e.g.:<br/>
&#160; &#160; dn: cn=Manager,o=MyOrganization<br/>
&#160; &#160; cn: Manager<br/>
&#160; &#160; sn: Manager<br/>
&#160; &#160; objectClass: person<br/>
&#160; &#160; objectClass: top<br/>
&#160; &#160; userPassword: {SSHA}someSSHAdata<br/>
Then binding as the<i>&#160;rootdn</i>&#160;will require a regular bind to that DN, which in turn requires auth access to that<br/>entry's DN and<i>&#160;userPassword</i>, and this can be restricted via ACLs. E.g.:<br/>
&#160; &#160; access to dn.base=&#34;cn=Manager,o=MyOrganization&#34;<br/>
&#160; &#160; &#160; by peername.regex=127\.0\.0\.1 auth<br/>
&#160; &#160; &#160; by peername.regex=192\.168\.0\..* auth<br/>
&#160; &#160; &#160; by users none<br/>
&#160; &#160; &#160; by * none<br/>
69<br/>
<hr/>
<a name=84></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
The ACLs above will only allow binding using rootdn from localhost and 192.168.0.0/24.<br/>
<b>8.4.4. Managing access with Groups</b><br/>
There are a few ways to do this. One approach is illustrated here. Consider the following DIT layout:<br/>
&#160; &#160; +-dc=example,dc=com<br/>
&#160; &#160; +---cn=administrators,dc=example,dc=com<br/>
&#160; &#160; +---cn=fred blogs,dc=example,dc=com<br/>
and the following group object (in LDIF format):<br/>
&#160; &#160; dn: cn=administrators,dc=example,dc=com<br/>
&#160; &#160; cn: administrators of this region<br/>
&#160; &#160; objectclass: groupOfNames &#160;(important for the group acl feature)<br/>
&#160; &#160; member: cn=fred blogs,dc=example,dc=com<br/>
&#160; &#160; member: cn=somebody else,dc=example,dc=com<br/>
One can then grant access to the members of this this group by adding appropriate<i>&#160;by group</i>&#160;clause to an<br/>access directive in<i>&#160;slapd.conf</i>(5). For instance,<br/>
&#160; &#160; access to dn.children=&#34;dc=example,dc=com&#34;<br/>
&#160; &#160; &#160; &#160; by self write<br/>
&#160; &#160; &#160; &#160; by group.exact=&#34;cn=Administrators,dc=example,dc=com&#34; write<br/>
&#160; &#160; &#160; &#160; by * auth<br/>
Like by<i>&#160;dn</i>&#160;clauses, one can also use<i>&#160;expand</i>&#160;to expand the group name based upon the regular expression<br/>matching of the target, that is, the to<i>&#160;dn.regex</i>). For instance,<br/>
&#160; &#160; access to dn.regex=&#34;(.+,)?ou=People,(dc=[^,]+,dc=[^,]+)$&#34;<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160;attrs=children,entry,uid<br/>
&#160; &#160; &#160; &#160; by group.expand=&#34;cn=Managers,$2&#34; write<br/>
&#160; &#160; &#160; &#160; by users read<br/>
&#160; &#160; &#160; &#160; by * auth<br/>
The above illustration assumed that the group members are to be found in the<i>&#160;member</i>&#160;attribute type of the<br/><i>groupOfNames</i>&#160;object class. If you need to use a different group object and/or a different attribute type then<br/>use the following<i>&#160;slapd.conf</i>(5) (abbreviated) syntax:<br/>
&#160; &#160; access to &lt;what&gt;<br/>
&#160; &#160; &#160; &#160; &#160; &#160; by group/&lt;objectclass&gt;/&lt;attributename&gt;=&lt;DN&gt; &lt;access&gt;<br/>
For example:<br/>
&#160; &#160; access to *<br/>
&#160; &#160; &#160; by group/organizationalRole/roleOccupant=&#34;cn=Administrator,dc=example,dc=com&#34; write<br/>
In this case, we have an ObjectClass<i>&#160;organizationalRole</i>&#160;which contains the administrator DN's in the<br/><i>roleOccupant</i>&#160;attribute. For instance:<br/>
&#160; &#160; dn: cn=Administrator,dc=example,dc=com<br/>
&#160; &#160; cn: Administrator<br/>
&#160; &#160; objectclass: organizationalRole<br/>
&#160; &#160; roleOccupant: cn=Jane Doe,dc=example,dc=com<br/>
70<br/>
<hr/>
<a name=85></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
<b>Note:</b>&#160;the specified member attribute type MUST be of DN or<i>&#160;NameAndOptionalUID</i>&#160;syntax, and the<br/>specified object class SHOULD allow the attribute type.<br/>
Dynamic Groups are also supported in Access Control. Please see<i>&#160;slapo-dynlist</i><a href="OpenLDAP-Admin-Guides.html#123">(5) and the Dynamic Lists<br/></a>overlay section.<br/>
<b>8.4.5. Granting access to a subset of attributes</b><br/>
You can grant access to a set of attributes by specifying a list of attribute names in the ACL<i>&#160;to</i>&#160;clause. To be<br/>useful, you also need to grant access to the<i>&#160;entry</i>&#160;itself. Also note how<i>&#160;children</i>&#160;controls the ability to add,<br/>delete, and rename entries.<br/>
&#160; &#160; # mail: self may write, authenticated users may read<br/>
&#160; &#160; access to attrs=mail<br/>
&#160; &#160; &#160; by self write<br/>
&#160; &#160; &#160; by users read<br/>
&#160; &#160; &#160; by * none<br/>
&#160; &#160; # cn, sn: self my write, all may read<br/>
&#160; &#160; access to attrs=cn,sn<br/>
&#160; &#160; &#160; by self write<br/>
&#160; &#160; &#160; by * read<br/>
&#160; &#160; # immediate children: only self can add/delete entries under this entry<br/>
&#160; &#160; access to attrs=children<br/>
&#160; &#160; &#160; by self write<br/>
&#160; &#160; # entry itself: self may write, all may read<br/>
&#160; &#160; access to attrs=entry<br/>
&#160; &#160; &#160; by self write<br/>
&#160; &#160; &#160; by * read<br/>
&#160; &#160; # other attributes: self may write, others have no access<br/>
&#160; &#160; access to *<br/>
&#160; &#160; &#160; by self write<br/>
&#160; &#160; &#160; by * none<br/>
ObjectClass names may also be specified in this list, which will affect all the attributes that are required<br/>and/or allowed by that<i>&#160;objectClass</i>. Actually, names in<i>&#160;attrlist</i>&#160;that are prefixed by<i>&#160;@</i>&#160;are directly treated as<br/>objectClass names. A name prefixed by<i>&#160;!</i>&#160;is also treated as an objectClass, but in this case the access rule<br/>affects the attributes that are not required nor allowed by that<i>&#160;objectClass</i>.<br/>
<b>8.4.6. Allowing a user write to all entries below theirs</b><br/>
For a setup where a user can write to its own record and to all of its children:<br/>
&#160; &#160; access to dn.regex=&#34;(.+,)?(uid=[^,]+,o=Company)$&#34;<br/>
&#160; &#160; &#160; &#160;by dn.exact,expand=&#34;$2&#34; write<br/>
&#160; &#160; &#160; &#160;by anonymous auth<br/>
(Add more examples for above)<br/>
71<br/>
<hr/>
<a name=86></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
<b>8.4.7. Allowing entry creation</b><br/>
Let's say, you have it like this:<br/>
&#160; &#160; &#160; &#160; o=&lt;basedn&gt;<br/>
&#160; &#160; &#160; &#160; &#160; &#160; ou=domains<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; associatedDomain=&lt;somedomain&gt;<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ou=users<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; uid=&lt;someuserid&gt;<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; uid=&lt;someotheruserid&gt;<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ou=addressbooks<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; uid=&lt;someuserid&gt;<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; cn=&lt;someone&gt;<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; cn=&lt;someoneelse&gt;<br/>
and, for another domain &lt;someotherdomain&gt;:<br/>
&#160; &#160; &#160; &#160; o=&lt;basedn&gt;<br/>
&#160; &#160; &#160; &#160; &#160; &#160; ou=domains<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; associatedDomain=&lt;someotherdomain&gt;<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ou=users<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; uid=&lt;someuserid&gt;<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; uid=&lt;someotheruserid&gt;<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ou=addressbooks<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; uid=&lt;someotheruserid&gt;<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; cn=&lt;someone&gt;<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; cn=&lt;someoneelse&gt;<br/>
then, if you wanted user<i>&#160;uid=&lt;someuserid&gt;</i>&#160;to<b>&#160;ONLY</b>&#160;create an entry for its own thing, you could write an<br/>ACL like this:<br/>
&#160; &#160; # this rule lets users of &#34;associatedDomain=&lt;matcheddomain&gt;&#34;<br/>
&#160; &#160; # write under &#34;ou=addressbook,associatedDomain=&lt;matcheddomain&gt;,ou=domains,o=&lt;basedn&gt;&#34;,<br/>
&#160; &#160; # i.e. a user can write ANY entry below its domain's address book;<br/>
&#160; &#160; # this permission is necessary, but not sufficient, the next<br/>
&#160; &#160; # will restrict this permission further<br/>
&#160; &#160; access to dn.regex=&#34;^ou=addressbook,associatedDomain=([^,]+),ou=domains,o=&lt;basedn&gt;$&#34; attrs=children<br/>
&#160; &#160; &#160; &#160; &#160; &#160; by dn.regex=&#34;^uid=([^,]+),ou=users,associatedDomain=$1,ou=domains,o=&lt;basedn&gt;$$&#34; write<br/>
&#160; &#160; &#160; &#160; &#160; &#160; by * none<br/>
&#160; &#160; # Note that above the &#34;by&#34; clause needs a &#34;regex&#34; style to make sure<br/>
&#160; &#160; # it expands to a DN that starts with a &#34;uid=&lt;someuserid&gt;&#34; pattern<br/>
&#160; &#160; # while substituting the associatedDomain submatch from the &#34;what&#34; clause.<br/>
&#160; &#160; # This rule lets a user with &#34;uid=&lt;matcheduid&gt;&#34; of &#34;&lt;associatedDomain=matcheddomain&gt;&#34;<br/>
&#160; &#160; # write (i.e. add, modify, delete) the entry whose DN is exactly<br/>
&#160; &#160; # &#34;uid=&lt;matcheduid&gt;,ou=addressbook,associatedDomain=&lt;matcheddomain&gt;,ou=domains,o=&lt;basedn&gt;&#34;<br/>
&#160; &#160; # and ANY entry as subtree of it<br/>
&#160; &#160; access to dn.regex=&#34;^(.+,)?uid=([^,]+),ou=addressbook,associatedDomain=([^,]+),ou=domains,o=&lt;basedn&gt;$&#34;<br/>
&#160; &#160; &#160; &#160; &#160; &#160; by dn.exact,expand=&#34;uid=$2,ou=users,associatedDomain=$3,ou=domains,o=&lt;basedn&gt;&#34; write<br/>
&#160; &#160; &#160; &#160; &#160; &#160; by * none<br/>
72<br/>
<hr/>
<a name=87></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
&#160; &#160; # Note that above the &#34;by&#34; clause uses the &#34;exact&#34; style with the &#34;expand&#34;<br/>
&#160; &#160; # modifier because now the whole pattern can be rebuilt by means of the<br/>
&#160; &#160; # submatches from the &#34;what&#34; clause, so a &#34;regex&#34; compilation and evaluation<br/>
&#160; &#160; # is no longer required.<br/>
<b>8.4.8. Tips for using regular expressions in Access Control</b><br/>
Always use<i>&#160;dn.regex=&lt;pattern&gt;</i>&#160;when you intend to use regular expression matching.<i>&#160;dn=&lt;pattern&gt;</i>&#160;alone<br/>defaults to<i>&#160;dn.exact&lt;pattern&gt;</i>.<br/>
Use<i>&#160;(.+)</i>&#160;instead of<i>&#160;(.*)</i>&#160;when you want at least one char to be matched.<i>&#160;(.*)</i>&#160;matches the empty string as well.<br/>
Don't use regular expressions for matches that can be done otherwise in a safer and cheaper manner.<br/>Examples:<br/>
&#160; &#160; dn.regex=&#34;.*dc=example,dc=com&#34;<br/>
is unsafe and expensive:<br/>
unsafe because any string containing<br/>
&#160;<br/>
<i>&#160;dc=example,dc=com</i>&#160;will match, not only those that end with<br/>
the desired pattern; use<i>&#160;.*dc=example,dc=com$</i>&#160;instead.<br/>unsafe also because it would allow any<br/>
&#160;<br/>
<i>&#160;attributeType</i>&#160;ending with<i>&#160;dc</i>&#160;as naming attribute for the first<br/>
RDN in the string, e.g. a custom attributeType<i>&#160;mydc</i>&#160;would match as well. If you really need a regular<br/>expression that allows just<i>&#160;dc=example,dc=com</i>&#160;or any of its subtrees, use<br/><i>^(.+,)?dc=example,dc=com$</i>, which means: anything to the left of dc=..., if any (the question mark<br/>after the pattern within brackets), must end with a comma;<br/>expensive because if you don't need submatches, you could use scoping styles, e.g.<br/>
&#160;<br/>
&#160; &#160; dn.subtree=&#34;dc=example,dc=com&#34;<br/>
to include<i>&#160;dc=example,dc=com</i>&#160;in the matching patterns,<br/>
&#160; &#160; dn.children=&#34;dc=example,dc=com&#34;<br/>
to exclude<i>&#160;dc=example,dc=com</i>&#160;from the matching patterns, or<br/>
&#160; &#160; dn.onelevel=&#34;dc=example,dc=com&#34;<br/>
to allow exactly one sublevel matches only.<br/>
Always use<i>&#160;^</i>&#160;and<i>&#160;$</i>&#160;in regexes, whenever appropriate, because<i>&#160;ou=(.+),ou=(.+),ou=addressbooks,o=basedn<br/></i>will match<br/><i>something=bla,ou=xxx,ou=yyy,ou=addressbooks,o=basedn,ou=addressbooks,o=basedn,dc=some,dc=org</i><br/>
Always use<i>&#160;([^,]+)</i>&#160;to indicate exactly one RDN, because<i>&#160;(.+)</i>&#160;can include any number of RDNs; e.g.<br/><i>ou=(.+),dc=example,dc=com</i>&#160;will match<i>&#160;ou=My,o=Org,dc=example,dc=com</i>, which might not be what you<br/>want.<br/>
Never add the rootdn to the by clauses. ACLs are not even processed for operations performed with rootdn<br/>identity (otherwise there would be no reason to define a rootdn at all).<br/>
73<br/>
<hr/>
<a name=88></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
Use shorthands. The user directive matches authenticated users and the anonymous directive matches<br/>anonymous users.<br/>
Don't use the<i>&#160;dn.regex</i>&#160;form for &lt;by&gt; clauses if all you need is scoping and/or substring replacement; use<br/>scoping styles (e.g.<i>&#160;exact</i>,<i>&#160;onelevel</i>,<i>&#160;children</i>&#160;or<i>&#160;subtree</i>) and the style modifier expand to cause substring<br/>expansion.<br/>
For instance,<br/>
&#160; &#160; access to dn.regex=&#34;.+,dc=([^,]+),dc=([^,]+)$&#34;<br/>
&#160; &#160; &#160; by dn.regex=&#34;^[^,],ou=Admin,dc=$1,dc=$2$$&#34; write<br/>
although correct, can be safely and efficiently replaced by<br/>
&#160; &#160; access to dn.regex=&#34;.+,(dc=[^,]+,dc=[^,]+)$&#34;<br/>
&#160; &#160; &#160; by dn.onelevel,expand=&#34;ou=Admin,$1&#34; write<br/>
where the regex in the<i>&#160;&lt;what&gt;</i>&#160;clause is more compact, and the one in the<i>&#160;&lt;by&gt;</i>&#160;clause is replaced by a much<br/>more efficient scoping style of onelevel with substring expansion.<br/>
<b>8.4.9. Granting and Denying access based on security strength factors (ssf)</b><br/>
You can restrict access based on the security strength factor (SSF)<br/>
&#160; &#160; access to dn=&#34;cn=example,cn=edu&#34;<br/>
&#160; &#160; &#160; &#160; &#160; by * ssf=256 read<br/>
0 (zero) implies no protection, 1 implies integrity protection only, 56 DES or other weak ciphers, 112 triple<br/>DES and other strong ciphers, 128 RC4, Blowfish and other modern strong ciphers.<br/>
Other possibilities:<br/>
&#160; &#160; transport_ssf=&lt;n&gt;<br/>
&#160; &#160; tls_ssf=&lt;n&gt;<br/>
&#160; &#160; sasl_ssf=&lt;n&gt;<br/>
256 is recommended.<br/>
See<i>&#160;slapd.conf</i>(5) for information on<i>&#160;ssf</i>.<br/>
<b>8.4.10. When things aren't working as expected</b><br/>
Consider this example:<br/>
&#160; &#160; access to *<br/>
&#160; &#160; &#160; by anonymous auth<br/>
&#160; &#160; access to *<br/>
&#160; &#160; &#160; by self write<br/>
&#160; &#160; access to *<br/>
&#160; &#160; &#160; by users read<br/>
74<br/>
<hr/>
<a name=89></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
You may think this will allow any user to login, to read everything and change his own data if he is logged in.<br/>But in this example only the login works and an ldapsearch returns no data. The Problem is that SLAPD goes<br/>through its access config line by line and stops as soon as it finds a match in the part of the access rule.(here:<br/><i>to *</i>)<br/>
To get what we wanted the file has to read:<br/>
&#160; &#160; access to *<br/>
&#160; &#160; &#160; by anonymous auth<br/>
&#160; &#160; &#160; by self write<br/>
&#160; &#160; &#160; by users read<br/>
The general rule is: &#34;special access rules first, generic access rules last&#34;<br/>
See also<i>&#160;slapd.access</i>(5), loglevel 128 and<i>&#160;slapacl</i>(8) for debugging information.<br/>
<b>8.5. Sets - Granting rights based on relationships</b><br/>
Sets are best illustrated via examples. The following sections will present a few set ACL examples in order to<br/>facilitate their understanding.<br/>
<a href="http://www.openldap.org/faq/data/cache/1133.html">(Sets in Access Controls FAQ Entry: http://www.openldap.org/faq/data/cache/1133.html)</a><br/>
<b>Note:</b>&#160;Sets are considered experimental.<br/>
<b>8.5.1. Groups of Groups</b><br/>
The OpenLDAP ACL for groups doesn't expand groups within groups, which are groups that have another<br/>group as a member. For example:<br/>
&#160;dn: cn=sudoadm,ou=group,dc=example,dc=com<br/>
&#160;cn: sudoadm<br/>
&#160;objectClass: groupOfNames<br/>
&#160;member: uid=john,ou=people,dc=example,dc=com<br/>
&#160;member: cn=accountadm,ou=group,dc=example,dc=com<br/>
&#160;dn: cn=accountadm,ou=group,dc=example,dc=com<br/>
&#160;cn: accountadm<br/>
&#160;objectClass: groupOfNames<br/>
&#160;member: uid=mary,ou=people,dc=example,dc=com<br/>
If we use standard group ACLs with the above entries and allow members of the&#160;sudoadm&#160;group to write<br/>somewhere,&#160;mary&#160;won't be included:<br/>
&#160;access to dn.subtree=&#34;ou=sudoers,dc=example,dc=com&#34;<br/>
&#160; &#160; &#160; &#160; &#160;by group.exact=&#34;cn=sudoadm,ou=group,dc=example,dc=com&#34; write<br/>
&#160; &#160; &#160; &#160; &#160;by * read<br/>
With sets we can make the ACL be recursive and consider group within groups. So for each member that is a<br/>group, it is further expanded:<br/>
&#160;access to dn.subtree=&#34;ou=sudoers,dc=example,dc=com&#34;<br/>
&#160; &#160; &#160; &#160;by set=&#34;[cn=sudoadm,ou=group,dc=example,dc=com]/member* &amp; user&#34; write<br/>
75<br/>
<hr/>
<a name=90></a><img src="../img/OpenLDAP-Admin-Guide-90_1.png"/><br/>
OpenLDAP Software 2.4 Administrator's Guide<br/>
&#160; &#160; &#160; &#160;by * read<br/>
This set ACL means: take the&#160;cn=sudoadm&#160;DN, check its&#160;member&#160;attribute(s) (where the &#34;*&#34; means<br/>recursively) and intersect the result with the authenticated user's DN. If the result is non-empty, the ACL is<br/>considered a match and write access is granted.<br/>
The following drawing explains how this set is built:<br/>
Figure X.Y: Populating a recursive group set<br/>
First we get the&#160;uid=john&#160;DN. This entry doesn't have a&#160;member&#160;attribute, so the expansion stops here.<br/>Now we get to&#160;cn=accountadm. This one does have a&#160;member&#160;attribute, which is&#160;uid=mary. The<br/>uid=mary&#160;entry, however, doesn't have member, so we stop here again. The end comparison is:<br/>
&#160;{&#34;uid=john,ou=people,dc=example,dc=com&#34;,&#34;uid=mary,ou=people,dc=example,dc=com&#34;} &amp; user<br/>
If the authenticated user's DN is any one of those two, write access is granted. So this set will include&#160;mary&#160;in<br/>the&#160;sudoadm&#160;group and she will be allowed the write access.<br/>
<b>8.5.2. Group ACLs without DN syntax</b><br/>
The traditional group ACLs, and even the previous example about recursive groups, require that the members<br/>are specified as DNs instead of just usernames.<br/>
With sets, however, it's also possible to use simple names in group ACLs, as this example will show.<br/>
Let's say we want to allow members of the&#160;sudoadm&#160;group to write to the&#160;ou=suders&#160;branch of our tree.<br/>But our group definition now is using&#160;memberUid&#160;for the group members:<br/>
&#160;dn: cn=sudoadm,ou=group,dc=example,dc=com<br/>
&#160;cn: sudoadm<br/>
&#160;objectClass: posixGroup<br/>
&#160;gidNumber: 1000<br/>
&#160;memberUid: john<br/>
With this type of group, we can't use group ACLs. But with a set ACL we can grant the desired access:<br/>
&#160;access to dn.subtree=&#34;ou=sudoers,dc=example,dc=com&#34;<br/>
&#160; &#160; &#160; &#160;by set=&#34;[cn=sudoadm,ou=group,dc=example,dc=com]/memberUid &amp; user/uid&#34; write<br/>
&#160; &#160; &#160; &#160;by * read<br/>
76<br/>
<hr/>
<a name=91></a><img src="../img/OpenLDAP-Admin-Guide-91_1.png"/><br/>
OpenLDAP Software 2.4 Administrator's Guide<br/>
We use a simple intersection where we compare the&#160;uid&#160;attribute of the connecting (and authenticated) user<br/>with the&#160;memberUid&#160;attributes of the group. If they match, the intersection is non-empty and the ACL will<br/>grant write access.<br/>
This drawing illustrates this set when the connecting user is authenticated as<br/>uid=john,ou=people,dc=example,dc=com:<br/>
Figure X.Y: Sets with&#160;memberUid<br/>
In this case, it's a match. If it were&#160;mary&#160;authenticating, however, she would be denied write access to<br/>ou=sudoers&#160;because her&#160;uid&#160;attribute is not listed in the group's&#160;memberUid.<br/>
<b>8.5.3. Following references</b><br/>
We will now show a quite powerful example of what can be done with sets. This example tends to make<br/>OpenLDAP administrators smile after they have understood it and its implications.<br/>
Let's start with an user entry:<br/>
&#160;dn: uid=john,ou=people,dc=example,dc=com<br/>
&#160;uid: john<br/>
&#160;objectClass: inetOrgPerson<br/>
&#160;givenName: John<br/>
&#160;sn: Smith<br/>
&#160;cn: john<br/>
&#160;manager: uid=mary,ou=people,dc=example,dc=com<br/>
Writing an ACL to allow the manager to update some attributes is quite simple using sets:<br/>
&#160;access to dn.exact=&#34;uid=john,ou=people,dc=example,dc=com&#34;<br/>
&#160; &#160; attrs=carLicense,homePhone,mobile,pager,telephoneNumber<br/>
&#160; &#160; by self write<br/>
&#160; &#160; by set=&#34;this/manager &amp; user&#34; write<br/>
&#160; &#160; by * read<br/>
In that set,&#160;this&#160;expands to the entry being accessed, so that&#160;this/manager&#160;expands to<br/>uid=mary,ou=people,dc=example,dc=com&#160;when john's entry is accessed. If the manager herself is<br/>accessing John's entry, the ACL will match and write access to those attributes will be granted.<br/>
So far, this same behavior can be obtained with the&#160;dnattr&#160;keyword. With sets, however, we can further<br/>enhance this ACL. Let's say we want to allow the secretary of the manager to also update these attributes. This<br/>is how we do it:<br/>
&#160;access to dn.exact=&#34;uid=john,ou=people,dc=example,dc=com&#34;<br/>
&#160; &#160; attrs=carLicense,homePhone,mobile,pager,telephoneNumber<br/>
77<br/>
<hr/>
<a name=92></a><img src="../img/OpenLDAP-Admin-Guide-92_1.png"/><br/>
OpenLDAP Software 2.4 Administrator's Guide<br/>
&#160; &#160; by self write<br/>
&#160; &#160; by set=&#34;this/manager &amp; user&#34; write<br/>
&#160; &#160; by set=&#34;this/manager/secretary &amp; user&#34; write<br/>
&#160; &#160; by * read<br/>
Now we need a picture to help explain what is happening here (entries shortened for clarity):<br/>
Figure X.Y: Sets jumping through entries<br/>
In this example, Jane is the secretary of Mary, which is the manager of John. This whole relationship is<br/>defined with the&#160;manager&#160;and&#160;secretary&#160;attributes, which are both of the distinguishedName syntax (i.e.,<br/>full DNs). So, when the&#160;uid=john&#160;entry is being accessed, the&#160;this/manager/secretary&#160;set<br/>becomes&#160;{&#34;uid=jane,ou=people,dc=example,dc=com&#34;} (follow the references in the picture):<br/>
&#160;this = [uid=john,ou=people,dc=example,dc=com]<br/>
&#160;this/manager = \<br/>
&#160; &#160;[uid=john,ou=people,dc=example,dc=com]/manager = uid=mary,ou=people,dc=example,dc=com<br/>
&#160;this/manager/secretary = \<br/>
&#160; &#160;[uid=mary,ou=people,dc=example,dc=com]/secretary = uid=jane,ou=people,dc=example,dc=com<br/>
The end result is that when Jane accesses John's entry, she will be granted write access to the specified<br/>attributes. Better yet, this will happen to any entry she accesses which has Mary as the manager.<br/>
This is all cool and nice, but perhaps gives too much power to secretaries. Maybe we need to further restrict it.<br/>For example, let's only allow executive secretaries to have this power:<br/>
&#160;access to dn.exact=&#34;uid=john,ou=people,dc=example,dc=com&#34;<br/>
&#160; &#160;attrs=carLicense,homePhone,mobile,pager,telephoneNumber<br/>
&#160; &#160;by self write<br/>
&#160; &#160;by set=&#34;this/manager &amp; user&#34; write<br/>
&#160; &#160;by set=&#34;this/manager/secretary &amp;<br/>
&#160; &#160; &#160; &#160; &#160; &#160;[cn=executive,ou=group,dc=example,dc=com]/member* &amp;<br/>
&#160; &#160; &#160; &#160; &#160; &#160;user&#34; write<br/>
&#160; &#160;by * read<br/>
It's almost the same ACL as before, but we now also require that the connecting user be a member of the<br/>(possibly nested)&#160;cn=executive&#160;group.<br/>
78<br/>
<hr/>
<a name=93></a><b>9. Limits</b><br/>
<b>9.1. Introduction</b><br/>
It is usually desirable to limit the server resources that can be consumed by each LDAP client. OpenLDAP<br/>provides two sets of limits: a size limit, which can restrict the<i>&#160;number</i>&#160;of entries that a client can retrieve in a<br/>single operation, and a time limit which restricts the length of time that an operation may continue. Both types<br/>of limit can be given different values depending on who initiated the operation.<br/>
<b>9.2. Soft and Hard limits</b><br/>
The server administrator can specify both<i>&#160;soft limits</i>&#160;and<i>&#160;hard limits</i>. Soft limits can be thought of as being the<br/>default limit value. Hard limits cannot be exceeded by ordinary LDAP users.<br/>
LDAP clients can specify their own size and time limits when issuing search operations. This feature has been<br/>present since the earliest version of X.500.<br/>
If the client specifies a limit then the lower of the requested value and the<i>&#160;hard limit</i>&#160;will become the limit for<br/>the operation.<br/>
If the client does not specify a limit then the server applies the<i>&#160;soft limit</i>.<br/>
Soft and Hard limits are often referred to together as<i>&#160;administrative limits</i>. Thus, if an LDAP client requests a<br/>search that would return more results than the limits allow it will get an<i>&#160;adminLimitExceeded</i>&#160;error. Note that<br/>the server will usually return some results even if the limit has been exceeded: this feature is useful to clients<br/>that just want to check for the existence of some entries without needing to see them all.<br/>
The<i>&#160;rootdn</i>&#160;is not subject to any limits.<br/>
<b>9.3. Global Limits</b><br/>
Limits specified in the global part of the server configuration act as defaults which are used if no database has<br/>more specific limits set.<br/>
In a<i>&#160;slapd.conf</i>(5) configuration the keywords are&#160;sizelimit&#160;and&#160;timelimit. When using the<i>&#160;slapd<br/>config</i>&#160;backend, the corresponding attributes are&#160;olcSizeLimit&#160;and&#160;olcTimeLimit. The syntax of these<br/>values are the same in both cases.<br/>
The simple form sets both soft and hard limits to the same value:<br/>
&#160; &#160;sizelimit {&lt;integer&gt;|unlimited}<br/>
&#160; &#160;timelimit {&lt;integer&gt;|unlimited}<br/>
The default sizelimit is 500 entries and the default timelimit is 3600 seconds.<br/>
An extended form allows soft and hard limits to be set separately:<br/>
&#160; &#160;sizelimit size[.{soft|hard|unchecked}]=&lt;integer&gt; [...]<br/>
&#160; &#160;timelimit time[.{soft|hard}]=&lt;integer&gt; [...]<br/>
79<br/>
<hr/>
<a name=94></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
Thus, to set a soft sizelimit of 10 entries and a hard limit of 75 entries:<br/>
&#160; sizelimit size.soft=10 size.hard=75<br/>
The<i>&#160;unchecked</i>&#160;keyword sets a limit on how many entries the server will examine once it has created an initial<br/>set of candidate results by using indices. This can be very important in a large directory, as a search that<br/>cannot be satisfied from an index might cause the server to examine millions of entries, therefore always make<br/>sure the correct indexes are configured.<br/>
<b>9.4. Per-Database Limits</b><br/>
Each database can have its own set of limits that override the global ones. The syntax is more flexible, and it<br/>allows different limits to be applied to different entities. Note that an<i>&#160;entity</i>&#160;is different from an<i>&#160;entry</i>: the term<br/><i>entity</i>&#160;is used here to indicate the ID of the person or process that has initiated the LDAP operation.<br/>
In a<i>&#160;slapd.conf</i>(5) configuration the keyword is&#160;limits. When using the<i>&#160;slapd config</i>&#160;backend, the<br/>corresponding attribute is&#160;olcLimits. The syntax of the values is the same in both cases.<br/>
&#160; &#160;limits &lt;who&gt; &lt;limit&gt; [&lt;limit&gt; [...]]<br/>
The<i>&#160;limits</i>&#160;clause can be specified multiple times to apply different limits to different initiators. The server<br/>examines each clause in turn until it finds one that matches the ID that requested the operation. If no match is<br/>found, the global limits will be used.<br/>
<b>9.4.1. Specify who the limits apply to</b><br/>
The&#160;&lt;who&gt;&#160;part of the<i>&#160;limits</i>&#160;clause can take any of these values:<br/>
Table ZZZ.ZZZ: Entity Specifiers<br/>
<b>Specifier</b><br/>
<b>Entities</b><br/>
*<br/>
All, including anonymous and authenticated users<br/>
anonymous<br/>
Anonymous (non-authenticated) users<br/>
users<br/>
Authenticated users<br/>
self<br/>
User associated with target entry<br/>
dn[.&lt;basic-style&gt;]=&lt;regex&gt;&#160;Users matching a regular expression<br/>
dn.&lt;scope-style&gt;=&lt;DN&gt;<br/>
Users within scope of a DN<br/>
group[/oc[/at]]=&lt;pattern&gt;<br/>
Members of a group<br/>
The rules for specifying&#160;&lt;who&gt;&#160;are the same as those used in access-control rules.<br/>
<b>9.4.2. Specify time limits</b><br/>
The syntax for time limits is<br/>
&#160; &#160;time[.{soft|hard}]=&lt;integer&gt;<br/>
where integer is the number of seconds slapd will spend answering a search request.<br/>
If neither<i>&#160;soft</i>&#160;nor<i>&#160;hard</i>&#160;is specified, the value is used for both, e.g.:<br/>
80<br/>
<hr/>
<a name=95></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
&#160; &#160;limits anonymous time=27<br/>
The value<i>&#160;unlimited</i>&#160;may be used to remove the hard time limit entirely, e.g.:<br/>
&#160; &#160;limits dn.exact=&#34;cn=anyuser,dc=example,dc=org&#34; time.hard=unlimited<br/>
<b>9.4.3. Specifying size limits</b><br/>
The syntax for size limit is<br/>
&#160; &#160;size[.{soft|hard|unchecked}]=&lt;integer&gt;<br/>
where&#160;&lt;integer&gt;&#160;is the maximum number of entries slapd will return when answering a search request.<br/>
Soft, hard, and &#34;unchecked&#34; limits are available, with the same meanings described for the global limits<br/>configuration above.<br/>
<b>9.4.4. Size limits and Paged Results</b><br/>
If the LDAP client adds the<i>&#160;pagedResultsControl</i>&#160;to the search operation, the hard size limit is used by<br/>default, because the request for a specific page size is considered an explicit request for a limitation on the<br/>number of entries to be returned. However, the size limit applies to the total count of entries returned within<br/>the search, and not to a single page.<br/>
Additional size limits may be enforced for paged searches.<br/>
The&#160;size.pr&#160;limit controls the maximum page size:<br/>
&#160; &#160;size.pr={&lt;integer&gt;|noEstimate|unlimited}<br/>
&lt;integer&gt;&#160;is the maximum page size if no explicit size is set.&#160;noEstimate&#160;has no effect in the current<br/>implementation as the server does not return an estimate of the result size anyway.&#160;unlimited&#160;indicates that<br/>no limit is applied to the maximum page size.<br/>
The&#160;size.prtotal&#160;limit controls the total number of entries that can be returned by a paged search. By<br/>default the limit is the same as the normal&#160;size.hard&#160;limit.<br/>
&#160; &#160;size.prtotal={&lt;integer&gt;|unlimited|disabled}<br/>
unlimited&#160;removes the limit on the number of entries that can be returned by a paged search.&#160;disabled<br/>can be used to selectively disable paged result searches.<br/>
<b>9.5. Example Limit Configurations</b><br/>
<b>9.5.1. Simple Global Limits</b><br/>
This simple global configuration fragment applies size and time limits to all searches by all users except<br/><i>rootdn</i>. It limits searches to 50 results and sets an overall time limit of 10 seconds.<br/>
&#160; &#160;sizelimit 50<br/>
&#160; &#160;timelimit 10<br/>
81<br/>
<hr/>
<a name=96></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
<b>9.5.2. Global Hard and Soft Limits</b><br/>
It is sometimes useful to limit the size of result sets but to allow clients to request a higher limit where needed.<br/>This can be achieved by setting separate hard and soft limits.<br/>
&#160; &#160;sizelimit size.soft=5 size.hard=100<br/>
To prevent clients from doing very inefficient non-indexed searches, add the<i>&#160;unchecked</i>&#160;limit:<br/>
&#160; &#160;sizelimit size.soft=5 size.hard=100 size.unchecked=100<br/>
<b>9.5.3. Giving specific users larger limits</b><br/>
Having set appropriate default limits in the global configuration, you may want to give certain users the<br/>ability to retrieve larger result sets. Here is a way to do that in the per-database configuration:<br/>
&#160; &#160;limits dn.exact=&#34;cn=anyuser,dc=example,dc=org&#34; size=100000<br/>
&#160; &#160;limits dn.exact=&#34;cn=personnel,dc=example,dc=org&#34; size=100000<br/>
&#160; &#160;limits dn.exact=&#34;cn=dirsync,dc=example,dc=org&#34; size=100000<br/>
It is generally best to avoid mentioning specific users in the server configuration. A better way is to give the<br/>higher limits to a group:<br/>
&#160; &#160;limits group/groupOfNames/member=&#34;cn=bigwigs,dc=example,dc=org&#34; size=100000<br/>
<b>9.5.4. Limiting who can do paged searches</b><br/>
It may be required that certain applications need very large result sets that they retrieve using paged searches,<br/>but that you do not want ordinary LDAP users to use the pagedResults control. The<i>&#160;pr</i>&#160;and<i>&#160;prtotal</i>&#160;limits can<br/>help:<br/>
&#160; &#160;limits group/groupOfNames/member=&#34;cn=dirsync,dc=example,dc=org&#34; size.prtotal=unlimited<br/>
&#160; &#160;limits users size.soft=5 size.hard=100 size.prtotal=disabled<br/>
&#160; &#160;limits anonymous size.soft=2 size.hard=5 size.prtotal=disabled<br/>
<b>9.6. Further Information</b><br/>
For further information please see<i>&#160;slapd.conf</i>(5),<i>&#160;ldapsearch</i>(1) and<i>&#160;slapd.access</i>(5)<br/>
82<br/>
<hr/>
<a name=97></a><b>10. Database Creation and Maintenance Tools</b><br/>
This section tells you how to create a slapd database from scratch, and how to do trouble shooting if you run<br/>into problems. There are two ways to create a database. First, you can create the database on-line using<br/>LDAP. With this method, you simply start up slapd and add entries using the LDAP client of your choice.<br/>This method is fine for relatively small databases (a few hundred or thousand entries, depending on your<br/>requirements). This method works for database types which support updates.<br/>
The second method of database creation is to do it off-line using special utilities provided with<i>&#160;slapd</i>(8). This<br/>method is best if you have many thousands of entries to create, which would take an unacceptably long time<br/>using the LDAP method, or if you want to ensure the database is not accessed while it is being created. Note<br/>that not all database types support these utilities.<br/>
<b>10.1. Creating a database over LDAP</b><br/>
With this method, you use the LDAP client of your choice (e.g., the<i>&#160;ldapadd</i>(1)) to add entries, just like you<br/>would once the database is created. You should be sure to set the following options in the configuration file<br/>before starting<i>&#160;slapd</i>(8).<br/>
&#160; &#160; &#160; &#160; suffix &lt;dn&gt;<br/>
<a href="OpenLDAP-Admin-Guides.html#61">As described in the General Database Directives section, this option defines which entries are to be held by<br/></a>this database. You should set this to the DN of the root of the subtree you are trying to create. For example:<br/>
&#160; &#160; &#160; &#160; suffix &#34;dc=example,dc=com&#34;<br/>
You should be sure to specify a directory where the index files should be created:<br/>
&#160; &#160; &#160; &#160; directory &lt;directory&gt;<br/>
For example:<br/>
&#160; &#160; &#160; &#160; directory /usr/local/var/openldap-data<br/>
You need to create this directory with appropriate permissions such that slapd can write to it.<br/>
You need to configure slapd so that you can connect to it as a directory user with permission to add entries.<br/>You can configure the directory to support a special<i>&#160;super-user</i>&#160;or<i>&#160;root</i>&#160;user just for this purpose. This is done<br/>through the following two options in the database definition:<br/>
&#160; &#160; &#160; &#160; rootdn &lt;dn&gt;<br/>
&#160; &#160; &#160; &#160; rootpw &lt;passwd&gt;<br/>
For example:<br/>
&#160; &#160; &#160; &#160; rootdn &#34;cn=Manager,dc=example,dc=com&#34;<br/>
&#160; &#160; &#160; &#160; rootpw secret<br/>
These options specify a DN and password that can be used to authenticate as the<i>&#160;super-user</i>&#160;entry of the<br/>database (i.e., the entry allowed to do anything). The DN and password specified here will always work,<br/>regardless of whether the entry named actually exists or has the password given. This solves the<br/>
83<br/>
<hr/>
<a name=98></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
chicken-and-egg problem of how to authenticate and add entries before any entries yet exist.<br/>
Finally, you should make sure that the database definition contains the index definitions you want:<br/>
&#160; &#160; &#160; &#160; index {&lt;attrlist&gt; | default} [pres,eq,approx,sub,none]<br/>
For example, to index the&#160;cn,&#160;sn,&#160;uid&#160;and&#160;objectclass&#160;attributes, the following&#160;index&#160;directives could<br/>be used:<br/>
&#160; &#160; &#160; &#160; index cn,sn,uid pres,eq,approx,sub<br/>
&#160; &#160; &#160; &#160; index objectClass eq<br/>
This would create presence, equality, approximate, and substring indices for the&#160;cn,&#160;sn, and&#160;uid&#160;attributes<br/>and an equality index for the&#160;objectClass&#160;attribute. Note that not all index types are available with all<br/><a href="OpenLDAP-Admin-Guides.html#57">attribute types. See The slapd Configuration File section for more information on this option.</a><br/>
Once you have configured things to your liking, start up slapd, connect with your LDAP client, and start<br/>adding entries. For example, to add an organization entry and an organizational role entry using the<i>&#160;ldapadd<br/></i>tool, you could create an LDIF file called&#160;entries.ldif&#160;with the contents:<br/>
&#160; &#160; &#160; &#160; # Organization for Example Corporation<br/>
&#160; &#160; &#160; &#160; dn: dc=example,dc=com<br/>
&#160; &#160; &#160; &#160; objectClass: dcObject<br/>
&#160; &#160; &#160; &#160; objectClass: organization<br/>
&#160; &#160; &#160; &#160; dc: example<br/>
&#160; &#160; &#160; &#160; o: Example Corporation<br/>
&#160; &#160; &#160; &#160; description: The Example Corporation<br/>
&#160; &#160; &#160; &#160; # Organizational Role for Directory Manager<br/>
&#160; &#160; &#160; &#160; dn: cn=Manager,dc=example,dc=com<br/>
&#160; &#160; &#160; &#160; objectClass: organizationalRole<br/>
&#160; &#160; &#160; &#160; cn: Manager<br/>
&#160; &#160; &#160; &#160; description: Directory Manager<br/>
and then use a command like this to actually create the entry:<br/>
&#160; &#160; &#160; &#160; ldapadd -f entries.ldif -x -D &#34;cn=Manager,dc=example,dc=com&#34; -w secret<br/>
The above command assumes settings provided in the above examples.<br/>
<b>10.2. Creating a database off-line</b><br/>
The second method of database creation is to do it off-line, using the slapd database tools described below.<br/>This method is best if you have many thousands of entries to create, which would take an unacceptably long<br/>time to add using the LDAP method described above. These tools read the slapd configuration file and an<br/>input file containing a text representation of the entries to add. For database types which support the tools,<br/>they produce the database files directly (otherwise you must use the on-line method above). There are several<br/>important configuration options you will want to be sure and set in the config file database definition first:<br/>
&#160; &#160; &#160; &#160; suffix &lt;dn&gt;<br/>
<a href="OpenLDAP-Admin-Guides.html#61">As described in the General Database Directives section, this option defines which entries are to be held by<br/></a>this database. You should set this to the DN of the root of the subtree you are trying to create. For example:<br/>
84<br/>
<hr/>
<a name=99></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
&#160; &#160; &#160; &#160; suffix &#34;dc=example,dc=com&#34;<br/>
You should be sure to specify a directory where the index files should be created:<br/>
&#160; &#160; &#160; &#160; directory &lt;directory&gt;<br/>
For example:<br/>
&#160; &#160; &#160; &#160; directory /usr/local/var/openldap-data<br/>
Finally, you need to specify which indices you want to build. This is done by one or more index options.<br/>
&#160; &#160; &#160; &#160; index {&lt;attrlist&gt; | default} [pres,eq,approx,sub,none]<br/>
For example:<br/>
&#160; &#160; &#160; &#160; index cn,sn,uid pres,eq,approx,sub<br/>
&#160; &#160; &#160; &#160; index objectClass eq<br/>
This would create presence, equality, approximate, and substring indices for the&#160;cn,&#160;sn, and&#160;uid&#160;attributes<br/>and an equality index for the&#160;objectClass&#160;attribute. Note that not all index types are available with all<br/><a href="OpenLDAP-Admin-Guides.html#57">attribute types. See The slapd Configuration File section for more information on this option.</a><br/>
<b>10.2.1. The&#160;slapadd&#160;program</b><br/>
Once you've configured things to your liking, you create the primary database and associated indices by<br/>running the<i>&#160;slapadd</i>(8) program:<br/>
&#160; &#160; &#160; &#160; slapadd -l &lt;inputfile&gt; -f &lt;slapdconfigfile&gt;<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; [-d &lt;debuglevel&gt;] [-n &lt;integer&gt;|-b &lt;suffix&gt;]<br/>
The arguments have the following meanings:<br/>
&#160; &#160; &#160; &#160; -l &lt;inputfile&gt;<br/>
<a href="OpenLDAP-Admin-Guides.html#100">Specifies the LDIF input file containing the entries to add in text form (described below in the The LDIF text<br/>entry format section).</a><br/>
&#160; &#160; &#160; &#160; -f &lt;slapdconfigfile&gt;<br/>
Specifies the slapd configuration file that tells where to create the indices, what indices to create, etc.<br/>
&#160; &#160; &#160; &#160; -F &lt;slapdconfdirectory&gt;<br/>
Specifies a config directory. If both&#160;-f&#160;and&#160;-F&#160;are specified, the config file will be read and converted to<br/>config directory format and written to the specified directory. If neither option is specified, an attempt to read<br/>the default config directory will be made before trying to use the default config file. If a valid config directory<br/>exists then the default config file is ignored. If dryrun mode is also specified, no conversion will occur.<br/>
&#160; &#160; &#160; &#160; -d &lt;debuglevel&gt;<br/>
Turn on debugging, as specified by&#160;&lt;debuglevel&gt;. The debug levels are the same as for slapd. See the<br/><a href="OpenLDAP-Admin-Guides.html#67">Command-Line Options section in Running slapd.</a><br/>
85<br/>
<hr/>
<a name=100></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
&#160; &#160; &#160; &#160; -n &lt;databasenumber&gt;<br/>
An optional argument that specifies which database to modify. The first database listed in the configuration<br/>file is&#160;1, the second&#160;2, etc. By default, the first database in the configuration file is used. Should not be used in<br/>conjunction with&#160;-b.<br/>
&#160; &#160; &#160; &#160; -b &lt;suffix&gt;<br/>
An optional argument that specifies which database to modify. The provided suffix is matched against a<br/>database&#160;suffix&#160;directive to determine the database number. Should not be used in conjunction with&#160;-n.<br/>
<b>10.2.2. The&#160;slapindex&#160;program</b><br/>
Sometimes it may be necessary to regenerate indices (such as after modifying<i>&#160;slapd.conf</i>(5)). This is possible<br/>using the<i>&#160;slapindex</i>(8) program.<i>&#160;slapindex</i>&#160;is invoked like this<br/>
&#160; &#160; &#160; &#160; slapindex -f &lt;slapdconfigfile&gt;<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; [-d &lt;debuglevel&gt;] [-n &lt;databasenumber&gt;|-b &lt;suffix&gt;]<br/>
Where the&#160;-f,&#160;-d,&#160;-n&#160;and&#160;-b&#160;options are the same as for the<i>&#160;slapadd</i>(1) program.<i>&#160;slapindex</i>&#160;rebuilds all<br/>indices based upon the current database contents.<br/>
<b>10.2.3. The&#160;slapcat&#160;program</b><br/>
The&#160;slapcat&#160;program is used to dump the database to an LDIF file. This can be useful when you want to<br/>make a human-readable backup of your database or when you want to edit your database off-line. The<br/>program is invoked like this:<br/>
&#160; &#160; &#160; &#160; slapcat -l &lt;filename&gt; -f &lt;slapdconfigfile&gt;<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; [-d &lt;debuglevel&gt;] [-n &lt;databasenumber&gt;|-b &lt;suffix&gt;]<br/>
where&#160;-n&#160;or&#160;-b&#160;is used to select the database in the<i>&#160;slapd.conf</i>(5) specified using&#160;-f. The corresponding<br/>LDIF output is written to standard output or to the file specified using the&#160;-l&#160;option.<br/>
<b>10.3. The LDIF text entry format</b><br/>
The LDAP Data Interchange Format (LDIF) is used to represent LDAP entries in a simple text format. This<br/>section provides a brief description of the LDIF entry format which complements<i>&#160;ldif</i>(5) and the technical<br/><a href="http://www.rfc-editor.org/rfc/rfc2849.txt">specification RFC2849.</a><br/>
The basic form of an entry is:<br/>
&#160; &#160; &#160; &#160; # comment<br/>
&#160; &#160; &#160; &#160; dn: &lt;distinguished name&gt;<br/>
&#160; &#160; &#160; &#160; &lt;attrdesc&gt;: &lt;attrvalue&gt;<br/>
&#160; &#160; &#160; &#160; &lt;attrdesc&gt;: &lt;attrvalue&gt;<br/>
&#160; &#160; &#160; &#160; ...<br/>
Lines starting with a '#' character are comments. An attribute description may be a simple attribute type like<br/>cn&#160;or&#160;objectClass&#160;or&#160;1.2.3&#160;(an OID associated with an attribute type) or may include options such as<br/>cn;lang_en_US&#160;or&#160;userCertificate;binary.<br/>
86<br/>
<hr/>
<a name=101></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
A line may be continued by starting the next line with a<i>&#160;single</i>&#160;space or tab character. For example:<br/>
&#160; &#160; &#160; &#160; dn: cn=Barbara J Jensen,dc=example,dc=<br/>
&#160; &#160; &#160; &#160; &#160;com<br/>
&#160; &#160; &#160; &#160; cn: Barbara J<br/>
&#160; &#160; &#160; &#160; &#160; Jensen<br/>
is equivalent to:<br/>
&#160; &#160; &#160; &#160; dn: cn=Barbara J Jensen,dc=example,dc=com<br/>
&#160; &#160; &#160; &#160; cn: Barbara J Jensen<br/>
Multiple attribute values are specified on separate lines. e.g.,<br/>
&#160; &#160; &#160; &#160; cn: Barbara J Jensen<br/>
&#160; &#160; &#160; &#160; cn: Babs Jensen<br/>
If an&#160;&lt;attrvalue&gt;&#160;contains non-printing characters or begins with a space, a colon (':'), or a less than ('&lt;'),<br/>the&#160;&lt;attrdesc&gt;&#160;is followed by a double colon and the base64 encoding of the value. For example, the<br/>value &#34;&#160;begins with a space&#34; would be encoded like this:<br/>
&#160; &#160; &#160; &#160; cn:: IGJlZ2lucyB3aXRoIGEgc3BhY2U=<br/>
You can also specify a URL containing the attribute value. For example, the following specifies the<br/>jpegPhoto&#160;value should be obtained from the file&#160;/path/to/file.jpeg.<br/>
&#160; &#160; &#160; &#160; cn:&lt; file:///path/to/file.jpeg<br/>
Multiple entries within the same LDIF file are separated by blank lines. Here's an example of an LDIF file<br/>containing three entries.<br/>
&#160; &#160; &#160; &#160; # Barbara's Entry<br/>
&#160; &#160; &#160; &#160; dn: cn=Barbara J Jensen,dc=example,dc=com<br/>
&#160; &#160; &#160; &#160; cn: Barbara J Jensen<br/>
&#160; &#160; &#160; &#160; cn: Babs Jensen<br/>
&#160; &#160; &#160; &#160; objectClass: person<br/>
&#160; &#160; &#160; &#160; sn: Jensen<br/>
&#160; &#160; &#160; &#160; # Bjorn's Entry<br/>
&#160; &#160; &#160; &#160; dn: cn=Bjorn J Jensen,dc=example,dc=com<br/>
&#160; &#160; &#160; &#160; cn: Bjorn J Jensen<br/>
&#160; &#160; &#160; &#160; cn: Bjorn Jensen<br/>
&#160; &#160; &#160; &#160; objectClass: person<br/>
&#160; &#160; &#160; &#160; sn: Jensen<br/>
&#160; &#160; &#160; &#160; # Base64 encoded JPEG photo<br/>
&#160; &#160; &#160; &#160; jpegPhoto:: /9j/4AAQSkZJRgABAAAAAQABAAD/2wBDABALD<br/>
&#160; &#160; &#160; &#160; &#160;A4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQ<br/>
&#160; &#160; &#160; &#160; &#160;ERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVG<br/>
&#160; &#160; &#160; &#160; # Jennifer's Entry<br/>
&#160; &#160; &#160; &#160; dn: cn=Jennifer J Jensen,dc=example,dc=com<br/>
&#160; &#160; &#160; &#160; cn: Jennifer J Jensen<br/>
&#160; &#160; &#160; &#160; cn: Jennifer Jensen<br/>
&#160; &#160; &#160; &#160; objectClass: person<br/>
&#160; &#160; &#160; &#160; sn: Jensen<br/>
&#160; &#160; &#160; &#160; # JPEG photo from file<br/>
&#160; &#160; &#160; &#160; jpegPhoto:&lt; file:///path/to/file.jpeg<br/>
87<br/>
<hr/>
<a name=102></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
Notice that the&#160;jpegPhoto&#160;in Bjorn's entry is base 64 encoded and the&#160;jpegPhoto&#160;in Jennifer's entry is<br/>obtained from the location indicated by the URL.<br/>
<b>Note:</b>&#160;Trailing spaces are not trimmed from values in an LDIF file. Nor are multiple internal spaces<br/>compressed. If you don't want them in your data, don't put them there.<br/>
88<br/>
<hr/>
<a name=103></a><b>11. Backends</b><br/>
Backends do the actual work of storing or retrieving data in response to LDAP requests. Backends may be<br/>compiled statically into<i>&#160;slapd</i>, or when module support is enabled, they may be dynamically loaded.<br/>
If your installation uses dynamic modules, you may need to add the relevant<i>&#160;moduleload</i>&#160;directives to the<br/>examples that follow. The name of the module for a backend is usually of the form:<br/>
&#160; &#160; &#160; &#160; back_&lt;backend name&gt;.la<br/>
So for example, if you need to load the<i>&#160;hdb</i>&#160;backend, you would configure<br/>
&#160; &#160; &#160; &#160; moduleload back_hdb.la<br/>
<b>11.1. Berkeley DB Backends</b><br/>
<b>11.1.1. Overview</b><br/>
The<i>&#160;hdb</i>&#160;backend to<i>&#160;slapd</i>(8) is the recommended primary backend for a normal<i>&#160;slapd</i>&#160;database. It uses the<br/>Oracle Berkeley DB (BDB) package to store data. It makes extensive use of indexing and caching (see the<br/><a href="OpenLDAP-Admin-Guides.html#209">Tuning section) to speed data access.</a><br/>
<i>hdb</i>&#160;is a variant of the original<i>&#160;bdb</i>&#160;backend which was first written for use with BDB.<i>&#160;hdb</i>&#160;uses a hierarchical<br/>database layout which supports subtree renames. It is otherwise identical to the<i>&#160;bdb</i>&#160;behavior, and all the same<br/>configuration options apply.<br/>
<b>Note:</b>&#160;An<i>&#160;hdb</i>&#160;database needs a large<i>&#160;idlcachesize</i>&#160;for good search performance, typically three times the<br/><i>cachesize</i>&#160;(entry cache size) or larger.<br/>
<b>Note:</b>&#160;The<i>&#160;hdb</i>&#160;backend has superseded the<i>&#160;bdb</i>&#160;backend, and both will soon be deprecated in favor of the new<br/><i>mdb</i>&#160;backend. See below.<br/>
<b>11.1.2. back-bdb/back-hdb Configuration</b><br/>
MORE LATER<br/>
<b>11.1.3. Further Information</b><br/>
<i>slapd-bdb</i>(5)<br/>
<b>11.2. LDAP</b><br/>
<b>11.2.1. Overview</b><br/>
The LDAP backend to<i>&#160;slapd</i>(8) is not an actual database; instead it acts as a proxy to forward incoming<br/>requests to another LDAP server. While processing requests it will also chase referrals, so that referrals are<br/>fully processed instead of being returned to the<i>&#160;slapd</i>&#160;client.<br/>
89<br/>
<hr/>
<a name=104></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
Sessions that explicitly<i>&#160;Bind</i>&#160;to the<i>&#160;back-ldap</i>&#160;database always create their own private connection to the<br/>remote LDAP server. Anonymous sessions will share a single anonymous connection to the remote server.<br/>For sessions bound through other mechanisms, all sessions with the same DN will share the same connection.<br/>This connection pooling strategy can enhance the proxy's efficiency by reducing the overhead of repeatedly<br/>making/breaking multiple connections.<br/>
The ldap database can also act as an information service, i.e. the identity of locally authenticated clients is<br/>asserted to the remote server, possibly in some modified form. For this purpose, the proxy binds to the remote<br/>server with some administrative identity, and, if required, authorizes the asserted identity.<br/>
<a href="OpenLDAP-Admin-Guides.html#204">It is heavily used by a lot of other Backends and Overlays.</a><br/>
<b>11.2.2. back-ldap Configuration</b><br/>
As previously mentioned,<i>&#160;slapd-ldap(5)</i><a href="OpenLDAP-Admin-Guides.html#204">&#160;is used behind the scenes by many other Backends and Overlays.<br/></a>Some of them merely provide a few configuration directive themselves, but have available to the<br/>administrator the whole of the<i>&#160;slapd-ldap(5)</i>&#160;options.<br/>
<a href="OpenLDAP-Admin-Guides.html#135">For example, the Translucent Proxy, which retrieves entries from a remote LDAP server that can be partially<br/></a>overridden by the defined database, has only four specific<i>&#160;translucent-</i>&#160;directives, but can be configured using<br/>any of the normal<i>&#160;slapd-ldap(5)</i>&#160;options. See {[slapo-translucent(5)}} for details.<br/>
<a href="OpenLDAP-Admin-Guides.html#239">Other Overlays allow you to tag directives in front of a normal</a><i>&#160;slapd-ldap(5)</i>&#160;directive. For example, the<br/><i>slapo-chain(5)</i>&#160;overlay does this:<br/>
<i>&#34;There are very few chain overlay specific directives; however, directives related to the instances of the ldap<br/>backend that may be implicitly instantiated by the overlay may assume a special meaning when used in<br/>conjunction with this overlay. They are described in slapd-ldap(5), and they also need to be prefixed by<br/>chain-.&#34;</i><br/>
You may have also seen the<i>&#160;slapd-ldap(5)</i><a href="">&#160;backend used and described in the Push Based Replication section<br/></a>of the guide.<br/>
It should therefore be obvious that the<i>&#160;slapd-ldap(5)</i>&#160;backend is extremely flexible and heavily used<br/>throughout the OpenLDAP Suite.<br/>
The following is a very simple example, but already the power of the<i>&#160;slapd-ldap(5)</i>&#160;backend is seen by use of<br/>a<i>&#160;uri list</i>:<br/>
&#160; &#160; &#160; &#160; database &#160; &#160; &#160; &#160;ldap<br/>
&#160; &#160; &#160; &#160; suffix &#160; &#160; &#160; &#160; &#160;&#34;dc=suretecsystems,dc=com&#34;<br/>
&#160; &#160; &#160; &#160; rootdn &#160; &#160; &#160; &#160; &#160;&#34;cn=slapd-ldap&#34;<br/>
&#160; &#160; &#160; &#160; uri &#160; &#160; &#160; &#160; &#160; &#160; ldap://localhost/ ldap://remotehost ldap://remotehost2<br/>
The URI list is space or comma-separated. Whenever the server that responds is not the first one in the list, the<br/>list is rearranged and the responsive server is moved to the head, so that it will be first contacted the next time<br/>a connection needs be created.<br/>
<a href="OpenLDAP-Admin-Guides.html#182">This feature can be used to provide a form of load balancing when using MirrorMode replication.</a><br/>
90<br/>
<hr/>
<a name=105></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
<b>11.2.3. Further Information</b><br/>
<i>slapd-ldap</i>(5)<br/>
<b>11.3. LDIF</b><br/>
<b>11.3.1. Overview</b><br/>
The LDIF backend to<i>&#160;slapd</i>(8) is a basic storage backend that stores entries in text files in LDIF format, and<br/>exploits the filesystem to create the tree structure of the database. It is intended as a cheap, low performance<br/>easy to use backend.<br/>
When using the<i>&#160;cn=config</i>&#160;dynamic configuration database with persistent storage, the configuration data is<br/>stored using this backend. See<i>&#160;slapd-config</i>(5) for more information<br/>
<b>11.3.2. back-ldif Configuration</b><br/>
Like many other backends, the LDIF backend can be instantiated with very few configuration lines:<br/>
&#160; &#160; &#160; &#160; include ./schema/core.schema<br/>
&#160; &#160; &#160; &#160; database &#160;ldif<br/>
&#160; &#160; &#160; &#160; directory ./ldif<br/>
&#160; &#160; &#160; &#160; suffix &#160; &#160;&#34;dc=suretecsystems,dc=com&#34;<br/>
&#160; &#160; &#160; &#160; rootdn &#160; &#160;&#34;cn=LDIF,dc=suretecsystems,dc=com&#34;<br/>
&#160; &#160; &#160; &#160; rootpw &#160; &#160;LDIF<br/>
If we add the<i>&#160;dcObject</i>&#160;for<i>&#160;dc=suretecsystems,dc=com</i>, you can see how this is added behind the scenes on<br/>the file system:<br/>
&#160; &#160;dn: dc=suretecsystems,dc=com<br/>
&#160; &#160;objectClass: dcObject<br/>
&#160; &#160;objectClass: organization<br/>
&#160; &#160;dc: suretecsystems<br/>
&#160; &#160;o: Suretec Systems Ltd<br/>
Now we add it to the directory:<br/>
&#160; &#160;ldapadd -x -H ldap://localhost:9011 -f suretec.ldif -D &#34;cn=LDIF,dc=suretecsystems,dc=com&#34; -w LDIF<br/>
&#160; &#160;adding new entry &#34;dc=suretecsystems,dc=com&#34;<br/>
And inside&#160;./ldif&#160;we have:<br/>
&#160; &#160;ls ./ldif<br/>
&#160; &#160;dc=suretecsystems,dc=com.ldif<br/>
which again contains:<br/>
&#160; &#160;cat ldif/dc\=suretecsystems\,dc\=com.ldif<br/>
&#160; &#160;dn: dc=suretecsystems<br/>
&#160; &#160;objectClass: dcObject<br/>
&#160; &#160;objectClass: organization<br/>
91<br/>
<hr/>
<a name=106></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
&#160; &#160;dc: suretecsystems<br/>
&#160; &#160;o: Suretec Systems Ltd.<br/>
&#160; &#160;structuralObjectClass: organization<br/>
&#160; &#160;entryUUID: 2134b714-e3a1-102c-9a15-f96ee263886d<br/>
&#160; &#160;creatorsName: cn=LDIF,dc=suretecsystems,dc=com<br/>
&#160; &#160;createTimestamp: 20080711142643Z<br/>
&#160; &#160;entryCSN: 20080711142643.661124Z#000000#000#000000<br/>
&#160; &#160;modifiersName: cn=LDIF,dc=suretecsystems,dc=com<br/>
&#160; &#160;modifyTimestamp: 20080711142643Z<br/>
This is the complete format you would get when exporting your directory using&#160;slapcat&#160;etc.<br/>
<b>11.3.3. Further Information</b><br/>
<i>slapd-ldif</i>(5)<br/>
<b>11.4. LMDB</b><br/>
<b>11.4.1. Overview</b><br/>
The<i>&#160;mdb</i>&#160;backend to<i>&#160;slapd</i>(8) is the upcoming primary backend for a normal<i>&#160;slapd</i>&#160;database. It uses<br/>OpenLDAP's own Lightning Memory-Mapped Database (LMDB) library to store data and is intended to<br/>replace the Berkeley DB backends.<br/>
It supports indexing like the BDB backends, but it uses no caching and requires no tuning to deliver maximum<br/>search performance. Like<i>&#160;hdb</i>, it is also fully hierarchical and supports subtree renames in constant time.<br/>
<b>11.4.2. back-mdb Configuration</b><br/>
Unlike the BDB backends, the<i>&#160;mdb</i>&#160;backend can be instantiated with very few configuration lines:<br/>
&#160; &#160; &#160; &#160; include ./schema/core.schema<br/>
&#160; &#160; &#160; &#160; database &#160;mdb<br/>
&#160; &#160; &#160; &#160; directory ./mdb<br/>
&#160; &#160; &#160; &#160; suffix &#160; &#160;&#34;dc=suretecsystems,dc=com&#34;<br/>
&#160; &#160; &#160; &#160; rootdn &#160; &#160;&#34;cn=mdb,dc=suretecsystems,dc=com&#34;<br/>
&#160; &#160; &#160; &#160; rootpw &#160; &#160;mdb<br/>
&#160; &#160; &#160; &#160; maxsize &#160; 1073741824<br/>
In addition to the usual parameters that a minimal configuration requires, the<i>&#160;mdb</i>&#160;backend requires a<br/>maximum size to be set. This should be the largest that the database is ever anticipated to grow (in bytes). The<br/>filesystem must also provide enough free space to accommodate this size.<br/>
<b>11.4.3. Further Information</b><br/>
<i>slapd-mdb</i>(5)<br/>
<b>11.5. Metadirectory</b><br/>
92<br/>
<hr/>
<a name=107></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
<b>11.5.1. Overview</b><br/>
The meta backend to<i>&#160;slapd</i>(8) performs basic LDAP proxying with respect to a set of remote LDAP servers,<br/>called &#34;targets&#34;. The information contained in these servers can be presented as belonging to a single<br/>Directory Information Tree (DIT).<br/>
A basic knowledge of the functionality of the<i>&#160;slapd-ldap</i>(5) backend is recommended. This backend has been<br/>designed as an enhancement of the ldap backend. The two backends share many features (actually they also<br/>share portions of code). While the ldap backend is intended to proxy operations directed to a single server, the<br/>meta backend is mainly intended for proxying of multiple servers and possibly naming context masquerading.<br/>
These features, although useful in many scenarios, may result in excessive overhead for some applications, so<br/>its use should be carefully considered.<br/>
<b>11.5.2. back-meta Configuration</b><br/>
LATER<br/>
<b>11.5.3. Further Information</b><br/>
<i>slapd-meta</i>(5)<br/>
<b>11.6. Monitor</b><br/>
<b>11.6.1. Overview</b><br/>
The monitor backend to<i>&#160;slapd</i>(8) is not an actual database; if enabled, it is automatically generated and<br/>dynamically maintained by slapd with information about the running status of the daemon.<br/>
To inspect all monitor information, issue a subtree search with base<i>&#160;cn=Monitor</i>, requesting that attributes &#34;+&#34;<br/>and &#34;*&#34; are returned. The monitor backend produces mostly operational attributes, and LDAP only returns<br/>operational attributes that are explicitly requested. Requesting attribute &#34;+&#34; is an extension which requests all<br/>operational attributes.<br/>
<a href="OpenLDAP-Admin-Guides.html#201">See the Monitoring section.</a><br/>
<b>11.6.2. back-monitor Configuration</b><br/>
The monitor database can be instantiated only once, i.e. only one occurrence of &#34;database monitor&#34; can occur<br/>in the<i>&#160;slapd.conf(5)</i>&#160;file. Also the suffix is automatically set to<i>&#160;&#34;cn=Monitor&#34;</i>.<br/>
You can however set a<i>&#160;rootdn</i>&#160;and<i>&#160;rootpw</i>. The following is all that is needed to instantiate a monitor<br/>backend:<br/>
&#160; &#160; &#160; &#160; include ./schema/core.schema<br/>
&#160; &#160; &#160; &#160; database monitor<br/>
&#160; &#160; &#160; &#160; rootdn &#34;cn=monitoring,cn=Monitor&#34;<br/>
&#160; &#160; &#160; &#160; rootpw monitoring<br/>
93<br/>
<hr/>
<a name=108></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
You can also apply Access Control to this database like any other database, for example:<br/>
&#160; &#160; &#160; &#160; access to dn.subtree=&#34;cn=Monitor&#34;<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160;by dn.exact=&#34;uid=Admin,dc=my,dc=org&#34; write<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160;by users read<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160;by * none<br/>
<b>Note:</b>&#160;The&#160;core.schema&#160;must be loaded for the monitor database to work.<br/>
A small example of the data returned via<i>&#160;ldapsearch</i>&#160;would be:<br/>
&#160; &#160; &#160; &#160; ldapsearch -x -H ldap://localhost:9011 -b 'cn=Monitor'<br/>
&#160; &#160; &#160; &#160; # extended LDIF<br/>
&#160; &#160; &#160; &#160; #<br/>
&#160; &#160; &#160; &#160; # LDAPv3<br/>
&#160; &#160; &#160; &#160; # base &lt;cn=Monitor&gt; with scope subtree<br/>
&#160; &#160; &#160; &#160; # filter: (objectclass=*)<br/>
&#160; &#160; &#160; &#160; # requesting: ALL<br/>
&#160; &#160; &#160; &#160; #<br/>
&#160; &#160; &#160; &#160; # Monitor<br/>
&#160; &#160; &#160; &#160; dn: cn=Monitor<br/>
&#160; &#160; &#160; &#160; objectClass: monitorServer<br/>
&#160; &#160; &#160; &#160; cn: Monitor<br/>
&#160; &#160; &#160; &#160; description: This subtree contains monitoring/managing objects.<br/>
&#160; &#160; &#160; &#160; description: This object contains information about this server.<br/>
&#160; &#160; &#160; &#160; description: Most of the information is held in operational attributes, which<br/>
&#160; &#160; &#160; &#160; &#160;must be explicitly requested.<br/>
&#160; &#160; &#160; &#160; # Backends, Monitor<br/>
&#160; &#160; &#160; &#160; dn: cn=Backends,cn=Monitor<br/>
&#160; &#160; &#160; &#160; objectClass: monitorContainer<br/>
&#160; &#160; &#160; &#160; cn: Backends<br/>
&#160; &#160; &#160; &#160; description: This subsystem contains information about available backends.<br/>
<a href="OpenLDAP-Admin-Guides.html#201">Please see the Monitoring section for complete examples of information available via this backend.</a><br/>
<b>11.6.3. Further Information</b><br/>
<i>slapd-monitor</i>(5)<br/>
<b>11.7. Null</b><br/>
<b>11.7.1. Overview</b><br/>
The Null backend to<i>&#160;slapd</i>(8) is surely the most useful part of slapd:<br/>
Searches return success but no entries.<br/>
&#160;<br/>
Compares return compareFalse.<br/>
&#160;<br/>
Updates return success (unless readonly is on) but do nothing.<br/>
&#160;<br/>
Binds other than as the rootdn fail unless the database option &#34;bind on&#34; is given.<br/>
&#160;<br/>
The slapadd(8) and slapcat(8) tools are equally exciting.<br/>
&#160;<br/>
Inspired by the&#160;/dev/null&#160;device.<br/>
94<br/>
<hr/>
<a name=109></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
<b>11.7.2. back-null Configuration</b><br/>
This has to be one of the shortest configurations you'll ever do. In order to test this, your&#160;slapd.conf&#160;file<br/>would look like:<br/>
&#160; &#160; &#160; &#160; database null<br/>
&#160; &#160; &#160; &#160; suffix &#34;cn=Nothing&#34;<br/>
&#160; &#160; &#160; &#160; bind on<br/>
<i>bind on</i>&#160;means:<br/>
<i>&#34;Allow binds as any DN in this backend's suffix, with any password. The default is &#34;off&#34;.&#34;</i><br/>
To test this backend with<i>&#160;ldapsearch</i>:<br/>
&#160; &#160; &#160; &#160; ldapsearch -x -H ldap://localhost:9011 -D &#34;uid=none,cn=Nothing&#34; -w testing -b 'cn=Nothing'<br/>
&#160; &#160; &#160; &#160; # extended LDIF<br/>
&#160; &#160; &#160; &#160; #<br/>
&#160; &#160; &#160; &#160; # LDAPv3<br/>
&#160; &#160; &#160; &#160; # base &lt;cn=Nothing&gt; with scope subtree<br/>
&#160; &#160; &#160; &#160; # filter: (objectclass=*)<br/>
&#160; &#160; &#160; &#160; # requesting: ALL<br/>
&#160; &#160; &#160; &#160; #<br/>
&#160; &#160; &#160; &#160; # search result<br/>
&#160; &#160; &#160; &#160; search: 2<br/>
&#160; &#160; &#160; &#160; result: 0 Success<br/>
&#160; &#160; &#160; &#160; # numResponses: 1<br/>
<b>11.7.3. Further Information</b><br/>
<i>slapd-null</i>(5)<br/>
<b>11.8. Passwd</b><br/>
<b>11.8.1. Overview</b><br/>
The PASSWD backend to<i>&#160;slapd</i>(8) serves up the user account information listed in the system<i>&#160;passwd</i>(5) file<br/>(defaulting to&#160;/etc/passwd).<br/>
This backend is provided for demonstration purposes only. The DN of each entry is<br/>&#34;uid=&lt;username&gt;,&lt;suffix&gt;&#34;.<br/>
<b>11.8.2. back-passwd Configuration</b><br/>
The configuration using&#160;slapd.conf&#160;a slightly longer, but not much. For example:<br/>
&#160; &#160; &#160; &#160; include ./schema/core.schema<br/>
&#160; &#160; &#160; &#160; database passwd<br/>
&#160; &#160; &#160; &#160; suffix &#34;cn=passwd&#34;<br/>
95<br/>
<hr/>
<a name=110></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
Again, testing this with<i>&#160;ldapsearch</i>&#160;would result in something like:<br/>
&#160; &#160; &#160; &#160; ldapsearch -x -H ldap://localhost:9011 -b 'cn=passwd'<br/>
&#160; &#160; &#160; &#160; # extended LDIF<br/>
&#160; &#160; &#160; &#160; #<br/>
&#160; &#160; &#160; &#160; # LDAPv3<br/>
&#160; &#160; &#160; &#160; # base &lt;cn=passwd&gt; with scope subtree<br/>
&#160; &#160; &#160; &#160; # filter: (objectclass=*)<br/>
&#160; &#160; &#160; &#160; # requesting: ALL<br/>
&#160; &#160; &#160; &#160; #<br/>
&#160; &#160; &#160; &#160; # passwd<br/>
&#160; &#160; &#160; &#160; dn: cn=passwd<br/>
&#160; &#160; &#160; &#160; cn: passwd<br/>
&#160; &#160; &#160; &#160; objectClass: organizationalUnit<br/>
&#160; &#160; &#160; &#160; # root, passwd<br/>
&#160; &#160; &#160; &#160; dn: uid=root,cn=passwd<br/>
&#160; &#160; &#160; &#160; objectClass: person<br/>
&#160; &#160; &#160; &#160; objectClass: uidObject<br/>
&#160; &#160; &#160; &#160; uid: root<br/>
&#160; &#160; &#160; &#160; cn: root<br/>
&#160; &#160; &#160; &#160; sn: root<br/>
&#160; &#160; &#160; &#160; description: root<br/>
<b>11.8.3. Further Information</b><br/>
<i>slapd-passwd</i>(5)<br/>
<b>11.9. Perl/Shell</b><br/>
<b>11.9.1. Overview</b><br/>
The Perl backend to<i>&#160;slapd</i>(8) works by embedding a<i>&#160;perl</i>(1) interpreter into<i>&#160;slapd</i>(8). Any perl database<br/>section of the configuration file<i>&#160;slapd.conf</i>(5) must then specify what Perl module to use. Slapd then creates a<br/>new Perl object that handles all the requests for that particular instance of the backend.<br/>
The Shell backend to<i>&#160;slapd</i>(8) executes external programs to implement operations, and is designed to make it<br/>easy to tie an existing database to the slapd front-end. This backend is is primarily intended to be used in<br/>prototypes.<br/>
<b>11.9.2. back-perl/back-shell Configuration</b><br/>
LATER<br/>
<b>11.9.3. Further Information</b><br/>
<i>slapd-shell</i>(5) and<i>&#160;slapd-perl</i>(5)<br/>
<b>11.10. Relay</b><br/>
96<br/>
<hr/>
<a name=111></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
<b>11.10.1. Overview</b><br/>
The primary purpose of this<i>&#160;slapd</i>(8) backend is to map a naming context defined in a database running in the<br/>same<i>&#160;slapd</i>(8) instance into a virtual naming context, with attributeType and objectClass manipulation, if<br/>required. It requires the rwm overlay.<br/>
This backend and the above mentioned overlay are experimental.<br/>
<b>11.10.2. back-relay Configuration</b><br/>
LATER<br/>
<b>11.10.3. Further Information</b><br/>
<i>slapd-relay</i>(5)<br/>
<b>11.11. SQL</b><br/>
<b>11.11.1. Overview</b><br/>
The primary purpose of this<i>&#160;slapd</i>(8) backend is to PRESENT information stored in some RDBMS as an<br/>LDAP subtree without any programming (some SQL and maybe stored procedures can't be considered<br/>programming, anyway ;).<br/>
That is, for example, when you (some ISP) have account information you use in an RDBMS, and want to use<br/>modern solutions that expect such information in LDAP (to authenticate users, make email lookups etc.). Or<br/>you want to synchronize or distribute information between different sites/applications that use RDBMSes<br/>and/or LDAP. Or whatever else...<br/>
It is<b>&#160;NOT</b>&#160;designed as a general-purpose backend that uses RDBMS instead of BerkeleyDB (as the standard<br/><a href="OpenLDAP-Admin-Guides.html#21">BDB backend does), though it can be used as such with several limitations. Please see LDAP vs RDBMS for<br/></a>discussion.<br/>
The idea is to use some meta-information to translate LDAP queries to SQL queries, leaving relational<br/>schema untouched, so that old applications can continue using it without any modifications. This allows SQL<br/>and LDAP applications to interoperate without replication, and exchange data as needed.<br/>
The SQL backend is designed to be tunable to virtually any relational schema without having to change<br/>source (through that meta-information mentioned). Also, it uses ODBC to connect to RDBMSes, and is highly<br/>configurable for SQL dialects RDBMSes may use, so it may be used for integration and distribution of data<br/>on different RDBMSes, OSes, hosts etc., in other words, in highly heterogeneous environments.<br/>
This backend is experimental.<br/>
<b>11.11.2. back-sql Configuration</b><br/>
This backend has to be one of the most abused and complex backends there is. Therefore, we will go through<br/>a simple, small example that comes with the OpenLDAP source and can be found in<br/>servers/slapd/back-sql/rdbms_depend/README<br/>
97<br/>
<hr/>
<a name=112></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
For this example we will be using PostgreSQL.<br/>
First, we add to&#160;/etc/odbc.ini&#160;a block of the form:<br/>
&#160; &#160; &#160; &#160; [example] &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;&lt;===<br/>
&#160; &#160; &#160; &#160; Description &#160; &#160; &#160; &#160; = Example for OpenLDAP's back-sql<br/>
&#160; &#160; &#160; &#160; Driver &#160; &#160; &#160; &#160; &#160; &#160; &#160;= PostgreSQL<br/>
&#160; &#160; &#160; &#160; Trace &#160; &#160; &#160; &#160; &#160; &#160; &#160; = No<br/>
&#160; &#160; &#160; &#160; Database &#160; &#160; &#160; &#160; &#160; &#160;= example &#160; &#160;&lt;===<br/>
&#160; &#160; &#160; &#160; Servername &#160; &#160; &#160; &#160; &#160;= localhost<br/>
&#160; &#160; &#160; &#160; UserName &#160; &#160; &#160; &#160; &#160; &#160;= manager &#160; &#160;&lt;===<br/>
&#160; &#160; &#160; &#160; Password &#160; &#160; &#160; &#160; &#160; &#160;= secret &#160; &#160; &lt;===<br/>
&#160; &#160; &#160; &#160; Port &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;= 5432<br/>
&#160; &#160; &#160; &#160; ;Protocol &#160; &#160; &#160; &#160; &#160; &#160;= 6.4<br/>
&#160; &#160; &#160; &#160; ReadOnly &#160; &#160; &#160; &#160; &#160; &#160;= No<br/>
&#160; &#160; &#160; &#160; RowVersioning &#160; &#160; &#160; = No<br/>
&#160; &#160; &#160; &#160; ShowSystemTables &#160; &#160;= No<br/>
&#160; &#160; &#160; &#160; ShowOidColumn &#160; &#160; &#160; = No<br/>
&#160; &#160; &#160; &#160; FakeOidIndex &#160; &#160; &#160; &#160;= No<br/>
&#160; &#160; &#160; &#160; ConnSettings &#160; &#160; &#160; &#160;=<br/>
The relevant information for our test setup is highlighted with '&lt;===' on the right above.<br/>
Next, we add to&#160;/etc/odbcinst.ini&#160;a block of the form:<br/>
&#160; &#160; &#160; &#160; [PostgreSQL]<br/>
&#160; &#160; &#160; &#160; Description &#160; &#160; = ODBC for PostgreSQL<br/>
&#160; &#160; &#160; &#160; Driver &#160; &#160; &#160; &#160; &#160;= /usr/lib/libodbcpsql.so<br/>
&#160; &#160; &#160; &#160; Setup &#160; &#160; &#160; &#160; &#160; = /usr/lib/libodbcpsqlS.so<br/>
&#160; &#160; &#160; &#160; FileUsage &#160; &#160; &#160; = 1<br/>
We will presume you know how to create a database and user in PostgreSQL and how to set a password. Also,<br/>we'll presume you can populate the 'example' database you've just created with the following files, as found in<br/>servers/slapd/back-sql/rdbms_depend/pgsql<br/>
&#160; &#160; &#160; &#160; backsql_create.sql, testdb_create.sql, testdb_data.sql, testdb_metadata.sql<br/>
Lastly, run the test:<br/>
&#160; &#160; &#160; &#160; [root@localhost]# cd $SOURCES/tests<br/>
&#160; &#160; &#160; &#160; [root@localhost]# SLAPD_USE_SQL=pgsql ./run sql-test000<br/>
Briefly, you should see something like (cut short for space):<br/>
&#160; &#160; &#160; &#160; Cleaning up test run directory leftover from previous run.<br/>
&#160; &#160; &#160; &#160; Running ./scripts/sql-test000-read...<br/>
&#160; &#160; &#160; &#160; running defines.sh<br/>
&#160; &#160; &#160; &#160; Starting slapd on TCP/IP port 9011...<br/>
&#160; &#160; &#160; &#160; Testing SQL backend read operations...<br/>
&#160; &#160; &#160; &#160; Waiting 5 seconds for slapd to start...<br/>
&#160; &#160; &#160; &#160; Testing correct bind... dn:cn=Mitya Kovalev,dc=example,dc=com<br/>
&#160; &#160; &#160; &#160; Testing incorrect bind (should fail)... ldap_bind: Invalid credentials (49)<br/>
&#160; &#160; &#160; &#160; ......<br/>
&#160; &#160; &#160; &#160; Filtering original ldif...<br/>
&#160; &#160; &#160; &#160; Comparing filter output...<br/>
98<br/>
<hr/>
<a name=113></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
&#160; &#160; &#160; &#160; &gt;&gt;&gt;&gt;&gt; Test succeeded<br/>
The test is basically readonly; this can be performed by all RDBMSes (listed above).<br/>
There is another test, sql-test900-write, which is currently enabled only for PostgreSQL and IBM db2.<br/>
Using&#160;sql-test000, files in&#160;servers/slapd/back-sql/rdbms_depend/pgsql/&#160;and the man<br/>page, you should be set.<br/>
<b>Note:</b>&#160;This backend is experimental.<br/>
<b>11.11.3. Further Information</b><br/>
<i>slapd-sql</i>(5) and&#160;servers/slapd/back-sql/rdbms_depend/README<br/>
99<br/>
<hr/>
<a name=114></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
100<br/>
<hr/>
<a name=115></a><b>12. Overlays</b><br/>
Overlays are software components that provide hooks to functions analogous to those provided by backends,<br/>which can be stacked on top of the backend calls and as callbacks on top of backend responses to alter their<br/>behavior.<br/>
Overlays may be compiled statically into<i>&#160;slapd</i>, or when module support is enabled, they may be dynamically<br/>loaded. Most of the overlays are only allowed to be configured on individual databases.<br/>
Some can be stacked on the&#160;frontend&#160;as well, for global use. This means that they can be executed after a<br/>request is parsed and validated, but right before the appropriate database is selected. The main purpose is to<br/>affect operations regardless of the database they will be handled by, and, in some cases, to influence the<br/>selection of the database by massaging the request DN.<br/>
Essentially, overlays represent a means to:<br/>
customize the behavior of existing backends without changing the backend code and without<br/>
&#160;<br/>
requiring one to write a new custom backend with complete functionality<br/>write functionality of general usefulness that can be applied to different backend types<br/>
&#160;<br/>
When using<i>&#160;slapd.conf</i>(5), overlays that are configured before any other databases are considered global, as<br/>mentioned above. In fact they are implicitly stacked on top of the&#160;frontend&#160;database. They can also be<br/>explicitly configured as such:<br/>
&#160; &#160; &#160; &#160; database frontend<br/>
&#160; &#160; &#160; &#160; overlay &lt;overlay name&gt;<br/>
Overlays are usually documented by separate specific man pages in section 5; the naming convention is<br/>
&#160; &#160; &#160; &#160; slapo-&lt;overlay name&gt;<br/>
All distributed core overlays have a man page. Feel free to contribute to any, if you think there is anything<br/>missing in describing the behavior of the component and the implications of all the related configuration<br/>directives.<br/>
Official overlays are located in<br/>
&#160; &#160; &#160; &#160; servers/slapd/overlays/<br/>
That directory also contains the file slapover.txt, which describes the rationale of the overlay implementation,<br/>and may serve as a guideline for the development of custom overlays.<br/>
Contribware overlays are located in<br/>
&#160; &#160; &#160; &#160; contrib/slapd-modules/&lt;overlay name&gt;/<br/>
along with other types of run-time loadable components; they are officially distributed, but not maintained by<br/>the project.<br/>
All the current overlays in OpenLDAP are listed and described in detail in the following sections.<br/>
101<br/>
<hr/>
<a name=116></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
<b>12.1. Access Logging</b><br/>
<b>12.1.1. Overview</b><br/>
This overlay can record accesses to a given backend database on another database.<br/>
This allows all of the activity on a given database to be reviewed using arbitrary LDAP queries, instead of just<br/>logging to local flat text files. Configuration options are available for selecting a subset of operation types to<br/>log, and to automatically prune older log records from the logging database. Log records are stored with audit<br/>schema to assure their readability whether viewed as LDIF or in raw form.<br/>
<a href="OpenLDAP-Admin-Guides.html#181">It is also used for delta-syncrepl replication</a><br/>
<b>12.1.2. Access Logging Configuration</b><br/>
The following is a basic example that implements Access Logging:<br/>
&#160; &#160; &#160; &#160; database bdb<br/>
&#160; &#160; &#160; &#160; suffix dc=example,dc=com<br/>
&#160; &#160; &#160; &#160; ...<br/>
&#160; &#160; &#160; &#160; overlay accesslog<br/>
&#160; &#160; &#160; &#160; logdb cn=log<br/>
&#160; &#160; &#160; &#160; logops writes reads<br/>
&#160; &#160; &#160; &#160; logold (objectclass=person)<br/>
&#160; &#160; &#160; &#160; database bdb<br/>
&#160; &#160; &#160; &#160; suffix cn=log<br/>
&#160; &#160; &#160; &#160; ...<br/>
&#160; &#160; &#160; &#160; index reqStart eq<br/>
&#160; &#160; &#160; &#160; access to *<br/>
&#160; &#160; &#160; &#160; &#160; by dn.base=&#34;cn=admin,dc=example,dc=com&#34; read<br/>
<a href="OpenLDAP-Admin-Guides.html#181">The following is an example used for delta-syncrepl replication:</a><br/>
&#160; &#160; &#160; &#160; database hdb<br/>
&#160; &#160; &#160; &#160; suffix cn=accesslog<br/>
&#160; &#160; &#160; &#160; directory /usr/local/var/openldap-accesslog<br/>
&#160; &#160; &#160; &#160; rootdn cn=accesslog<br/>
&#160; &#160; &#160; &#160; index default eq<br/>
&#160; &#160; &#160; &#160; index entryCSN,objectClass,reqEnd,reqResult,reqStart<br/>
Accesslog overlay definitions for the primary db<br/>
&#160; &#160; &#160; &#160; database bdb<br/>
&#160; &#160; &#160; &#160; suffix dc=example,dc=com<br/>
&#160; &#160; &#160; &#160; ...<br/>
&#160; &#160; &#160; &#160; overlay accesslog<br/>
&#160; &#160; &#160; &#160; logdb cn=accesslog<br/>
&#160; &#160; &#160; &#160; logops writes<br/>
&#160; &#160; &#160; &#160; logsuccess TRUE<br/>
&#160; &#160; &#160; &#160; # scan the accesslog DB every day, and purge entries older than 7 days<br/>
&#160; &#160; &#160; &#160; logpurge 07+00:00 01+00:00<br/>
An example search result against<b>&#160;cn=accesslog</b>&#160;might look like:<br/>
102<br/>
<hr/>
<a name=117></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
&#160; &#160; &#160; &#160; [ghenry@suretec ghenry]# ldapsearch -x -b cn=accesslog<br/>
&#160; &#160; &#160; &#160; # extended LDIF<br/>
&#160; &#160; &#160; &#160; #<br/>
&#160; &#160; &#160; &#160; # LDAPv3<br/>
&#160; &#160; &#160; &#160; # base &lt;cn=accesslog&gt; with scope subtree<br/>
&#160; &#160; &#160; &#160; # filter: (objectclass=*)<br/>
&#160; &#160; &#160; &#160; # requesting: ALL<br/>
&#160; &#160; &#160; &#160; #<br/>
&#160; &#160; &#160; &#160; # accesslog<br/>
&#160; &#160; &#160; &#160; dn: cn=accesslog<br/>
&#160; &#160; &#160; &#160; objectClass: auditContainer<br/>
&#160; &#160; &#160; &#160; cn: accesslog<br/>
&#160; &#160; &#160; &#160; # 20080110163829.000004Z, accesslog<br/>
&#160; &#160; &#160; &#160; dn: reqStart=20080110163829.000004Z,cn=accesslog<br/>
&#160; &#160; &#160; &#160; objectClass: auditModify<br/>
&#160; &#160; &#160; &#160; reqStart: 20080110163829.000004Z<br/>
&#160; &#160; &#160; &#160; reqEnd: 20080110163829.000005Z<br/>
&#160; &#160; &#160; &#160; reqType: modify<br/>
&#160; &#160; &#160; &#160; reqSession: 196696<br/>
&#160; &#160; &#160; &#160; reqAuthzID: cn=admin,dc=suretecsystems,dc=com<br/>
&#160; &#160; &#160; &#160; reqDN: uid=suretec-46022f8$,ou=Users,dc=suretecsystems,dc=com<br/>
&#160; &#160; &#160; &#160; reqResult: 0<br/>
&#160; &#160; &#160; &#160; reqMod: sambaPwdCanChange:- ###CENSORED###<br/>
&#160; &#160; &#160; &#160; reqMod: sambaPwdCanChange:+ ###CENSORED###<br/>
&#160; &#160; &#160; &#160; reqMod: sambaNTPassword:- ###CENSORED###<br/>
&#160; &#160; &#160; &#160; reqMod: sambaNTPassword:+ ###CENSORED###<br/>
&#160; &#160; &#160; &#160; reqMod: sambaPwdLastSet:- ###CENSORED###<br/>
&#160; &#160; &#160; &#160; reqMod: sambaPwdLastSet:+ ###CENSORED###<br/>
&#160; &#160; &#160; &#160; reqMod: entryCSN:= 20080110163829.095157Z#000000#000#000000<br/>
&#160; &#160; &#160; &#160; reqMod: modifiersName:= cn=admin,dc=suretecsystems,dc=com<br/>
&#160; &#160; &#160; &#160; reqMod: modifyTimestamp:= 20080110163829Z<br/>
&#160; &#160; &#160; &#160; # search result<br/>
&#160; &#160; &#160; &#160; search: 2<br/>
&#160; &#160; &#160; &#160; result: 0 Success<br/>
&#160; &#160; &#160; &#160; # numResponses: 3<br/>
&#160; &#160; &#160; &#160; # numEntries: 2<br/>
<b>12.1.3. Further Information</b><br/>
<i>slapo-accesslog(5)</i><a href="OpenLDAP-Admin-Guides.html#181">&#160;and the delta-syncrepl replication section.</a><br/>
<b>12.2. Audit Logging</b><br/>
The Audit Logging overlay can be used to record all changes on a given backend database to a specified log<br/>file.<br/>
<b>12.2.1. Overview</b><br/>
If the need arises whereby changes need to be logged as standard LDIF, then the auditlog overlay<br/><b>slapo-auditlog (5)</b>&#160;can be used. Full examples are available in the man page<b>&#160;slapo-auditlog (5)</b><br/>
103<br/>
<hr/>
<a name=118></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
<b>12.2.2. Audit Logging Configuration</b><br/>
If the directory is running vi&#160;slapd.d, then the following LDIF could be used to add the overlay to the<br/>overlay list in<b>&#160;cn=config</b>&#160;and set what file the LDIF gets logged to (adjust to suit)<br/>
&#160; &#160; &#160; &#160;dn: olcOverlay=auditlog,olcDatabase={1}hdb,cn=config<br/>
&#160; &#160; &#160; &#160;changetype: add<br/>
&#160; &#160; &#160; &#160;objectClass: olcOverlayConfig<br/>
&#160; &#160; &#160; &#160;objectClass: olcAuditLogConfig<br/>
&#160; &#160; &#160; &#160;olcOverlay: auditlog<br/>
&#160; &#160; &#160; &#160;olcAuditlogFile: /tmp/auditlog.ldif<br/>
In this example for testing, we are logging changes to&#160;/tmp/auditlog.ldif<br/>
A typical LDIF file created by<b>&#160;slapo-auditlog(5)</b>&#160;would look like:<br/>
&#160; &#160; &#160; &#160;# add 1196797576 dc=suretecsystems,dc=com cn=admin,dc=suretecsystems,dc=com<br/>
&#160; &#160; &#160; &#160;dn: dc=suretecsystems,dc=com<br/>
&#160; &#160; &#160; &#160;changetype: add<br/>
&#160; &#160; &#160; &#160;objectClass: dcObject<br/>
&#160; &#160; &#160; &#160;objectClass: organization<br/>
&#160; &#160; &#160; &#160;dc: suretecsystems<br/>
&#160; &#160; &#160; &#160;o: Suretec Systems Ltd.<br/>
&#160; &#160; &#160; &#160;structuralObjectClass: organization<br/>
&#160; &#160; &#160; &#160;entryUUID: 1606f8f8-f06e-1029-8289-f0cc9d81e81a<br/>
&#160; &#160; &#160; &#160;creatorsName: cn=admin,dc=suretecsystems,dc=com<br/>
&#160; &#160; &#160; &#160;modifiersName: cn=admin,dc=suretecsystems,dc=com<br/>
&#160; &#160; &#160; &#160;createTimestamp: 20051123130912Z<br/>
&#160; &#160; &#160; &#160;modifyTimestamp: 20051123130912Z<br/>
&#160; &#160; &#160; &#160;entryCSN: 20051123130912.000000Z#000001#000#000000<br/>
&#160; &#160; &#160; &#160;auditContext: cn=accesslog<br/>
&#160; &#160; &#160; &#160;# end add 1196797576<br/>
&#160; &#160; &#160; &#160;# add 1196797577 dc=suretecsystems,dc=com cn=admin,dc=suretecsystems,dc=com<br/>
&#160; &#160; &#160; &#160;dn: ou=Groups,dc=suretecsystems,dc=com<br/>
&#160; &#160; &#160; &#160;changetype: add<br/>
&#160; &#160; &#160; &#160;objectClass: top<br/>
&#160; &#160; &#160; &#160;objectClass: organizationalUnit<br/>
&#160; &#160; &#160; &#160;ou: Groups<br/>
&#160; &#160; &#160; &#160;structuralObjectClass: organizationalUnit<br/>
&#160; &#160; &#160; &#160;entryUUID: 160aaa2a-f06e-1029-828a-f0cc9d81e81a<br/>
&#160; &#160; &#160; &#160;creatorsName: cn=admin,dc=suretecsystems,dc=com<br/>
&#160; &#160; &#160; &#160;modifiersName: cn=admin,dc=suretecsystems,dc=com<br/>
&#160; &#160; &#160; &#160;createTimestamp: 20051123130912Z<br/>
&#160; &#160; &#160; &#160;modifyTimestamp: 20051123130912Z<br/>
&#160; &#160; &#160; &#160;entryCSN: 20051123130912.000000Z#000002#000#000000<br/>
&#160; &#160; &#160; &#160;# end add 1196797577<br/>
<b>12.2.3. Further Information</b><br/>
<i>slapo-auditlog(5)</i><br/>
<b>12.3. Chaining</b><br/>
104<br/>
<hr/>
<a name=119></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
<b>12.3.1. Overview</b><br/>
The chain overlay provides basic chaining capability to the underlying database.<br/>
What is chaining? It indicates the capability of a DSA to follow referrals on behalf of the client, so that<br/>distributed systems are viewed as a single virtual DSA by clients that are otherwise unable to &#34;chase&#34; (i.e.<br/>follow) referrals by themselves.<br/>
The chain overlay is built on top of the ldap backend; it is compiled by default when<b>&#160;--enable-ldap</b>.<br/>
<b>12.3.2. Chaining Configuration</b><br/>
In order to demonstrate how this overlay works, we shall discuss a typical scenario which might be one master<br/>server and three Syncrepl slaves.<br/>
On each replica, add this near the top of the<i>&#160;slapd.conf</i>(5) file (global), before any database definitions:<br/>
&#160; &#160; &#160; &#160; overlay &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;chain<br/>
&#160; &#160; &#160; &#160; chain-uri &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;&#34;ldap://ldapmaster.example.com&#34;<br/>
&#160; &#160; &#160; &#160; chain-idassert-bind &#160; &#160; &#160; &#160;bindmethod=&#34;simple&#34;<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;binddn=&#34;cn=Manager,dc=example,dc=com&#34;<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;credentials=&#34;&lt;secret&gt;&#34;<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;mode=&#34;self&#34;<br/>
&#160; &#160; &#160; &#160; chain-tls &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;start<br/>
&#160; &#160; &#160; &#160; chain-return-error &#160; &#160; &#160; &#160; TRUE<br/>
Add this below your<i>&#160;syncrepl</i>&#160;statement:<br/>
&#160; &#160; &#160; &#160; updateref &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;&#34;ldap://ldapmaster.example.com/&#34;<br/>
The<b>&#160;chain-tls</b>&#160;statement enables TLS from the slave to the ldap master. The DITs are exactly the same<br/>between these machines, therefore whatever user bound to the slave will also exist on the master. If that DN<br/>does not have update privileges on the master, nothing will happen.<br/>
You will need to restart the slave after these<i>&#160;slapd.conf</i>&#160;changes. Then, if you are using<i>&#160;loglevel stats</i>&#160;(256),<br/>you can monitor an<i>&#160;ldapmodify</i>&#160;on the slave and the master. (If you're using<i>&#160;cn=config</i>&#160;no restart is required.)<br/>
Now start an<i>&#160;ldapmodify</i>&#160;on the slave and watch the logs. You should expect something like:<br/>
&#160; &#160; &#160; &#160; Sep &#160;6 09:27:25 slave1 slapd[29274]: conn=11 fd=31 ACCEPT from IP=143.199.102.216:45181 (IP=143.199.102.216:389)<br/>
&#160; &#160; &#160; &#160; Sep &#160;6 09:27:25 slave1 slapd[29274]: conn=11 op=0 STARTTLS<br/>
&#160; &#160; &#160; &#160; Sep &#160;6 09:27:25 slave1 slapd[29274]: conn=11 op=0 RESULT oid= err=0 text=<br/>
&#160; &#160; &#160; &#160; Sep &#160;6 09:27:25 slave1 slapd[29274]: conn=11 fd=31 TLS established tls_ssf=256 ssf=256<br/>
&#160; &#160; &#160; &#160; Sep &#160;6 09:27:28 slave1 slapd[29274]: conn=11 op=1 BIND dn=&#34;uid=user1,ou=people,dc=example,dc=com&#34; method=128<br/>
&#160; &#160; &#160; &#160; Sep &#160;6 09:27:28 slave1 slapd[29274]: conn=11 op=1 BIND dn=&#34;uid=user1,ou=People,dc=example,dc=com&#34; mech=SIMPLE ssf=0<br/>
&#160; &#160; &#160; &#160; Sep &#160;6 09:27:28 slave1 slapd[29274]: conn=11 op=1 RESULT tag=97 err=0 text=<br/>
&#160; &#160; &#160; &#160; Sep &#160;6 09:27:28 slave1 slapd[29274]: conn=11 op=2 MOD dn=&#34;uid=user1,ou=People,dc=example,dc=com&#34;<br/>
&#160; &#160; &#160; &#160; Sep &#160;6 09:27:28 slave1 slapd[29274]: conn=11 op=2 MOD attr=mail<br/>
&#160; &#160; &#160; &#160; Sep &#160;6 09:27:28 slave1 slapd[29274]: conn=11 op=2 RESULT tag=103 err=0 text=<br/>
&#160; &#160; &#160; &#160; Sep &#160;6 09:27:28 slave1 slapd[29274]: conn=11 op=3 UNBIND<br/>
&#160; &#160; &#160; &#160; Sep &#160;6 09:27:28 slave1 slapd[29274]: conn=11 fd=31 closed<br/>
&#160; &#160; &#160; &#160; Sep &#160;6 09:27:28 slave1 slapd[29274]: syncrepl_entry: LDAP_RES_SEARCH_ENTRY(LDAP_SYNC_MODIFY)<br/>
&#160; &#160; &#160; &#160; Sep &#160;6 09:27:28 slave1 slapd[29274]: syncrepl_entry: be_search (0)<br/>
&#160; &#160; &#160; &#160; Sep &#160;6 09:27:28 slave1 slapd[29274]: syncrepl_entry: uid=user1,ou=People,dc=example,dc=com<br/>
&#160; &#160; &#160; &#160; Sep &#160;6 09:27:28 slave1 slapd[29274]: syncrepl_entry: be_modify (0)<br/>
105<br/>
<hr/>
<a name=120></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
And on the master you will see this:<br/>
&#160; &#160; &#160; &#160; Sep &#160;6 09:23:57 ldapmaster slapd[2961]: conn=55902 op=3 PROXYAUTHZ dn=&#34;uid=user1,ou=people,dc=example,dc=com&#34;<br/>
&#160; &#160; &#160; &#160; Sep &#160;6 09:23:57 ldapmaster slapd[2961]: conn=55902 op=3 MOD dn=&#34;uid=user1,ou=People,dc=example,dc=com&#34;<br/>
&#160; &#160; &#160; &#160; Sep &#160;6 09:23:57 ldapmaster slapd[2961]: conn=55902 op=3 MOD attr=mail<br/>
&#160; &#160; &#160; &#160; Sep &#160;6 09:23:57 ldapmaster slapd[2961]: conn=55902 op=3 RESULT tag=103 err=0 text=<br/>
<b>Note:</b>&#160;You can clearly see the PROXYAUTHZ line on the master, indicating the proper identity assertion for<br/>the update on the master. Also note the slave immediately receiving the Syncrepl update from the master.<br/>
<b>12.3.3. Handling Chaining Errors</b><br/>
By default, if chaining fails, the original referral is returned to the client under the assumption that the client<br/>might want to try and follow the referral.<br/>
With the following directive however, if the chaining fails at the provider side, the actual error is returned to<br/>the client.<br/>
&#160; &#160; &#160; &#160; chain-return-error TRUE<br/>
<b>12.3.4. Read-Back of Chained Modifications</b><br/>
Occasionally, applications want to read back the data that they just wrote. If a modification requested to a<br/>shadow server was silently chained to its provider, an immediate read could result in receiving data not yet<br/>synchronized. In those cases, clients should use the<b>&#160;dontusecopy</b>&#160;control to ensure they are directed to the<br/>authoritative source for that piece of data.<br/>
This control usually causes a referral to the actual source of the data to be returned. However, when the<br/><i>slapo-chain(5)</i>&#160;overlay is used, it intercepts the referral being returned in response to the<b>&#160;dontusecopy</b>&#160;control,<br/>and tries to fetch the requested data.<br/>
<b>12.3.5. Further Information</b><br/>
<i>slapo-chain(5)</i><br/>
<b>12.4. Constraints</b><br/>
<b>12.4.1. Overview</b><br/>
This overlay enforces a regular expression constraint on all values of specified attributes during an LDAP<br/>modify request that contains add or modify commands. It is used to enforce a more rigorous syntax when the<br/>underlying attribute syntax is too general.<br/>
<b>12.4.2. Constraint Configuration</b><br/>
Configuration via<i>&#160;slapd.conf</i>(5) would look like:<br/>
&#160; &#160; &#160; &#160; overlay constraint<br/>
&#160; &#160; &#160; &#160; constraint_attribute mail regex ^[[:alnum:]]+@mydomain.com$<br/>
&#160; &#160; &#160; &#160; constraint_attribute title uri<br/>
&#160; &#160; &#160; &#160; ldap:///dc=catalog,dc=example,dc=com?title?sub?(objectClass=titleCatalog)<br/>
106<br/>
<hr/>
<a name=121></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
A specification like the above would reject any<i>&#160;mail</i>&#160;attribute which did not look like<i>&#160;&lt;alpha-numeric<br/>string&gt;@mydomain.com</i>.<br/>
It would also reject any title attribute whose values were not listed in the title attribute of any<i>&#160;titleCatalog<br/></i>entries in the given scope.<br/>
An example for use with<i>&#160;cn=config</i>:<br/>
&#160; &#160; &#160; &#160;dn: olcOverlay=constraint,olcDatabase={1}hdb,cn=config<br/>
&#160; &#160; &#160; &#160;changetype: add<br/>
&#160; &#160; &#160; &#160;objectClass: olcOverlayConfig<br/>
&#160; &#160; &#160; &#160;objectClass: olcConstraintConfig<br/>
&#160; &#160; &#160; &#160;olcOverlay: constraint<br/>
&#160; &#160; &#160; &#160;olcConstraintAttribute: mail regex ^[[:alnum:]]+@mydomain.com$<br/>
&#160; &#160; &#160; &#160;olcConstraintAttribute: title uri ldap:///dc=catalog,dc=example,dc=com?title?sub?(objectClass=titleCatalog)<br/>
<b>12.4.3. Further Information</b><br/>
<i>slapo-constraint(5)</i><br/>
<b>12.5. Dynamic Directory Services</b><br/>
<b>12.5.1. Overview</b><br/>
The<i>&#160;dds</i>&#160;overlay to<i>&#160;slapd</i><a href="http://www.rfc-editor.org/rfc/rfc2589.txt">(8) implements dynamic objects as per RFC2589. The name</a><i>&#160;dds</i>&#160;stands for Dynamic<br/>Directory Services. It allows to define dynamic objects, characterized by the<i>&#160;dynamicObject</i>&#160;objectClass.<br/>
Dynamic objects have a limited lifetime, determined by a time-to-live (TTL) that can be refreshed by means<br/>of a specific refresh extended operation. This operation allows to set the Client Refresh Period (CRP), namely<br/>the period between refreshes that is required to preserve the dynamic object from expiration. The expiration<br/>time is computed by adding the requested TTL to the current time. When dynamic objects reach the end of<br/>their lifetime without being further refreshed, they are automatically<i>&#160;deleted</i>. There is no guarantee of<br/>immediate deletion, so clients should not count on it.<br/>
<b>12.5.2. Dynamic Directory Service Configuration</b><br/>
A usage of dynamic objects might be to implement dynamic meetings; in this case, all the participants to the<br/>meeting are allowed to refresh the meeting object, but only the creator can delete it (otherwise it will be<br/>deleted when the TTL expires).<br/>
If we add the overlay to an example database, specifying a Max TTL of 1 day, a min of 10 seconds, with a<br/>default TTL of 1 hour. We'll also specify an interval of 120 (less than 60s might be too small) seconds<br/>between expiration checks and a tolerance of 5 second (lifetime of a dynamic object will be<i>&#160;entryTtl +<br/>tolerance</i>).<br/>
&#160; &#160; &#160; &#160;overlay dds<br/>
&#160; &#160; &#160; &#160;dds-max-ttl &#160; &#160; 1d<br/>
&#160; &#160; &#160; &#160;dds-min-ttl &#160; &#160; 10s<br/>
&#160; &#160; &#160; &#160;dds-default-ttl 1h<br/>
&#160; &#160; &#160; &#160;dds-interval &#160; &#160;120s<br/>
&#160; &#160; &#160; &#160;dds-tolerance &#160; 5s<br/>
107<br/>
<hr/>
<a name=122></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
and add an index:<br/>
&#160; &#160; &#160; &#160;entryExpireTimestamp<br/>
Creating a meeting is as simple as adding the following:<br/>
&#160; &#160; &#160; &#160;dn: cn=OpenLDAP Documentation Meeting,ou=Meetings,dc=example,dc=com<br/>
&#160; &#160; &#160; &#160;objectClass: groupOfNames<br/>
&#160; &#160; &#160; &#160;objectClass: dynamicObject<br/>
&#160; &#160; &#160; &#160;cn: OpenLDAP Documentation Meeting<br/>
&#160; &#160; &#160; &#160;member: uid=ghenry,ou=People,dc=example,dc=com<br/>
&#160; &#160; &#160; &#160;member: uid=hyc,ou=People,dc=example,dc=com<br/>
<b>12.5.2.1. Dynamic Directory Service ACLs</b><br/>
Allow users to start a meeting and to join it; restrict refresh to the<i>&#160;member</i>; restrict delete to the creator:<br/>
&#160; &#160; &#160; &#160;access to attrs=userPassword<br/>
&#160; &#160; &#160; &#160; &#160; by self write<br/>
&#160; &#160; &#160; &#160; &#160; by * read<br/>
&#160; &#160; &#160; &#160;access to dn.base=&#34;ou=Meetings,dc=example,dc=com&#34;<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;attrs=children<br/>
&#160; &#160; &#160; &#160; &#160; &#160; by users write<br/>
&#160; &#160; &#160; &#160;access to dn.onelevel=&#34;ou=Meetings,dc=example,dc=com&#34;<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;attrs=entry<br/>
&#160; &#160; &#160; &#160; &#160; &#160; by dnattr=creatorsName write<br/>
&#160; &#160; &#160; &#160; &#160; &#160; by * read<br/>
&#160; &#160; &#160; &#160;access to dn.onelevel=&#34;ou=Meetings,dc=example,dc=com&#34;<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;attrs=participant<br/>
&#160; &#160; &#160; &#160; &#160; &#160; by dnattr=creatorsName write<br/>
&#160; &#160; &#160; &#160; &#160; &#160; by users selfwrite<br/>
&#160; &#160; &#160; &#160; &#160; &#160; by * read<br/>
&#160; &#160; &#160; &#160;access to dn.onelevel=&#34;ou=Meetings,dc=example,dc=com&#34;<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;attrs=entryTtl<br/>
&#160; &#160; &#160; &#160; &#160; &#160; by dnattr=member manage<br/>
&#160; &#160; &#160; &#160; &#160; &#160; by * read<br/>
In simple terms, the user who created the<i>&#160;OpenLDAP Documentation Meeting</i>&#160;can add new attendees, refresh<br/>the meeting using (basically complete control):<br/>
&#160; &#160; &#160; &#160;ldapexop -x -H ldap://ldaphost &#34;refresh&#34; &#34;cn=OpenLDAP Documentation Meeting,ou=Meetings,dc=example,dc=com&#34; &#34;120&#34; -D &#34;uid=ghenry,ou=People,dc=example,dc=com&#34; -W<br/>
Any user can join the meeting, but not add another attendee, but they can refresh the meeting. The ACLs<br/>above are quite straight forward to understand.<br/>
<b>12.5.3. Further Information</b><br/>
<i>slapo-dds(5)</i><br/>
108<br/>
<hr/>
<a name=123></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
<b>12.6. Dynamic Groups</b><br/>
<b>12.6.1. Overview</b><br/>
This overlay extends the Compare operation to detect members of a dynamic group. This overlay is now<br/><a href="OpenLDAP-Admin-Guides.html#123">deprecated as all of its functions are available using the Dynamic Lists overlay.</a><br/>
<b>12.6.2. Dynamic Group Configuration</b><br/>
<b>12.7. Dynamic Lists</b><br/>
<b>12.7.1. Overview</b><br/>
This overlay allows expansion of dynamic groups and lists. Instead of having the group members or list<br/>attributes hard coded, this overlay allows us to define an LDAP search whose results will make up the group<br/>or list.<br/>
<b>12.7.2. Dynamic List Configuration</b><br/>
This module can behave both as a dynamic list and dynamic group, depending on the configuration. The<br/>syntax is as follows:<br/>
&#160; &#160; &#160; &#160;overlay dynlist<br/>
&#160; &#160; &#160; &#160;dynlist-attrset &lt;group-oc&gt; &lt;URL-ad&gt; [member-ad]<br/>
The parameters to the&#160;dynlist-attrset&#160;directive have the following meaning:<br/>
&lt;group-oc&gt;<br/>
&#160;<br/>
: specifies which object class triggers the subsequent LDAP search. Whenever an entry<br/>
with this object class is retrieved, the search is performed.<br/>&lt;URL-ad&gt;<br/>
&#160;<br/>
: is the name of the attribute which holds the search URI. It has to be a subtype of<br/>
labeledURI. The attributes and values present in the search result are added to the entry unless<br/>member-ad&#160;is used (see below).<br/>member-ad<br/>
&#160;<br/>
: if present, changes the overlay behavior into a dynamic group. Instead of inserting the<br/>
results of the search in the entry, the distinguished name of the results are added as values of this<br/>attribute.<br/>
Here is an example which will allow us to have an email alias which automatically expands to all user's emails<br/>according to our LDAP filter:<br/>
In<i>&#160;slapd.conf</i>(5):<br/>
&#160; &#160; &#160; &#160;overlay dynlist<br/>
&#160; &#160; &#160; &#160;dynlist-attrset nisMailAlias labeledURI<br/>
This means that whenever an entry which has the&#160;nisMailAlias&#160;object class is retrieved, the search<br/>specified in the&#160;labeledURI&#160;attribute is performed.<br/>
Let's say we have this entry in our directory:<br/>
&#160; &#160; &#160; &#160;cn=all,ou=aliases,dc=example,dc=com<br/>
109<br/>
<hr/>
<a name=124></a><img src="../img/OpenLDAP-Admin-Guide-124_1.png"/><br/>
OpenLDAP Software 2.4 Administrator's Guide<br/>
&#160; &#160; &#160; &#160;cn: all<br/>
&#160; &#160; &#160; &#160;objectClass: nisMailAlias<br/>
&#160; &#160; &#160; &#160;labeledURI: ldap:///ou=People,dc=example,dc=com?mail?one?(objectClass=inetOrgPerson)<br/>
If this entry is retrieved, the search specified in&#160;labeledURI&#160;will be performed and the results will be added<br/>to the entry just as if they have always been there. In this case, the search filter selects all entries directly<br/>under&#160;ou=People&#160;that have the&#160;inetOrgPerson&#160;object class and retrieves the&#160;mail&#160;attribute, if it exists.<br/>
This is what gets added to the entry when we have two users under&#160;ou=People&#160;that match the filter:<br/>
Figure X.Y: Dynamic List for all emails<br/>
The configuration for a dynamic group is similar. Let's see an example which would automatically populate<br/>an&#160;allusers&#160;group with all the user accounts in the directory.<br/>
In&#160;slapd.conf(5):<br/>
&#160; &#160; &#160; &#160;include /path/to/dyngroup.schema<br/>
&#160; &#160; &#160; &#160;...<br/>
&#160; &#160; &#160; &#160;overlay dynlist<br/>
&#160; &#160; &#160; &#160;dynlist-attrset groupOfURLs labeledURI member<br/>
1.&#160;Note: We must include the&#160;<br/>
2.&#160;<br/>
dyngroup.schema&#160;file that defines the<br/>
groupOfURLs<br/>
3.&#160;<br/>
&#160;objectClass used in this example.<br/>
Let's apply it to the following entry:<br/>
&#160; &#160; &#160; &#160;cn=allusers,ou=group,dc=example,dc=com<br/>
&#160; &#160; &#160; &#160;cn: all<br/>
&#160; &#160; &#160; &#160;objectClass: groupOfURLs<br/>
&#160; &#160; &#160; &#160;labeledURI: ldap:///ou=people,dc=example,dc=com??one?(objectClass=inetOrgPerson)<br/>
The behavior is similar to the dynamic list configuration we had before: whenever an entry with the<br/>groupOfURLs&#160;object class is retrieved, the search specified in the&#160;labeledURI&#160;attribute is performed. But<br/>this time, only the distinguished names of the results are added, and as values of the&#160;member&#160;attribute.<br/>
This is what we get:<br/>
110<br/>
<hr/>
<a name=125></a><img src="../img/OpenLDAP-Admin-Guide-125_1.png"/><br/>
OpenLDAP Software 2.4 Administrator's Guide<br/>
Figure X.Y: Dynamic Group for all users<br/>
Note that a side effect of this scheme of dynamic groups is that the members need to be specified as full DNs.<br/>So, if you are planning in using this for&#160;posixGroups, be sure to use RFC2307bis and some attribute which<br/>can hold distinguished names. The&#160;memberUid&#160;attribute used in the&#160;posixGroup&#160;object class can hold<br/>only names, not DNs, and is therefore not suitable for dynamic groups.<br/>
<b>12.7.3. Further Information</b><br/>
<i>slapo-dynlist(5)</i><br/>
<b>12.8. Reverse Group Membership Maintenance</b><br/>
<b>12.8.1. Overview</b><br/>
In some scenarios, it may be desirable for a client to be able to determine which groups an entry is a member<br/>of, without performing an additional search. Examples of this are applications using the DIT for access control<br/>based on group authorization.<br/>
The<b>&#160;memberof</b>&#160;overlay updates an attribute (by default<b>&#160;memberOf</b>) whenever changes occur to the<br/>membership attribute (by default<b>&#160;member</b>) of entries of the objectclass (by default<b>&#160;groupOfNames</b>)<br/>configured to trigger updates.<br/>
Thus, it provides maintenance of the list of groups an entry is a member of, when usual maintenance of groups<br/>is done by modifying the members on the group entry.<br/>
<b>12.8.2. Member Of Configuration</b><br/>
The typical use of this overlay requires just enabling the overlay for a specific database. For example, with the<br/>following minimal slapd.conf:<br/>
&#160; &#160; &#160; &#160; include /usr/share/openldap/schema/core.schema<br/>
&#160; &#160; &#160; &#160; include /usr/share/openldap/schema/cosine.schema<br/>
&#160; &#160; &#160; &#160; authz-regexp &#34;gidNumber=0\\\+uidNumber=0,cn=peercred,cn=external,cn=auth&#34;<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#34;cn=Manager,dc=example,dc=com&#34;<br/>
&#160; &#160; &#160; &#160; database &#160; &#160; &#160; &#160;bdb<br/>
&#160; &#160; &#160; &#160; suffix &#160; &#160; &#160; &#160; &#160;&#34;dc=example,dc=com&#34;<br/>
&#160; &#160; &#160; &#160; rootdn &#160; &#160; &#160; &#160; &#160;&#34;cn=Manager,dc=example,dc=com&#34;<br/>
&#160; &#160; &#160; &#160; rootpw &#160; &#160; &#160; &#160; &#160;secret<br/>
&#160; &#160; &#160; &#160; directory &#160; &#160; &#160; /var/lib/ldap2.4<br/>
&#160; &#160; &#160; &#160; checkpoint 256 5<br/>
&#160; &#160; &#160; &#160; index &#160; objectClass &#160; eq<br/>
&#160; &#160; &#160; &#160; index &#160; uid &#160; &#160; &#160; &#160; &#160; eq,sub<br/>
111<br/>
<hr/>
<a name=126></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
&#160; &#160; &#160; &#160; overlay memberof<br/>
adding the following ldif:<br/>
&#160; &#160; &#160; &#160; cat memberof.ldif<br/>
&#160; &#160; &#160; &#160; dn: dc=example,dc=com<br/>
&#160; &#160; &#160; &#160; objectclass: domain<br/>
&#160; &#160; &#160; &#160; dc: example<br/>
&#160; &#160; &#160; &#160; dn: ou=Group,dc=example,dc=com<br/>
&#160; &#160; &#160; &#160; objectclass: organizationalUnit<br/>
&#160; &#160; &#160; &#160; ou: Group<br/>
&#160; &#160; &#160; &#160; dn: ou=People,dc=example,dc=com<br/>
&#160; &#160; &#160; &#160; objectclass: organizationalUnit<br/>
&#160; &#160; &#160; &#160; ou: People<br/>
&#160; &#160; &#160; &#160; dn: uid=test1,ou=People,dc=example,dc=com<br/>
&#160; &#160; &#160; &#160; objectclass: account<br/>
&#160; &#160; &#160; &#160; uid: test1<br/>
&#160; &#160; &#160; &#160; dn: cn=testgroup,ou=Group,dc=example,dc=com<br/>
&#160; &#160; &#160; &#160; objectclass: groupOfNames<br/>
&#160; &#160; &#160; &#160; cn: testgroup<br/>
&#160; &#160; &#160; &#160; member: uid=test1,ou=People,dc=example,dc=com<br/>
Results in the following output from a search on the test1 user:<br/>
&#160;# ldapsearch -LL -Y EXTERNAL -H ldapi:/// &#34;(uid=test1)&#34; -b dc=example,dc=com memberOf<br/>
&#160;SASL/EXTERNAL authentication started<br/>
&#160;SASL username: gidNumber=0+uidNumber=0,cn=peercred,cn=external,cn=auth<br/>
&#160;SASL SSF: 0<br/>
&#160;version: 1<br/>
&#160;dn: uid=test1,ou=People,dc=example,dc=com<br/>
&#160;memberOf: cn=testgroup,ou=Group,dc=example,dc=com<br/>
Note that the<b>&#160;memberOf</b>&#160;attribute is an operational attribute, so it must be requested explicitly.<br/>
<b>12.8.3. Further Information</b><br/>
<i>slapo-memberof(5)</i><br/>
<b>12.9. The Proxy Cache Engine</b><br/>
LDAP servers typically hold one or more subtrees of a DIT. Replica (or shadow) servers hold shadow copies<br/>of entries held by one or more master servers. Changes are propagated from the master server to replica<br/>(slave) servers using LDAP Sync replication. An LDAP cache is a special type of replica which holds entries<br/>corresponding to search filters instead of subtrees.<br/>
<b>12.9.1. Overview</b><br/>
The proxy cache extension of slapd is designed to improve the responsiveness of the ldap and meta backends.<br/>It handles a search request (query) by first determining whether it is contained in any cached search filter.<br/>
112<br/>
<hr/>
<a name=127></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
Contained requests are answered from the proxy cache's local database. Other requests are passed on to the<br/>underlying ldap or meta backend and processed as usual.<br/>
E.g.&#160;(shoesize&gt;=9)&#160;is contained in&#160;(shoesize&gt;=8)&#160;and&#160;(sn=Richardson)&#160;is contained in<br/>(sn=Richards*)<br/>
Correct matching rules and syntaxes are used while comparing assertions for query containment. To simplify<br/>the query containment problem, a list of cacheable &#34;templates&#34; (defined below) is specified at configuration<br/>time. A query is cached or answered only if it belongs to one of these templates. The entries corresponding to<br/>cached queries are stored in the proxy cache local database while its associated meta information (filter,<br/>scope, base, attributes) is stored in main memory.<br/>
A template is a prototype for generating LDAP search requests. Templates are described by a prototype search<br/>filter and a list of attributes which are required in queries generated from the template. The representation for<br/><a href="http://www.rfc-editor.org/rfc/rfc4515.txt">prototype filter is similar to RFC4515, except that the assertion values are missing. Examples of prototype<br/></a>filters are: (sn=),(&amp;(sn=)(givenname=)) which are instantiated by search filters (sn=Doe) and<br/>(&amp;(sn=Doe)(givenname=John)) respectively.<br/>
The cache replacement policy removes the least recently used (LRU) query and entries belonging to only that<br/>query. Queries are allowed a maximum time to live (TTL) in the cache thus providing weak consistency. A<br/>background task periodically checks the cache for expired queries and removes them.<br/>
<a href="http://www.openldap.org/pub/kapurva/proxycaching.pdf">The Proxy Cache paper (http://www.openldap.org/pub/kapurva/proxycaching.pdf) provides design and<br/></a>implementation details.<br/>
<b>12.9.2. Proxy Cache Configuration</b><br/>
The cache configuration specific directives described below must appear after a&#160;overlay pcache<br/>directive within a&#160;&#34;database meta&#34;&#160;or&#160;&#34;database ldap&#34;&#160;section of the server's<i>&#160;slapd.conf</i>(5) file.<br/>
<b>12.9.2.1. Setting cache parameters</b><br/>
&#160;pcache &lt;DB&gt; &lt;maxentries&gt; &lt;nattrsets&gt; &lt;entrylimit&gt; &lt;period&gt;<br/>
This directive enables proxy caching and sets general cache parameters. The &lt;DB&gt; parameter specifies which<br/>underlying database is to be used to hold cached entries. It should be set to&#160;bdb&#160;or&#160;hdb. The &lt;maxentries&gt;<br/>parameter specifies the total number of entries which may be held in the cache. The &lt;nattrsets&gt; parameter<br/>specifies the total number of attribute sets (as specified by the&#160;pcacheAttrset&#160;directive) that may be<br/>defined. The &lt;entrylimit&gt; parameter specifies the maximum number of entries in a cacheable query. The<br/>&lt;period&gt; specifies the consistency check period (in seconds). In each period, queries with expired TTLs are<br/>removed.<br/>
<b>12.9.2.2. Defining attribute sets</b><br/>
&#160;pcacheAttrset &lt;index&gt; &lt;attrs...&gt;<br/>
Used to associate a set of attributes to an index. Each attribute set is associated with an index number from 0<br/>to &lt;numattrsets&gt;-1. These indices are used by the pcacheTemplate directive to define cacheable templates.<br/>
113<br/>
<hr/>
<a name=128></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
<b>12.9.2.3. Specifying cacheable templates</b><br/>
&#160;pcacheTemplate &lt;prototype_string&gt; &lt;attrset_index&gt; &lt;TTL&gt;<br/>
Specifies a cacheable template and the &#34;time to live&#34; (in sec) &lt;TTL&gt; for queries belonging to the template. A<br/>template is described by its prototype filter string and set of required attributes identified by &lt;attrset_index&gt;.<br/>
<b>12.9.2.4. Example for slapd.conf</b><br/>
An example<i>&#160;slapd.conf</i>(5) database section for a caching server which proxies for the<br/>&#34;dc=example,dc=com&#34;&#160;subtree held at server&#160;ldap.example.com.<br/>
&#160; &#160; &#160; &#160; database &#160; &#160; &#160; &#160;ldap<br/>
&#160; &#160; &#160; &#160; suffix &#160; &#160; &#160; &#160; &#160;&#34;dc=example,dc=com&#34;<br/>
&#160; &#160; &#160; &#160; rootdn &#160; &#160; &#160; &#160; &#160;&#34;dc=example,dc=com&#34;<br/>
&#160; &#160; &#160; &#160; uri &#160; &#160; &#160; &#160; &#160; &#160; ldap://ldap.example.com/<br/>
&#160; &#160; &#160; &#160; overlay pcache<br/>
&#160; &#160; &#160; &#160; pcache &#160; &#160; &#160; &#160; hdb 100000 1 1000 100<br/>
&#160; &#160; &#160; &#160; pcacheAttrset &#160;0 mail postaladdress telephonenumber<br/>
&#160; &#160; &#160; &#160; pcacheTemplate (sn=) 0 3600<br/>
&#160; &#160; &#160; &#160; pcacheTemplate (&amp;(sn=)(givenName=)) 0 3600<br/>
&#160; &#160; &#160; &#160; pcacheTemplate (&amp;(departmentNumber=)(secretary=*)) 0 3600<br/>
&#160; &#160; &#160; &#160; cachesize 20<br/>
&#160; &#160; &#160; &#160; directory ./testrun/db.2.a<br/>
&#160; &#160; &#160; &#160; index &#160; &#160; &#160; objectClass eq<br/>
&#160; &#160; &#160; &#160; index &#160; &#160; &#160; cn,sn,uid,mail &#160;pres,eq,sub<br/>
<b>12.9.2.5. Example for slapd-config</b><br/>
The same example as a LDIF file for back-config for a caching server which proxies for the<br/>&#34;dc=example,dc=com&#34;&#160;subtree held at server&#160;ldap.example.com.<br/>
&#160; &#160;dn: olcDatabase={2}ldap,cn=config<br/>
&#160; &#160;objectClass: olcDatabaseConfig<br/>
&#160; &#160;objectClass: olcLDAPConfig<br/>
&#160; &#160;olcDatabase: {2}ldap<br/>
&#160; &#160;olcSuffix: dc=example,dc=com<br/>
&#160; &#160;olcRootDN: dc=example,dc=com<br/>
&#160; &#160;olcDbURI: &#34;ldap://ldap.example.com&#34;<br/>
&#160; &#160;dn: olcOverlay={0}pcache,olcDatabase={2}ldap,cn=config<br/>
&#160; &#160;objectClass: olcOverlayConfig<br/>
&#160; &#160;objectClass: olcPcacheConfig<br/>
&#160; &#160;olcOverlay: {0}pcache<br/>
&#160; &#160;olcPcache: hdb 100000 1 1000 100<br/>
&#160; &#160;olcPcacheAttrset: 0 mail postalAddress telephoneNumber<br/>
&#160; &#160;olcPcacheTemplate: &#34;(sn=)&#34; 0 3600 0 0 0<br/>
&#160; &#160;olcPcacheTemplate: &#34;(&amp;(sn=)(givenName=))&#34; 0 3600 0 0 0<br/>
&#160; &#160;olcPcacheTemplate: &#34;(&amp;(departmentNumber=)(secretary=))&#34; 0 3600<br/>
&#160; &#160;dn: olcDatabase={0}hdb,olcOverlay={0}pcache,olcDatabase={2}ldap,cn=config<br/>
&#160; &#160;objectClass: olcHdbConfig<br/>
&#160; &#160;objectClass: olcPcacheDatabase<br/>
&#160; &#160;olcDatabase: {0}hdb<br/>
&#160; &#160;olcDbDirectory: ./testrun/db.2.a<br/>
&#160; &#160;olcDbCacheSize: 20<br/>
&#160; &#160;olcDbIndex: objectClass eq<br/>
114<br/>
<hr/>
<a name=129></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
&#160; &#160;olcDbIndex: cn,sn,uid,mail &#160;pres,eq,sub<br/>
<b>12.9.2.5.1. Cacheable Queries</b><br/>
A LDAP search query is cacheable when its filter matches one of the templates as defined in the<br/>&#34;pcacheTemplate&#34; statements and when it references only the attributes specified in the corresponding<br/>attribute set. In the example above the attribute set number 0 defines that only the attributes:&#160;mail<br/>postaladdress telephonenumber&#160;are cached for the following pcacheTemplates.<br/>
<b>12.9.2.5.2. Examples:</b><br/>
&#160; &#160; &#160; &#160; Filter: (&amp;(sn=Richard*)(givenName=jack))<br/>
&#160; &#160; &#160; &#160; Attrs: mail telephoneNumber<br/>
is cacheable, because it matches the template&#160;(&amp;(sn=)(givenName=))&#160;and its attributes are contained in<br/>pcacheAttrset 0.<br/>
&#160; &#160; &#160; &#160; Filter: (&amp;(sn=Richard*)(telephoneNumber))<br/>
&#160; &#160; &#160; &#160; Attrs: givenName<br/>
is not cacheable, because the filter does not match the template, nor is the attribute givenName stored in the<br/>cache<br/>
&#160; &#160; &#160; &#160; Filter: (|(sn=Richard*)(givenName=jack))<br/>
&#160; &#160; &#160; &#160; Attrs: mail telephoneNumber<br/>
is not cacheable, because the filter does not match the template ( logical OR &#34;|&#34; condition instead of logical<br/>AND &#34;&amp;&#34; )<br/>
<b>12.9.3. Further Information</b><br/>
<i>slapo-pcache(5)</i><br/>
<b>12.10. Password Policies</b><br/>
<b>12.10.1. Overview</b><br/>
This overlay follows the specifications contained in the draft RFC titled<br/>draft-behera-ldap-password-policy-09. While the draft itself is expired, it has been implemented in several<br/>directory servers, including slapd. Nonetheless, it is important to note that it is a draft, meaning that it is<br/>subject to change and is a work-in-progress.<br/>
The key abilities of the password policy overlay are as follows:<br/>
Enforce a minimum length for new passwords<br/>
&#160;<br/>
Make sure passwords are not changed too frequently<br/>
&#160;<br/>
Cause passwords to expire, provide warnings before they need to be changed, and allow a fixed<br/>
&#160;<br/>
number of 'grace' logins to allow them to be changed after they have expired<br/>Maintain a history of passwords to prevent password re-use<br/>
&#160;<br/>
Prevent password guessing by locking a password for a specified period of time after repeated<br/>
&#160;<br/>
authentication failures<br/>
115<br/>
<hr/>
<a name=130></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
Force a password to be changed at the next authentication<br/>
&#160;<br/>
Set an administrative lock on an account<br/>
&#160;<br/>
Support multiple password policies on a default or a per-object basis.<br/>
&#160;<br/>
Perform arbitrary quality checks using an external loadable module. This is a non-standard extension<br/>
&#160;<br/>
of the draft RFC.<br/>
<b>12.10.2. Password Policy Configuration</b><br/>
Instantiate the module in the database where it will be used, after adding the new ppolicy schema and loading<br/>the ppolicy module. The following example shows the ppolicy module being added to the database that<br/>handles the naming context &#34;dc=example,dc=com&#34;. In this example we are also specifying the DN of a policy<br/>object to use if none other is specified in a user's object.<br/>
&#160; &#160; &#160; &#160;database bdb<br/>
&#160; &#160; &#160; &#160;suffix &#34;dc=example,dc=com&#34;<br/>
&#160; &#160; &#160; &#160;[...additional database configuration directives go here...]<br/>
&#160; &#160; &#160; &#160;overlay ppolicy<br/>
&#160; &#160; &#160; &#160;ppolicy_default &#34;cn=default,ou=policies,dc=example,dc=com&#34;<br/>
Now we need a container for the policy objects. In our example the password policy objects are going to be<br/>placed in a section of the tree called &#34;ou=policies,dc=example,dc=com&#34;:<br/>
&#160; &#160; &#160; &#160;dn: ou=policies,dc=example,dc=com<br/>
&#160; &#160; &#160; &#160;objectClass: organizationalUnit<br/>
&#160; &#160; &#160; &#160;objectClass: top<br/>
&#160; &#160; &#160; &#160;ou: policies<br/>
The default policy object that we are creating defines the following policies:<br/>
The user is allowed to change his own password. Note that the directory ACLs for this attribute can<br/>
&#160;<br/>
also affect this ability (pwdAllowUserChange: TRUE).<br/>The name of the password attribute is &#34;userPassword&#34; (pwdAttribute: userPassword). Note that this is<br/>
&#160;<br/>
the only value that is accepted by OpenLDAP for this attribute.<br/>The server will check the syntax of the password. If the server is unable to check the syntax (i.e., it<br/>
&#160;<br/>
was hashed or otherwise encoded by the client) it will return an error refusing the password<br/>(pwdCheckQuality: 2).<br/>When a client includes the Password Policy Request control with a bind request, the server will<br/>
&#160;<br/>
respond with a password expiration warning if it is going to expire in ten minutes or less<br/>(pwdExpireWarning: 600). The warnings themselves are returned in a Password Policy Response<br/>control.<br/>When the password for a DN has expired, the server will allow five additional &#34;grace&#34; logins<br/>
&#160;<br/>
(pwdGraceAuthNLimit: 5).<br/>The server will maintain a history of the last five passwords that were used for a DN (pwdInHistory:<br/>
&#160;<br/>
5).<br/>The server will lock the account after the maximum number of failed bind attempts has been exceeded<br/>
&#160;<br/>
(pwdLockout: TRUE).<br/>When the server has locked an account, the server will keep it locked until an administrator unlocks it<br/>
&#160;<br/>
(pwdLockoutDuration: 0)<br/>The server will reset its failed bind count after a period of 30 seconds.<br/>
&#160;<br/>
Passwords will not expire (pwdMaxAge: 0).<br/>
&#160;<br/>
Passwords can be changed as often as desired (pwdMinAge: 0).<br/>
&#160;<br/>
116<br/>
<hr/>
<a name=131></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
Passwords must be at least 5 characters in length (pwdMinLength: 5).<br/>
&#160;<br/>
The password does not need to be changed at the first bind or when the administrator has reset the<br/>
&#160;<br/>
password (pwdMustChange: FALSE)<br/>The current password does not need to be included with password change requests (pwdSafeModify:<br/>
&#160;<br/>
FALSE)<br/>The server will only allow five failed binds in a row for a particular DN (pwdMaxFailure: 5).<br/>
&#160;<br/>
The actual policy would be:<br/>
&#160; &#160; &#160; &#160;dn: cn=default,ou=policies,dc=example,dc=com<br/>
&#160; &#160; &#160; &#160;cn: default<br/>
&#160; &#160; &#160; &#160;objectClass: pwdPolicy<br/>
&#160; &#160; &#160; &#160;objectClass: person<br/>
&#160; &#160; &#160; &#160;objectClass: top<br/>
&#160; &#160; &#160; &#160;pwdAllowUserChange: TRUE<br/>
&#160; &#160; &#160; &#160;pwdAttribute: userPassword<br/>
&#160; &#160; &#160; &#160;pwdCheckQuality: 2<br/>
&#160; &#160; &#160; &#160;pwdExpireWarning: 600<br/>
&#160; &#160; &#160; &#160;pwdFailureCountInterval: 30<br/>
&#160; &#160; &#160; &#160;pwdGraceAuthNLimit: 5<br/>
&#160; &#160; &#160; &#160;pwdInHistory: 5<br/>
&#160; &#160; &#160; &#160;pwdLockout: TRUE<br/>
&#160; &#160; &#160; &#160;pwdLockoutDuration: 0<br/>
&#160; &#160; &#160; &#160;pwdMaxAge: 0<br/>
&#160; &#160; &#160; &#160;pwdMaxFailure: 5<br/>
&#160; &#160; &#160; &#160;pwdMinAge: 0<br/>
&#160; &#160; &#160; &#160;pwdMinLength: 5<br/>
&#160; &#160; &#160; &#160;pwdMustChange: FALSE<br/>
&#160; &#160; &#160; &#160;pwdSafeModify: FALSE<br/>
&#160; &#160; &#160; &#160;sn: dummy value<br/>
You can create additional policy objects as needed.<br/>
There are two ways password policy can be applied to individual objects:<br/>
1. The pwdPolicySubentry in a user's object - If a user's object has a pwdPolicySubEntry attribute specifying<br/>the DN of a policy object, then the policy defined by that object is applied.<br/>
2. Default password policy - If there is no specific pwdPolicySubentry set for an object, and the password<br/>policy module was configured with the DN of a default policy object and if that object exists, then the policy<br/>defined in that object is applied.<br/>
Please see<i>&#160;slapo-ppolicy(5)</i>&#160;for complete explanations of features and discussion of &#34;Password Management<br/><a href="http://www.symas.com/blog/?page_id=66">Issues&#34; at http://www.symas.com/blog/?page_id=66</a><br/>
<b>12.10.3. Further Information</b><br/>
<i>slapo-ppolicy(5)</i><br/>
<b>12.11. Referential Integrity</b><br/>
117<br/>
<hr/>
<a name=132></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
<b>12.11.1. Overview</b><br/>
This overlay can be used with a backend database such as slapd-bdb(5) to maintain the cohesiveness of a<br/>schema which utilizes reference attributes.<br/>
Whenever a<i>&#160;modrdn</i>&#160;or<i>&#160;delete</i>&#160;is performed, that is, when an entry's DN is renamed or an entry is removed, the<br/>server will search the directory for references to this DN (in selected attributes: see below) and update them<br/>accordingly. If it was a<i>&#160;delete</i>&#160;operation, the reference is deleted. If it was a<i>&#160;modrdn</i>&#160;operation, then the<br/>reference is updated with the new DN.<br/>
For example, a very common administration task is to maintain group membership lists, specially when users<br/>are removed from the directory. When an user account is deleted or renamed, all groups this user is a member<br/>of have to be updated. LDAP administrators usually have scripts for that. But we can use the&#160;refint&#160;overlay<br/>to automate this task. In this example, if the user is removed from the directory, the overlay will take care to<br/>remove the user from all the groups he/she was a member of. No more scripting for this.<br/>
<b>12.11.2. Referential Integrity Configuration</b><br/>
The configuration for this overlay is as follows:<br/>
&#160; &#160; &#160; &#160;overlay refint<br/>
&#160; &#160; &#160; &#160;refint_attributes &lt;attribute [attribute ...]&gt;<br/>
&#160; &#160; &#160; &#160;refint_nothing &lt;string&gt;<br/>
refint_attributes<br/>
&#160;<br/>
: this parameter specifies a space separated list of attributes which will have<br/>
the referential integrity maintained. When an entry is removed or has its DN renamed, the server will<br/>do an internal search for any of the&#160;refint_attributes&#160;that point to the affected DN and update<br/>them accordingly. IMPORTANT: the attributes listed here must have the&#160;distinguishedName<br/>syntax, that is, hold DNs as values.<br/>refint_nothing<br/>
&#160;<br/>
: some times, while trying to maintain the referential integrity, the server has to<br/>
remove the last attribute of its kind from an entry. This may be prohibited by the schema: for<br/>example, the&#160;groupOfNames&#160;object class requires at least one member. In these cases, the server<br/>will add the attribute value specified in&#160;refint_nothing&#160;to the entry.<br/>
To illustrate this overlay, we will use the group membership scenario.<br/>
In&#160;slapd.conf:<br/>
&#160; &#160; &#160; &#160;overlay refint<br/>
&#160; &#160; &#160; &#160;refint_attributes member<br/>
&#160; &#160; &#160; &#160;refint_nothing &#34;cn=admin,dc=example,dc=com&#34;<br/>
This configuration tells the overlay to maintain the referential integrity of the&#160;member&#160;attribute. This attribute<br/>is used in the&#160;groupOfNames&#160;object class which always needs a member, so we add the<br/>refint_nothing&#160;directive to fill in the group with a standard member should all the members vanish.<br/>
If we have the following group membership, the refint overlay will automatically remove&#160;john&#160;from the<br/>group if his entry is removed from the directory:<br/>
118<br/>
<hr/>
<a name=133></a><img src="../img/OpenLDAP-Admin-Guide-133_1.png"/><br/>
OpenLDAP Software 2.4 Administrator's Guide<br/>
Figure X.Y: Maintaining referential integrity in groups<br/>
Notice that if we rename (modrdn) the&#160;john&#160;entry to, say,&#160;jsmith, the refint overlay will also rename the<br/>reference in the&#160;member&#160;attribute, so the group membership stays correct.<br/>
If we removed all users from the directory who are a member of this group, then the end result would be a<br/>single member in the group:&#160;cn=admin,dc=example,dc=com. This is the&#160;refint_nothing<br/>parameter kicking into action so that the schema is not violated.<br/>
The<i>&#160;rootdn</i>&#160;must be set for the database as refint runs as the<i>&#160;rootdn</i>&#160;to gain access to make its updates. The<br/><i>rootpw</i>&#160;does not need to be set.<br/>
<b>12.11.3. Further Information</b><br/>
<i>slapo-refint(5)</i><br/>
<b>12.12. Return Code</b><br/>
<b>12.12.1. Overview</b><br/>
This overlay is useful to test the behavior of clients when server-generated erroneous and/or unusual<br/>responses occur, for example; error codes, referrals, excessive response times and so on.<br/>
This would be classed as a debugging tool whilst developing client software or additional Overlays.<br/>
For detailed information, please see the<i>&#160;slapo-retcode(5)</i>&#160;man page.<br/>
<b>12.12.2. Return Code Configuration</b><br/>
The retcode overlay utilizes the &#34;return code&#34; schema described in the man page. This schema is specifically<br/>designed for use with this overlay and is not intended to be used otherwise.<br/>
<b>Note:</b>&#160;The necessary schema is loaded automatically by the overlay.<br/>
An example configuration might be:<br/>
&#160; &#160; &#160; &#160;overlay &#160; &#160; &#160; &#160; retcode<br/>
&#160; &#160; &#160; &#160;retcode-parent &#160;&#34;ou=RetCodes,dc=example,dc=com&#34;<br/>
119<br/>
<hr/>
<a name=134></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
&#160; &#160; &#160; &#160;include &#160; &#160; &#160; &#160; ./retcode.conf<br/>
&#160; &#160; &#160; &#160;retcode-item &#160; &#160;&#34;cn=Unsolicited&#34; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;0x00 unsolicited=&#34;0&#34;<br/>
&#160; &#160; &#160; &#160;retcode-item &#160; &#160;&#34;cn=Notice of Disconnect&#34; &#160; &#160; &#160; 0x00 unsolicited=&#34;1.3.6.1.4.1.1466.20036&#34;<br/>
&#160; &#160; &#160; &#160;retcode-item &#160; &#160;&#34;cn=Pre-disconnect&#34; &#160; &#160; &#160; &#160; &#160; &#160; 0x34 flags=&#34;pre-disconnect&#34;<br/>
&#160; &#160; &#160; &#160;retcode-item &#160; &#160;&#34;cn=Post-disconnect&#34; &#160; &#160; &#160; &#160; &#160; &#160;0x34 flags=&#34;post-disconnect&#34;<br/>
<b>Note:</b><i>&#160;retcode.conf</i>&#160;can be found in the openldap source at:&#160;tests/data/retcode.conf<br/>
An excerpt of a&#160;retcode.conf&#160;would be something like:<br/>
&#160; &#160; &#160; &#160;retcode-item &#160; &#160;&#34;cn=success&#34; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;0x00<br/>
&#160; &#160; &#160; &#160;retcode-item &#160; &#160;&#34;cn=success w/ delay&#34; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; 0x00 &#160; &#160;sleeptime=2<br/>
&#160; &#160; &#160; &#160;retcode-item &#160; &#160;&#34;cn=operationsError&#34; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;0x01<br/>
&#160; &#160; &#160; &#160;retcode-item &#160; &#160;&#34;cn=protocolError&#34; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;0x02<br/>
&#160; &#160; &#160; &#160;retcode-item &#160; &#160;&#34;cn=timeLimitExceeded&#34; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;0x03 &#160; &#160;op=search<br/>
&#160; &#160; &#160; &#160;retcode-item &#160; &#160;&#34;cn=sizeLimitExceeded&#34; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;0x04 &#160; &#160;op=search<br/>
&#160; &#160; &#160; &#160;retcode-item &#160; &#160;&#34;cn=compareFalse&#34; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; 0x05 &#160; &#160;op=compare<br/>
&#160; &#160; &#160; &#160;retcode-item &#160; &#160;&#34;cn=compareTrue&#34; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;0x06 &#160; &#160;op=compare<br/>
&#160; &#160; &#160; &#160;retcode-item &#160; &#160;&#34;cn=authMethodNotSupported&#34; &#160; &#160; &#160; &#160; &#160; &#160; 0x07<br/>
&#160; &#160; &#160; &#160;retcode-item &#160; &#160;&#34;cn=strongAuthNotSupported&#34; &#160; &#160; &#160; &#160; &#160; &#160; 0x07 &#160; &#160;text=&#34;same as authMethodNotSupported&#34;<br/>
&#160; &#160; &#160; &#160;retcode-item &#160; &#160;&#34;cn=strongAuthRequired&#34; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; 0x08<br/>
&#160; &#160; &#160; &#160;retcode-item &#160; &#160;&#34;cn=strongerAuthRequired&#34; &#160; &#160; &#160; &#160; &#160; &#160; &#160; 0x08 &#160; &#160;text=&#34;same as strongAuthRequired&#34;<br/>
Please see&#160;tests/data/retcode.conf&#160;for a complete&#160;retcode.conf<br/>
<b>12.12.3. Further Information</b><br/>
<i>slapo-retcode(5)</i><br/>
<b>12.13. Rewrite/Remap</b><br/>
<b>12.13.1. Overview</b><br/>
It performs basic DN/data rewrite and objectClass/attributeType mapping. Its usage is mostly intended to<br/>provide virtual views of existing data either remotely, in conjunction with the proxy backend described in<br/><i>slapd-ldap(5)</i>, or locally, in conjunction with the relay backend described in<i>&#160;slapd-relay(5)</i>.<br/>
This overlay is extremely configurable and advanced, therefore recommended reading is the<i>&#160;slapo-rwm(5)<br/></i>man page.<br/>
<b>12.13.2. Rewrite/Remap Configuration</b><br/>
<b>12.13.3. Further Information</b><br/>
<i>slapo-rwm(5)</i><br/>
<b>12.14. Sync Provider</b><br/>
120<br/>
<hr/>
<a name=135></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
<b>12.14.1. Overview</b><br/>
<a href="http://www.rfc-editor.org/rfc/rfc4533.txt">This overlay implements the provider-side support for the LDAP Content Synchronization (RFC4533) as well<br/></a>as syncrepl replication support, including persistent search functionality.<br/>
<b>12.14.2. Sync Provider Configuration</b><br/>
There is very little configuration needed for this overlay, in fact for many situations merely loading the<br/>overlay will suffice.<br/>
However, because the overlay creates a contextCSN attribute in the root entry of the database which is<br/>updated for every write operation performed against the database and only updated in memory, it is<br/>recommended to configure a checkpoint so that the contextCSN is written into the underlying database to<br/>minimize recovery time after an unclean shutdown:<br/>
&#160; &#160; &#160; &#160;overlay syncprov<br/>
&#160; &#160; &#160; &#160;syncprov-checkpoint 100 10<br/>
For every 100 operations or 10 minutes, which ever is sooner, the contextCSN will be checkpointed.<br/>
The four configuration directives available are<b>&#160;syncprov-checkpoint</b>,<b>&#160;syncprov-sessionlog</b>,<br/><b>syncprov-nopresent</b>&#160;and<b>&#160;syncprov-reloadhint</b>&#160;which are covered in the man page discussing various other<br/>scenarios where this overlay can be used.<br/>
<b>12.14.3. Further Information</b><br/>
The<i>&#160;slapo-syncprov(5)</i><a href="OpenLDAP-Admin-Guides.html#184">&#160;man page and the Configuring the different replication types section</a><br/>
<b>12.15. Translucent Proxy</b><br/>
<b>12.15.1. Overview</b><br/>
This overlay can be used with a backend database such as<i>&#160;slapd-bdb</i>(5) to create a &#34;translucent proxy&#34;.<br/>
Entries retrieved from a remote LDAP server may have some or all attributes overridden, or new attributes<br/>added, by entries in the local database before being presented to the client.<br/>
A search operation is first populated with entries from the remote LDAP server, the attributes of which are<br/>then overridden with any attributes defined in the local database. Local overrides may be populated with the<br/>add, modify, and modrdn operations, the use of which is restricted to the root user of the translucent local<br/>database.<br/>
A compare operation will perform a comparison with attributes defined in the local database record (if any)<br/>before any comparison is made with data in the remote database.<br/>
<b>12.15.2. Translucent Proxy Configuration</b><br/>
There are various options available with this overlay, but for this example we will demonstrate adding new<br/>attributes to a remote entry and also searching against these newly added local attributes. For more<br/>information about overriding remote entries and search configuration, please see<i>&#160;slapo-translucent(5)</i><br/>
121<br/>
<hr/>
<a name=136></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
<b>Note:</b>&#160;The Translucent Proxy overlay will disable schema checking in the local database, so that an entry<br/>consisting of overlay attributes need not adhere to the complete schema.<br/>
First we configure the overlay in the normal manner:<br/>
&#160; &#160; &#160; &#160;include &#160; &#160; /usr/local/etc/openldap/schema/core.schema<br/>
&#160; &#160; &#160; &#160;include &#160; &#160; /usr/local/etc/openldap/schema/cosine.schema<br/>
&#160; &#160; &#160; &#160;include &#160; &#160; /usr/local/etc/openldap/schema/nis.schema<br/>
&#160; &#160; &#160; &#160;include &#160; &#160; /usr/local/etc/openldap/schema/inetorgperson.schema<br/>
&#160; &#160; &#160; &#160;pidfile &#160; &#160; ./slapd.pid<br/>
&#160; &#160; &#160; &#160;argsfile &#160; &#160;./slapd.args<br/>
&#160; &#160; &#160; &#160;database &#160; &#160;bdb<br/>
&#160; &#160; &#160; &#160;suffix &#160; &#160; &#160;&#34;dc=suretecsystems,dc=com&#34;<br/>
&#160; &#160; &#160; &#160;rootdn &#160; &#160; &#160;&#34;cn=trans,dc=suretecsystems,dc=com&#34;<br/>
&#160; &#160; &#160; &#160;rootpw &#160; &#160; &#160;secret<br/>
&#160; &#160; &#160; &#160;directory &#160; ./openldap-data<br/>
&#160; &#160; &#160; &#160;index &#160; &#160; &#160; objectClass eq<br/>
&#160; &#160; &#160; &#160;overlay &#160; &#160; translucent<br/>
&#160; &#160; &#160; &#160;translucent_local carLicense<br/>
&#160; &#160; &#160; &#160;uri &#160; &#160; &#160; &#160; ldap://192.168.X.X:389<br/>
&#160; &#160; &#160; &#160;lastmod &#160; &#160; off<br/>
&#160; &#160; &#160; &#160;acl-bind &#160; &#160;binddn=&#34;cn=admin,dc=suretecsystems,dc=com&#34; credentials=&#34;blahblah&#34;<br/>
You will notice the overlay directive and a directive to say what attribute we want to be able to search against<br/>in the local database. We must also load the ldap backend which will connect to the remote directory server.<br/>
Now we take an example LDAP group:<br/>
&#160; &#160; &#160; &#160;# itsupport, Groups, suretecsystems.com<br/>
&#160; &#160; &#160; &#160;dn: cn=itsupport,ou=Groups,dc=suretecsystems,dc=com<br/>
&#160; &#160; &#160; &#160;objectClass: posixGroup<br/>
&#160; &#160; &#160; &#160;objectClass: sambaGroupMapping<br/>
&#160; &#160; &#160; &#160;cn: itsupport<br/>
&#160; &#160; &#160; &#160;gidNumber: 1000<br/>
&#160; &#160; &#160; &#160;sambaSID: S-1-5-21-XXX<br/>
&#160; &#160; &#160; &#160;sambaGroupType: 2<br/>
&#160; &#160; &#160; &#160;displayName: itsupport<br/>
&#160; &#160; &#160; &#160;memberUid: ghenry<br/>
&#160; &#160; &#160; &#160;memberUid: joebloggs<br/>
and create an LDIF file we can use to add our data to the local database, using some pretty strange choices of<br/>new attributes for demonstration purposes:<br/>
&#160; &#160; &#160; &#160;[ghenry@suretec test_configs]$ cat test-translucent-add.ldif<br/>
&#160; &#160; &#160; &#160;dn: cn=itsupport,ou=Groups,dc=suretecsystems,dc=com<br/>
&#160; &#160; &#160; &#160;businessCategory: frontend-override<br/>
&#160; &#160; &#160; &#160;carLicense: LIVID<br/>
&#160; &#160; &#160; &#160;employeeType: special<br/>
&#160; &#160; &#160; &#160;departmentNumber: 9999999<br/>
&#160; &#160; &#160; &#160;roomNumber: 41L-535<br/>
122<br/>
<hr/>
<a name=137></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
Searching against the proxy gives:<br/>
&#160; &#160; &#160; &#160;[ghenry@suretec test_configs]$ ldapsearch -x -H ldap://127.0.0.1:9001 &#34;(cn=itsupport)&#34;<br/>
&#160; &#160; &#160; &#160;# itsupport, Groups, OxObjects, suretecsystems.com<br/>
&#160; &#160; &#160; &#160;dn: cn=itsupport,ou=Groups,ou=OxObjects,dc=suretecsystems,dc=com<br/>
&#160; &#160; &#160; &#160;objectClass: posixGroup<br/>
&#160; &#160; &#160; &#160;objectClass: sambaGroupMapping<br/>
&#160; &#160; &#160; &#160;cn: itsupport<br/>
&#160; &#160; &#160; &#160;gidNumber: 1003<br/>
&#160; &#160; &#160; &#160;SAMBASID: S-1-5-21-XXX<br/>
&#160; &#160; &#160; &#160;SAMBAGROUPTYPE: 2<br/>
&#160; &#160; &#160; &#160;displayName: itsupport<br/>
&#160; &#160; &#160; &#160;memberUid: ghenry<br/>
&#160; &#160; &#160; &#160;memberUid: joebloggs<br/>
&#160; &#160; &#160; &#160;roomNumber: 41L-535<br/>
&#160; &#160; &#160; &#160;departmentNumber: 9999999<br/>
&#160; &#160; &#160; &#160;employeeType: special<br/>
&#160; &#160; &#160; &#160;carLicense: LIVID<br/>
&#160; &#160; &#160; &#160;businessCategory: frontend-override<br/>
Here we can see that the 5 new attributes are added to the remote entry before being returned to the our client.<br/>
Because we have configured a local attribute to search against:<br/>
&#160; &#160; &#160; &#160;overlay &#160; &#160; translucent<br/>
&#160; &#160; &#160; &#160;translucent_local carLicense<br/>
we can also search for that to return the completely fabricated entry:<br/>
&#160; &#160; &#160; &#160;ldapsearch -x -H ldap://127.0.0.1:9001 (carLicense=LIVID)<br/>
This is an extremely feature because you can then extend a remote directory server locally and also search<br/>against the local entries.<br/>
<b>Note:</b>&#160;Because the translucent overlay does not perform any DN rewrites, the local and remote database<br/>instances must have the same suffix. Other configurations will probably fail with No Such Object and other<br/>errors<br/>
<b>12.15.3. Further Information</b><br/>
<i>slapo-translucent(5)</i><br/>
<b>12.16. Attribute Uniqueness</b><br/>
<b>12.16.1. Overview</b><br/>
This overlay can be used with a backend database such as<i>&#160;slapd-bdb(5)</i>&#160;to enforce the uniqueness of some or<br/>all attributes within a subtree.<br/>
<b>12.16.2. Attribute Uniqueness Configuration</b><br/>
This overlay is only effective on new data from the point the overlay is enabled. To check uniqueness for<br/>existing data, you can export and import your data again via the LDAP Add operation, which will not be<br/>
123<br/>
<hr/>
<a name=138></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
suitable for large amounts of data, unlike<b>&#160;slapcat</b>.<br/>
For the following example, if uniqueness were enforced for the<b>&#160;mail</b>&#160;attribute, the subtree would be searched<br/>for any other records which also have a<b>&#160;mail</b>&#160;attribute containing the same value presented with an<b>&#160;add</b>,<br/><b>modify</b>&#160;or<b>&#160;modrdn</b>&#160;operation which are unique within the configured scope. If any are found, the request is<br/>rejected.<br/>
<b>Note:</b>&#160;If no attributes are specified, for example<b>&#160;ldap:///??sub?</b>, then the URI applies to all non-operational<br/>attributes. However, the keyword<b>&#160;ignore</b>&#160;can be specified to exclude certain non-operational attributes.<br/>
To search at the base dn of the current backend database ensuring uniqueness of the<b>&#160;mail</b>&#160;attribute, we simply<br/>add the following configuration:<br/>
&#160; &#160; &#160; &#160;overlay unique<br/>
&#160; &#160; &#160; &#160;unique_uri ldap:///?mail?sub?<br/>
For an existing entry of:<br/>
&#160; &#160; &#160; &#160;dn: cn=gavin,dc=suretecsystems,dc=com<br/>
&#160; &#160; &#160; &#160;objectClass: top<br/>
&#160; &#160; &#160; &#160;objectClass: inetorgperson<br/>
&#160; &#160; &#160; &#160;cn: gavin<br/>
&#160; &#160; &#160; &#160;sn: henry<br/>
&#160; &#160; &#160; &#160;mail: ghenry@suretecsystems.com<br/>
and we then try to add a new entry of:<br/>
&#160; &#160; &#160; &#160;dn: cn=robert,dc=suretecsystems,dc=com<br/>
&#160; &#160; &#160; &#160;objectClass: top<br/>
&#160; &#160; &#160; &#160;objectClass: inetorgperson<br/>
&#160; &#160; &#160; &#160;cn: robert<br/>
&#160; &#160; &#160; &#160;sn: jones<br/>
&#160; &#160; &#160; &#160;mail: ghenry@suretecsystems.com<br/>
would result in an error like so:<br/>
&#160; &#160; &#160; &#160;adding new entry &#34;cn=robert,dc=example,dc=com&#34;<br/>
&#160; &#160; &#160; &#160;ldap_add: Constraint violation (19)<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;additional info: some attributes not unique<br/>
The overlay can have multiple URIs specified within a domain, allowing complex selections of objects and<br/>also have multiple<b>&#160;unique_uri</b>&#160;statements or<b>&#160;olcUniqueURI</b>&#160;attributes which will create independent<br/>domains.<br/>
For more information and details about the<b>&#160;strict</b>&#160;and<b>&#160;ignore</b>&#160;keywords, please see the<i>&#160;slapo-unique(5)</i>&#160;man<br/>page.<br/>
<b>12.16.3. Further Information</b><br/>
<i>slapo-unique(5)</i><br/>
124<br/>
<hr/>
<a name=139></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
<b>12.17. Value Sorting</b><br/>
<b>12.17.1. Overview</b><br/>
The Value Sorting overlay can be used with a backend database to sort the values of specific multi-valued<br/>attributes within a subtree. The sorting occurs whenever the attributes are returned in a search response.<br/>
<b>12.17.2. Value Sorting Configuration</b><br/>
Sorting can be specified in ascending or descending order, using either numeric or alphanumeric sort methods.<br/>Additionally, a &#34;weighted&#34; sort can be specified, which uses a numeric weight prepended to the attribute<br/>values.<br/>
The weighted sort is always performed in ascending order, but may be combined with the other methods for<br/>values that all have equal weights. The weight is specified by prepending an integer weight {&lt;weight&gt;} in<br/>front of each value of the attribute for which weighted sorting is desired. This weighting factor is stripped off<br/>and never returned in search results.<br/>
Here are a few examples:<br/>
&#160; &#160; &#160; &#160;loglevel &#160; &#160;sync stats<br/>
&#160; &#160; &#160; &#160;database &#160; &#160;hdb<br/>
&#160; &#160; &#160; &#160;suffix &#160; &#160; &#160;&#34;dc=suretecsystems,dc=com&#34;<br/>
&#160; &#160; &#160; &#160;directory &#160; /usr/local/var/openldap-data<br/>
&#160; &#160; &#160; &#160;......<br/>
&#160; &#160; &#160; &#160;overlay valsort<br/>
&#160; &#160; &#160; &#160;valsort-attr memberUid ou=Groups,dc=suretecsystems,dc=com alpha-ascend<br/>
For example, ascend:<br/>
&#160; &#160; &#160; &#160;# sharedemail, Groups, suretecsystems.com<br/>
&#160; &#160; &#160; &#160;dn: cn=sharedemail,ou=Groups,dc=suretecsystems,dc=com<br/>
&#160; &#160; &#160; &#160;objectClass: posixGroup<br/>
&#160; &#160; &#160; &#160;objectClass: top<br/>
&#160; &#160; &#160; &#160;cn: sharedemail<br/>
&#160; &#160; &#160; &#160;gidNumber: 517<br/>
&#160; &#160; &#160; &#160;memberUid: admin<br/>
&#160; &#160; &#160; &#160;memberUid: dovecot<br/>
&#160; &#160; &#160; &#160;memberUid: laura<br/>
&#160; &#160; &#160; &#160;memberUid: suretec<br/>
For weighted, we change our data to:<br/>
&#160; &#160; &#160; &#160;# sharedemail, Groups, suretecsystems.com<br/>
&#160; &#160; &#160; &#160;dn: cn=sharedemail,ou=Groups,dc=suretecsystems,dc=com<br/>
&#160; &#160; &#160; &#160;objectClass: posixGroup<br/>
&#160; &#160; &#160; &#160;objectClass: top<br/>
&#160; &#160; &#160; &#160;cn: sharedemail<br/>
&#160; &#160; &#160; &#160;gidNumber: 517<br/>
&#160; &#160; &#160; &#160;memberUid: {4}admin<br/>
&#160; &#160; &#160; &#160;memberUid: {2}dovecot<br/>
&#160; &#160; &#160; &#160;memberUid: {1}laura<br/>
125<br/>
<hr/>
<a name=140></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
&#160; &#160; &#160; &#160;memberUid: {3}suretec<br/>
and change the config to:<br/>
&#160; &#160; &#160; &#160;overlay valsort<br/>
&#160; &#160; &#160; &#160;valsort-attr memberUid ou=Groups,dc=suretecsystems,dc=com weighted<br/>
Searching now results in:<br/>
&#160; &#160; &#160; &#160;# sharedemail, Groups, OxObjects, suretecsystems.com<br/>
&#160; &#160; &#160; &#160;dn: cn=sharedemail,ou=Groups,ou=OxObjects,dc=suretecsystems,dc=com<br/>
&#160; &#160; &#160; &#160;objectClass: posixGroup<br/>
&#160; &#160; &#160; &#160;objectClass: top<br/>
&#160; &#160; &#160; &#160;cn: sharedemail<br/>
&#160; &#160; &#160; &#160;gidNumber: 517<br/>
&#160; &#160; &#160; &#160;memberUid: laura<br/>
&#160; &#160; &#160; &#160;memberUid: dovecot<br/>
&#160; &#160; &#160; &#160;memberUid: suretec<br/>
&#160; &#160; &#160; &#160;memberUid: admin<br/>
<b>12.17.3. Further Information</b><br/>
<i>slapo-valsort(5)</i><br/>
<b>12.18. Overlay Stacking</b><br/>
<b>12.18.1. Overview</b><br/>
Overlays can be stacked, which means that more than one overlay can be instantiated for each database, or for<br/>the&#160;frontend. As a consequence, each overlays function is called, if defined, when overlay execution is<br/>invoked. Multiple overlays are executed in reverse order (as a stack) with respect to their definition in<br/>slapd.conf (5), or with respect to their ordering in the config database, as documented in slapd-config (5).<br/>
<b>12.18.2. Example Scenarios</b><br/>
<b>12.18.2.1. Samba</b><br/>
126<br/>
<hr/>
<a name=141></a><b>13. Schema Specification</b><br/>
This chapter describes how to extend the user schema used by<i>&#160;slapd</i>(8). The chapter assumes the reader is<br/>familiar with the LDAP/X.500 information model.<br/>
<a href="OpenLDAP-Admin-Guides.html#141">The first section, Distributed Schema Files details optional schema definitions provided in the distribution and<br/>where to obtain other definitions. The second section, Extending Schema, details how to define new schema<br/></a>items.<br/>
This chapter does not discuss how to extend system schema used by<i>&#160;slapd</i>(8) as this requires source code<br/>modification. System schema includes all operational attribute types or any object class which allows or<br/>requires an operational attribute (directly or indirectly).<br/>
<b>13.1. Distributed Schema Files</b><br/>
OpenLDAP Software is distributed with a set of schema specifications for your use. Each set is defined in a<br/>file suitable for inclusion (using the&#160;include&#160;directive) in your<i>&#160;slapd.conf</i>(5) file. These schema files are<br/>normally installed in the&#160;/usr/local/etc/openldap/schema&#160;directory.<br/>
Table 8.1: Provided Schema Specifications<br/>
<b>File</b><br/>
<b>Description</b><br/>
core.schema<br/>
OpenLDAP<i>&#160;core</i>&#160;(required)<br/>
cosine.schema<br/>
Cosine and Internet X.500 (useful)<br/>
inetorgperson.schema<br/>
InetOrgPerson (useful)<br/>
misc.schema<br/>
Assorted (experimental)<br/>
nis.schema<br/>
Network Information Services (FYI)<br/>
openldap.schema<br/>
OpenLDAP Project (experimental)<br/>
To use any of these schema files, you only need to include the desired file in the global definitions portion of<br/>your<i>&#160;slapd.conf</i>(5) file. For example:<br/>
&#160; &#160; &#160; &#160; # include schema<br/>
&#160; &#160; &#160; &#160; include /usr/local/etc/openldap/schema/core.schema<br/>
&#160; &#160; &#160; &#160; include /usr/local/etc/openldap/schema/cosine.schema<br/>
&#160; &#160; &#160; &#160; include /usr/local/etc/openldap/schema/inetorgperson.schema<br/>
<a href="http://www.openldap.org/faq/">Additional files may be available. Please consult the OpenLDAP FAQ (http://www.openldap.org/faq/).</a><br/>
<b>Note:</b>&#160;You should not modify any of the schema items defined in provided files.<br/>
<b>13.2. Extending Schema</b><br/>
Schema used by<i>&#160;slapd</i>(8) may be extended to support additional syntaxes, matching rules, attribute types, and<br/>object classes. This chapter details how to add user application attribute types and object classes using the<br/>syntaxes and matching rules already supported by slapd. slapd can also be extended to support additional<br/>syntaxes, matching rules and system schema, but this requires some programming and hence is not discussed<br/>here.<br/>
127<br/>
<hr/>
<a name=142></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
There are five steps to defining new schema:<br/>
obtain Object Identifier<br/>
1.&#160;<br/>
choose a name prefix<br/>
2.&#160;<br/>
create local schema file<br/>
3.&#160;<br/>
define custom attribute types (if necessary)<br/>
4.&#160;<br/>
define custom object classes<br/>
5.&#160;<br/>
<b>13.2.1. Object Identifiers</b><br/>
Each schema element is identified by a globally unique Object Identifier (OID). OIDs are also used to identify<br/>other objects. They are commonly found in protocols described by ASN.1. In particular, they are heavily used<br/>by the Simple Network Management Protocol (SNMP). As OIDs are hierarchical, your organization can<br/>obtain one OID and branch it as needed. For example, if your organization were assigned OID&#160;1.1, you could<br/>branch the tree as follows:<br/>
Table 8.2: Example OID hierarchy<br/>
<b>OID</b><br/>
<b>Assignment</b><br/>
1.1<br/>
Organization's OID<br/>
1.1.1<br/>
SNMP Elements<br/>
1.1.2<br/>
LDAP Elements<br/>
1.1.2.1<br/>
AttributeTypes<br/>
1.1.2.1.1<br/>
x-my-Attribute<br/>
1.1.2.2<br/>
ObjectClasses<br/>
1.1.2.2.1<br/>
x-my-ObjectClass<br/>
You are, of course, free to design a hierarchy suitable to your organizational needs under your organization's<br/>OID. No matter what hierarchy you choose, you should maintain a registry of assignments you make. This can<br/>be a simple flat file or something more sophisticated such as the<i>&#160;OpenLDAP OID Registry<br/></i><a href="http://www.openldap.org/faq/index.cgi?file=197">(http://www.openldap.org/faq/index.cgi?file=197).</a><br/>
<a href="http://www.alvestrand.no/objectid/">For more information about Object Identifiers (and a listing service) see http://www.alvestrand.no/objectid/.</a><br/>
<i>Under no circumstances should you hijack OID namespace!</i><br/>
To obtain a registered OID at<i>&#160;no cost</i><a href="http://www.iana.org/">, apply for a OID under the Internet Assigned Numbers Authority<br/></a>(ORG:IANA) maintained<i>&#160;Private Enterprise</i>&#160;arc. Any private enterprise (organization) may request a Private<br/>Enterprise Number (PEN) to be assigned under this arc. Just fill out the IANA form at<br/><a href="http://pen.iana.org/pen/PenApplication.page">http://pen.iana.org/pen/PenApplication.page and your official PEN will be sent to you usually within a few<br/></a>days. Your base OID will be something like&#160;1.3.6.1.4.1.X&#160;where&#160;X&#160;is an integer.<br/>
<b>Note:</b>&#160;PENs obtained using this form may be used for any purpose including identifying LDAP schema<br/>elements.<br/>
<a href="http://www.ansi.org/">Alternatively, OID name space may be available from a national authority (e.g., ANSI, BSI).</a><br/>
128<br/>
<hr/>
<a name=143></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
<b>13.2.2. Naming Elements</b><br/>
In addition to assigning a unique object identifier to each schema element, you should provide at least one<br/><a href="http://www.iana.org/">textual name for each element. Names should be registered with the IANA or prefixed with &#34;x-&#34; to place in<br/></a>the &#34;private use&#34; name space.<br/>
The name should be both descriptive and not likely to clash with names of other schema elements. In<br/>particular, any name you choose should not clash with present or future Standard Track names (this is assured<br/>if you registered names or use names beginning with &#34;x-&#34;).<br/>
It is noted that you can obtain your own registered name prefix so as to avoid having to register your names<br/><a href="http://www.rfc-editor.org/rfc/rfc4520.txt">individually. See RFC4520 for details.</a><br/>
In the examples below, we have used a short prefix 'x-my-'. Such a short prefix would only be suitable for a<br/>very large, global organization. In general, we recommend something like 'x-de-Firm-' (German company)<br/>or 'x-com-Example' (elements associated with organization associated with&#160;example.com).<br/>
<b>13.2.3. Local schema file</b><br/>
The&#160;objectclass&#160;and&#160;attributeTypes&#160;configuration file directives can be used to define schema rules<br/>on entries in the directory. It is customary to create a file to contain definitions of your custom schema items.<br/>We recommend you create a file&#160;local.schema&#160;in<br/>/usr/local/etc/openldap/schema/local.schema&#160;and then include this file in your<br/><i>slapd.conf</i>(5) file immediately after other schema&#160;include&#160;directives.<br/>
&#160; &#160; &#160; &#160; # include schema<br/>
&#160; &#160; &#160; &#160; include /usr/local/etc/openldap/schema/core.schema<br/>
&#160; &#160; &#160; &#160; include /usr/local/etc/openldap/schema/cosine.schema<br/>
&#160; &#160; &#160; &#160; include /usr/local/etc/openldap/schema/inetorgperson.schema<br/>
&#160; &#160; &#160; &#160; # include local schema<br/>
&#160; &#160; &#160; &#160; include /usr/local/etc/openldap/schema/local.schema<br/>
<b>13.2.4. Attribute Type Specification</b><br/>
The<i>&#160;attributetype</i>&#160;directive is used to define a new attribute type. The directive uses the same Attribute Type<br/><a href="http://www.rfc-editor.org/rfc/rfc4512.txt">Description (as defined in RFC4512) used by the attributeTypes attribute found in the subschema subentry,<br/></a>e.g.:<br/>
<a href="http://www.rfc-editor.org/rfc/rfc4512.txt">&#160; &#160; &#160; &#160; attributetype &lt;RFC4512</a>&#160;Attribute Type Description&gt;<br/>
where Attribute Type Description is defined by the following ABNF:<br/>
&#160; &#160; &#160; AttributeTypeDescription = &#34;(&#34; whsp<br/>
&#160; &#160; &#160; &#160; &#160; &#160; numericoid whsp &#160; &#160; &#160; &#160; &#160; &#160; &#160;; AttributeType identifier<br/>
&#160; &#160; &#160; &#160; &#160; [ &#34;NAME&#34; qdescrs ] &#160; &#160; &#160; &#160; &#160; &#160; ; name used in AttributeType<br/>
&#160; &#160; &#160; &#160; &#160; [ &#34;DESC&#34; qdstring ] &#160; &#160; &#160; &#160; &#160; &#160;; description<br/>
&#160; &#160; &#160; &#160; &#160; [ &#34;OBSOLETE&#34; whsp ]<br/>
&#160; &#160; &#160; &#160; &#160; [ &#34;SUP&#34; woid ] &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ; derived from this other<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;; AttributeType<br/>
&#160; &#160; &#160; &#160; &#160; [ &#34;EQUALITY&#34; woid &#160; &#160; &#160; &#160; &#160; &#160; &#160;; Matching Rule name<br/>
&#160; &#160; &#160; &#160; &#160; [ &#34;ORDERING&#34; woid &#160; &#160; &#160; &#160; &#160; &#160; &#160;; Matching Rule name<br/>
&#160; &#160; &#160; &#160; &#160; [ &#34;SUBSTR&#34; woid ] &#160; &#160; &#160; &#160; &#160; &#160; &#160;; Matching Rule name<br/>
&#160; &#160; &#160; &#160; &#160; [ &#34;SYNTAX&#34; whsp noidlen whsp ] ; Syntax OID<br/>
129<br/>
<hr/>
<a name=144></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
&#160; &#160; &#160; &#160; &#160; [ &#34;SINGLE-VALUE&#34; whsp ] &#160; &#160; &#160; &#160;; default multi-valued<br/>
&#160; &#160; &#160; &#160; &#160; [ &#34;COLLECTIVE&#34; whsp ] &#160; &#160; &#160; &#160; &#160;; default not collective<br/>
&#160; &#160; &#160; &#160; &#160; [ &#34;NO-USER-MODIFICATION&#34; whsp ]; default user modifiable<br/>
&#160; &#160; &#160; &#160; &#160; [ &#34;USAGE&#34; whsp AttributeUsage ]; default userApplications<br/>
&#160; &#160; &#160; &#160; &#160; whsp &#34;)&#34;<br/>
&#160; &#160; &#160; AttributeUsage =<br/>
&#160; &#160; &#160; &#160; &#160; &#34;userApplications&#34; &#160; &#160; /<br/>
&#160; &#160; &#160; &#160; &#160; &#34;directoryOperation&#34; &#160; /<br/>
&#160; &#160; &#160; &#160; &#160; &#34;distributedOperation&#34; / ; DSA-shared<br/>
&#160; &#160; &#160; &#160; &#160; &#34;dSAOperation&#34; &#160; &#160; &#160; &#160; &#160;; DSA-specific, value depends on server<br/>
where whsp is a space (' '), numericoid is a globally unique OID in dotted-decimal form (e.g.&#160;1.1.0), qdescrs<br/>is one or more names, woid is either the name or OID optionally followed by a length specifier (e.g&#160;{10}).<br/>
For example, the attribute types&#160;name&#160;and&#160;cn&#160;are defined in&#160;core.schema&#160;as:<br/>
&#160; &#160; &#160; &#160; attributeType ( 2.5.4.41 NAME 'name'<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; DESC 'name(s) associated with the object'<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; EQUALITY caseIgnoreMatch<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; SUBSTR caseIgnoreSubstringsMatch<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; SYNTAX 1.3.6.1.4.1.1466.115.121.1.15{32768} )<br/>
&#160; &#160; &#160; &#160; attributeType ( 2.5.4.3 NAME ( 'cn' 'commonName' )<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; DESC 'common name(s) assciated with the object'<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; SUP name )<br/>
Notice that each defines the attribute's OID, provides a short name, and a brief description. Each name is an<br/>alias for the OID.<i>&#160;slapd</i>(8) returns the first listed name when returning results.<br/>
The first attribute,&#160;name, holds values of&#160;directoryString&#160;(UTF-8 encoded Unicode) syntax. The<br/>syntax is specified by OID (1.3.6.1.4.1.1466.115.121.1.15 identifies the directoryString syntax). A length<br/>recommendation of 32768 is specified. Servers should support values of this length, but may support longer<br/>values. The field does NOT specify a size constraint, so is ignored on servers (such as slapd) which don't<br/>impose such size limits. In addition, the equality and substring matching uses case ignore rules. Below are<br/>tables listing commonly used syntax and matching rules (<i>slapd</i>(8) supports these and many more).<br/>
Table 8.3: Commonly Used Syntaxes<br/>
<b>Name</b><br/>
<b>OID</b><br/>
<b>Description</b><br/>
boolean<br/>
1.3.6.1.4.1.1466.115.121.1.7<br/>
boolean value<br/>
directoryString<br/>
1.3.6.1.4.1.1466.115.121.1.15&#160;Unicode (UTF-8) string<br/>
distinguishedName&#160;1.3.6.1.4.1.1466.115.121.1.12&#160;LDAP DN<br/>
integer<br/>
1.3.6.1.4.1.1466.115.121.1.27&#160;integer<br/>
numericString<br/>
1.3.6.1.4.1.1466.115.121.1.36&#160;numeric string<br/>
OID<br/>
1.3.6.1.4.1.1466.115.121.1.38&#160;object identifier<br/>
octetString<br/>
1.3.6.1.4.1.1466.115.121.1.40&#160;arbitrary octets<br/>
Table 8.4: Commonly Used Matching Rules<br/>
<b>Name</b><br/>
<b>Type</b><br/>
<b>Description</b><br/>
130<br/>
<hr/>
<a name=145></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
booleanMatch<br/>
equality<br/>
boolean<br/>
caseIgnoreMatch<br/>
equality<br/>
case insensitive, space insensitive<br/>
caseIgnoreOrderingMatch<br/>
ordering<br/>
case insensitive, space insensitive<br/>
caseIgnoreSubstringsMatch<br/>
substrings&#160;case insensitive, space insensitive<br/>
caseExactMatch<br/>
equality<br/>
case sensitive, space insensitive<br/>
caseExactOrderingMatch<br/>
ordering<br/>
case sensitive, space insensitive<br/>
caseExactSubstringsMatch<br/>
substrings&#160;case sensitive, space insensitive<br/>
distinguishedNameMatch<br/>
equality<br/>
distinguished name<br/>
integerMatch<br/>
equality<br/>
integer<br/>
integerOrderingMatch<br/>
ordering<br/>
integer<br/>
numericStringMatch<br/>
equality<br/>
numerical<br/>
numericStringOrderingMatch<br/>
ordering<br/>
numerical<br/>
numericStringSubstringsMatch<br/>
substrings&#160;numerical<br/>
octetStringMatch<br/>
equality<br/>
octet string<br/>
octetStringOrderingMatch<br/>
ordering<br/>
octet string<br/>
octetStringSubstringsMatch ordering&#160;octet st<br/>
ring<br/>
objectIdentiferMatch<br/>
equality<br/>
object identifier<br/>
The second attribute,&#160;cn, is a subtype of&#160;name&#160;hence it inherits the syntax, matching rules, and usage of<br/>name.&#160;commonName&#160;is an alternative name.<br/>
Neither attribute is restricted to a single value. Both are meant for usage by user applications. Neither is<br/>obsolete nor collective.<br/>
The following subsections provide a couple of examples.<br/>
<b>13.2.4.1. x-my-UniqueName</b><br/>
Many organizations maintain a single unique name for each user. Though one could use&#160;displayName<br/><a href="http://www.rfc-editor.org/rfc/rfc2798.txt">(RFC2798), this attribute is really meant to be controlled by the user, not the organization. We could just copy<br/></a>the definition of&#160;displayName&#160;from&#160;inetorgperson.schema&#160;and replace the OID, name, and<br/>description, e.g:<br/>
&#160; &#160; &#160; &#160; attributetype ( 1.1.2.1.1 NAME 'x-my-UniqueName'<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; DESC 'unique name with my organization'<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; EQUALITY caseIgnoreMatch<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; SUBSTR caseIgnoreSubstringsMatch<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; SYNTAX 1.3.6.1.4.1.1466.115.121.1.15<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; SINGLE-VALUE )<br/>
However, if we want this name to be used in&#160;name&#160;assertions, e.g.&#160;(name=*Jane*), the attribute could<br/>alternatively be defined as a subtype of&#160;name, e.g.:<br/>
&#160; &#160; &#160; &#160; attributetype ( 1.1.2.1.1 NAME 'x-my-UniqueName'<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; DESC 'unique name with my organization'<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; SUP name )<br/>
131<br/>
<hr/>
<a name=146></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
<b>13.2.4.2. x-my-Photo</b><br/>
Many organizations maintain a photo of each each user. A&#160;x-my-Photo&#160;attribute type could be defined to<br/>hold a photo. Of course, one could use just use&#160;jpegPhoto<a href="http://www.rfc-editor.org/rfc/rfc2798.txt">&#160;(RFC2798) (or a subtype) to hold the photo.<br/></a>However, you can only do this if the photo is in<i>&#160;JPEG File Interchange Format</i>. Alternatively, an attribute<br/>type which uses the<i>&#160;Octet String</i>&#160;syntax can be defined, e.g.:<br/>
&#160; &#160; &#160; &#160; attributetype ( 1.1.2.1.2 NAME 'x-my-Photo'<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; DESC 'a photo (application defined format)'<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; SYNTAX 1.3.6.1.4.1.1466.115.121.1.40<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; SINGLE-VALUE )<br/>
In this case, the syntax doesn't specify the format of the photo. It's assumed (maybe incorrectly) that all<br/>applications accessing this attribute agree on the handling of values.<br/>
If you wanted to support multiple photo formats, you could define a separate attribute type for each format,<br/>prefix the photo with some typing information, or describe the value using ASN.1 and use the&#160;;binary<br/>transfer option.<br/>
Another alternative is for the attribute to hold a URI pointing to the photo. You can model such an attribute<br/>after&#160;labeledURI<a href="http://www.rfc-editor.org/rfc/rfc2079.txt">&#160;(RFC2079) or simply create a subtype, e.g.:</a><br/>
&#160; &#160; &#160; &#160; attributetype ( 1.1.2.1.3 NAME 'x-my-PhotoURI'<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; DESC 'URI and optional label referring to a photo'<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; SUP labeledURI )<br/>
<b>13.2.5. Object Class Specification</b><br/>
The<i>&#160;objectclasses</i>&#160;directive is used to define a new object class. The directive uses the same Object Class<br/><a href="http://www.rfc-editor.org/rfc/rfc4512.txt">Description (as defined in RFC4512) used by the objectClasses attribute found in the subschema subentry,<br/></a>e.g.:<br/>
<a href="http://www.rfc-editor.org/rfc/rfc4512.txt">&#160; &#160; &#160; &#160; objectclass &lt;RFC4512</a>&#160;Object Class Description&gt;<br/>
where Object Class Description is defined by the following ABNF:<br/>
&#160; &#160; &#160; &#160; ObjectClassDescription = &#34;(&#34; whsp<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; numericoid whsp &#160; &#160; &#160;; ObjectClass identifier<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; [ &#34;NAME&#34; qdescrs ]<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; [ &#34;DESC&#34; qdstring ]<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; [ &#34;OBSOLETE&#34; whsp ]<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; [ &#34;SUP&#34; oids ] &#160; &#160; &#160; ; Superior ObjectClasses<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; [ ( &#34;ABSTRACT&#34; / &#34;STRUCTURAL&#34; / &#34;AUXILIARY&#34; ) whsp ]<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ; default structural<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; [ &#34;MUST&#34; oids ] &#160; &#160; &#160;; AttributeTypes<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; [ &#34;MAY&#34; oids ] &#160; &#160; &#160; ; AttributeTypes<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; whsp &#34;)&#34;<br/>
where whsp is a space (' '), numericoid is a globally unique OID in dotted-decimal form (e.g.&#160;1.1.0), qdescrs<br/>is one or more names, and oids is one or more names and/or OIDs.<br/>
132<br/>
<hr/>
<a name=147></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
<b>13.2.5.1. x-my-PhotoObject</b><br/>
To define an<i>&#160;auxiliary</i>&#160;object class which allows x-my-Photo to be added to any existing entry.<br/>
&#160; &#160; &#160; &#160; objectclass ( 1.1.2.2.1 NAME 'x-my-PhotoObject'<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; DESC 'mixin x-my-Photo'<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; AUXILIARY<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; MAY x-my-Photo )<br/>
<b>13.2.5.2. x-my-Person</b><br/>
If your organization would like have a private<i>&#160;structural</i>&#160;object class to instantiate users, you can subclass one<br/>of the existing person classes, such as&#160;inetOrgPerson<a href="http://www.rfc-editor.org/rfc/rfc2798.txt">&#160;(RFC2798), and add any additional attributes which<br/></a>you desire.<br/>
&#160; &#160; &#160; &#160; objectclass ( 1.1.2.2.2 NAME 'x-my-Person'<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; DESC 'my person'<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; SUP inetOrgPerson<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; MUST ( x-my-UniqueName $ givenName )<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; MAY x-my-Photo )<br/>
The object class inherits the required/allowed attribute types of&#160;inetOrgPerson&#160;but requires<br/>x-my-UniqueName&#160;and&#160;givenName&#160;and allows&#160;x-my-Photo.<br/>
<b>13.2.6. OID Macros</b><br/>
To ease the management and use of OIDs,<i>&#160;slapd</i>(8) supports<i>&#160;Object Identifier</i>&#160;macros. The<br/>objectIdentifier&#160;directive is used to equate a macro (name) with a OID. The OID may possibly be<br/>derived from a previously defined OID macro. The<i>&#160;slapd.conf</i>(5) syntax is:<br/>
&#160; &#160; &#160; &#160; objectIdentifier &lt;name&gt; { &lt;oid&gt; | &lt;name&gt;[:&lt;suffix&gt;] }<br/>
The following demonstrates definition of a set of OID macros and their use in defining schema elements:<br/>
&#160; &#160; &#160; &#160; objectIdentifier myOID &#160;1.1<br/>
&#160; &#160; &#160; &#160; objectIdentifier mySNMP myOID:1<br/>
&#160; &#160; &#160; &#160; objectIdentifier myLDAP myOID:2<br/>
&#160; &#160; &#160; &#160; objectIdentifier myAttributeType &#160; &#160; &#160; &#160;myLDAP:1<br/>
&#160; &#160; &#160; &#160; objectIdentifier myObjectClass &#160;myLDAP:2<br/>
&#160; &#160; &#160; &#160; attributetype ( myAttributeType:3 NAME 'x-my-PhotoURI'<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; DESC 'URI and optional label referring to a photo'<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; SUP labeledURI )<br/>
&#160; &#160; &#160; &#160; objectclass ( myObjectClass:1 NAME 'x-my-PhotoObject'<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; DESC 'mixin x-my-Photo'<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; AUXILIARY<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; MAY x-my-Photo )<br/>
133<br/>
<hr/>
<a name=148></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
134<br/>
<hr/>
<a name=149></a><b>14. Security Considerations</b><br/>
OpenLDAP Software is designed to run in a wide variety of computing environments from tightly-controlled<br/>closed networks to the global Internet. Hence, OpenLDAP Software supports many different security<br/>mechanisms. This chapter describes these mechanisms and discusses security considerations for using<br/>OpenLDAP Software.<br/>
<b>14.1. Network Security</b><br/>
<b>14.1.1. Selective Listening</b><br/>
By default,<i>&#160;slapd</i>(8) will listen on both the IPv4 and IPv6 &#34;any&#34; addresses. It is often desirable to have<i>&#160;slapd<br/></i>listen on select address/port pairs. For example, listening only on the IPv4 address&#160;127.0.0.1&#160;will disallow<br/>remote access to the directory server. E.g.:<br/>
&#160; &#160; &#160; &#160; slapd -h ldap://127.0.0.1<br/>
While the server can be configured to listen on a particular interface address, this doesn't necessarily restrict<br/>access to the server to only those networks accessible via that interface. To selective restrict remote access, it<br/><a href="OpenLDAP-Admin-Guides.html#149">is recommend that an IP Firewall be used to restrict access.</a><br/>
<a href="OpenLDAP-Admin-Guides.html#67">See Command-line Options and</a><i>&#160;slapd</i>(8) for more information.<br/>
<b>14.1.2. IP Firewall</b><br/>
IP firewall capabilities of the server system can be used to restrict access based upon the client's IP address<br/>and/or network interface used to communicate with the client.<br/>
Generally,<i>&#160;slapd</i><a href="">(8) listens on port 389/tcp for ldap:// sessions and port 636/tcp for ldaps://) sessions.</a><i>&#160;slapd</i>(8)<br/>may be configured to listen on other ports.<br/>
As specifics of how to configure IP firewall are dependent on the particular kind of IP firewall used, no<br/>examples are provided here. See the document associated with your IP firewall.<br/>
<b>14.1.3. TCP Wrappers</b><br/>
<i>slapd</i>(8) supports TCP Wrappers. TCP Wrappers provide a rule-based access control system for controlling<br/>TCP/IP access to the server. For example, the<i>&#160;host_options</i>(5) rule:<br/>
&#160; &#160; &#160; &#160; slapd: 10.0.0.0/255.0.0.0 127.0.0.1 : ALLOW<br/>
&#160; &#160; &#160; &#160; slapd: ALL : DENY<br/>
allows only incoming connections from the private network&#160;10.0.0.0&#160;and localhost (127.0.0.1) to<br/>access the directory service.<br/>
<b>Note:</b>&#160;IP addresses are used as<i>&#160;slapd</i>(8) is not normally configured to perform reverse lookups.<br/>
It is noted that TCP wrappers require the connection to be accepted. As significant processing is required just<br/>to deny a connection, it is generally advised that IP firewall protection be used instead of TCP wrappers.<br/>
135<br/>
<hr/>
<a name=150></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
See<i>&#160;hosts_access</i>(5) for more information on TCP wrapper rules.<br/>
<b>14.2. Data Integrity and Confidentiality Protection</b><br/>
Transport Layer Security (TLS) can be used to provide data integrity and confidentiality protection.<br/><a href="">OpenLDAP supports negotiation of TLS (SSL) via both StartTLS and ldaps://. See the Using TLS chapter for<br/></a>more information. StartTLS is the standard track mechanism.<br/>
A number of Simple Authentication and Security Layer (SASL) mechanisms, such as DIGEST-MD5 and<br/><a href="OpenLDAP-Admin-Guides.html#157">GSSAPI, also provide data integrity and confidentiality protection. See the Using SASL chapter for more<br/></a>information.<br/>
<b>14.2.1. Security Strength Factors</b><br/>
The server uses Security Strength Factors (SSF) to indicate the relative strength of protection. A SSF of zero<br/>(0) indicates no protections are in place. A SSF of one (1) indicates integrity protection are in place. A SSF<br/>greater than one (&gt;1) roughly correlates to the effective encryption key length. For example, DES is 56, 3DES<br/>is 112, and AES 128, 192, or 256.<br/>
A number of administrative controls rely on SSFs associated with TLS and SASL protection in place on an<br/>LDAP session.<br/>
security&#160;controls disallow operations when appropriate protections are not in place. For example:<br/>
&#160; &#160; &#160; &#160; security ssf=1 update_ssf=112<br/>
requires integrity protection for all operations and encryption protection, 3DES equivalent, for update<br/>operations (e.g. add, delete, modify, etc.). See<i>&#160;slapd.conf</i>(5) for details.<br/>
<a href="OpenLDAP-Admin-Guides.html#71">For fine-grained control, SSFs may be used in access controls. See the Access Control section for more<br/></a>information.<br/>
<b>14.3. Authentication Methods</b><br/>
<b>14.3.1. &#34;simple&#34; method</b><br/>
The LDAP &#34;simple&#34; method has three modes of operation:<br/>
anonymous,<br/>
&#160;<br/>
unauthenticated, and<br/>
&#160;<br/>
user/password authenticated.<br/>
&#160;<br/>
Anonymous access is requested by providing no name and no password to the &#34;simple&#34; bind operation.<br/>Unauthenticated access is requested by providing a name but no password. Authenticated access is requested<br/>by providing a valid name and password.<br/>
An anonymous bind results in an<i>&#160;anonymous</i>&#160;authorization association. Anonymous bind mechanism is<br/>enabled by default, but can be disabled by specifying &#34;disallow bind_anon&#34; in<i>&#160;slapd.conf</i>(5).<br/>
136<br/>
<hr/>
<a name=151></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
<b>Note:</b>&#160;Disabling the anonymous bind mechanism does not prevent anonymous access to the directory. To<br/>require authentication to access the directory, one should instead specify &#34;require authc&#34;.<br/>
An unauthenticated bind also results in an<i>&#160;anonymous</i>&#160;authorization association. Unauthenticated bind<br/>mechanism is disabled by default, but can be enabled by specifying &#34;allow bind_anon_cred&#34; in<br/><i>slapd.conf</i>(5). As a number of LDAP applications mistakenly generate unauthenticated bind request when<br/>authenticated access was intended (that is, they do not ensure a password was provided), this mechanism<br/>should generally remain disabled.<br/>
A successful user/password authenticated bind results in a user authorization identity, the provided name,<br/>being associated with the session. User/password authenticated bind is enabled by default. However, as this<br/>mechanism itself offers no eavesdropping protection (e.g., the password is set in the clear), it is recommended<br/>that it be used only in tightly controlled systems or when the LDAP session is protected by other means (e.g.,<br/>TLS, IPsec). Where the administrator relies on TLS to protect the password, it is recommended that<br/>unprotected authentication be disabled. This is done using the&#160;security&#160;directive's&#160;simple_bind&#160;option,<br/>which provides fine grain control over the level of confidential protection to require for<i>&#160;simple</i>&#160;user/password<br/>authentication. E.g., using&#160;security simple_bind=56&#160;would require<i>&#160;simple</i>&#160;binds to use encryption of<br/>DES equivalent or better.<br/>
The user/password authenticated bind mechanism can be completely disabled by setting &#34;disallow<br/>bind_simple&#34;.<br/>
<b>Note:</b>&#160;An unsuccessful bind always results in the session having an<i>&#160;anonymous</i>&#160;authorization association.<br/>
<b>14.3.2. SASL method</b><br/>
<a href="OpenLDAP-Admin-Guides.html#157">The LDAP SASL method allows the use of any SASL authentication mechanism. The Using SASL section<br/></a>discusses the use of SASL.<br/>
<b>14.4. Password Storage</b><br/>
LDAP passwords are normally stored in the<i>&#160;userPassword</i><a href="http://www.rfc-editor.org/rfc/rfc4519.txt">&#160;attribute. RFC4519 specifies that passwords are<br/></a>not stored in encrypted (or hashed) form. This allows a wide range of password-based authentication<br/>mechanisms, such as&#160;DIGEST-MD5&#160;to be used. This is also the most interoperable storage scheme.<br/>
However, it may be desirable to store a hash of password instead.<i>&#160;slapd</i>(8) supports a variety of storage<br/>schemes for the administrator to choose from.<br/>
<b>Note:</b>&#160;Values of password attributes, regardless of storage scheme used, should be protected as if they were<br/>clear text. Hashed passwords are subject to<i>&#160;dictionary attacks</i>&#160;and<i>&#160;brute-force attacks</i>.<br/>
The<i>&#160;userPassword</i>&#160;attribute is allowed to have more than one value, and it is possible for each value to be<br/>stored in a different form. During authentication,<i>&#160;slapd</i>&#160;will iterate through the values until it finds one that<br/>matches the offered password or until it runs out of values to inspect. The storage scheme is stored as a prefix<br/>on the value, so a hashed password using the Salted SHA1 (SSHA) scheme looks like:<br/>
&#160;userPassword: {SSHA}DkMTwBl+a/3DQTxCYEApdUtNXGgdUac3<br/>
The advantage of hashed passwords is that an attacker which discovers the hash does not have direct access to<br/>
137<br/>
<hr/>
<a name=152></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
the actual password. Unfortunately, as dictionary and brute force attacks are generally quite easy for attackers<br/>to successfully mount, this advantage is marginal at best (this is why all modern Unix systems use shadow<br/>password files).<br/>
The disadvantages of hashed storage is that they are non-standard, may cause interoperability problem, and<br/>generally preclude the use of stronger than Simple (or SASL/PLAIN) password-based authentication<br/>mechanisms such as&#160;DIGEST-MD5.<br/>
<b>14.4.1. SSHA password storage scheme</b><br/>
This is the salted version of the SHA scheme. It is believed to be the most secure password storage scheme<br/>supported by<i>&#160;slapd</i>.<br/>
These values represent the same password:<br/>
&#160;userPassword: {SSHA}DkMTwBl+a/3DQTxCYEApdUtNXGgdUac3<br/>
&#160;userPassword: {SSHA}d0Q0626PSH9VUld7yWpR0k6BlpQmtczb<br/>
<b>14.4.2. CRYPT password storage scheme</b><br/>
This scheme uses the operating system's<i>&#160;crypt(3)</i>&#160;hash function. It normally produces the traditional<br/>Unix-style 13 character hash, but on systems with&#160;glibc2&#160;it can also generate the more secure 34-byte MD5<br/>hash.<br/>
&#160;userPassword: {CRYPT}aUihad99hmev6<br/>
&#160;userPassword: {CRYPT}$1$czBJdDqS$TmkzUAb836oMxg/BmIwN.1<br/>
The advantage of the CRYPT scheme is that passwords can be transferred to or from an existing Unix<br/>password file without having to know the cleartext form. Both forms of<i>&#160;crypt</i>&#160;include salt so they have some<br/>resistance to dictionary attacks.<br/>
<b>Note:</b>&#160;Since this scheme uses the operating system's<i>&#160;crypt(3)</i>&#160;hash function, it is therefore operating system<br/>specific.<br/>
<b>14.4.3. MD5 password storage scheme</b><br/>
This scheme simply takes the MD5 hash of the password and stores it in base64 encoded form:<br/>
&#160;userPassword: {MD5}Xr4ilOzQ4PCOq3aQ0qbuaQ==<br/>
Although safer than cleartext storage, this is not a very secure scheme. The MD5 algorithm is fast, and<br/>because there is no salt the scheme is vulnerable to a dictionary attack.<br/>
<b>14.4.4. SMD5 password storage scheme</b><br/>
This improves on the basic MD5 scheme by adding salt (random data which means that there are many<br/>possible representations of a given plaintext password). For example, both of these values represent the same<br/>password:<br/>
&#160;userPassword: {SMD5}4QWGWZpj9GCmfuqEvm8HtZhZS6E=<br/>
&#160;userPassword: {SMD5}g2/J/7D5EO6+oPdklp5p8YtNFk4=<br/>
138<br/>
<hr/>
<a name=153></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
<b>14.4.5. SHA password storage scheme</b><br/>
Like the MD5 scheme, this simply feeds the password through an SHA hash process. SHA is thought to be<br/>more secure than MD5, but the lack of salt leaves the scheme exposed to dictionary attacks.<br/>
&#160;userPassword: {SHA}5en6G6MezRroT3XKqkdPOmY/BfQ=<br/>
<b>14.4.6. SASL password storage scheme</b><br/>
This is not really a password storage scheme at all. It uses the value of the<i>&#160;userPassword</i>&#160;attribute to delegate<br/>password verification to another process. See below for more information.<br/>
<b>Note:</b>&#160;This is not the same as using SASL to authenticate the LDAP session.<br/>
<b>14.5. Pass-Through authentication</b><br/>
Since OpenLDAP 2.0<i>&#160;slapd</i>&#160;has had the ability to delegate password verification to a separate process. This<br/>uses the<i>&#160;sasl_checkpass(3)</i>&#160;function so it can use any back-end server that Cyrus SASL supports for checking<br/>passwords. The choice is very wide, as one option is to use<i>&#160;saslauthd(8)</i>&#160;which in turn can use local files,<br/>Kerberos, an IMAP server, another LDAP server, or anything supported by the PAM mechanism.<br/>
The server must be built with the&#160;--enable-spasswd&#160;configuration option to enable pass-through<br/>authentication.<br/>
<b>Note:</b>&#160;This is not the same as using a SASL mechanism to authenticate the LDAP session.<br/>
Pass-Through authentication works only with plaintext passwords, as used in the &#34;simple bind&#34; and &#34;SASL<br/>PLAIN&#34; authentication mechanisms.}}<br/>
Pass-Through authentication is selective: it only affects users whose<i>&#160;userPassword</i>&#160;attribute has a value<br/>marked with the &#34;{SASL}&#34; scheme. The format of the attribute is:<br/>
&#160;userPassword: {SASL}username@realm<br/>
The<i>&#160;username</i>&#160;and<i>&#160;realm</i>&#160;are passed to the SASL authentication mechanism and are used to identify the<br/>account whose password is to be verified. This allows arbitrary mapping between entries in OpenLDAP and<br/>accounts known to the backend authentication service.<br/>
It would be wise to use access control to prevent users from changing their passwords through LDAP where<br/>they have pass-through authentication enabled.<br/>
<b>14.5.1. Configuring slapd to use an authentication provider</b><br/>
Where an entry has a &#34;{SASL}&#34; password value, OpenLDAP delegates the whole process of validating that<br/>entry's password to Cyrus SASL. All the configuration is therefore done in SASL config files.<br/>
The first file to be considered is confusingly named<i>&#160;slapd.conf</i>&#160;and is typically found in the SASL library<br/>directory, often&#160;/usr/lib/sasl2/slapd.conf&#160;This file governs the use of SASL when talking LDAP<br/>to<i>&#160;slapd</i>&#160;as well as the use of SASL backends for pass-through authentication. See&#160;options.html&#160;in the<br/>
139<br/>
<hr/>
<a name=154></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
<a href="http://asg.web.cmu.edu/sasl/sasl-library.html">Cyrus SASL docs for full details. Here is a simple example for a server that will use</a><i>&#160;saslauthd</i>&#160;to verify<br/>passwords:<br/>
&#160;mech_list: plain<br/>
&#160;pwcheck_method: saslauthd<br/>
&#160;saslauthd_path: /var/run/sasl2/mux<br/>
<b>14.5.2. Configuring saslauthd</b><br/>
<i>saslauthd</i>&#160;is capable of using many different authentication services: see<i>&#160;saslauthd(8)</i>&#160;for details. A common<br/>requirement is to delegate some or all authentication to another LDAP server. Here is a sample<br/>saslauthd.conf&#160;that uses Microsoft Active Directory (AD):<br/>
&#160;ldap_servers: ldap://dc1.example.com/ ldap://dc2.example.com/<br/>
&#160;ldap_search_base: cn=Users,DC=ad,DC=example,DC=com<br/>
&#160;ldap_filter: (userPrincipalName=%u)<br/>
&#160;ldap_bind_dn: cn=saslauthd,cn=Users,DC=ad,DC=example,DC=com<br/>
&#160;ldap_password: secret<br/>
In this case,<i>&#160;saslauthd</i>&#160;is run with the&#160;ldap&#160;authentication mechanism and is set to combine the SASL realm<br/>with the login name:<br/>
&#160;saslauthd -a ldap -r<br/>
This means that the &#34;username@realm&#34; string from the<i>&#160;userPassword</i>&#160;attribute ends up being used to search<br/>AD for &#34;userPrincipalName=username@realm&#34; - the password is then verified by attempting to bind to AD<br/>using the entry found by the search and the password supplied by the LDAP client.<br/>
<b>14.5.3. Testing pass-through authentication</b><br/>
It is usually best to start with the back-end authentication provider and work through<i>&#160;saslauthd</i>&#160;and<i>&#160;slapd<br/></i>towards the LDAP client.<br/>
In the AD example above, first check that the DN and password that<i>&#160;saslauthd</i>&#160;will use when it connects to<br/>AD are valid:<br/>
&#160;ldapsearch -x -H ldap://dc1.example.com/ \<br/>
&#160; &#160; &#160; -D cn=saslauthd,cn=Users,DC=ad,DC=example,DC=com \<br/>
&#160; &#160; &#160; -w secret \<br/>
&#160; &#160; &#160; -b '' \<br/>
&#160; &#160; &#160; -s base<br/>
Next check that a sample AD user can be found:<br/>
&#160;ldapsearch -x -H ldap://dc1.example.com/ \<br/>
&#160; &#160; &#160; -D cn=saslauthd,cn=Users,DC=ad,DC=example,DC=com \<br/>
&#160; &#160; &#160; -w secret \<br/>
&#160; &#160; &#160; -b cn=Users,DC=ad,DC=example,DC=com \<br/>
&#160; &#160; &#160; &#34;(userPrincipalName=user@ad.example.com)&#34;<br/>
Check that the user can bind to AD:<br/>
140<br/>
<hr/>
<a name=155></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
&#160;ldapsearch -x -H ldap://dc1.example.com/ \<br/>
&#160; &#160; &#160; -D cn=user,cn=Users,DC=ad,DC=example,DC=com \<br/>
&#160; &#160; &#160; -w userpassword \<br/>
&#160; &#160; &#160; -b cn=user,cn=Users,DC=ad,DC=example,DC=com \<br/>
&#160; &#160; &#160; -s base \<br/>
&#160; &#160; &#160; &#160; &#34;(objectclass=*)&#34;<br/>
If all that works then<i>&#160;saslauthd</i>&#160;should be able to do the same:<br/>
&#160;testsaslauthd -u user@ad.example.com -p userpassword<br/>
&#160;testsaslauthd -u user@ad.example.com -p wrongpassword<br/>
Now put the magic token into an entry in OpenLDAP:<br/>
&#160;userPassword: {SASL}user@ad.example.com<br/>
It should now be possible to bind to OpenLDAP using the DN of that entry and the password of the AD user.<br/>
141<br/>
<hr/>
<a name=156></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
142<br/>
<hr/>
<a name=157></a><b>15. Using SASL</b><br/>
OpenLDAP clients and servers are capable of authenticating via the Simple Authentication and Security Layer<br/><a href="http://www.rfc-editor.org/rfc/rfc4422.txt">(SASL) framework, which is detailed in RFC4422. This chapter describes how to make use of SASL in<br/></a>OpenLDAP.<br/>
There are several industry standard authentication mechanisms that can be used with SASL, including<br/>GSSAPI for Kerberos V, DIGEST-MD5, and PLAIN and EXTERNAL for use with Transport Layer Security<br/>(TLS).<br/>
The standard client tools provided with OpenLDAP Software, such as<i>&#160;ldapsearch</i>(1) and<i>&#160;ldapmodify</i>(1), will<br/>by default attempt to authenticate the user to the LDAP directory server using SASL. Basic authentication<br/>service can be set up by the LDAP administrator with a few steps, allowing users to be authenticated to the<br/>slapd server as their LDAP entry. With a few extra steps, some users and services can be allowed to exploit<br/>SASL's proxy authorization feature, allowing them to authenticate themselves and then switch their identity to<br/>that of another user or service.<br/>
This chapter assumes you have read<i>&#160;Cyrus SASL for System Administrators</i><a href="http://asg.web.cmu.edu/sasl/sasl-library.html">, provided with the Cyrus SASL<br/></a>package (in&#160;doc/sysadmin.html) and have a working Cyrus SASL installation. You should use the<br/>Cyrus SASL&#160;sample_client&#160;and&#160;sample_server&#160;to test your SASL installation before attempting to<br/>make use of it with OpenLDAP Software.<br/>
Note that in the following text the term<i>&#160;user</i>&#160;is used to describe a person or application entity who is<br/>connecting to the LDAP server via an LDAP client, such as<i>&#160;ldapsearch</i>(1). That is, the term<i>&#160;user</i>&#160;not only<br/>applies to both an individual using an LDAP client, but to an application entity which issues LDAP client<br/>operations without direct user control. For example, an e-mail server which uses LDAP operations to access<br/>information held in an LDAP server is an application entity.<br/>
<b>15.1. SASL Security Considerations</b><br/>
SASL offers many different authentication mechanisms. This section briefly outlines security considerations.<br/>
Some mechanisms, such as PLAIN and LOGIN, offer no greater security over LDAP<i>&#160;simple</i>&#160;authentication.<br/>Like LDAP<i>&#160;simple</i>&#160;authentication, such mechanisms should not be used unless you have adequate security<br/>protections in place. It is recommended that these mechanisms be used only in conjunction with Transport<br/>Layer Security (TLS). Use of PLAIN and LOGIN are not discussed further in this document.<br/>
The DIGEST-MD5 mechanism is the mandatory-to-implement authentication mechanism for LDAPv3.<br/>Though DIGEST-MD5 is not a strong authentication mechanism in comparison with trusted third party<br/>authentication systems (such as Kerberos or public key systems), it does offer significant protections against a<br/>number of attacks. Unlike the CRAM-MD5 mechanism, it prevents chosen plaintext attacks. DIGEST-MD5 is<br/>favored over the use of plaintext password mechanisms. The CRAM-MD5 mechanism is deprecated in favor<br/><a href="OpenLDAP-Admin-Guides.html#160">of DIGEST-MD5. Use of DIGEST-MD5 is discussed below.</a><br/>
The GSSAPI mechanism utilizes GSS-API Kerberos V to provide secure authentication services. The<br/>KERBEROS_V4 mechanism is available for those using Kerberos IV. Kerberos is viewed as a secure,<br/><a href="OpenLDAP-Admin-Guides.html#158">distributed authentication system suitable for both small and large enterprises. Use of GSSAPI and<br/></a><a href="OpenLDAP-Admin-Guides.html#159">KERBEROS_V4 are discussed below.</a><br/>
143<br/>
<hr/>
<a name=158></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
The EXTERNAL mechanism utilizes authentication services provided by lower level network services such<br/>as Transport Layer Security (TLS). When used in conjunction with TLS X.509-based public key technology,<br/><a href="OpenLDAP-Admin-Guides.html#169">EXTERNAL offers strong authentication. TLS is discussed in the Using TLS chapter.</a><br/>
EXTERNAL can also be used with the&#160;ldapi:///&#160;transport, as Unix-domain sockets can report the UID<br/>and GID of the client process.<br/>
There are other strong authentication mechanisms to choose from, including OTP (one time passwords) and<br/>SRP (secure remote passwords). These mechanisms are not discussed in this document.<br/>
<b>15.2. SASL Authentication</b><br/>
Getting basic SASL authentication running involves a few steps. The first step configures your slapd server<br/>environment so that it can communicate with client programs using the security system in place at your site.<br/>This usually involves setting up a service key, a public key, or other form of secret. The second step concerns<br/>mapping authentication identities to LDAP DN's, which depends on how entries are laid out in your directory.<br/>An explanation of the first step will be given in the next section using Kerberos V4 as an example mechanism.<br/>The steps necessary for your site's authentication mechanism will be similar, but a guide to every mechanism<br/>available under SASL is beyond the scope of this chapter. The second step is described in the section<br/><a href="OpenLDAP-Admin-Guides.html#161">Mapping Authentication Identities.</a><br/>
<b>15.2.1. GSSAPI</b><br/>
This section describes the use of the SASL GSSAPI mechanism and Kerberos V with OpenLDAP. It will be<br/>assumed that you have Kerberos V deployed, you are familiar with the operation of the system, and that your<br/>users are trained in its use. This section also assumes you have familiarized yourself with the use of the<br/>GSSAPI mechanism by reading<i>&#160;Configuring GSSAPI and Cyrus SASL</i>&#160;(provided with Cyrus SASL in the<br/>doc/gssapi&#160;file) and successfully experimented with the Cyrus provided&#160;sample_server&#160;and<br/>sample_client&#160;applications. General information about Kerberos is available at<br/><a href="http://web.mit.edu/kerberos/www/">http://web.mit.edu/kerberos/www/.</a><br/>
To use the GSSAPI mechanism with<i>&#160;slapd</i>(8) one must create a service key with a principal for<i>&#160;ldap</i>&#160;service<br/>within the realm for the host on which the service runs. For example, if you run<i>&#160;slapd</i>&#160;on<br/>directory.example.com&#160;and your realm is&#160;EXAMPLE.COM, you need to create a service key with the<br/>principal:<br/>
&#160; &#160; &#160; &#160; ldap/directory.example.com@EXAMPLE.COM<br/>
When<i>&#160;slapd</i>(8) runs, it must have access to this key. This is generally done by placing the key into a keytab<br/>file,&#160;/etc/krb5.keytab. See your Kerberos and Cyrus SASL documentation for information regarding<br/>keytab location settings.<br/>
To use the GSSAPI mechanism to authenticate to the directory, the user obtains a Ticket Granting Ticket<br/>(TGT) prior to running the LDAP client. When using OpenLDAP client tools, the user may mandate use of<br/>the GSSAPI mechanism by specifying&#160;-Y GSSAPI&#160;as a command option.<br/>
For the purposes of authentication and authorization,<i>&#160;slapd</i>(8) associates an authentication request DN of the<br/>form:<br/>
&#160; &#160; &#160; &#160; uid=&lt;primary[/instance]&gt;,cn=&lt;realm&gt;,cn=gssapi,cn=auth<br/>
144<br/>
<hr/>
<a name=159></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
Continuing our example, a user with the Kerberos principal&#160;kurt@EXAMPLE.COM&#160;would have the<br/>associated DN:<br/>
&#160; &#160; &#160; &#160; uid=kurt,cn=example.com,cn=gssapi,cn=auth<br/>
and the principal&#160;ursula/admin@FOREIGN.REALM&#160;would have the associated DN:<br/>
&#160; &#160; &#160; &#160; uid=ursula/admin,cn=foreign.realm,cn=gssapi,cn=auth<br/>
The authentication request DN can be used directly ACLs and&#160;groupOfNames&#160;&#34;member&#34; attributes, since it<br/>is of legitimate LDAP DN format. Or alternatively, the authentication DN could be mapped before use. See<br/><a href="OpenLDAP-Admin-Guides.html#161">the section Mapping Authentication Identities for details.</a><br/>
<b>15.2.2. KERBEROS_V4</b><br/>
This section describes the use of the SASL KERBEROS_V4 mechanism with OpenLDAP. It will be assumed<br/>that you are familiar with the workings of the Kerberos IV security system, and that your site has Kerberos IV<br/>deployed. Your users should be familiar with authentication policy, how to receive credentials in a Kerberos<br/>ticket cache, and how to refresh expired credentials.<br/>
<b>Note:</b>&#160;KERBEROS_V4 and Kerberos IV are deprecated in favor of GSSAPI and Kerberos V.<br/>
Client programs will need to be able to obtain a session key for use when connecting to your LDAP server.<br/>This allows the LDAP server to know the identity of the user, and allows the client to know it is connecting to<br/>a legitimate server. If encryption layers are to be used, the session key can also be used to help negotiate that<br/>option.<br/>
The slapd server runs the service called &#34;<i>ldap</i>&#34;, and the server will require a srvtab file with a service key.<br/>SASL aware client programs will be obtaining an &#34;ldap&#34; service ticket with the user's ticket granting ticket<br/>(TGT), with the instance of the ticket matching the hostname of the OpenLDAP server. For example, if your<br/>realm is named&#160;EXAMPLE.COM&#160;and the slapd server is running on the host named<br/>directory.example.com, the&#160;/etc/srvtab&#160;file on the server will have a service key<br/>
&#160; &#160; &#160; &#160; ldap.directory@EXAMPLE.COM<br/>
When an LDAP client is authenticating a user to the directory using the KERBEROS_IV mechanism, it will<br/>request a session key for that same principal, either from the ticket cache or by obtaining a new one from the<br/>Kerberos server. This will require the TGT to be available and valid in the cache as well. If it is not present or<br/>has expired, the client may print out the message:<br/>
&#160; &#160; &#160; &#160; ldap_sasl_interactive_bind_s: Local error<br/>
When the service ticket is obtained, it will be passed to the LDAP server as proof of the user's identity. The<br/>server will extract the identity and realm out of the service ticket using SASL library calls, and convert them<br/>into an<i>&#160;authentication request DN</i>&#160;of the form<br/>
&#160; &#160; &#160; &#160; uid=&lt;username&gt;,cn=&lt;realm&gt;,cn=&lt;mechanism&gt;,cn=auth<br/>
So in our above example, if the user's name were &#34;adamson&#34;, the authentication request DN would be:<br/>
&#160; &#160; &#160; &#160; uid=adamsom,cn=example.com,cn=kerberos_v4,cn=auth<br/>
145<br/>
<hr/>
<a name=160></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
This authentication request DN can be used directly ACLs or, alternatively, mapped prior to use. See the<br/><a href="OpenLDAP-Admin-Guides.html#161">section Mapping Authentication Identities for details.</a><br/>
<b>15.2.3. DIGEST-MD5</b><br/>
This section describes the use of the SASL DIGEST-MD5 mechanism using secrets stored either in the<br/>directory itself or in Cyrus SASL's own database. DIGEST-MD5 relies on the client and the server sharing a<br/>&#34;secret&#34;, usually a password. The server generates a challenge and the client a response proving that it knows<br/>the shared secret. This is much more secure than simply sending the secret over the wire.<br/>
Cyrus SASL supports several shared-secret mechanisms. To do this, it needs access to the plaintext password<br/>(unlike mechanisms which pass plaintext passwords over the wire, where the server can store a hashed version<br/>of the password).<br/>
The server's copy of the shared-secret may be stored in Cyrus SASL's own<i>&#160;sasldb</i>&#160;database, in an external<br/>system accessed via<i>&#160;saslauthd</i>, or in LDAP database itself. In either case it is very important to apply file<br/>access controls and LDAP access controls to prevent exposure of the passwords. The configuration and<br/>commands discussed in this section assume the use of Cyrus SASL 2.1.<br/>
To use secrets stored in<i>&#160;sasldb</i>, simply add users with the<i>&#160;saslpasswd2</i>&#160;command:<br/>
&#160; &#160; &#160; &#160;saslpasswd2 -c &lt;username&gt;<br/>
The passwords for such users must be managed with the<i>&#160;saslpasswd2</i>&#160;command.<br/>
To use secrets stored in the LDAP directory, place plaintext passwords in the&#160;userPassword&#160;attribute. It<br/>will be necessary to add an option to&#160;slapd.conf&#160;to make sure that passwords set using the LDAP<br/>Password Modify Operation are stored in plaintext:<br/>
&#160; &#160; &#160; &#160;password-hash &#160; {CLEARTEXT}<br/>
Passwords stored in this way can be managed either with<i>&#160;ldappasswd</i>(1) or by simply modifying the<br/>userPassword&#160;attribute. Regardless of where the passwords are stored, a mapping will be needed from<br/>authentication request DN to user's DN.<br/>
The DIGEST-MD5 mechanism produces authentication IDs of the form:<br/>
&#160; &#160; &#160; &#160; uid=&lt;username&gt;,cn=&lt;realm&gt;,cn=digest-md5,cn=auth<br/>
If the default realm is used, the realm name is omitted from the ID, giving:<br/>
&#160; &#160; &#160; &#160; uid=&lt;username&gt;,cn=digest-md5,cn=auth<br/>
<a href="OpenLDAP-Admin-Guides.html#161">See Mapping Authentication Identities below for information on optional mapping of identities.</a><br/>
With suitable mappings in place, users can specify SASL IDs when performing LDAP operations, and the<br/>password stored in<i>&#160;sasldb</i>&#160;or in the directory itself will be used to verify the authentication. For example, the<br/>user identified by the directory entry:<br/>
&#160; &#160; &#160; &#160;dn: cn=Andrew Findlay+uid=u000997,dc=example,dc=com<br/>
&#160; &#160; &#160; &#160;objectclass: inetOrgPerson<br/>
&#160; &#160; &#160; &#160;objectclass: person<br/>
146<br/>
<hr/>
<a name=161></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
&#160; &#160; &#160; &#160;sn: Findlay<br/>
&#160; &#160; &#160; &#160;uid: u000997<br/>
&#160; &#160; &#160; &#160;userPassword: secret<br/>
can issue commands of the form:<br/>
&#160; &#160; &#160; &#160;ldapsearch -Y DIGEST-MD5 -U u000997 ...<br/>
<b>Note:</b>&#160;in each of the above cases, no authorization identity (e.g.&#160;-X) was provided. Unless you are attempting<br/><a href="OpenLDAP-Admin-Guides.html#164">SASL Proxy Authorization, no authorization identity should be specified. The server will infer an<br/></a>authorization identity from authentication identity (as described below).<br/>
<b>15.2.4. EXTERNAL</b><br/>
The SASL EXTERNAL mechanism makes use of an authentication performed by a lower-level protocol:<br/>usually TLS or Unix IPC<br/>
Each transport protocol returns Authentication Identities in its own format:<br/>
<b>15.2.4.1. TLS Authentication Identity Format</b><br/>
This is the Subject DN from the client-side certificate. Note that DNs are displayed differently by LDAP and<br/>by X.509, so a certificate issued to<br/>
&#160; &#160; &#160; &#160; C=gb, O=The Example Organisation, CN=A Person<br/>
will produce an authentication identity of:<br/>
&#160; &#160; &#160; &#160; cn=A Person,o=The Example Organisation,c=gb<br/>
Note that you must set a suitable value for TLSVerifyClient to make the server request the use of a client-side<br/><a href="OpenLDAP-Admin-Guides.html#169">certificate. Without this, the SASL EXTERNAL mechanism will not be offered. Refer to the Using TLS<br/></a>chapter for details.<br/>
<b>15.2.4.2. IPC (ldapi:///) Identity Format</b><br/>
This is formed from the Unix UID and GID of the client process:<br/>
&#160; &#160; &#160; &#160; gidNumber=&lt;number&gt;+uidNumber=&lt;number&gt;,cn=peercred,cn=external,cn=auth<br/>
Thus, a client process running as&#160;root&#160;will be:<br/>
&#160; &#160; &#160; &#160; gidNumber=0+uidNumber=0,cn=peercred,cn=external,cn=auth<br/>
<b>15.2.5. Mapping Authentication Identities</b><br/>
The authentication mechanism in the slapd server will use SASL library calls to obtain the authenticated user's<br/>&#34;username&#34;, based on whatever underlying authentication mechanism was used. This username is in the<br/>namespace of the authentication mechanism, and not in the normal LDAP namespace. As stated in the<br/>sections above, that username is reformatted into an authentication request DN of the form<br/>
&#160; &#160; &#160; &#160; uid=&lt;username&gt;,cn=&lt;realm&gt;,cn=&lt;mechanism&gt;,cn=auth<br/>
147<br/>
<hr/>
<a name=162></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
or<br/>
&#160; &#160; &#160; &#160; uid=&lt;username&gt;,cn=&lt;mechanism&gt;,cn=auth<br/>
depending on whether or not &lt;mechanism&gt; employs the concept of &#34;realms&#34;. Note also that the realm part<br/>will be omitted if the default realm was used in the authentication.<br/>
The<i>&#160;ldapwhoami</i>(1) command may be used to determine the identity associated with the user. It is very useful<br/>for determining proper function of mappings.<br/>
It is not intended that you should add LDAP entries of the above form to your LDAP database. Chances are<br/>you have an LDAP entry for each of the persons that will be authenticating to LDAP, laid out in your<br/>directory tree, and the tree does not start at cn=auth. But if your site has a clear mapping between the<br/>&#34;username&#34; and an LDAP entry for the person, you will be able to configure your LDAP server to<br/>automatically map a authentication request DN to the user's<i>&#160;authentication DN</i>.<br/>
<b>Note:</b>&#160;it is not required that the authentication request DN nor the user's authentication DN resulting from the<br/>mapping refer to an entry held in the directory. However, additional capabilities become available (see<br/>below).<br/>
The LDAP administrator will need to tell the slapd server how to map an authentication request DN to a user's<br/>authentication DN. This is done by adding one or more&#160;authz-regexp&#160;directives to the<i>&#160;slapd.conf</i>(5) file.<br/>This directive takes two arguments:<br/>
&#160; &#160; &#160; &#160; authz-regexp &#160; &lt;search pattern&gt; &#160; &lt;replacement pattern&gt;<br/>
The authentication request DN is compared to the search pattern using the regular expression functions<br/><i>regcomp</i>() and<i>&#160;regexec</i>(), and if it matches, it is rewritten as the replacement pattern. If there are multiple<br/>authz-regexp&#160;directives, only the first whose search pattern matches the authentication identity is used.<br/>The string that is output from the replacement pattern should be the authentication DN of the user or an LDAP<br/>URL. If replacement string produces a DN, the entry named by this DN need not be held by this server. If the<br/>replace string produces an LDAP URL, that LDAP URL must evaluate to one and only one entry held by this<br/>server.<br/>
The search pattern can contain any of the regular expression characters listed in<i>&#160;regexec</i>(3C). The main<br/>characters of note are dot &#34;.&#34;, asterisk &#34;*&#34;, and the open and close parenthesis &#34;(&#34; and &#34;)&#34;. Essentially, the dot<br/>matches any character, the asterisk allows zero or more repeats of the immediately preceding character or<br/>pattern, and terms in parenthesis are remembered for the replacement pattern.<br/>
The replacement pattern will produce either a DN or URL referring to the user. Anything from the<br/>authentication request DN that matched a string in parenthesis in the search pattern is stored in the variable<br/>&#34;$1&#34;. That variable &#34;$1&#34; can appear in the replacement pattern, and will be replaced by the string from the<br/>authentication request DN. If there were multiple sets of parentheses in the search pattern, the variables $2,<br/>$3, etc are used.<br/>
<b>15.2.6. Direct Mapping</b><br/>
Where possible, direct mapping of the authentication request DN to the user's DN is generally recommended.<br/>Aside from avoiding the expense of searching for the user's DN, it allows mapping to DNs which refer to<br/>entries not held by this server.<br/>
148<br/>
<hr/>
<a name=163></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
Suppose the authentication request DN is written as:<br/>
&#160; &#160; &#160; &#160; uid=adamson,cn=example.com,cn=gssapi,cn=auth<br/>
and the user's actual LDAP entry is:<br/>
&#160; &#160; &#160; &#160; uid=adamson,ou=people,dc=example,dc=com<br/>
then the following&#160;authz-regexp&#160;directive in<i>&#160;slapd.conf</i>(5) would provide for direct mapping.<br/>
&#160; &#160; &#160; &#160; authz-regexp<br/>
&#160; &#160; &#160; &#160; &#160; uid=([^,]*),cn=example.com,cn=gssapi,cn=auth<br/>
&#160; &#160; &#160; &#160; &#160; uid=$1,ou=people,dc=example,dc=com<br/>
An even more lenient rule could be written as<br/>
&#160; &#160; &#160; &#160; authz-regexp<br/>
&#160; &#160; &#160; &#160; &#160; uid=([^,]*),cn=[^,]*,cn=auth<br/>
&#160; &#160; &#160; &#160; &#160; uid=$1,ou=people,dc=example,dc=com<br/>
Be careful about setting the search pattern too leniently, however, since it may mistakenly allow persons to<br/>become authenticated as a DN to which they should not have access. It is better to write several strict<br/>directives than one lenient directive which has security holes. If there is only one authentication mechanism in<br/>place at your site, and zero or one realms in use, you might be able to map between authentication identities<br/>and LDAP DN's with a single&#160;authz-regexp&#160;directive.<br/>
Don't forget to allow for the case where the realm is omitted as well as the case with an explicitly specified<br/>realm. This may well require a separate&#160;authz-regexp&#160;directive for each case, with the explicit-realm<br/>entry being listed first.<br/>
<b>15.2.7. Search-based mappings</b><br/>
There are a number of cases where mapping to a LDAP URL may be appropriate. For instance, some sites<br/>may have person objects located in multiple areas of the LDAP tree, such as if there were an<br/>ou=accounting&#160;tree and an&#160;ou=engineering&#160;tree, with persons interspersed between them. Or, maybe<br/>the desired mapping must be based upon information in the user's information. Consider the need to map the<br/>above authentication request DN to user whose entry is as follows:<br/>
&#160; &#160; &#160; &#160; dn: cn=Mark Adamson,ou=People,dc=Example,dc=COM<br/>
&#160; &#160; &#160; &#160; objectclass: person<br/>
&#160; &#160; &#160; &#160; cn: Mark Adamson<br/>
&#160; &#160; &#160; &#160; uid: adamson<br/>
The information in the authentication request DN is insufficient to allow the user's DN to be directly derived,<br/>instead the user's DN must be searched for. For these situations, a replacement pattern which produces a<br/>LDAP URL can be used in the&#160;authz-regexp&#160;directives. This URL will then be used to perform an<br/>internal search of the LDAP database to find the person's authentication DN.<br/>
An LDAP URL, similar to other URL's, is of the form<br/>
&#160; &#160; &#160; &#160; ldap://&lt;host&gt;/&lt;base&gt;?&lt;attrs&gt;?&lt;scope&gt;?&lt;filter&gt;<br/>
149<br/>
<hr/>
<a name=164></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
This contains all of the elements necessary to perform an LDAP search: the name of the server &lt;host&gt;, the<br/>LDAP DN search base &lt;base&gt;, the LDAP attributes to retrieve &lt;attrs&gt;, the search scope &lt;scope&gt; which is<br/>one of the three options &#34;base&#34;, &#34;one&#34;, or &#34;sub&#34;, and lastly an LDAP search filter &lt;filter&gt;. Since the search is<br/>for an LDAP DN within the current server, the &lt;host&gt; portion should be empty. The &lt;attrs&gt; field is also<br/>ignored since only the DN is of concern. These two elements are left in the format of the URL to maintain the<br/>clarity of what information goes where in the string.<br/>
Suppose that the person in the example from above did in fact have an authentication username of &#34;adamson&#34;<br/>and that information was kept in the attribute &#34;uid&#34; in their LDAP entry. The&#160;authz-regexp&#160;directive<br/>might be written as<br/>
&#160; &#160; &#160; &#160; authz-regexp<br/>
&#160; &#160; &#160; &#160; &#160; uid=([^,]*),cn=example.com,cn=gssapi,cn=auth<br/>
&#160; &#160; &#160; &#160; &#160; ldap:///ou=people,dc=example,dc=com??one?(uid=$1)<br/>
This will initiate an internal search of the LDAP database inside the slapd server. If the search returns exactly<br/>one entry, it is accepted as being the DN of the user. If there are more than one entries returned, or if there are<br/>zero entries returned, the authentication fails and the user's connection is left bound as the authentication<br/>request DN.<br/>
The attributes that are used in the search filter &lt;filter&gt; in the URL should be indexed to allow faster searching.<br/>If they are not, the authentication step alone can take uncomfortably long periods, and users may assume the<br/>server is down.<br/>
A more complex site might have several realms in use, each mapping to a different subtree in the directory.<br/>These can be handled with statements of the form:<br/>
&#160; &#160; &#160; &#160; # Match Engineering realm<br/>
&#160; &#160; &#160; &#160; authz-regexp<br/>
&#160; &#160; &#160; &#160; &#160; &#160;uid=([^,]*),cn=engineering.example.com,cn=digest-md5,cn=auth<br/>
&#160; &#160; &#160; &#160; &#160; &#160;ldap:///dc=eng,dc=example,dc=com??one?(&amp;(uid=$1)(objectClass=person))<br/>
&#160; &#160; &#160; &#160; # Match Accounting realm<br/>
&#160; &#160; &#160; &#160; authz-regexp<br/>
&#160; &#160; &#160; &#160; &#160; &#160;uid=([^,].*),cn=accounting.example.com,cn=digest-md5,cn=auth<br/>
&#160; &#160; &#160; &#160; &#160; &#160;ldap:///dc=accounting,dc=example,dc=com??one?(&amp;(uid=$1)(objectClass=person))<br/>
&#160; &#160; &#160; &#160; # Default realm is customers.example.com<br/>
&#160; &#160; &#160; &#160; authz-regexp<br/>
&#160; &#160; &#160; &#160; &#160; &#160;uid=([^,]*),cn=digest-md5,cn=auth<br/>
&#160; &#160; &#160; &#160; &#160; &#160;ldap:///dc=customers,dc=example,dc=com??one?(&amp;(uid=$1)(objectClass=person))<br/>
Note that the explicitly-named realms are handled first, to avoid the realm name becoming part of the UID.<br/>Also note the use of scope and filters to limit matching to desirable entries.<br/>
Note as well that&#160;authz-regexp&#160;internal search are subject to access controls. Specifically, the<br/>authentication identity must have&#160;auth&#160;access.<br/>
See<i>&#160;slapd.conf</i>(5) for more detailed information.<br/>
<b>15.3. SASL Proxy Authorization</b><br/>
150<br/>
<hr/>
<a name=165></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
The SASL offers a feature known as<i>&#160;proxy authorization</i>, which allows an authenticated user to request that<br/>they act on the behalf of another user. This step occurs after the user has obtained an authentication DN, and<br/>involves sending an authorization identity to the server. The server will then make a decision on whether or<br/>not to allow the authorization to occur. If it is allowed, the user's LDAP connection is switched to have a<br/>binding DN derived from the authorization identity, and the LDAP session proceeds with the access of the<br/>new authorization DN.<br/>
The decision to allow an authorization to proceed depends on the rules and policies of the site where LDAP is<br/>running, and thus cannot be made by SASL alone. The SASL library leaves it up to the server to make the<br/>decision. The LDAP administrator sets the guidelines of who can authorize to what identity by adding<br/>information into the LDAP database entries. By default, the authorization features are disabled, and must be<br/>explicitly configured by the LDAP administrator before use.<br/>
<b>15.3.1. Uses of Proxy Authorization</b><br/>
This sort of service is useful when one entity needs to act on the behalf of many other users. For example,<br/>users may be directed to a web page to make changes to their personal information in their LDAP entry. The<br/>users authenticate to the web server to establish their identity, but the web server CGI cannot authenticate to<br/>the LDAP server as that user to make changes for them. Instead, the web server authenticates itself to the<br/>LDAP server as a service identity, say,<br/>
&#160; &#160; &#160; &#160; cn=WebUpdate,dc=example,dc=com<br/>
and then it will SASL authorize to the DN of the user. Once so authorized, the CGI makes changes to the<br/>LDAP entry of the user, and as far as the slapd server can tell for its ACLs, it is the user themself on the other<br/>end of the connection. The user could have connected to the LDAP server directly and authenticated as<br/>themself, but that would require the user to have more knowledge of LDAP clients, knowledge which the web<br/>page provides in an easier format.<br/>
Proxy authorization can also be used to limit access to an account that has greater access to the database. Such<br/>an account, perhaps even the root DN specified in<i>&#160;slapd.conf</i>(5), can have a strict list of people who can<br/>authorize to that DN. Changes to the LDAP database could then be only allowed by that DN, and in order to<br/>become that DN, users must first authenticate as one of the persons on the list. This allows for better auditing<br/>of who made changes to the LDAP database. If people were allowed to authenticate directly to the privileged<br/>account, possibly through the&#160;rootpw<i>&#160;slapd.conf</i>(5) directive or through a&#160;userPassword&#160;attribute, then<br/>auditing becomes more difficult.<br/>
Note that after a successful proxy authorization, the original authentication DN of the LDAP connection is<br/>overwritten by the new DN from the authorization request. If a service program is able to authenticate itself as<br/>its own authentication DN and then authorize to other DN's, and it is planning on switching to several<br/>different identities during one LDAP session, it will need to authenticate itself each time before authorizing to<br/>another DN (or use a different proxy authorization mechanism). The slapd server does not keep record of the<br/>service program's ability to switch to other DN's. On authentication mechanisms like Kerberos this will not<br/>require multiple connections being made to the Kerberos server, since the user's TGT and &#34;ldap&#34; session key<br/>are valid for multiple uses for the several hours of the ticket lifetime.<br/>
<b>15.3.2. SASL Authorization Identities</b><br/>
The SASL authorization identity is sent to the LDAP server via the&#160;-X&#160;switch for<i>&#160;ldapsearch</i>(1) and other<br/>tools, or in the&#160;*authzid&#160;parameter to the<i>&#160;lutil_sasl_defaults</i>() call. The identity can be in one of two forms,<br/>
151<br/>
<hr/>
<a name=166></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
either<br/>
&#160; &#160; &#160; &#160; u:&lt;username&gt;<br/>
or<br/>
&#160; &#160; &#160; &#160; dn:&lt;dn&gt;<br/>
In the first form, the &lt;username&gt; is from the same namespace as the authentication identities above. It is the<br/>user's username as it is referred to by the underlying authentication mechanism. Authorization identities of<br/>this form are converted into a DN format by the same function that the authentication process used, producing<br/>an<i>&#160;authorization request DN</i>&#160;of the form<br/>
&#160; &#160; &#160; &#160; uid=&lt;username&gt;,cn=&lt;realm&gt;,cn=&lt;mechanism&gt;,cn=auth<br/>
That authorization request DN is then run through the same&#160;authz-regexp&#160;process to convert it into a<br/>legitimate authorization DN from the database. If it cannot be converted due to a failed search from an LDAP<br/>URL, the authorization request fails with &#34;inappropriate access&#34;. Otherwise, the DN string is now a legitimate<br/>authorization DN ready to undergo approval.<br/>
If the authorization identity was provided in the second form, with a&#160;&#34;dn:&#34;&#160;prefix, the string after the prefix<br/>is already in authorization DN form, ready to undergo approval.<br/>
<b>15.3.3. Proxy Authorization Rules</b><br/>
Once slapd has the authorization DN, the actual approval process begins. There are two attributes that the<br/>LDAP administrator can put into LDAP entries to allow authorization:<br/>
&#160; &#160; &#160; &#160; authzTo<br/>
&#160; &#160; &#160; &#160; authzFrom<br/>
Both can be multivalued. The&#160;authzTo&#160;attribute is a source rule, and it is placed into the entry associated<br/>with the authentication DN to tell what authorization DNs the authenticated DN is allowed to assume. The<br/>second attribute is a destination rule, and it is placed into the entry associated with the requested authorization<br/>DN to tell which authenticated DNs may assume it.<br/>
The choice of which authorization policy attribute to use is up to the administrator. Source rules are checked<br/>first in the person's authentication DN entry, and if none of the&#160;authzTo&#160;rules specify the authorization is<br/>permitted, the&#160;authzFrom&#160;rules in the authorization DN entry are then checked. If neither case specifies that<br/>the request be honored, the request is denied. Since the default behavior is to deny authorization requests,<br/>rules only specify that a request be allowed; there are no negative rules telling what authorizations to deny.<br/>
The value(s) in the two attributes are of the same form as the output of the replacement pattern of a<br/>authz-regexp&#160;directive: either a DN or an LDAP URL. For example, if a&#160;authzTo&#160;value is a DN, that<br/>DN is one the authenticated user can authorize to. On the other hand, if the&#160;authzTo&#160;value is an LDAP<br/>URL, the URL is used as an internal search of the LDAP database, and the authenticated user can become<br/>ANY DN returned by the search. If an LDAP entry looked like:<br/>
&#160; &#160; &#160; &#160; dn: cn=WebUpdate,dc=example,dc=com<br/>
&#160; &#160; &#160; &#160; authzTo: ldap:///dc=example,dc=com??sub?(objectclass=person)<br/>
152<br/>
<hr/>
<a name=167></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
then any user who authenticated as&#160;cn=WebUpdate,dc=example,dc=com&#160;could authorize to any other<br/>LDAP entry under the search base&#160;dc=example,dc=com&#160;which has an objectClass of&#160;Person.<br/>
<b>15.3.3.1. Notes on Proxy Authorization Rules</b><br/>
An LDAP URL in a&#160;authzTo&#160;or&#160;authzFrom&#160;attribute will return a set of DNs. Each DN returned will be<br/>checked. Searches which return a large set can cause the authorization process to take an uncomfortably long<br/>time. Also, searches should be performed on attributes that have been indexed by slapd.<br/>
To help produce more sweeping rules for&#160;authzFrom&#160;and&#160;authzTo, the values of these attributes are<br/>allowed to be DNs with regular expression characters in them. This means a source rule like<br/>
&#160; &#160; &#160; &#160; authzTo: dn.regex:^uid=[^,]*,dc=example,dc=com$<br/>
would allow that authenticated user to authorize to any DN that matches the regular expression pattern given.<br/>This regular expression comparison can be evaluated much faster than an LDAP search for&#160;(uid=*).<br/>
Also note that the values in an authorization rule must be one of the two forms: an LDAP URL or a DN (with<br/>or without regular expression characters). Anything that does not begin with &#34;ldap://&#34; is taken as a DN. It<br/>is not permissible to enter another authorization identity of the form &#34;u:&lt;username&gt;&#34; as an authorization<br/>rule.<br/>
<b>15.3.3.2. Policy Configuration</b><br/>
The decision of which type of rules to use,&#160;authzFrom&#160;or&#160;authzTo, will depend on the site's situation. For<br/>example, if the set of people who may become a given identity can easily be written as a search filter, then a<br/>single destination rule could be written. If the set of people is not easily defined by a search filter, and the set<br/>of people is small, it may be better to write a source rule in the entries of each of those people who should be<br/>allowed to perform the proxy authorization.<br/>
By default, processing of proxy authorization rules is disabled. The&#160;authz-policy&#160;directive must be set in<br/>the<i>&#160;slapd.conf</i>(5) file to enable authorization. This directive can be set to&#160;none&#160;for no rules (the default),&#160;to<br/>for source rules,&#160;from&#160;for destination rules, or&#160;both&#160;for both source and destination rules.<br/>
Source rules are extremely powerful. If ordinary users have access to write the&#160;authzTo&#160;attribute in their<br/>own entries, then they can write rules that would allow them to authorize as anyone else. As such, when using<br/>source rules, the&#160;authzTo&#160;attribute should be protected with an ACL that only allows privileged users to set<br/>its values.<br/>
153<br/>
<hr/>
<a name=168></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
154<br/>
<hr/>
<a name=169></a><b>16. Using TLS</b><br/>
OpenLDAP clients and servers are capable of using the Transport Layer Security (TLS) framework to provide<br/>integrity and confidentiality protections and to support LDAP authentication using the SASL EXTERNAL<br/><a href="http://www.rfc-editor.org/rfc/rfc4346.txt">mechanism. TLS is defined in RFC4346.</a><br/>
<b>Note:</b><a href="http://www.openldap.org/faq/data/cache/185.html">&#160;For generating certifcates, please reference http://www.openldap.org/faq/data/cache/185.html</a><br/>
<b>16.1. TLS Certificates</b><br/>
TLS uses X.509 certificates to carry client and server identities. All servers are required to have valid<br/>certificates, whereas client certificates are optional. Clients must have a valid certificate in order to<br/>authenticate via SASL EXTERNAL. For more information on creating and managing certificates, see the<br/><a href="http://www.openssl.org/">OpenSSL, GnuTLS, or MozNSS documentation, depending on which TLS implementation libraries you are<br/></a>using.<br/>
<b>16.1.1. Server Certificates</b><br/>
The DN of a server certificate must use the&#160;CN&#160;attribute to name the server, and the&#160;CN&#160;must carry the server's<br/>fully qualified domain name. Additional alias names and wildcards may be present in the<br/>subjectAltName<a href="http://www.rfc-editor.org/rfc/rfc4513.txt">&#160;certificate extension. More details on server certificate names are in RFC4513.</a><br/>
<b>16.1.2. Client Certificates</b><br/>
The DN of a client certificate can be used directly as an authentication DN. Since X.509 is a part of the X.500<br/>standard and LDAP is also based on X.500, both use the same DN formats and generally the DN in a user's<br/>X.509 certificate should be identical to the DN of their LDAP entry. However, sometimes the DNs may not be<br/><a href="OpenLDAP-Admin-Guides.html#161">exactly the same, and so the mapping facility described in Mapping Authentication Identities can be applied to<br/></a>these DNs as well.<br/>
<b>16.2. TLS Configuration</b><br/>
After obtaining the required certificates, a number of options must be configured on both the client and the<br/>server to enable TLS and make use of the certificates. At a minimum, the clients must be configured with the<br/>name of the file containing all of the Certificate Authority (CA) certificates it will trust. The server must be<br/>configured with the CA certificates and also its own server certificate and private key.<br/>
Typically a single CA will have issued the server certificate and all of the trusted client certificates, so the<br/>server only needs to trust that one signing CA. However, a client may wish to connect to a variety of secure<br/>servers managed by different organizations, with server certificates generated by many different CAs. As<br/>such, a client is likely to need a list of many different trusted CAs in its configuration.<br/>
<b>16.2.1. Server Configuration</b><br/>
The configuration directives for slapd belong in the global directives section of<i>&#160;slapd.conf</i>(5).<br/>
155<br/>
<hr/>
<a name=170></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
<b>16.2.1.1. TLSCACertificateFile &lt;filename&gt;</b><br/>
This directive specifies the PEM-format file containing certificates for the CA's that slapd will trust. The<br/>certificate for the CA that signed the server certificate must be included among these certificates. If the<br/>signing CA was not a top-level (root) CA, certificates for the entire sequence of CA's from the signing CA to<br/>the top-level CA should be present. Multiple certificates are simply appended to the file; the order is not<br/>significant.<br/>
<b>16.2.1.2. TLSCACertificatePath &lt;path&gt;</b><br/>
This directive specifies the path of a directory that contains individual CA certificates in separate files. In<br/>addition, this directory must be specially managed using the OpenSSL<i>&#160;c_rehash</i>&#160;utility. When using this<br/>feature, the OpenSSL library will attempt to locate certificate files based on a hash of their name and serial<br/>number. The<i>&#160;c_rehash</i>&#160;utility is used to generate symbolic links with the hashed names that point to the actual<br/>certificate files. As such, this option can only be used with a filesystem that actually supports symbolic links.<br/>In general, it is simpler to use the&#160;TLSCACertificateFile&#160;directive instead.<br/>
When using Mozilla NSS, this directive can be used to specify the path of the directory containing the NSS<br/>certificate and key database files. The<i>&#160;certutil</i>&#160;command can be used to add a CA certificate:<br/>
&#160; &#160; &#160; &#160; certutil -d &lt;path&gt; -A -n &#34;name of CA cert&#34; -t CT,, -a -i /path/to/cacertfile.pem<br/>
This command will add a CA certficate stored in the PEM (ASCII) formatted<br/>file named /path/to/cacertfile.pem.&#160;-t CT,,&#160;means that the certificate is<br/>trusted to be a CA issuing certs for use in TLS clients and servers.<br/>
<b>16.2.1.3. TLSCertificateFile &lt;filename&gt;</b><br/>
This directive specifies the file that contains the slapd server certificate. Certificates are generally public<br/>information and require no special protection.<br/>
When using Mozilla NSS, if using a cert/key database (specified with&#160;TLSCACertificatePath), this<br/>directive specifies the name of the certificate to use:<br/>
&#160; &#160; &#160; &#160;TLSCertificateFile Server-Cert<br/>
If using a token other than the internal built in token, specify the<br/>token name first, followed by a colon:<br/>
&#160; &#160; &#160; &#160;TLSCertificateFile my hardware device:Server-Cert<br/>
Use&#160;certutil -L&#160;to list the certificates by name:<br/>
&#160; &#160; &#160; &#160;certutil -d /path/to/certdbdir -L<br/>
<b>16.2.1.4. TLSCertificateKeyFile &lt;filename&gt;</b><br/>
This directive specifies the file that contains the private key that matches the certificate stored in the<br/>TLSCertificateFile&#160;file. Private keys themselves are sensitive data and are usually password encrypted<br/>for protection. However, the current implementation doesn't support encrypted keys so the key must not be<br/>encrypted and the file itself must be protected carefully.<br/>
156<br/>
<hr/>
<a name=171></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
When using Mozilla NSS, this directive specifies the name of a file that contains the password for the key for<br/>the certificate specified with&#160;TLSCertificateFile. The modutil command can be used to turn off<br/>password protection for the cert/key database. For example, if&#160;TLSCACertificatePath&#160;specifes<br/>/etc/openldap/certdb as the location of the cert/key database, use modutil to change the password to the empty<br/>string:<br/>
&#160; &#160; &#160; &#160; modutil -dbdir /etc/openldap/certdb -changepw 'NSS Certificate DB'<br/>
You must have the old password, if any. Ignore the WARNING about the running<br/>browser. Press 'Enter' for the new password.<br/>
<b>16.2.1.5. TLSCipherSuite &lt;cipher-suite-spec&gt;</b><br/>
This directive configures what ciphers will be accepted and the preference order.&#160;&lt;cipher-suite-spec&gt;<br/>should be a cipher specification for OpenSSL. You can use the command<br/>
&#160; &#160; &#160; &#160; openssl ciphers -v ALL<br/>
to obtain a verbose list of available cipher specifications.<br/>
Besides the individual cipher names, the specifiers&#160;HIGH,&#160;MEDIUM,&#160;LOW,&#160;EXPORT, and&#160;EXPORT40&#160;may be<br/>helpful, along with&#160;TLSv1,&#160;SSLv3, and&#160;SSLv2.<br/>
To obtain the list of ciphers in GnuTLS use:<br/>
&#160; &#160; &#160; &#160; gnutls-cli -l<br/>
When using Mozilla NSS, the OpenSSL cipher suite specifications are used and translated into the format<br/>used internally by Mozilla NSS. There isn't an easy way to list the cipher suites from the command line. The<br/>authoritative list is in the source code for Mozilla NSS in the file sslinfo.c in the structure<br/>
&#160; &#160; &#160; &#160;static const SSLCipherSuiteInfo suiteInfo[]<br/>
<b>16.2.1.6. TLSRandFile &lt;filename&gt;</b><br/>
This directive specifies the file to obtain random bits from when&#160;/dev/urandom&#160;is not available. If the<br/>system provides&#160;/dev/urandom&#160;then this option is not needed, otherwise a source of random data must be<br/>configured. Some systems (e.g. Linux) provide&#160;/dev/urandom&#160;by default, while others (e.g. Solaris)<br/>require the installation of a patch to provide it, and others may not support it at all. In the latter case, EGD or<br/>PRNGD should be installed, and this directive should specify the name of the EGD/PRNGD socket. The<br/>environment variable&#160;RANDFILE&#160;can also be used to specify the filename. Also, in the absence of these<br/>options, the&#160;.rnd&#160;file in the slapd user's home directory may be used if it exists. To use the&#160;.rnd&#160;file, just<br/>create the file and copy a few hundred bytes of arbitrary data into the file. The file is only used to provide a<br/>seed for the pseudo-random number generator, and it doesn't need very much data to work.<br/>
This directive is ignored with GnuTLS and Mozilla NSS.<br/>
<b>16.2.1.7. TLSEphemeralDHParamFile &lt;filename&gt;</b><br/>
This directive specifies the file that contains parameters for Diffie-Hellman ephemeral key exchange. This is<br/>required in order to use a DSA certificate on the server side (i.e.&#160;TLSCertificateKeyFile&#160;points to a<br/>
157<br/>
<hr/>
<a name=172></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
DSA key). Multiple sets of parameters can be included in the file; all of them will be processed. Parameters<br/>can be generated using the following command<br/>
&#160; &#160; &#160; &#160; openssl dhparam [-dsaparam] -out &lt;filename&gt; &lt;numbits&gt;<br/>
This directive is ignored with GnuTLS and Mozilla NSS.<br/>
<b>16.2.1.8. TLSVerifyClient { never | allow | try | demand }</b><br/>
This directive specifies what checks to perform on client certificates in an incoming TLS session, if any. This<br/>option is set to&#160;never&#160;by default, in which case the server never asks the client for a certificate. With a<br/>setting of&#160;allow&#160;the server will ask for a client certificate; if none is provided the session proceeds normally.<br/>If a certificate is provided but the server is unable to verify it, the certificate is ignored and the session<br/>proceeds normally, as if no certificate had been provided. With a setting of&#160;try&#160;the certificate is requested,<br/>and if none is provided, the session proceeds normally. If a certificate is provided and it cannot be verified, the<br/>session is immediately terminated. With a setting of&#160;demand&#160;the certificate is requested and a valid certificate<br/>must be provided, otherwise the session is immediately terminated.<br/>
<b>Note:</b>&#160;The server must request a client certificate in order to use the SASL EXTERNAL authentication<br/>mechanism with a TLS session. As such, a non-default&#160;TLSVerifyClient&#160;setting must be configured<br/>before SASL EXTERNAL authentication may be attempted, and the SASL EXTERNAL mechanism will<br/>only be offered to the client if a valid client certificate was received.<br/>
<b>16.2.2. Client Configuration</b><br/>
Most of the client configuration directives parallel the server directives. The names of the directives are<br/>different, and they go into<i>&#160;ldap.conf</i>(5) instead of<i>&#160;slapd.conf</i>(5), but their functionality is mostly the same.<br/>Also, while most of these options may be configured on a system-wide basis, they may all be overridden by<br/>individual users in their<i>&#160;.ldaprc</i>&#160;files.<br/>
The LDAP Start TLS operation is used in LDAP to initiate TLS negotiation. All OpenLDAP command line<br/>tools support a&#160;-Z&#160;and&#160;-ZZ&#160;flag to indicate whether a Start TLS operation is to be issued. The latter flag<br/>indicates that the tool is to cease processing if TLS cannot be started while the former allows the command to<br/>continue.<br/>
In LDAPv2 environments, TLS is normally started using the LDAP Secure URI scheme (ldaps://) instead<br/>of the normal LDAP URI scheme (ldap://). OpenLDAP command line tools allow either scheme to used<br/>with the&#160;-H&#160;flag and with the&#160;URI<i>&#160;ldap.conf</i>(5) option.<br/>
<b>16.2.2.1. TLS_CACERT &lt;filename&gt;</b><br/>
This is equivalent to the server's&#160;TLSCACertificateFile<a href="OpenLDAP-Admin-Guides.html#169">&#160;option. As noted in the TLS Configuration<br/></a>section, a client typically may need to know about more CAs than a server, but otherwise the same<br/>considerations apply.<br/>
<b>16.2.2.2. TLS_CACERTDIR &lt;path&gt;</b><br/>
This is equivalent to the server's&#160;TLSCACertificatePath&#160;option. The specified directory must be<br/>managed with the OpenSSL<i>&#160;c_rehash</i>&#160;utility as well. If using Mozilla NSS, &lt;path&gt; may contain a cert/key<br/>database.<br/>
158<br/>
<hr/>
<a name=173></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
<b>16.2.2.3. TLS_CERT &lt;filename&gt;</b><br/>
This directive specifies the file that contains the client certificate. This is a user-only directive and can only be<br/>specified in a user's<i>&#160;.ldaprc</i>&#160;file.<br/>
When using Mozilla NSS, if using a cert/key database (specified with&#160;TLS_CACERTDIR), this directive<br/>specifies the name of the certificate to use:<br/>
&#160; &#160; &#160; &#160;TLS_CERT Certificate for Sam Carter<br/>
If using a token other than the internal built in token, specify the<br/>token name first, followed by a colon:<br/>
&#160; &#160; &#160; &#160;TLS_CERT my hardware device:Certificate for Sam Carter<br/>
Use&#160;certutil -L&#160;to list the certificates by name:<br/>
&#160; &#160; &#160; &#160;certutil -d /path/to/certdbdir -L<br/>
<b>16.2.2.4. TLS_KEY &lt;filename&gt;</b><br/>
This directive specifies the file that contains the private key that matches the certificate stored in the<br/>TLS_CERT&#160;file. The same constraints mentioned for&#160;TLSCertificateKeyFile&#160;apply here. This is also a<br/>user-only directive.<br/>
<b>16.2.2.5. TLS_RANDFILE &lt;filename&gt;</b><br/>
This directive is the same as the server's&#160;TLSRandFile&#160;option.<br/>
<b>16.2.2.6. TLS_REQCERT { never | allow | try | demand }</b><br/>
This directive is equivalent to the server's&#160;TLSVerifyClient&#160;option. However, for clients the default<br/>value is&#160;demand&#160;and there generally is no good reason to change this setting.<br/>
159<br/>
<hr/>
<a name=174></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
160<br/>
<hr/>
<a name=175></a><b>17. Constructing a Distributed Directory Service</b><br/>
For many sites, running one or more<i>&#160;slapd</i>(8) that hold an entire subtree of data is sufficient. But often it is<br/>desirable to have one<i>&#160;slapd</i>&#160;refer to other directory services for a certain part of the tree (which may or may<br/>not be running<i>&#160;slapd</i>).<br/>
<i>slapd</i>&#160;supports<i>&#160;subordinate</i>&#160;and<i>&#160;superior</i>&#160;knowledge information. Subordinate knowledge information is held<br/>in&#160;referral<a href="http://www.rfc-editor.org/rfc/rfc3296.txt">&#160;objects (RFC3296).</a><br/>
<b>17.1. Subordinate Knowledge Information</b><br/>
Subordinate knowledge information may be provided to delegate a subtree. Subordinate knowledge<br/>information is maintained in the directory as a special<i>&#160;referral</i>&#160;object at the delegate point. The referral object<br/>acts as a delegation point, gluing two services together. This mechanism allows for hierarchical directory<br/>services to be constructed.<br/>
A referral object has a structural object class of&#160;referral&#160;and has the same Distinguished Name as the<br/>delegated subtree. Generally, the referral object will also provide the auxiliary object class<br/>extensibleObject. This allows the entry to contain appropriate Relative Distinguished Name values.<br/>This is best demonstrated by example.<br/>
If the server&#160;a.example.net&#160;holds&#160;dc=example,dc=net&#160;and wished to delegate the subtree<br/>ou=subtree,dc=example,dc=net&#160;to another server&#160;b.example.net, the following named referral<br/>object would be added to&#160;a.example.net:<br/>
&#160; &#160; &#160; &#160; dn: dc=subtree,dc=example,dc=net<br/>
&#160; &#160; &#160; &#160; objectClass: referral<br/>
&#160; &#160; &#160; &#160; objectClass: extensibleObject<br/>
&#160; &#160; &#160; &#160; dc: subtree<br/>
&#160; &#160; &#160; &#160; ref: ldap://b.example.net/dc=subtree,dc=example,dc=net<br/>
The server uses this information to generate referrals and search continuations to subordinate servers.<br/>
For those familiar with X.500, a<i>&#160;named referral</i>&#160;object is similar to an X.500 knowledge reference held in a<br/><i>subr</i>&#160;DSE.<br/>
<b>17.2. Superior Knowledge Information</b><br/>
Superior knowledge information may be specified using the&#160;referral&#160;directive. The value is a list of URIs<br/>referring to superior directory services. For servers without immediate superiors, such as for<br/>a.example.net&#160;in the example above, the server can be configured to use a directory service with<i>&#160;global<br/>knowledge</i>, such as the<i>&#160;OpenLDAP Root Service</i><a href="http://www.openldap.org/faq/index.cgi?file=393">&#160;(http://www.openldap.org/faq/index.cgi?file=393).</a><br/>
&#160; &#160; &#160; &#160; referral &#160; &#160; &#160; &#160;ldap://root.openldap.org/<br/>
However, as&#160;a.example.net&#160;is the<i>&#160;immediate superior</i>&#160;to&#160;b.example.net,<i>&#160;b.example.net</i>&#160;would be<br/>configured as follows:<br/>
&#160; &#160; &#160; &#160; referral &#160; &#160; &#160; &#160;ldap://a.example.net/<br/>
161<br/>
<hr/>
<a name=176></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
The server uses this information to generate referrals for operations acting upon entries not within or<br/>subordinate to any of the naming contexts held by the server.<br/>
For those familiar with X.500, this use of the&#160;ref&#160;attribute is similar to an X.500 knowledge reference held in<br/>a<i>&#160;Supr</i>&#160;DSE.<br/>
<b>17.3. The ManageDsaIT Control</b><br/>
Adding, modifying, and deleting referral objects is generally done using<i>&#160;ldapmodify</i>(1) or similar tools which<br/>support the ManageDsaIT control. The ManageDsaIT control informs the server that you intend to manage the<br/>referral object as a regular entry. This keeps the server from sending a referral result for requests which<br/>interrogate or update referral objects.<br/>
The ManageDsaIT control should not be specified when managing regular entries.<br/>
The&#160;-M&#160;option of<i>&#160;ldapmodify</i>(1) (and other tools) enables ManageDsaIT. For example:<br/>
&#160; &#160; &#160; &#160; ldapmodify -M -f referral.ldif -x -D &#34;cn=Manager,dc=example,dc=net&#34; -W<br/>
or with<i>&#160;ldapsearch</i>(1):<br/>
&#160; &#160; &#160; &#160; ldapsearch -M -b &#34;dc=example,dc=net&#34; -x &#34;(objectclass=referral)&#34; '*' ref<br/>
<b>Note:</b>&#160;the&#160;ref&#160;attribute is operational and must be explicitly requested when desired in search results.<br/>
<b>Note:</b>&#160;the use of referrals to construct a Distributed Directory Service is extremely clumsy and not well<br/>supported by common clients. If an existing installation has already been built using referrals, the use of the<br/><i>chain</i>&#160;overlay to hide the referrals will greatly improve the usability of the Directory system. A better<br/>approach would be to use explicitly defined local and proxy databases in<i>&#160;subordinate</i>&#160;configurations to<br/>provide a seamless view of the Distributed Directory.<br/>
<b>Note:</b>&#160;LDAP operations, even subtree searches, normally access only one database. That can be changed by<br/>gluing databases together with the<b>&#160;subordinate</b>/<b>olcSubordinate</b>&#160;keyword. Please see<i>&#160;slapd.conf</i>(5) and<br/><i>slapd-config</i>(5).<br/>
162<br/>
<hr/>
<a name=177></a><b>18. Replication</b><br/>
Replicated directories are a fundamental requirement for delivering a resilient enterprise deployment.<br/>
<a href="http://www.openldap.org/">OpenLDAP has various configuration options for creating a replicated directory. In previous releases,<br/></a>replication was discussed in terms of a<i>&#160;master</i>&#160;server and some number of<i>&#160;slave</i>&#160;servers. A master accepted<br/>directory updates from other clients, and a slave only accepted updates from a (single) master. The replication<br/>structure was rigidly defined and any particular database could only fulfill a single role, either master or slave.<br/>
As OpenLDAP now supports a wide variety of replication topologies, these terms have been deprecated in<br/>favor of<i>&#160;provider</i>&#160;and<i>&#160;consumer</i>: A provider replicates directory updates to consumers; consumers receive<br/>replication updates from providers. Unlike the rigidly defined master/slave relationships, provider/consumer<br/>roles are quite fluid: replication updates received in a consumer can be further propagated by that consumer to<br/>other servers, so a consumer can also act simultaneously as a provider. Also, a consumer need not be an actual<br/>LDAP server; it may be just an LDAP client.<br/>
The following sections will describe the replication technology and discuss the various replication options that<br/>are available.<br/>
<b>18.1. Replication Technology</b><br/>
<b>18.1.1. LDAP Sync Replication</b><br/>
The LDAP Sync Replication engine, syncrepl for short, is a consumer-side replication engine that enables the<br/>consumer LDAP server to maintain a shadow copy of a DIT fragment. A syncrepl engine resides at the<br/>consumer and executes as one of the<i>&#160;slapd</i>(8) threads. It creates and maintains a consumer replica by<br/>connecting to the replication provider to perform the initial DIT content load followed either by periodic<br/>content polling or by timely updates upon content changes.<br/>
Syncrepl uses the LDAP Content Synchronization protocol (or LDAP Sync for short) as the replica<br/>synchronization protocol. LDAP Sync provides a stateful replication which supports both pull-based and<br/>push-based synchronization and does not mandate the use of a history store. In pull-based replication the<br/>consumer periodically polls the provider for updates. In push-based replication the consumer listens for<br/>updates that are sent by the provider in realtime. Since the protocol does not require a history store, the<br/>provider does not need to maintain any log of updates it has received (Note that the syncrepl engine is<br/>extensible and additional replication protocols may be supported in the future.).<br/>
Syncrepl keeps track of the status of the replication content by maintaining and exchanging synchronization<br/>cookies. Because the syncrepl consumer and provider maintain their content status, the consumer can poll the<br/>provider content to perform incremental synchronization by asking for the entries required to make the<br/>consumer replica up-to-date with the provider content. Syncrepl also enables convenient management of<br/>replicas by maintaining replica status. The consumer replica can be constructed from a consumer-side or a<br/>provider-side backup at any synchronization status. Syncrepl can automatically resynchronize the consumer<br/>replica up-to-date with the current provider content.<br/>
Syncrepl supports both pull-based and push-based synchronization. In its basic refreshOnly synchronization<br/>mode, the provider uses pull-based synchronization where the consumer servers need not be tracked and no<br/>history information is maintained. The information required for the provider to process periodic polling<br/>requests is contained in the synchronization cookie of the request itself. To optimize the pull-based<br/>
163<br/>
<hr/>
<a name=178></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
synchronization, syncrepl utilizes the present phase of the LDAP Sync protocol as well as its delete phase,<br/>instead of falling back on frequent full reloads. To further optimize the pull-based synchronization, the<br/>provider can maintain a per-scope session log as a history store. In its refreshAndPersist mode of<br/>synchronization, the provider uses a push-based synchronization. The provider keeps track of the consumer<br/>servers that have requested a persistent search and sends them necessary updates as the provider replication<br/>content gets modified.<br/>
With syncrepl, a consumer server can create a replica without changing the provider's configurations and<br/>without restarting the provider server, if the consumer server has appropriate access privileges for the DIT<br/>fragment to be replicated. The consumer server can stop the replication also without the need for provider-side<br/>changes and restart.<br/>
Syncrepl supports partial, sparse, and fractional replications. The shadow DIT fragment is defined by a<br/>general search criteria consisting of base, scope, filter, and attribute list. The replica content is also subject to<br/>the access privileges of the bind identity of the syncrepl replication connection.<br/>
<b>18.1.1.1. The LDAP Content Synchronization Protocol</b><br/>
The LDAP Sync protocol allows a client to maintain a synchronized copy of a DIT fragment. The LDAP Sync<br/>operation is defined as a set of controls and other protocol elements which extend the LDAP search operation.<br/>This section introduces the LDAP Content Sync protocol only briefly. For more information, refer to<br/><a href="http://www.rfc-editor.org/rfc/rfc4533.txt">RFC4533.</a><br/>
The LDAP Sync protocol supports both polling and listening for changes by defining two respective<br/>synchronization operations:<i>&#160;refreshOnly</i>&#160;and<i>&#160;refreshAndPersist</i>. Polling is implemented by the<i>&#160;refreshOnly<br/></i>operation. The consumer polls the provider using an LDAP Search request with an LDAP Sync control<br/>attached. The consumer copy is synchronized to the provider copy at the time of polling using the information<br/>returned in the search. The provider finishes the search operation by returning<i>&#160;SearchResultDone</i>&#160;at the end of<br/>the search operation as in the normal search. Listening is implemented by the<i>&#160;refreshAndPersist</i>&#160;operation. As<br/>the name implies, it begins with a search, like refreshOnly. Instead of finishing the search after returning all<br/>entries currently matching the search criteria, the synchronization search remains persistent in the provider.<br/>Subsequent updates to the synchronization content in the provider cause additional entry updates to be sent to<br/>the consumer.<br/>
The<i>&#160;refreshOnly</i>&#160;operation and the refresh stage of the<i>&#160;refreshAndPersist</i>&#160;operation can be performed with a<br/>present phase or a delete phase.<br/>
In the present phase, the provider sends the consumer the entries updated within the search scope since the last<br/>synchronization. The provider sends all requested attributes, be they changed or not, of the updated entries.<br/>For each unchanged entry which remains in the scope, the provider sends a present message consisting only of<br/>the name of the entry and the synchronization control representing state present. The present message does not<br/>contain any attributes of the entry. After the consumer receives all update and present entries, it can reliably<br/>determine the new consumer copy by adding the entries added to the provider, by replacing the entries<br/>modified at the provider, and by deleting entries in the consumer copy which have not been updated nor<br/>specified as being present at the provider.<br/>
The transmission of the updated entries in the delete phase is the same as in the present phase. The provider<br/>sends all the requested attributes of the entries updated within the search scope since the last synchronization<br/>to the consumer. In the delete phase, however, the provider sends a delete message for each entry deleted from<br/>the search scope, instead of sending present messages. The delete message consists only of the name of the<br/>entry and the synchronization control representing state delete. The new consumer copy can be determined by<br/>
164<br/>
<hr/>
<a name=179></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
adding, modifying, and removing entries according to the synchronization control attached to the<br/><i>SearchResultEntry</i>&#160;message.<br/>
In the case that the LDAP Sync provider maintains a history store and can determine which entries are scoped<br/>out of the consumer copy since the last synchronization time, the provider can use the delete phase. If the<br/>provider does not maintain any history store, cannot determine the scoped-out entries from the history store,<br/>or the history store does not cover the outdated synchronization state of the consumer, the provider should use<br/>the present phase. The use of the present phase is much more efficient than a full content reload in terms of<br/>the synchronization traffic. To reduce the synchronization traffic further, the LDAP Sync protocol also<br/>provides several optimizations such as the transmission of the normalized&#160;entryUUIDs and the transmission<br/>of multiple&#160;entryUUIDs&#160;in a single<i>&#160;syncIdSet</i>&#160;message.<br/>
At the end of the<i>&#160;refreshOnly</i>&#160;synchronization, the provider sends a synchronization cookie to the consumer as<br/>a state indicator of the consumer copy after the synchronization is completed. The consumer will present the<br/>received cookie when it requests the next incremental synchronization to the provider.<br/>
When<i>&#160;refreshAndPersist</i>&#160;synchronization is used, the provider sends a synchronization cookie at the end of the<br/>refresh stage by sending a Sync Info message with refreshDone=TRUE. It also sends a synchronization<br/>cookie by attaching it to<i>&#160;SearchResultEntry</i>&#160;messages generated in the persist stage of the synchronization<br/>search. During the persist stage, the provider can also send a Sync Info message containing the<br/>synchronization cookie at any time the provider wants to update the consumer-side state indicator.<br/>
In the LDAP Sync protocol, entries are uniquely identified by the&#160;entryUUID&#160;attribute value. It can function<br/>as a reliable identifier of the entry. The DN of the entry, on the other hand, can be changed over time and<br/>hence cannot be considered as the reliable identifier. The&#160;entryUUID&#160;is attached to each<i>&#160;SearchResultEntry<br/></i>or<i>&#160;SearchResultReference</i>&#160;as a part of the synchronization control.<br/>
<b>18.1.1.2. Syncrepl Details</b><br/>
The syncrepl engine utilizes both the<i>&#160;refreshOnly</i>&#160;and the<i>&#160;refreshAndPersist</i>&#160;operations of the LDAP Sync<br/>protocol. If a syncrepl specification is included in a database definition,<i>&#160;slapd</i>(8) launches a syncrepl engine as<br/>a<i>&#160;slapd</i>(8) thread and schedules its execution. If the<i>&#160;refreshOnly</i>&#160;operation is specified, the syncrepl engine<br/>will be rescheduled at the interval time after a synchronization operation is completed. If the<br/><i>refreshAndPersist</i>&#160;operation is specified, the engine will remain active and process the persistent<br/>synchronization messages from the provider.<br/>
The syncrepl engine utilizes both the present phase and the delete phase of the refresh synchronization. It is<br/>possible to configure a session log in the provider which stores the&#160;entryUUIDs of a finite number of entries<br/>deleted from a database. Multiple replicas share the same session log. The syncrepl engine uses the delete<br/>phase if the session log is present and the state of the consumer server is recent enough that no session log<br/>entries are truncated after the last synchronization of the client. The syncrepl engine uses the present phase if<br/>no session log is configured for the replication content or if the consumer replica is too outdated to be covered<br/>by the session log. The current design of the session log store is memory based, so the information contained<br/>in the session log is not persistent over multiple provider invocations. It is not currently supported to access<br/>the session log store by using LDAP operations. It is also not currently supported to impose access control to<br/>the session log.<br/>
As a further optimization, even in the case the synchronization search is not associated with any session log,<br/>no entries will be transmitted to the consumer server when there has been no update in the replication context.<br/>
165<br/>
<hr/>
<a name=180></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
The syncrepl engine, which is a consumer-side replication engine, can work with any backends. The LDAP<br/>Sync provider can be configured as an overlay on any backend, but works best with the<i>&#160;back-bdb</i>&#160;or<i>&#160;back-hdb<br/></i>backend.<br/>
The LDAP Sync provider maintains a&#160;contextCSN&#160;for each database as the current synchronization state<br/>indicator of the provider content. It is the largest&#160;entryCSN&#160;in the provider context such that no transactions<br/>for an entry having smaller&#160;entryCSN&#160;value remains outstanding. The&#160;contextCSN&#160;could not just be set to<br/>the largest issued&#160;entryCSN&#160;because&#160;entryCSN&#160;is obtained before a transaction starts and transactions are<br/>not committed in the issue order.<br/>
The provider stores the&#160;contextCSN&#160;of a context in the&#160;contextCSN&#160;attribute of the context suffix entry.<br/>The attribute is not written to the database after every update operation though; instead it is maintained<br/>primarily in memory. At database start time the provider reads the last saved&#160;contextCSN&#160;into memory and<br/>uses the in-memory copy exclusively thereafter. By default, changes to the&#160;contextCSN&#160;as a result of<br/>database updates will not be written to the database until the server is cleanly shut down. A checkpoint facility<br/>exists to cause the&#160;contextCSN&#160;to be written out more frequently if desired.<br/>
Note that at startup time, if the provider is unable to read a&#160;contextCSN&#160;from the suffix entry, it will scan<br/>the entire database to determine the value, and this scan may take quite a long time on a large database. When<br/>a&#160;contextCSN&#160;value is read, the database will still be scanned for any&#160;entryCSN&#160;values greater than it, to<br/>make sure the&#160;contextCSN&#160;value truly reflects the greatest committed&#160;entryCSN&#160;in the database. On<br/>databases which support inequality indexing, setting an eq index on the&#160;entryCSN&#160;attribute and configuring<br/><i>contextCSN</i>&#160;checkpoints will greatly speed up this scanning step.<br/>
If no&#160;contextCSN&#160;can be determined by reading and scanning the database, a new value will be generated.<br/>Also, if scanning the database yielded a greater&#160;entryCSN&#160;than was previously recorded in the suffix entry's<br/>contextCSN&#160;attribute, a checkpoint will be immediately written with the new value.<br/>
The consumer also stores its replica state, which is the provider's&#160;contextCSN&#160;received as a synchronization<br/>cookie, in the&#160;contextCSN&#160;attribute of the suffix entry. The replica state maintained by a consumer server is<br/>used as the synchronization state indicator when it performs subsequent incremental synchronization with the<br/>provider server. It is also used as a provider-side synchronization state indicator when it functions as a<br/>secondary provider server in a cascading replication configuration. Since the consumer and provider state<br/>information are maintained in the same location within their respective databases, any consumer can be<br/>promoted to a provider (and vice versa) without any special actions.<br/>
Because a general search filter can be used in the syncrepl specification, some entries in the context may be<br/>omitted from the synchronization content. The syncrepl engine creates a glue entry to fill in the holes in the<br/>replica context if any part of the replica content is subordinate to the holes. The glue entries will not be<br/>returned in the search result unless<i>&#160;ManageDsaIT</i>&#160;control is provided.<br/>
Also as a consequence of the search filter used in the syncrepl specification, it is possible for a modification to<br/>remove an entry from the replication scope even though the entry has not been deleted on the provider.<br/>Logically the entry must be deleted on the consumer but in<i>&#160;refreshOnly</i>&#160;mode the provider cannot detect and<br/>propagate this change without the use of the session log on the provider.<br/>
<a href="OpenLDAP-Admin-Guides.html#184">For configuration, please see the Syncrepl section.</a><br/>
166<br/>
<hr/>
<a name=181></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
<b>18.2. Deployment Alternatives</b><br/>
While the LDAP Sync specification only defines a narrow scope for replication, the OpenLDAP<br/>implementation is extremely flexible and supports a variety of operating modes to handle other scenarios not<br/>explicitly addressed in the spec.<br/>
<b>18.2.1. Delta-syncrepl replication</b><br/>
Disadvantages of LDAP Sync replication:<br/>
&#160;<br/>
LDAP Sync replication is an object-based replication mechanism. When any attribute value in a replicated<br/>object is changed on the provider, each consumer fetches and processes the complete changed object,<br/>including<b>&#160;both the changed and unchanged attribute values</b>&#160;during replication. One advantage of this<br/>approach is that when multiple changes occur to a single object, the precise sequence of those changes need<br/>not be preserved; only the final state of the entry is significant. But this approach may have drawbacks when<br/>the usage pattern involves single changes to multiple objects.<br/>
For example, suppose you have a database consisting of 102,400 objects of 1 KB each. Further, suppose you<br/>routinely run a batch job to change the value of a single two-byte attribute value that appears in each of the<br/>102,400 objects on the master. Not counting LDAP and TCP/IP protocol overhead, each time you run this job<br/>each consumer will transfer and process<b>&#160;100 MB</b>&#160;of data to process<b>&#160;200KB of changes!</b><br/>
99.98% of the data that is transmitted and processed in a case like this will be redundant, since it represents<br/>values that did not change. This is a waste of valuable transmission and processing bandwidth and can cause<br/>an unacceptable replication backlog to develop. While this situation is extreme, it serves to demonstrate a very<br/>real problem that is encountered in some LDAP deployments.<br/>
Where Delta-syncrepl comes in:<br/>
&#160;<br/>
Delta-syncrepl, a changelog-based variant of syncrepl, is designed to address situations like the one described<br/>above. Delta-syncrepl works by maintaining a changelog of a selectable depth in a separate database on the<br/>provider. The replication consumer checks the changelog for the changes it needs and, as long as the<br/>changelog contains the needed changes, the consumer fetches the changes from the changelog and applies<br/>them to its database. If, however, a replica is too far out of sync (or completely empty), conventional syncrepl<br/>is used to bring it up to date and replication then switches back to the delta-syncrepl mode.<br/>
<b>Note:</b>&#160;since the database state is stored in both the changelog DB and the main DB on the provider, it is<br/>important to backup/restore both the changelog DB and the main DB using slapcat/slapadd when restoring a<br/>DB or copying it to another machine.<br/>
<a href="OpenLDAP-Admin-Guides.html#186">For configuration, please see the Delta-syncrepl section.</a><br/>
<b>18.2.2. N-Way Multi-Master replication</b><br/>
Multi-Master replication is a replication technique using Syncrepl to replicate data to multiple provider<br/>(&#34;Master&#34;) Directory servers.<br/>
167<br/>
<hr/>
<a name=182></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
<b>18.2.2.1. Valid Arguments for Multi-Master replication</b><br/>
If any provider fails, other providers will continue to accept updates<br/>
&#160;<br/>
Avoids a single point of failure<br/>
&#160;<br/>
Providers can be located in several physical sites i.e. distributed across the network/globe.<br/>
&#160;<br/>
Good for Automatic failover/High Availability<br/>
&#160;<br/>
<b>18.2.2.2. Invalid Arguments for Multi-Master replication</b><br/>
(These are often claimed to be advantages of Multi-Master replication but those claims are false):<br/>
It has<br/>
&#160;<br/>
<b>&#160;NOTHING</b>&#160;to do with load balancing<br/>
Providers<br/>
&#160;<br/>
<b>&#160;must</b>&#160;propagate writes to<b>&#160;all</b>&#160;the other servers, which means the network traffic and write<br/>
load spreads across all of the servers the same as for single-master.<br/>Server utilization and performance are at best identical for Multi-Master and Single-Master<br/>
&#160;<br/>
replication; at worst Single-Master is superior because indexing can be tuned differently to optimize<br/>for the different usage patterns between the provider and the consumers.<br/>
<b>18.2.2.3. Arguments against Multi-Master replication</b><br/>
Breaks the data consistency guarantees of the directory model<br/>
&#160;<br/>
<a href="http://www.openldap.org/faq/data/cache/1240.html">http://www.openldap.org/faq/data/cache/1240.html</a><br/>
&#160;<br/>
If connectivity with a provider is lost because of a network partition, then &#34;automatic failover&#34; can<br/>
&#160;<br/>
just compound the problem<br/>Typically, a particular machine cannot distinguish between losing contact with a peer because that<br/>
&#160;<br/>
peer crashed, or because the network link has failed<br/>If a network is partitioned and multiple clients start writing to each of the &#34;masters&#34; then<br/>
&#160;<br/>
reconciliation will be a pain; it may be best to simply deny writes to the clients that are partitioned<br/>from the single provider<br/>
<a href="OpenLDAP-Admin-Guides.html#188">For configuration, please see the N-Way Multi-Master section below</a><br/>
<b>18.2.3. MirrorMode replication</b><br/>
MirrorMode is a hybrid configuration that provides all of the consistency guarantees of single-master<br/>replication, while also providing the high availability of multi-master. In MirrorMode two providers are set up<br/>to replicate from each other (as a multi-master configuration), but an external frontend is employed to direct<br/>all writes to only one of the two servers. The second provider will only be used for writes if the first provider<br/>crashes, at which point the frontend will switch to directing all writes to the second provider. When a crashed<br/>provider is repaired and restarted it will automatically catch up to any changes on the running provider and<br/>resync.<br/>
<b>18.2.3.1. Arguments for MirrorMode</b><br/>
Provides a high-availability (HA) solution for directory writes (replicas handle reads)<br/>
&#160;<br/>
As long as one provider is operational, writes can safely be accepted<br/>
&#160;<br/>
Provider nodes replicate from each other, so they are always up to date and can be ready to take over<br/>
&#160;<br/>
(hot standby)<br/>Syncrepl also allows the provider nodes to re-synchronize after any downtime<br/>
&#160;<br/>
168<br/>
<hr/>
<a name=183></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
<b>18.2.3.2. Arguments against MirrorMode</b><br/>
MirrorMode is not what is termed as a Multi-Master solution. This is because writes have to go to just<br/>
&#160;<br/>
one of the mirror nodes at a time<br/>MirrorMode can be termed as Active-Active Hot-Standby, therefore an external server (slapd in proxy<br/>
&#160;<br/>
mode) or device (hardware load balancer) is needed to manage which provider is currently active<br/>Backups are managed slightly differently<br/>
&#160;<br/>
If backing up the Berkeley database itself and periodically backing up the transaction log<br/>
&#160;<br/>
files, then the same member of the mirror pair needs to be used to collect logfiles until the<br/>next database backup is taken<br/>
<a href="OpenLDAP-Admin-Guides.html#189">For configuration, please see the MirrorMode section below</a><br/>
<b>18.2.4. Syncrepl Proxy Mode</b><br/>
While the LDAP Sync protocol supports both pull- and push-based replication, the push mode<br/>(refreshAndPersist) must still be initiated from the consumer before the provider can begin pushing changes.<br/>In some network configurations, particularly where firewalls restrict the direction in which connections can be<br/>made, a provider-initiated push mode may be needed.<br/>
<a href="OpenLDAP-Admin-Guides.html#204">This mode can be configured with the aid of the LDAP Backend (Backends and</a><i>&#160;slapd-ldap(8)</i>). Instead of<br/>running the syncrepl engine on the actual consumer, a slapd-ldap proxy is set up near (or collocated with) the<br/>provider that points to the consumer, and the syncrepl engine runs on the proxy.<br/>
<a href="OpenLDAP-Admin-Guides.html#191">For configuration, please see the Syncrepl Proxy section.</a><br/>
<b>18.2.4.1. Replacing Slurpd</b><br/>
The old<i>&#160;slurpd</i>&#160;mechanism only operated in provider-initiated push mode. Slurpd replication was deprecated<br/>in favor of Syncrepl replication and has been completely removed from OpenLDAP 2.4.<br/>
The slurpd daemon was the original replication mechanism inherited from UMich's LDAP and operated in<br/>push mode: the master pushed changes to the slaves. It was replaced for many reasons, in brief:<br/>
It was not reliable<br/>
&#160;<br/>
It was extremely sensitive to the ordering of records in the replog<br/>
&#160;<br/>
It could easily go out of sync, at which point manual intervention was required to resync the<br/>
&#160;<br/>
slave database with the master directory<br/>It wasn't very tolerant of unavailable servers. If a slave went down for a long time, the replog<br/>
&#160;<br/>
could grow to a size that was too large for slurpd to process<br/>
It only worked in push mode<br/>
&#160;<br/>
It required stopping and restarting the master to add new slaves<br/>
&#160;<br/>
It only supported single master replication<br/>
&#160;<br/>
Syncrepl has none of those weaknesses:<br/>
Syncrepl is self-synchronizing; you can start with a consumer database in any state from totally empty<br/>
&#160;<br/>
to fully synced and it will automatically do the right thing to achieve and maintain synchronization<br/>
It is completely insensitive to the order in which changes occur<br/>
&#160;<br/>
It guarantees convergence between the consumer and the provider content without manual<br/>
&#160;<br/>
intervention<br/>
169<br/>
<hr/>
<a name=184></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
It can resynchronize regardless of how long a consumer stays out of contact with the provider<br/>
&#160;<br/>
Syncrepl can operate in either direction<br/>
&#160;<br/>
Consumers can be added at any time without touching anything on the provider<br/>
&#160;<br/>
Multi-master replication is supported<br/>
&#160;<br/>
<b>18.3. Configuring the different replication types</b><br/>
<b>18.3.1. Syncrepl</b><br/>
<b>18.3.1.1. Syncrepl configuration</b><br/>
Because syncrepl is a consumer-side replication engine, the syncrepl specification is defined in<i>&#160;slapd.conf</i>(5)<br/>of the consumer server, not in the provider server's configuration file. The initial loading of the replica content<br/>can be performed either by starting the syncrepl engine with no synchronization cookie or by populating the<br/>consumer replica by loading an LDIF file dumped as a backup at the provider.<br/>
When loading from a backup, it is not required to perform the initial loading from the up-to-date backup of the<br/>provider content. The syncrepl engine will automatically synchronize the initial consumer replica to the<br/>current provider content. As a result, it is not required to stop the provider server in order to avoid the replica<br/>inconsistency caused by the updates to the provider content during the content backup and loading process.<br/>
When replicating a large scale directory, especially in a bandwidth constrained environment, it is advised to<br/>load the consumer replica from a backup instead of performing a full initial load using syncrepl.<br/>
<b>18.3.1.2. Set up the provider slapd</b><br/>
The provider is implemented as an overlay, so the overlay itself must first be configured in<i>&#160;slapd.conf</i>(5)<br/>before it can be used. The provider has only two configuration directives, for setting checkpoints on the<br/>contextCSN&#160;and for configuring the session log. Because the LDAP Sync search is subject to access<br/>control, proper access control privileges should be set up for the replicated content.<br/>
The&#160;contextCSN&#160;checkpoint is configured by the<br/>
&#160; &#160; &#160; &#160; syncprov-checkpoint &lt;ops&gt; &lt;minutes&gt;<br/>
directive. Checkpoints are only tested after successful write operations. If<i>&#160;&lt;ops&gt;</i>&#160;operations or more than<br/><i>&lt;minutes&gt;</i>&#160;time has passed since the last checkpoint, a new checkpoint is performed.<br/>
The session log is configured by the<br/>
&#160; &#160; &#160; &#160; syncprov-sessionlog &lt;size&gt;<br/>
directive, where<i>&#160;&lt;size&gt;</i>&#160;is the maximum number of session log entries the session log can record. When a<br/>session log is configured, it is automatically used for all LDAP Sync searches within the database.<br/>
Note that using the session log requires searching on the<i>&#160;entryUUID</i>&#160;attribute. Setting an eq index on this<br/>attribute will greatly benefit the performance of the session log on the provider.<br/>
A more complete example of the<i>&#160;slapd.conf</i>(5) content is thus:<br/>
&#160; &#160; &#160; &#160; database bdb<br/>
170<br/>
<hr/>
<a name=185></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
&#160; &#160; &#160; &#160; suffix dc=Example,dc=com<br/>
&#160; &#160; &#160; &#160; rootdn dc=Example,dc=com<br/>
&#160; &#160; &#160; &#160; directory /var/ldap/db<br/>
&#160; &#160; &#160; &#160; index objectclass,entryCSN,entryUUID eq<br/>
&#160; &#160; &#160; &#160; overlay syncprov<br/>
&#160; &#160; &#160; &#160; syncprov-checkpoint 100 10<br/>
&#160; &#160; &#160; &#160; syncprov-sessionlog 100<br/>
<b>18.3.1.3. Set up the consumer slapd</b><br/>
The syncrepl replication is specified in the database section of<i>&#160;slapd.conf</i>(5) for the replica context. The<br/>syncrepl engine is backend independent and the directive can be defined with any database type.<br/>
&#160; &#160; &#160; &#160; database hdb<br/>
&#160; &#160; &#160; &#160; suffix dc=Example,dc=com<br/>
&#160; &#160; &#160; &#160; rootdn dc=Example,dc=com<br/>
&#160; &#160; &#160; &#160; directory /var/ldap/db<br/>
&#160; &#160; &#160; &#160; index objectclass,entryCSN,entryUUID eq<br/>
&#160; &#160; &#160; &#160; syncrepl rid=123<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; provider=ldap://provider.example.com:389<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; type=refreshOnly<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; interval=01:00:00:00<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; searchbase=&#34;dc=example,dc=com&#34;<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; filter=&#34;(objectClass=organizationalPerson)&#34;<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; scope=sub<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; attrs=&#34;cn,sn,ou,telephoneNumber,title,l&#34;<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; schemachecking=off<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; bindmethod=simple<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; binddn=&#34;cn=syncuser,dc=example,dc=com&#34;<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; credentials=secret<br/>
In this example, the consumer will connect to the provider<i>&#160;slapd</i>(8) at port 389 of<br/><a href="">ldap://provider.example.com to perform a polling (</a><i>refreshOnly</i>) mode of synchronization once a day. It will<br/>bind as&#160;cn=syncuser,dc=example,dc=com&#160;using simple authentication with password &#34;secret&#34;. Note<br/>that the access control privilege of&#160;cn=syncuser,dc=example,dc=com&#160;should be set appropriately in<br/>the provider to retrieve the desired replication content. Also the search limits must be high enough on the<br/>provider to allow the syncuser to retrieve a complete copy of the requested content. The consumer uses the<br/>rootdn to write to its database so it always has full permissions to write all content.<br/>
The synchronization search in the above example will search for the entries whose objectClass is<br/>organizationalPerson in the entire subtree rooted at&#160;dc=example,dc=com. The requested attributes are&#160;cn,<br/>sn,&#160;ou,&#160;telephoneNumber,&#160;title, and&#160;l. The schema checking is turned off, so that the consumer<br/><i>slapd</i>(8) will not enforce entry schema checking when it processes updates from the provider<i>&#160;slapd</i>(8).<br/>
<a href="OpenLDAP-Admin-Guides.html#184">For more detailed information on the syncrepl directive, see the syncrepl section of The slapd Configuration<br/></a><a href="OpenLDAP-Admin-Guides.html#57">File chapter of this admin guide.</a><br/>
<b>18.3.1.4. Start the provider and the consumer slapd</b><br/>
The provider<i>&#160;slapd</i>(8) is not required to be restarted.<i>&#160;contextCSN</i>&#160;is automatically generated as needed: it<br/>might be originally contained in the LDIF file, generated by<i>&#160;slapadd</i>&#160;(8), generated upon changes in the<br/>context, or generated when the first LDAP Sync search arrives at the provider. If an LDIF file is being loaded<br/>which did not previously contain the<i>&#160;contextCSN</i>, the<i>&#160;-w</i>&#160;option should be used with<i>&#160;slapadd</i>&#160;(8) to cause it to<br/>
171<br/>
<hr/>
<a name=186></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
be generated. This will allow the server to startup a little quicker the first time it runs.<br/>
When starting a consumer<i>&#160;slapd</i>(8), it is possible to provide a synchronization cookie as the<i>&#160;-c cookie<br/></i>command line option in order to start the synchronization from a specific state. The cookie is a comma<br/>separated list of name=value pairs. Currently supported syncrepl cookie fields are<i>&#160;csn=&lt;csn&gt;</i>&#160;and<i>&#160;rid=&lt;rid&gt;</i>.<br/><i>&lt;csn&gt;</i>&#160;represents the current synchronization state of the consumer replica.<i>&#160;&lt;rid&gt;</i>&#160;identifies a consumer<br/>replica locally within the consumer server. It is used to relate the cookie to the syncrepl definition in<br/><i>slapd.conf</i>(5) which has the matching replica identifier. The<i>&#160;&lt;rid&gt;</i>&#160;must have no more than 3 decimal digits.<br/>The command line cookie overrides the synchronization cookie stored in the consumer replica database.<br/>
<b>18.3.2. Delta-syncrepl</b><br/>
<b>18.3.2.1. Delta-syncrepl Provider configuration</b><br/>
Setting up delta-syncrepl requires configuration changes on both the master and replica servers:<br/>
&#160; &#160; &#160;# Give the replica DN unlimited read access. &#160;This ACL needs to be<br/>
&#160; &#160; &#160;# merged with other ACL statements, and/or moved within the scope<br/>
&#160; &#160; &#160;# of a database. &#160;The &#34;by * break&#34; portion causes evaluation of<br/>
&#160; &#160; &#160;# subsequent rules. &#160;See slapd.access(5) for details.<br/>
&#160; &#160; &#160;access to *<br/>
&#160; &#160; &#160; &#160; by dn.base=&#34;cn=replicator,dc=symas,dc=com&#34; read<br/>
&#160; &#160; &#160; &#160; by * break<br/>
&#160; &#160; &#160;# Set the module path location<br/>
&#160; &#160; &#160;modulepath /opt/symas/lib/openldap<br/>
&#160; &#160; &#160;# Load the hdb backend<br/>
&#160; &#160; &#160;moduleload back_hdb.la<br/>
&#160; &#160; &#160;# Load the accesslog overlay<br/>
&#160; &#160; &#160;moduleload accesslog.la<br/>
&#160; &#160; &#160;#Load the syncprov overlay<br/>
&#160; &#160; &#160;moduleload syncprov.la<br/>
&#160; &#160; &#160;# Accesslog database definitions<br/>
&#160; &#160; &#160;database hdb<br/>
&#160; &#160; &#160;suffix cn=accesslog<br/>
&#160; &#160; &#160;directory /db/accesslog<br/>
&#160; &#160; &#160;rootdn cn=accesslog<br/>
&#160; &#160; &#160;index default eq<br/>
&#160; &#160; &#160;index entryCSN,objectClass,reqEnd,reqResult,reqStart<br/>
&#160; &#160; &#160;overlay syncprov<br/>
&#160; &#160; &#160;syncprov-nopresent TRUE<br/>
&#160; &#160; &#160;syncprov-reloadhint TRUE<br/>
&#160; &#160; &#160;# Let the replica DN have limitless searches<br/>
&#160; &#160; &#160;limits dn.exact=&#34;cn=replicator,dc=symas,dc=com&#34; time.soft=unlimited time.hard=unlimited size.soft=unlimited size.hard=unlimited<br/>
&#160; &#160; &#160;# Primary database definitions<br/>
&#160; &#160; &#160;database hdb<br/>
&#160; &#160; &#160;suffix &#34;dc=symas,dc=com&#34;<br/>
&#160; &#160; &#160;rootdn &#34;cn=manager,dc=symas,dc=com&#34;<br/>
&#160; &#160; &#160;## Whatever other configuration options are desired<br/>
172<br/>
<hr/>
<a name=187></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
&#160; &#160; &#160;# syncprov specific indexing<br/>
&#160; &#160; &#160;index entryCSN eq<br/>
&#160; &#160; &#160;index entryUUID eq<br/>
&#160; &#160; &#160;# syncrepl Provider for primary db<br/>
&#160; &#160; &#160;overlay syncprov<br/>
&#160; &#160; &#160;syncprov-checkpoint 1000 60<br/>
&#160; &#160; &#160;# accesslog overlay definitions for primary db<br/>
&#160; &#160; &#160;overlay accesslog<br/>
&#160; &#160; &#160;logdb cn=accesslog<br/>
&#160; &#160; &#160;logops writes<br/>
&#160; &#160; &#160;logsuccess TRUE<br/>
&#160; &#160; &#160;# scan the accesslog DB every day, and purge entries older than 7 days<br/>
&#160; &#160; &#160;logpurge 07+00:00 01+00:00<br/>
&#160; &#160; &#160;# Let the replica DN have limitless searches<br/>
&#160; &#160; &#160;limits dn.exact=&#34;cn=replicator,dc=symas,dc=com&#34; time.soft=unlimited time.hard=unlimited size.soft=unlimited size.hard=unlimited<br/>
For more information, always consult the relevant man pages (<i>slapo-accesslog</i>(5) and<i>&#160;slapd.conf</i>(5))<br/>
<b>18.3.2.2. Delta-syncrepl Consumer configuration</b><br/>
&#160; &#160; &#160;# Replica database configuration<br/>
&#160; &#160; &#160;database hdb<br/>
&#160; &#160; &#160;suffix &#34;dc=symas,dc=com&#34;<br/>
&#160; &#160; &#160;rootdn &#34;cn=manager,dc=symas,dc=com&#34;<br/>
&#160; &#160; &#160;## Whatever other configuration bits for the replica, like indexing<br/>
&#160; &#160; &#160;## that you want<br/>
&#160; &#160; &#160;# syncrepl specific indices<br/>
&#160; &#160; &#160;index entryUUID eq<br/>
&#160; &#160; &#160;# syncrepl directives<br/>
&#160; &#160; &#160;syncrepl &#160;rid=0<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;provider=ldap://ldapmaster.symas.com:389<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;bindmethod=simple<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;binddn=&#34;cn=replicator,dc=symas,dc=com&#34;<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;credentials=secret<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;searchbase=&#34;dc=symas,dc=com&#34;<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;logbase=&#34;cn=accesslog&#34;<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;logfilter=&#34;(&amp;(objectClass=auditWriteObject)(reqResult=0))&#34;<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;schemachecking=on<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;type=refreshAndPersist<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;retry=&#34;60 +&#34;<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;syncdata=accesslog<br/>
&#160; &#160; &#160;# Refer updates to the master<br/>
&#160; &#160; &#160;updateref &#160; &#160; &#160; &#160; &#160; &#160; &#160; ldap://ldapmaster.symas.com<br/>
The above configuration assumes that you have a replicator identity defined in your database that can be used<br/>to bind to the provider. In addition, all of the databases (primary, replica, and the accesslog storage database)<br/>should also have properly tuned<i>&#160;DB_CONFIG</i>&#160;files that meet your needs.<br/>
173<br/>
<hr/>
<a name=188></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
<b>18.3.3. N-Way Multi-Master</b><br/>
For the following example we will be using 3 Master nodes. Keeping in line with<br/><b>test050-syncrepl-multimaster</b>&#160;of the OpenLDAP test suite, we will be configuring<i>&#160;slapd(8)</i>&#160;via<b>&#160;cn=config</b><br/>
This sets up the config database:<br/>
&#160; &#160; &#160;dn: cn=config<br/>
&#160; &#160; &#160;objectClass: olcGlobal<br/>
&#160; &#160; &#160;cn: config<br/>
&#160; &#160; &#160;olcServerID: 1<br/>
&#160; &#160; &#160;dn: olcDatabase={0}config,cn=config<br/>
&#160; &#160; &#160;objectClass: olcDatabaseConfig<br/>
&#160; &#160; &#160;olcDatabase: {0}config<br/>
&#160; &#160; &#160;olcRootPW: secret<br/>
second and third servers will have a different olcServerID obviously:<br/>
&#160; &#160; &#160;dn: cn=config<br/>
&#160; &#160; &#160;objectClass: olcGlobal<br/>
&#160; &#160; &#160;cn: config<br/>
&#160; &#160; &#160;olcServerID: 2<br/>
&#160; &#160; &#160;dn: olcDatabase={0}config,cn=config<br/>
&#160; &#160; &#160;objectClass: olcDatabaseConfig<br/>
&#160; &#160; &#160;olcDatabase: {0}config<br/>
&#160; &#160; &#160;olcRootPW: secret<br/>
This sets up syncrepl as a provider (since these are all masters):<br/>
&#160; &#160; &#160;dn: cn=module,cn=config<br/>
&#160; &#160; &#160;objectClass: olcModuleList<br/>
&#160; &#160; &#160;cn: module<br/>
&#160; &#160; &#160;olcModulePath: /usr/local/libexec/openldap<br/>
&#160; &#160; &#160;olcModuleLoad: syncprov.la<br/>
Now we setup the first Master Node (replace $URI1, $URI2 and $URI3 etc. with your actual ldap urls):<br/>
&#160; &#160; &#160;dn: cn=config<br/>
&#160; &#160; &#160;changetype: modify<br/>
&#160; &#160; &#160;replace: olcServerID<br/>
&#160; &#160; &#160;olcServerID: 1 $URI1<br/>
&#160; &#160; &#160;olcServerID: 2 $URI2<br/>
&#160; &#160; &#160;olcServerID: 3 $URI3<br/>
&#160; &#160; &#160;dn: olcOverlay=syncprov,olcDatabase={0}config,cn=config<br/>
&#160; &#160; &#160;changetype: add<br/>
&#160; &#160; &#160;objectClass: olcOverlayConfig<br/>
&#160; &#160; &#160;objectClass: olcSyncProvConfig<br/>
&#160; &#160; &#160;olcOverlay: syncprov<br/>
&#160; &#160; &#160;dn: olcDatabase={0}config,cn=config<br/>
&#160; &#160; &#160;changetype: modify<br/>
&#160; &#160; &#160;add: olcSyncRepl<br/>
&#160; &#160; &#160;olcSyncRepl: rid=001 provider=$URI1 binddn=&#34;cn=config&#34; bindmethod=simple<br/>
&#160; &#160; &#160; &#160;credentials=secret searchbase=&#34;cn=config&#34; type=refreshAndPersist<br/>
&#160; &#160; &#160; &#160;retry=&#34;5 5 300 5&#34; timeout=1<br/>
174<br/>
<hr/>
<a name=189></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
&#160; &#160; &#160;olcSyncRepl: rid=002 provider=$URI2 binddn=&#34;cn=config&#34; bindmethod=simple<br/>
&#160; &#160; &#160; &#160;credentials=secret searchbase=&#34;cn=config&#34; type=refreshAndPersist<br/>
&#160; &#160; &#160; &#160;retry=&#34;5 5 300 5&#34; timeout=1<br/>
&#160; &#160; &#160;olcSyncRepl: rid=003 provider=$URI3 binddn=&#34;cn=config&#34; bindmethod=simple<br/>
&#160; &#160; &#160; &#160;credentials=secret searchbase=&#34;cn=config&#34; type=refreshAndPersist<br/>
&#160; &#160; &#160; &#160;retry=&#34;5 5 300 5&#34; timeout=1<br/>
&#160; &#160; &#160;-<br/>
&#160; &#160; &#160;add: olcMirrorMode<br/>
&#160; &#160; &#160;olcMirrorMode: TRUE<br/>
Now start up the Master and a consumer/s, also add the above LDIF to the first consumer, second consumer<br/>etc. It will then replicate<b>&#160;cn=config</b>. You now have N-Way Multimaster on the config database.<br/>
We still have to replicate the actual data, not just the config, so add to the master (all active and configured<br/>consumers/masters will pull down this config, as they are all syncing). Also, replace all<i>&#160;${</i>} variables with<br/>whatever is applicable to your setup:<br/>
&#160; &#160; &#160;dn: olcDatabase={1}$BACKEND,cn=config<br/>
&#160; &#160; &#160;objectClass: olcDatabaseConfig<br/>
&#160; &#160; &#160;objectClass: olc${BACKEND}Config<br/>
&#160; &#160; &#160;olcDatabase: {1}$BACKEND<br/>
&#160; &#160; &#160;olcSuffix: $BASEDN<br/>
&#160; &#160; &#160;olcDbDirectory: ./db<br/>
&#160; &#160; &#160;olcRootDN: $MANAGERDN<br/>
&#160; &#160; &#160;olcRootPW: $PASSWD<br/>
&#160; &#160; &#160;olcLimits: dn.exact=&#34;$MANAGERDN&#34; time.soft=unlimited time.hard=unlimited size.soft=unlimited size.hard=unlimited<br/>
&#160; &#160; &#160;olcSyncRepl: rid=004 provider=$URI1 binddn=&#34;$MANAGERDN&#34; bindmethod=simple<br/>
&#160; &#160; &#160; &#160;credentials=$PASSWD searchbase=&#34;$BASEDN&#34; type=refreshOnly<br/>
&#160; &#160; &#160; &#160;interval=00:00:00:10 retry=&#34;5 5 300 5&#34; timeout=1<br/>
&#160; &#160; &#160;olcSyncRepl: rid=005 provider=$URI2 binddn=&#34;$MANAGERDN&#34; bindmethod=simple<br/>
&#160; &#160; &#160; &#160;credentials=$PASSWD searchbase=&#34;$BASEDN&#34; type=refreshOnly<br/>
&#160; &#160; &#160; &#160;interval=00:00:00:10 retry=&#34;5 5 300 5&#34; timeout=1<br/>
&#160; &#160; &#160;olcSyncRepl: rid=006 provider=$URI3 binddn=&#34;$MANAGERDN&#34; bindmethod=simple<br/>
&#160; &#160; &#160; &#160;credentials=$PASSWD searchbase=&#34;$BASEDN&#34; type=refreshOnly<br/>
&#160; &#160; &#160; &#160;interval=00:00:00:10 retry=&#34;5 5 300 5&#34; timeout=1<br/>
&#160; &#160; &#160;olcMirrorMode: TRUE<br/>
&#160; &#160; &#160;dn: olcOverlay=syncprov,olcDatabase={1}${BACKEND},cn=config<br/>
&#160; &#160; &#160;changetype: add<br/>
&#160; &#160; &#160;objectClass: olcOverlayConfig<br/>
&#160; &#160; &#160;objectClass: olcSyncProvConfig<br/>
&#160; &#160; &#160;olcOverlay: syncprov<br/>
<b>Note:</b><a href="http://www.ntp.org/">&#160;All of your servers' clocks must be tightly synchronized using e.g. NTP http://www.ntp.org/, atomic<br/></a>clock, or some other reliable time reference.<br/>
<b>Note:</b>&#160;As stated in<i>&#160;slapd-config</i>(5), URLs specified in<i>&#160;olcSyncRepl</i>&#160;directives are the URLs of the servers from<br/>which to replicate. These must exactly match the URLs<i>&#160;slapd</i>&#160;listens on (<i>-h</i><a href="OpenLDAP-Admin-Guides.html#67">&#160;in Command-Line Options).<br/></a>Otherwise slapd may attempt to replicate from itself, causing a loop.<br/>
<b>18.3.4. MirrorMode</b><br/>
MirrorMode configuration is actually very easy. If you have ever setup a normal slapd syncrepl provider, then<br/>the only change is the following two directives:<br/>
175<br/>
<hr/>
<a name=190></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
&#160; &#160; &#160; &#160;mirrormode &#160;on<br/>
&#160; &#160; &#160; &#160;serverID &#160; &#160;1<br/>
<b>Note:</b>&#160;You need to make sure that the<i>&#160;serverID</i>&#160;of each mirror node is different and add it as a global<br/>configuration option.<br/>
<b>18.3.4.1. Mirror Node Configuration</b><br/>
<a href="OpenLDAP-Admin-Guides.html#184">The first step is to configure the syncrepl provider the same as in the Set up the provider slapd section.</a><br/>
<a href="OpenLDAP-Admin-Guides.html#177">Here's a specific cut down example using LDAP Sync Replication in</a><i>&#160;refreshAndPersist</i>&#160;mode:<br/>
MirrorMode node 1:<br/>
&#160; &#160; &#160; &#160;# Global section<br/>
&#160; &#160; &#160; &#160;serverID &#160; &#160;1<br/>
&#160; &#160; &#160; &#160;# database section<br/>
&#160; &#160; &#160; &#160;# syncrepl directive<br/>
&#160; &#160; &#160; &#160;syncrepl &#160; &#160; &#160;rid=001<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;provider=ldap://ldap-sid2.example.com<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;bindmethod=simple<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;binddn=&#34;cn=mirrormode,dc=example,dc=com&#34;<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;credentials=mirrormode<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;searchbase=&#34;dc=example,dc=com&#34;<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;schemachecking=on<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;type=refreshAndPersist<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;retry=&#34;60 +&#34;<br/>
&#160; &#160; &#160; &#160;mirrormode on<br/>
MirrorMode node 2:<br/>
&#160; &#160; &#160; &#160;# Global section<br/>
&#160; &#160; &#160; &#160;serverID &#160; &#160;2<br/>
&#160; &#160; &#160; &#160;# database section<br/>
&#160; &#160; &#160; &#160;# syncrepl directive<br/>
&#160; &#160; &#160; &#160;syncrepl &#160; &#160; &#160;rid=001<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;provider=ldap://ldap-sid1.example.com<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;bindmethod=simple<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;binddn=&#34;cn=mirrormode,dc=example,dc=com&#34;<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;credentials=mirrormode<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;searchbase=&#34;dc=example,dc=com&#34;<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;schemachecking=on<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;type=refreshAndPersist<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;retry=&#34;60 +&#34;<br/>
&#160; &#160; &#160; &#160;mirrormode on<br/>
It's simple really; each MirrorMode node is setup<b>&#160;exactly</b>&#160;the same, except that the<i>&#160;serverID</i>&#160;is unique, and<br/>each consumer is pointed to the other server.<br/>
176<br/>
<hr/>
<a name=191></a><img src="../img/OpenLDAP-Admin-Guide-191_1.png"/><br/>
OpenLDAP Software 2.4 Administrator's Guide<br/>
<b>18.3.4.1.1. Failover Configuration</b><br/>
There are generally 2 choices for this; 1. Hardware proxies/load-balancing or dedicated proxy software, 2.<br/>using a Back-LDAP proxy as a syncrepl provider<br/>
A typical enterprise example might be:<br/>
Figure X.Y: MirrorMode in a Dual Data Center Configuration<br/>
<b>18.3.4.1.2. Normal Consumer Configuration</b><br/>
<a href="OpenLDAP-Admin-Guides.html#185">This is exactly the same as the Set up the consumer slapd section. It can either setup in normal syncrepl<br/></a><a href="">replication mode, or in delta-syncrepl replication mode.</a><br/>
<b>18.3.4.2. MirrorMode Summary</b><br/>
You will now have a directory architecture that provides all of the consistency guarantees of single-master<br/>replication, while also providing the high availability of multi-master replication.<br/>
<b>18.3.5. Syncrepl Proxy</b><br/>
177<br/>
<hr/>
<a name=192></a><img src="../img/OpenLDAP-Admin-Guide-192_1.png"/><br/>
OpenLDAP Software 2.4 Administrator's Guide<br/>
Figure X.Y: Replacing slurpd<br/>
The following example is for a self-contained push-based replication solution:<br/>
&#160; &#160; &#160; &#160; #######################################################################<br/>
&#160; &#160; &#160; &#160; # Standard OpenLDAP Master/Provider<br/>
&#160; &#160; &#160; &#160; #######################################################################<br/>
&#160; &#160; &#160; &#160; include &#160; &#160; /usr/local/etc/openldap/schema/core.schema<br/>
&#160; &#160; &#160; &#160; include &#160; &#160; /usr/local/etc/openldap/schema/cosine.schema<br/>
&#160; &#160; &#160; &#160; include &#160; &#160; /usr/local/etc/openldap/schema/nis.schema<br/>
&#160; &#160; &#160; &#160; include &#160; &#160; /usr/local/etc/openldap/schema/inetorgperson.schema<br/>
&#160; &#160; &#160; &#160; include &#160; &#160; /usr/local/etc/openldap/slapd.acl<br/>
&#160; &#160; &#160; &#160; modulepath &#160;/usr/local/libexec/openldap<br/>
&#160; &#160; &#160; &#160; moduleload &#160;back_hdb.la<br/>
&#160; &#160; &#160; &#160; moduleload &#160;syncprov.la<br/>
&#160; &#160; &#160; &#160; moduleload &#160;back_monitor.la<br/>
&#160; &#160; &#160; &#160; moduleload &#160;back_ldap.la<br/>
&#160; &#160; &#160; &#160; pidfile &#160; &#160; /usr/local/var/slapd.pid<br/>
&#160; &#160; &#160; &#160; argsfile &#160; &#160;/usr/local/var/slapd.args<br/>
&#160; &#160; &#160; &#160; loglevel &#160; &#160;sync stats<br/>
&#160; &#160; &#160; &#160; database &#160; &#160;hdb<br/>
&#160; &#160; &#160; &#160; suffix &#160; &#160; &#160;&#34;dc=suretecsystems,dc=com&#34;<br/>
&#160; &#160; &#160; &#160; directory &#160; /usr/local/var/openldap-data<br/>
&#160; &#160; &#160; &#160; checkpoint &#160; &#160; &#160;1024 5<br/>
178<br/>
<hr/>
<a name=193></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
&#160; &#160; &#160; &#160; cachesize &#160; &#160; &#160; 10000<br/>
&#160; &#160; &#160; &#160; idlcachesize &#160; &#160;10000<br/>
&#160; &#160; &#160; &#160; index &#160; &#160; &#160; objectClass eq<br/>
&#160; &#160; &#160; &#160; # rest of indexes<br/>
&#160; &#160; &#160; &#160; index &#160; &#160; &#160; default &#160; &#160; sub<br/>
&#160; &#160; &#160; &#160; rootdn &#160; &#160; &#160; &#160; &#160;&#34;cn=admin,dc=suretecsystems,dc=com&#34;<br/>
&#160; &#160; &#160; &#160; rootpw &#160; &#160; &#160; &#160; &#160;testing<br/>
&#160; &#160; &#160; &#160; # syncprov specific indexing<br/>
&#160; &#160; &#160; &#160; index entryCSN eq<br/>
&#160; &#160; &#160; &#160; index entryUUID eq<br/>
&#160; &#160; &#160; &#160; # syncrepl Provider for primary db<br/>
&#160; &#160; &#160; &#160; overlay syncprov<br/>
&#160; &#160; &#160; &#160; syncprov-checkpoint 1000 60<br/>
&#160; &#160; &#160; &#160; # Let the replica DN have limitless searches<br/>
&#160; &#160; &#160; &#160; limits dn.exact=&#34;cn=replicator,dc=suretecsystems,dc=com&#34; time.soft=unlimited time.hard=unlimited size.soft=unlimited size.hard=unlimited<br/>
&#160; &#160; &#160; &#160; database &#160; &#160;monitor<br/>
&#160; &#160; &#160; &#160; database &#160; &#160;config<br/>
&#160; &#160; &#160; &#160; rootpw &#160; &#160; &#160; &#160; &#160;testing<br/>
&#160; &#160; &#160; &#160; ##############################################################################<br/>
&#160; &#160; &#160; &#160; # Consumer Proxy that pulls in data via Syncrepl and pushes out via slapd-ldap<br/>
&#160; &#160; &#160; &#160; ##############################################################################<br/>
&#160; &#160; &#160; &#160; database &#160; &#160; &#160; &#160;ldap<br/>
&#160; &#160; &#160; &#160; # ignore conflicts with other databases, as we need to push out to same suffix<br/>
&#160; &#160; &#160; &#160; hidden &#160; &#160; &#160; &#160; &#160; &#160; &#160;on<br/>
&#160; &#160; &#160; &#160; suffix &#160; &#160; &#160; &#160; &#160;&#34;dc=suretecsystems,dc=com&#34;<br/>
&#160; &#160; &#160; &#160; rootdn &#160; &#160; &#160; &#160; &#160;&#34;cn=slapd-ldap&#34;<br/>
&#160; &#160; &#160; &#160; uri &#160; &#160; &#160; &#160; &#160; &#160; ldap://localhost:9012/<br/>
&#160; &#160; &#160; &#160; lastmod &#160; &#160; &#160; &#160; on<br/>
&#160; &#160; &#160; &#160; # We don't need any access to this DSA<br/>
&#160; &#160; &#160; &#160; restrict &#160; &#160; &#160; &#160;all<br/>
&#160; &#160; &#160; &#160; acl-bind &#160; &#160; &#160; &#160;bindmethod=simple<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; binddn=&#34;cn=replicator,dc=suretecsystems,dc=com&#34;<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; credentials=testing<br/>
&#160; &#160; &#160; &#160; syncrepl &#160; &#160; &#160; &#160;rid=001<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; provider=ldap://localhost:9011/<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; binddn=&#34;cn=replicator,dc=suretecsystems,dc=com&#34;<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; bindmethod=simple<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; credentials=testing<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; searchbase=&#34;dc=suretecsystems,dc=com&#34;<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; type=refreshAndPersist<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; retry=&#34;5 5 300 5&#34;<br/>
&#160; &#160; &#160; &#160; overlay &#160; &#160; &#160; &#160; syncprov<br/>
A replica configuration for this type of setup could be:<br/>
&#160; &#160; &#160; &#160; #######################################################################<br/>
&#160; &#160; &#160; &#160; # Standard OpenLDAP Slave without Syncrepl<br/>
179<br/>
<hr/>
<a name=194></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
&#160; &#160; &#160; &#160; #######################################################################<br/>
&#160; &#160; &#160; &#160; include &#160; &#160; /usr/local/etc/openldap/schema/core.schema<br/>
&#160; &#160; &#160; &#160; include &#160; &#160; /usr/local/etc/openldap/schema/cosine.schema<br/>
&#160; &#160; &#160; &#160; include &#160; &#160; /usr/local/etc/openldap/schema/nis.schema<br/>
&#160; &#160; &#160; &#160; include &#160; &#160; /usr/local/etc/openldap/schema/inetorgperson.schema<br/>
&#160; &#160; &#160; &#160; include &#160; &#160; /usr/local/etc/openldap/slapd.acl<br/>
&#160; &#160; &#160; &#160; modulepath &#160;/usr/local/libexec/openldap<br/>
&#160; &#160; &#160; &#160; moduleload &#160;back_hdb.la<br/>
&#160; &#160; &#160; &#160; moduleload &#160;syncprov.la<br/>
&#160; &#160; &#160; &#160; moduleload &#160;back_monitor.la<br/>
&#160; &#160; &#160; &#160; moduleload &#160;back_ldap.la<br/>
&#160; &#160; &#160; &#160; pidfile &#160; &#160; /usr/local/var/slapd.pid<br/>
&#160; &#160; &#160; &#160; argsfile &#160; &#160;/usr/local/var/slapd.args<br/>
&#160; &#160; &#160; &#160; loglevel &#160; &#160;sync stats<br/>
&#160; &#160; &#160; &#160; database &#160; &#160;hdb<br/>
&#160; &#160; &#160; &#160; suffix &#160; &#160; &#160;&#34;dc=suretecsystems,dc=com&#34;<br/>
&#160; &#160; &#160; &#160; directory &#160; /usr/local/var/openldap-slave/data<br/>
&#160; &#160; &#160; &#160; checkpoint &#160; &#160; &#160;1024 5<br/>
&#160; &#160; &#160; &#160; cachesize &#160; &#160; &#160; 10000<br/>
&#160; &#160; &#160; &#160; idlcachesize &#160; &#160;10000<br/>
&#160; &#160; &#160; &#160; index &#160; &#160; &#160; objectClass eq<br/>
&#160; &#160; &#160; &#160; # rest of indexes<br/>
&#160; &#160; &#160; &#160; index &#160; &#160; &#160; default &#160; &#160; sub<br/>
&#160; &#160; &#160; &#160; rootdn &#160; &#160; &#160; &#160; &#160;&#34;cn=admin,dc=suretecsystems,dc=com&#34;<br/>
&#160; &#160; &#160; &#160; rootpw &#160; &#160; &#160; &#160; &#160;testing<br/>
&#160; &#160; &#160; &#160; # Let the replica DN have limitless searches<br/>
&#160; &#160; &#160; &#160; limits dn.exact=&#34;cn=replicator,dc=suretecsystems,dc=com&#34; time.soft=unlimited time.hard=unlimited size.soft=unlimited size.hard=unlimited<br/>
&#160; &#160; &#160; &#160; updatedn &#34;cn=replicator,dc=suretecsystems,dc=com&#34;<br/>
&#160; &#160; &#160; &#160; # Refer updates to the master<br/>
&#160; &#160; &#160; &#160; updateref &#160; ldap://localhost:9011<br/>
&#160; &#160; &#160; &#160; database &#160; &#160;monitor<br/>
&#160; &#160; &#160; &#160; database &#160; &#160;config<br/>
&#160; &#160; &#160; &#160; rootpw &#160; &#160; &#160; &#160; &#160;testing<br/>
You can see we use the<i>&#160;updatedn</i>&#160;directive here and example ACLs<br/>(usr/local/etc/openldap/slapd.acl) for this could be:<br/>
&#160; &#160; &#160; &#160; # Give the replica DN unlimited read access. &#160;This ACL may need to be<br/>
&#160; &#160; &#160; &#160; # merged with other ACL statements.<br/>
&#160; &#160; &#160; &#160; access to *<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160;by dn.base=&#34;cn=replicator,dc=suretecsystems,dc=com&#34; write<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160;by * break<br/>
&#160; &#160; &#160; &#160; access to dn.base=&#34;&#34;<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; by * read<br/>
180<br/>
<hr/>
<a name=195></a><img src="../img/OpenLDAP-Admin-Guide-195_1.png"/><br/>
OpenLDAP Software 2.4 Administrator's Guide<br/>
&#160; &#160; &#160; &#160; access to dn.base=&#34;cn=Subschema&#34;<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; by * read<br/>
&#160; &#160; &#160; &#160; access to dn.subtree=&#34;cn=Monitor&#34;<br/>
&#160; &#160; &#160; &#160; &#160; &#160; by dn.exact=&#34;uid=admin,dc=suretecsystems,dc=com&#34; write<br/>
&#160; &#160; &#160; &#160; &#160; &#160; by users read<br/>
&#160; &#160; &#160; &#160; &#160; &#160; by * none<br/>
&#160; &#160; &#160; &#160; access to *<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; by self write<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; by * read<br/>
In order to support more replicas, just add more<i>&#160;database ldap</i>&#160;sections and increment the<i>&#160;syncrepl rid</i>&#160;number<br/>accordingly.<br/>
<b>Note:</b>&#160;You must populate the Master and Slave directories with the same data, unlike when using normal<br/>Syncrepl<br/>
If you do not have access to modify the master directory configuration you can configure a standalone ldap<br/>proxy, which might look like:<br/>
Figure X.Y: Replacing slurpd with a standalone version<br/>
The following configuration is an example of a standalone LDAP Proxy:<br/>
&#160; &#160; &#160; &#160; include &#160; &#160; /usr/local/etc/openldap/schema/core.schema<br/>
&#160; &#160; &#160; &#160; include &#160; &#160; /usr/local/etc/openldap/schema/cosine.schema<br/>
&#160; &#160; &#160; &#160; include &#160; &#160; /usr/local/etc/openldap/schema/nis.schema<br/>
181<br/>
<hr/>
<a name=196></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
&#160; &#160; &#160; &#160; include &#160; &#160; /usr/local/etc/openldap/schema/inetorgperson.schema<br/>
&#160; &#160; &#160; &#160; include &#160; &#160; /usr/local/etc/openldap/slapd.acl<br/>
&#160; &#160; &#160; &#160; modulepath &#160;/usr/local/libexec/openldap<br/>
&#160; &#160; &#160; &#160; moduleload &#160;syncprov.la<br/>
&#160; &#160; &#160; &#160; moduleload &#160;back_ldap.la<br/>
&#160; &#160; &#160; &#160; ##############################################################################<br/>
&#160; &#160; &#160; &#160; # Consumer Proxy that pulls in data via Syncrepl and pushes out via slapd-ldap<br/>
&#160; &#160; &#160; &#160; ##############################################################################<br/>
&#160; &#160; &#160; &#160; database &#160; &#160; &#160; &#160;ldap<br/>
&#160; &#160; &#160; &#160; # ignore conflicts with other databases, as we need to push out to same suffix<br/>
&#160; &#160; &#160; &#160; hidden &#160; &#160; &#160; &#160; &#160; &#160; &#160;on<br/>
&#160; &#160; &#160; &#160; suffix &#160; &#160; &#160; &#160; &#160;&#34;dc=suretecsystems,dc=com&#34;<br/>
&#160; &#160; &#160; &#160; rootdn &#160; &#160; &#160; &#160; &#160;&#34;cn=slapd-ldap&#34;<br/>
&#160; &#160; &#160; &#160; uri &#160; &#160; &#160; &#160; &#160; &#160; ldap://localhost:9012/<br/>
&#160; &#160; &#160; &#160; lastmod &#160; &#160; &#160; &#160; on<br/>
&#160; &#160; &#160; &#160; # We don't need any access to this DSA<br/>
&#160; &#160; &#160; &#160; restrict &#160; &#160; &#160; &#160;all<br/>
&#160; &#160; &#160; &#160; acl-bind &#160; &#160; &#160; &#160;bindmethod=simple<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; binddn=&#34;cn=replicator,dc=suretecsystems,dc=com&#34;<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; credentials=testing<br/>
&#160; &#160; &#160; &#160; syncrepl &#160; &#160; &#160; &#160;rid=001<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; provider=ldap://localhost:9011/<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; binddn=&#34;cn=replicator,dc=suretecsystems,dc=com&#34;<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; bindmethod=simple<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; credentials=testing<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; searchbase=&#34;dc=suretecsystems,dc=com&#34;<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; type=refreshAndPersist<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; retry=&#34;5 5 300 5&#34;<br/>
&#160; &#160; &#160; &#160; overlay &#160; &#160; &#160; &#160; syncprov<br/>
As you can see, you can let your imagination go wild using Syncrepl and<i>&#160;slapd-ldap(8)</i>&#160;tailoring your<br/>replication to fit your specific network topology.<br/>
182<br/>
<hr/>
<a name=197></a><b>19. Maintenance</b><br/>
System Administration is all about maintenance, so it is only fair that we discuss how to correctly maintain an<br/>OpenLDAP deployment.<br/>
<b>19.1. Directory Backups</b><br/>
Backup strategies largely depend on the amount of change in the database and how much of that change an<br/>administrator might be willing to lose in a catastrophic failure. There are two basic methods that can be used:<br/>
1. Backup the Berkeley database itself and periodically back up the transaction log files:<br/>
Berkeley DB produces transaction logs that can be used to reconstruct changes from a given point in time. For<br/>example, if an administrator were willing to only lose one hour's worth of changes, they could take down the<br/>server in the middle of the night, copy the Berkeley database files offsite, and bring the server back online.<br/>Then, on an hourly basis, they could force a database checkpoint, capture the log files that have been<br/>generated in the past hour, and copy them offsite. The accumulated log files, in combination with the previous<br/>database backup, could be used with db_recover to reconstruct the database up to the time the last collection<br/>of log files was copied offsite. This method affords good protection, with minimal space overhead.<br/>
2. Periodically run slapcat and back up the LDIF file:<br/>
Slapcat can be run while slapd is active. However, one runs the risk of an inconsistent database- not from the<br/>point of slapd, but from the point of the applications using LDAP. For example, if a provisioning application<br/>performed tasks that consisted of several LDAP operations, and the slapcat took place concurrently with those<br/>operations, then there might be inconsistencies in the LDAP database from the point of view of that<br/>provisioning application and applications that depended on it. One must, therefore, be convinced something<br/>like that won't happen. One way to do that would be to put the database in read-only mode while performing<br/>the slapcat. The other disadvantage of this approach is that the generated LDIF files can be rather large and<br/>the accumulation of the day's backups could add up to a substantial amount of space.<br/>
You can use<i>&#160;slapcat</i>(8) to generate an LDIF file for each of your<i>&#160;slapd</i>(8) back-bdb or back-hdb databases.<br/>
&#160; &#160; slapcat -f slapd.conf -b &#34;dc=example,dc=com&#34;<br/>
For back-bdb and back-hdb, this command may be ran while slapd(8) is running.<br/>
MORE on actual Berkeley DB backups later covering db_recover etc.<br/>
<b>19.2. Berkeley DB Logs</b><br/>
Berkeley DB log files grow, and the administrator has to deal with it. The procedure is known as log file<br/>archival or log file rotation.<br/>
<b>Note:</b>&#160;The actual log file rotation is handled by the Berkeley DB engine.<br/>
Logs of current transactions need to be stored into files so that the database can be recovered in the event of<br/>an application crash. Administrators can change the size limit of a single log file (by default 10MB), and have<br/>old log files removed automatically, by setting up DB environment (see below). The reason Berkeley DB<br/>
183<br/>
<hr/>
<a name=198></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
never deletes any log files by default is that the administrator may wish to backup the log files before removal<br/>to make database recovery possible even after a catastrophic failure, such as file system corruption.<br/>
Log file names are&#160;log.XXXXXXXXXX&#160;(X is a digit). By default the log files are located in the BDB backend<br/>directory. The&#160;db_archive&#160;tool knows what log files are used in current transactions, and what are not.<br/>Administrators can move unused log files to a backup media, and delete them. To have them removed<br/>automatically, place set_flags<i>&#160;DB_LOG_AUTOREMOVE</i>&#160;directive in&#160;DB_CONFIG.<br/>
<b>Note:</b>&#160;If the log files are removed automatically, recovery after a catastrophic failure is likely to be<br/>impossible.<br/>
The files with names&#160;__db.001,&#160;__db.002, etc are just shared memory regions (or whatever). These ARE<br/>NOT 'logs', they must be left alone. Don't be afraid of them, they do not grow like logs do.<br/>
To understand the&#160;db_archive&#160;interface, the reader should refer to chapter 9 of the Berkeley DB guide. In<br/>particular, the following chapters are recommended:<br/>
Database and log file archival -<br/>
&#160;<br/>
<a href="http://www.oracle.com/technology/documentation/berkeley-db/db/ref/transapp/archival.html">http://www.oracle.com/technology/documentation/berkeley-db/db/ref/transapp/archival.html<br/></a>Log file removal -<br/>
&#160;<br/>
<a href="http://www.oracle.com/technology/documentation/berkeley-db/db/ref/transapp/logfile.html">http://www.oracle.com/technology/documentation/berkeley-db/db/ref/transapp/logfile.html<br/></a>Recovery procedures -<br/>
&#160;<br/>
<a href="http://www.oracle.com/technology/documentation/berkeley-db/db/ref/transapp/recovery.html">http://www.oracle.com/technology/documentation/berkeley-db/db/ref/transapp/recovery.html<br/></a>Hot failover -<br/>
&#160;<br/>
<a href="http://www.oracle.com/technology/documentation/berkeley-db/db/ref/transapp/hotfail.html">http://www.oracle.com/technology/documentation/berkeley-db/db/ref/transapp/hotfail.html<br/></a>Complete list of Berkeley DB flags -<br/>
&#160;<br/>
<a href="http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/env_set_flags.html">http://www.oracle.com/technology/documentation/berkeley-db/db/api_c/env_set_flags.html</a><br/>
Advanced installations can use special environment settings to fine-tune some Berkeley DB options (change<br/>the log file limit, etc). This can be done by using the&#160;DB_CONFIG&#160;file. This magic file can be created in BDB<br/>backend directory set up by<i>&#160;slapd.conf</i>(5). More information on this file can be found in File naming chapter.<br/>Specific directives can be found in C Interface, look for<i>&#160;DB_ENV-&gt;set_XXXX</i>&#160;calls.<br/>
<b>Note:</b>&#160;options set in&#160;DB_CONFIG&#160;file override options set by OpenLDAP. Use them with extreme caution.<br/>Do not use them unless You know what You are doing.<br/>
The advantages of&#160;DB_CONFIG&#160;usage can be the following:<br/>
to keep data files and log files on different mediums (i.e. disks) to improve performance and/or<br/>
&#160;<br/>
reliability;<br/>to fine-tune some specific options (such as shared memory region sizes);<br/>
&#160;<br/>
to set the log file limit (please read Log file limits before doing this).<br/>
&#160;<br/>
To figure out the best-practice BDB backup scenario, the reader is highly recommended to read the whole<br/>Chapter 9: Berkeley DB Transactional Data Store Applications. This chapter is a set of small pages with<br/>examples in C language. Non-programming people can skip these examples without loss of knowledge.<br/>
184<br/>
<hr/>
<a name=199></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
<b>19.3. Checkpointing</b><br/>
MORE/TIDY<br/>
If you put &#34;checkpoint 1024 5&#34; in slapd.conf (to checkpoint after 1024kb or 5 minutes, for example), this does<br/>not checkpoint every 5 minutes as you may think. The explanation from Howard is:<br/>
'In OpenLDAP 2.1 and 2.2 the checkpoint directive acts as follows - *when there is a write operation*, and<br/>more than &lt;check&gt; minutes have occurred since the last checkpoint, perform the checkpoint. If more than<br/>&lt;check&gt; minutes pass after a write without any other write operations occurring, no checkpoint is performed,<br/>so it's possible to lose the last write that occurred.''<br/>
In other words, a write operation occurring less than &#34;check&#34; minutes after the last checkpoint will not be<br/>checkpointed until the next write occurs after &#34;check&#34; minutes have passed since the checkpoint.<br/>
This has been modified in 2.3 to indeed checkpoint every so often; in the meantime a workaround is to invoke<br/>&#34;db_checkpoint&#34; from a cron script every so often, say 5 minutes.<br/>
<b>19.4. Migration</b><br/>
The simplest steps needed to migrate between versions or upgrade, depending on your deployment type are:<br/>
<b>Stop the current server when convenient</b><br/>
1.&#160;<br/>
<b>slapcat the current data out</b><br/>
2.&#160;<br/>
<b>Clear out the current data directory (/usr/local/var/openldap-data/) leaving DB_CONFIG in</b><br/>
3.&#160;<br/>
<b>place</b><br/>
<b>Perform the software upgrades</b><br/>
4.&#160;<br/>
<b>slapadd the exported data back into the directory</b><br/>
5.&#160;<br/>
<b>Start the server</b><br/>
6.&#160;<br/>
<a href="OpenLDAP-Admin-Guides.html#189">Obviously this doesn't cater for any complicated deployments like MirrorMode or N-Way Multi-Master, but<br/></a>following the above sections and using either commercial support or community support should help. Also<br/><a href="OpenLDAP-Admin-Guides.html#215">check the Troubleshooting section.</a><br/>
185<br/>
<hr/>
<a name=200></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
186<br/>
<hr/>
<a name=201></a><b>20. Monitoring</b><br/>
<i>slapd</i>(8) supports an optional LDAP monitoring interface you can use to obtain information regarding the<br/>current state of your<i>&#160;slapd</i>&#160;instance. For instance, the interface allows you to determine how many clients are<br/>connected to the server currently. The monitoring information is provided by a specialized backend, the<br/><i>monitor</i>&#160;backend. A manual page,<i>&#160;slapd-monitor</i>(5) is available.<br/>
When the monitoring interface is enabled, LDAP clients may be used to access information provided by the<br/><i>monitor</i>&#160;backend, subject to access and other controls.<br/>
When enabled, the<i>&#160;monitor</i>&#160;backend dynamically generates and returns objects in response to search requests<br/>in the<i>&#160;cn=Monitor</i>&#160;subtree. Each object contains information about a particular aspect of the server. The<br/>information is held in a combination of user applications and operational attributes. This information can be<br/>access with<i>&#160;ldapsearch(1)</i>, with any general-purpose LDAP browser, or with specialized monitoring tools.<br/><a href="OpenLDAP-Admin-Guides.html#202">The Accessing Monitoring Information section provides a brief tutorial on how to use</a><i>&#160;ldapsearch</i>(1) to access<br/><a href="OpenLDAP-Admin-Guides.html#203">monitoring information, while the Monitor information section details monitoring information base and its<br/></a>organization.<br/>
While support for the monitor backend is included in default builds of slapd(8), this support requires some<br/>configuration to become active. This may be done using either&#160;cn=config&#160;or<i>&#160;slapd.conf</i>(5). The former is<br/><a href="">discussed in the Monitor configuration via cn=config section of this of this chapter. The latter is discussed in<br/></a><a href="OpenLDAP-Admin-Guides.html#201">the Monitor configuration via slapd.conf(5) section of this chapter. These sections assume monitor backend is<br/></a>built into<i>&#160;slapd</i>&#160;(e.g.,&#160;--enable-monitor=yes, the default). If the monitor backend was built as a module<br/>(e.g.,&#160;--enable-monitor=mod, this module must loaded. Loading of modules is discussed in the<br/><a href="OpenLDAP-Admin-Guides.html#37">Configuring slapd and The slapd Configuration File chapters.</a><br/>
<b>20.1. Monitor configuration via cn=config(5)</b><br/>
<i>This section has yet to be written.</i><br/>
<b>20.2. Monitor configuration via slapd.conf(5)</b><br/>
Configuration of the slapd.conf(5) to support LDAP monitoring is quite simple.<br/>
First, ensure<i>&#160;core.schema</i>&#160;schema configuration file is included by your<i>&#160;slapd.conf</i>(5) file. The<i>&#160;monitor<br/></i>backend requires it.<br/>
Second, instantiate the<i>&#160;monitor backend</i>&#160;by adding a<i>&#160;database monitor</i>&#160;directive below your existing database<br/>sections. For instance:<br/>
&#160; &#160; &#160; &#160; database monitor<br/>
Lastly, add additional global or database directives as needed.<br/>
Like most other database backends, the monitor backend does honor slapd(8) access and other administrative<br/>controls. As some monitor information may be sensitive, it is generally recommend access to cn=monitor be<br/>restricted to directory administrators and their monitoring agents. Adding an<i>&#160;access</i>&#160;directive immediately<br/>below the<i>&#160;database monitor</i>&#160;directive is a clear and effective approach for controlling access. For instance, the<br/>addition of the following<i>&#160;access</i>&#160;directive immediately below the<i>&#160;database monitor</i>&#160;directive restricts access to<br/>
187<br/>
<hr/>
<a name=202></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
monitoring information to the specified directory manager.<br/>
&#160; &#160; &#160; &#160; access to *<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; by dn.exact=&#34;cn=Manager,dc=example,dc=com<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; by * none<br/>
More information on<i>&#160;slapd</i>(8) access controls, see<i>&#160;The access Control Directive</i><a href="OpenLDAP-Admin-Guides.html#57">&#160;section of the The slapd<br/>Configuration File chapter and</a><i>&#160;slapd.access</i>(5).<br/>
After restarting<i>&#160;slapd</i>(8), you are ready to start exploring the monitoring information provided in<br/>cn=config<a href="OpenLDAP-Admin-Guides.html#202">&#160;as discussed in the Accessing Monitoring Information section of this chapter.</a><br/>
One can verify slapd(8) is properly configured to provide monitoring information by attempting to read the<br/>cn=monitor&#160;object. For instance, if the following<i>&#160;ldapsearch</i>(1) command returns the cn=monitor object<br/>(with, as requested, no attributes), it's working.<br/>
&#160; &#160; &#160; &#160; ldapsearch -x -D 'cn=Manager,dc=example,dc=com' -W \<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; -b 'cn=Monitor' -s base 1.1<br/>
Note that unlike general purpose database backends, the database suffix is hardcoded. It's always<br/>cn=Monitor. So no<i>&#160;suffix</i>&#160;directive should be provided. Also note that general purpose database backends,<br/>the monitor backend cannot be instantiated multiple times. That is, there can only be one (or zero) occurrences<br/>of&#160;database monitor&#160;in the server's configuration.<br/>
<b>20.3. Accessing Monitoring Information</b><br/>
As previously discussed, when enabled, the<i>&#160;monitor</i>&#160;backend dynamically generates and returns objects in<br/>response to search requests in the<i>&#160;cn=Monitor</i>&#160;subtree. Each object contains information about a particular<br/>aspect of the server. The information is held in a combination of user applications and operational attributes.<br/>This information can be access with<i>&#160;ldapsearch(1)</i>, with any general-purpose LDAP browser, or with<br/>specialized monitoring tools.<br/>
This section provides a provides a brief tutorial on how to use<i>&#160;ldapsearch</i>(1) to access monitoring<br/>information.<br/>
To inspect any particular monitor object, one performs search operation on the object with a baseObject scope<br/>and a&#160;(objectClass=*)&#160;filter. As the monitoring information is contained in a combination of user<br/>applications and operational attributes, the return all user applications attributes (e.g.,&#160;'*') and all operational<br/>attributes (e.g.,&#160;'+') should be requested. For instance, to read the&#160;cn=Monitor&#160;object itself, the<br/><i>ldapsearch</i>(1) command (modified to fit your configuration) can be used:<br/>
&#160; &#160; &#160; &#160; ldapsearch -x -D 'cn=Manager,dc=example,dc=com' -W \<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; -b 'cn=Monitor' -s base '(objectClass=*)' '*' '+'<br/>
When run against your server, this should produce output similar to:<br/>
&#160; &#160; &#160; &#160; dn: cn=Monitor<br/>
&#160; &#160; &#160; &#160; objectClass: monitorServer<br/>
&#160; &#160; &#160; &#160; structuralObjectClass: monitorServer<br/>
&#160; &#160; &#160; &#160; cn: Monitor<br/>
&#160; &#160; &#160; &#160; creatorsName:<br/>
&#160; &#160; &#160; &#160; modifiersName:<br/>
&#160; &#160; &#160; &#160; createTimestamp: 20061208223558Z<br/>
188<br/>
<hr/>
<a name=203></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
&#160; &#160; &#160; &#160; modifyTimestamp: 20061208223558Z<br/>
&#160; &#160; &#160; &#160; description: This subtree contains monitoring/managing objects.<br/>
&#160; &#160; &#160; &#160; description: This object contains information about this server.<br/>
&#160; &#160; &#160; &#160; description: Most of the information is held in operational attributes, which<br/>
&#160; &#160; &#160; &#160; &#160;must be explicitly requested.<br/>
&#160; &#160; &#160; &#160; monitoredInfo: OpenLDAP: slapd 2.4 (Dec &#160;7 2006 17:30:29)<br/>
&#160; &#160; &#160; &#160; entryDN: cn=Monitor<br/>
&#160; &#160; &#160; &#160; subschemaSubentry: cn=Subschema<br/>
&#160; &#160; &#160; &#160; hasSubordinates: TRUE<br/>
To reduce the number of uninteresting attributes returned, one can be more selective when requesting which<br/>attributes are to be returned. For instance, one could request the return of all attributes allowed by the<br/><i>monitorServer</i>&#160;object class (e.g.,&#160;@objectClass) instead of all user and all operational attributes:<br/>
&#160; &#160; &#160; &#160; ldapsearch -x -D 'cn=Manager,dc=example,dc=com' -W \<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; -b 'cn=Monitor' -s base '(objectClass=*)' '@monitorServer'<br/>
This limits the output as follows:<br/>
&#160; &#160; &#160; &#160; dn: cn=Monitor<br/>
&#160; &#160; &#160; &#160; objectClass: monitorServer<br/>
&#160; &#160; &#160; &#160; cn: Monitor<br/>
&#160; &#160; &#160; &#160; description: This subtree contains monitoring/managing objects.<br/>
&#160; &#160; &#160; &#160; description: This object contains information about this server.<br/>
&#160; &#160; &#160; &#160; description: Most of the information is held in operational attributes, which<br/>
&#160; &#160; &#160; &#160; &#160;must be explicitly requested.<br/>
&#160; &#160; &#160; &#160; monitoredInfo: OpenLDAP: slapd 2.X (Dec &#160;7 2006 17:30:29)<br/>
To return the names of all the monitoring objects, one performs a search of&#160;cn=Monitor&#160;with subtree scope<br/>and&#160;(objectClass=*)&#160;filter and requesting no attributes (e.g.,&#160;1.1) be returned.<br/>
&#160; &#160; &#160; &#160; ldapsearch -x -D 'cn=Manager,dc=example,dc=com' -W -b 'cn=Monitor' -s sub 1.1<br/>
If you run this command you will discover that there are many objects in the<i>&#160;cn=Monitor</i>&#160;subtree. The<br/>following section describes some of the commonly available monitoring objects.<br/>
<b>20.4. Monitor Information</b><br/>
The<i>&#160;monitor</i>&#160;backend provides a wealth of information useful for monitoring the slapd(8) contained in set of<br/>monitor objects. Each object contains information about a particular aspect of the server, such as a backends, a<br/>connection, or a thread. Some objects serve as containers for other objects and used to construct a hierarchy of<br/>objects.<br/>
In this hierarchy, the most superior object is {cn=Monitor}. While this object primarily serves as a container<br/>for other objects, most of which are containers, this object provides information about this server. In<br/>particular, it provides the slapd(8) version string. Example:<br/>
&#160; &#160; &#160; &#160; dn: cn=Monitor<br/>
&#160; &#160; &#160; &#160; monitoredInfo: OpenLDAP: slapd 2.X (Dec &#160;7 2006 17:30:29)<br/>
<b>Note:</b>&#160;Examples in this section (and its subsections) have been trimmed to show only key information.<br/>
189<br/>
<hr/>
<a name=204></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
<b>20.4.1. Backends</b><br/>
The&#160;cn=Backends,cn=Monitor&#160;object, itself, provides a list of available backends. The list of available<br/>backends all builtin backends, as well as backends loaded by modules. For example:<br/>
&#160; &#160; &#160; &#160; dn: cn=Backends,cn=Monitor<br/>
&#160; &#160; &#160; &#160; monitoredInfo: config<br/>
&#160; &#160; &#160; &#160; monitoredInfo: ldif<br/>
&#160; &#160; &#160; &#160; monitoredInfo: monitor<br/>
&#160; &#160; &#160; &#160; monitoredInfo: bdb<br/>
&#160; &#160; &#160; &#160; monitoredInfo: hdb<br/>
This indicates the<i>&#160;config</i>,<i>&#160;ldif</i>,<i>&#160;monitor</i>,<i>&#160;bdb</i>, and<i>&#160;hdb</i>&#160;backends are available.<br/>
The&#160;cn=Backends,cn=Monitor&#160;object is also a container for available backend objects. Each available<br/>backend object contains information about a particular backend. For example:<br/>
&#160; &#160; &#160; &#160; dn: cn=Backend 0,cn=Backends,cn=Monitor<br/>
&#160; &#160; &#160; &#160; monitoredInfo: config<br/>
&#160; &#160; &#160; &#160; monitorRuntimeConfig: TRUE<br/>
&#160; &#160; &#160; &#160; supportedControl: 2.16.840.1.113730.3.4.2<br/>
&#160; &#160; &#160; &#160; seeAlso: cn=Database 0,cn=Databases,cn=Monitor<br/>
&#160; &#160; &#160; &#160; dn: cn=Backend 1,cn=Backends,cn=Monitor<br/>
&#160; &#160; &#160; &#160; monitoredInfo: ldif<br/>
&#160; &#160; &#160; &#160; monitorRuntimeConfig: TRUE<br/>
&#160; &#160; &#160; &#160; supportedControl: 2.16.840.1.113730.3.4.2<br/>
&#160; &#160; &#160; &#160; dn: cn=Backend 2,cn=Backends,cn=Monitor<br/>
&#160; &#160; &#160; &#160; monitoredInfo: monitor<br/>
&#160; &#160; &#160; &#160; monitorRuntimeConfig: TRUE<br/>
&#160; &#160; &#160; &#160; supportedControl: 2.16.840.1.113730.3.4.2<br/>
&#160; &#160; &#160; &#160; seeAlso: cn=Database 2,cn=Databases,cn=Monitor<br/>
&#160; &#160; &#160; &#160; dn: cn=Backend 3,cn=Backends,cn=Monitor<br/>
&#160; &#160; &#160; &#160; monitoredInfo: bdb<br/>
&#160; &#160; &#160; &#160; monitorRuntimeConfig: TRUE<br/>
&#160; &#160; &#160; &#160; supportedControl: 1.3.6.1.1.12<br/>
&#160; &#160; &#160; &#160; supportedControl: 2.16.840.1.113730.3.4.2<br/>
&#160; &#160; &#160; &#160; supportedControl: 1.3.6.1.4.1.4203.666.5.2<br/>
&#160; &#160; &#160; &#160; supportedControl: 1.2.840.113556.1.4.319<br/>
&#160; &#160; &#160; &#160; supportedControl: 1.3.6.1.1.13.1<br/>
&#160; &#160; &#160; &#160; supportedControl: 1.3.6.1.1.13.2<br/>
&#160; &#160; &#160; &#160; supportedControl: 1.3.6.1.4.1.4203.1.10.1<br/>
&#160; &#160; &#160; &#160; supportedControl: 1.2.840.113556.1.4.1413<br/>
&#160; &#160; &#160; &#160; supportedControl: 1.3.6.1.4.1.4203.666.11.7.2<br/>
&#160; &#160; &#160; &#160; seeAlso: cn=Database 1,cn=Databases,cn=Monitor<br/>
&#160; &#160; &#160; &#160; dn: cn=Backend 4,cn=Backends,cn=Monitor<br/>
&#160; &#160; &#160; &#160; monitoredInfo: hdb<br/>
&#160; &#160; &#160; &#160; monitorRuntimeConfig: TRUE<br/>
&#160; &#160; &#160; &#160; supportedControl: 1.3.6.1.1.12<br/>
&#160; &#160; &#160; &#160; supportedControl: 2.16.840.1.113730.3.4.2<br/>
&#160; &#160; &#160; &#160; supportedControl: 1.3.6.1.4.1.4203.666.5.2<br/>
&#160; &#160; &#160; &#160; supportedControl: 1.2.840.113556.1.4.319<br/>
&#160; &#160; &#160; &#160; supportedControl: 1.3.6.1.1.13.1<br/>
&#160; &#160; &#160; &#160; supportedControl: 1.3.6.1.1.13.2<br/>
&#160; &#160; &#160; &#160; supportedControl: 1.3.6.1.4.1.4203.1.10.1<br/>
&#160; &#160; &#160; &#160; supportedControl: 1.2.840.113556.1.4.1413<br/>
190<br/>
<hr/>
<a name=205></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
&#160; &#160; &#160; &#160; supportedControl: 1.3.6.1.4.1.4203.666.11.7.2<br/>
For each of these objects, monitorInfo indicates which backend the information in the object is about. For<br/>instance, the&#160;cn=Backend 3,cn=Backends,cn=Monitor&#160;object contains (in the example)<br/>information about the<i>&#160;bdb</i>&#160;backend.<br/>
<b>Attribute</b><br/>
<b>Description</b><br/>
monitoredInfo<br/>
Name of backend<br/>
supportedControl&#160;supported LDAP control extensions<br/>
seeAlso<br/>
Database objects of instances of this backend<br/>
<b>20.4.2. Connections</b><br/>
The main entry is empty; it should contain some statistics on the number of connections.<br/>
Dynamic child entries are created for each open connection, with stats on the activity on that connection (the<br/>format will be detailed later). There are two special child entries that show the number of total and current<br/>connections respectively.<br/>
For example:<br/>
Total Connections:<br/>
&#160; &#160;dn: cn=Total,cn=Connections,cn=Monitor<br/>
&#160; &#160;structuralObjectClass: monitorCounterObject<br/>
&#160; &#160;monitorCounter: 4<br/>
&#160; &#160;entryDN: cn=Total,cn=Connections,cn=Monitor<br/>
&#160; &#160;subschemaSubentry: cn=Subschema<br/>
&#160; &#160;hasSubordinates: FALSE<br/>
Current Connections:<br/>
&#160; &#160;dn: cn=Current,cn=Connections,cn=Monitor<br/>
&#160; &#160;structuralObjectClass: monitorCounterObject<br/>
&#160; &#160;monitorCounter: 2<br/>
&#160; &#160;entryDN: cn=Current,cn=Connections,cn=Monitor<br/>
&#160; &#160;subschemaSubentry: cn=Subschema<br/>
&#160; &#160;hasSubordinates: FALSE<br/>
<b>20.4.3. Databases</b><br/>
The main entry contains the naming context of each configured database; the child entries contain, for each<br/>database, the type and the naming context.<br/>
For example:<br/>
&#160; &#160;dn: cn=Database 2,cn=Databases,cn=Monitor<br/>
&#160; &#160;structuralObjectClass: monitoredObject<br/>
&#160; &#160;monitoredInfo: monitor<br/>
&#160; &#160;monitorIsShadow: FALSE<br/>
&#160; &#160;monitorContext: cn=Monitor<br/>
&#160; &#160;readOnly: FALSE<br/>
&#160; &#160;entryDN: cn=Database 2,cn=Databases,cn=Monitor<br/>
&#160; &#160;subschemaSubentry: cn=Subschema<br/>
191<br/>
<hr/>
<a name=206></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
&#160; &#160;hasSubordinates: FALSE<br/>
<b>20.4.4. Listener</b><br/>
It contains the description of the devices the server is currently listening on:<br/>
&#160; &#160;dn: cn=Listener 0,cn=Listeners,cn=Monitor<br/>
&#160; &#160;structuralObjectClass: monitoredObject<br/>
&#160; &#160;monitorConnectionLocalAddress: IP=0.0.0.0:389<br/>
&#160; &#160;entryDN: cn=Listener 0,cn=Listeners,cn=Monitor<br/>
&#160; &#160;subschemaSubentry: cn=Subschema<br/>
&#160; &#160;hasSubordinates: FALSE<br/>
<b>20.4.5. Log</b><br/>
It contains the currently active log items. The<i>&#160;Log</i>&#160;subsystem allows user modify operations on the<i>&#160;description<br/></i>attribute, whose values<i>&#160;MUST</i>&#160;be in the list of admittable log switches:<br/>
&#160; &#160;Trace<br/>
&#160; &#160;Packets<br/>
&#160; &#160;Args<br/>
&#160; &#160;Conns<br/>
&#160; &#160;BER<br/>
&#160; &#160;Filter<br/>
&#160; &#160;Config<br/>
&#160; &#160;ACL<br/>
&#160; &#160;Stats<br/>
&#160; &#160;Stats2<br/>
&#160; &#160;Shell<br/>
&#160; &#160;Parse<br/>
&#160; &#160;Sync<br/>
These values can be added, replaced or deleted; they affect what messages are sent to the syslog device.<br/>Custom values could be added by custom modules.<br/>
<b>20.4.6. Operations</b><br/>
It shows some statistics on the operations performed by the server:<br/>
&#160; &#160;Initiated<br/>
&#160; &#160;Completed<br/>
and for each operation type, i.e.:<br/>
&#160; &#160;Bind<br/>
&#160; &#160;Unbind<br/>
&#160; &#160;Add<br/>
&#160; &#160;Delete<br/>
&#160; &#160;Modrdn<br/>
&#160; &#160;Modify<br/>
&#160; &#160;Compare<br/>
&#160; &#160;Search<br/>
&#160; &#160;Abandon<br/>
&#160; &#160;Extended<br/>
192<br/>
<hr/>
<a name=207></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
<a href="">There are too many types to list example here, so please try for yourself using Monitor search example</a><br/>
<b>20.4.7. Overlays</b><br/>
The main entry contains the type of overlays available at run-time; the child entries, for each overlay, contain<br/>the type of the overlay.<br/>
It should also contain the modules that have been loaded if dynamic overlays are enabled:<br/>
&#160; &#160;# Overlays, Monitor<br/>
&#160; &#160;dn: cn=Overlays,cn=Monitor<br/>
&#160; &#160;structuralObjectClass: monitorContainer<br/>
&#160; &#160;monitoredInfo: syncprov<br/>
&#160; &#160;monitoredInfo: accesslog<br/>
&#160; &#160;monitoredInfo: glue<br/>
&#160; &#160;entryDN: cn=Overlays,cn=Monitor<br/>
&#160; &#160;subschemaSubentry: cn=Subschema<br/>
&#160; &#160;hasSubordinates: TRUE<br/>
<b>20.4.8. SASL</b><br/>
Currently empty.<br/>
<b>20.4.9. Statistics</b><br/>
It shows some statistics on the data sent by the server:<br/>
&#160; &#160;Bytes<br/>
&#160; &#160;PDU<br/>
&#160; &#160;Entries<br/>
&#160; &#160;Referrals<br/>
e.g.<br/>
&#160; &#160;# Entries, Statistics, Monitor<br/>
&#160; &#160;dn: cn=Entries,cn=Statistics,cn=Monitor<br/>
&#160; &#160;structuralObjectClass: monitorCounterObject<br/>
&#160; &#160;monitorCounter: 612248<br/>
&#160; &#160;entryDN: cn=Entries,cn=Statistics,cn=Monitor<br/>
&#160; &#160;subschemaSubentry: cn=Subschema<br/>
&#160; &#160;hasSubordinates: FALSE<br/>
<b>20.4.10. Threads</b><br/>
It contains the maximum number of threads enabled at startup and the current backload.<br/>
e.g.<br/>
&#160; &#160;# Max, Threads, Monitor<br/>
&#160; &#160;dn: cn=Max,cn=Threads,cn=Monitor<br/>
&#160; &#160;structuralObjectClass: monitoredObject<br/>
&#160; &#160;monitoredInfo: 16<br/>
&#160; &#160;entryDN: cn=Max,cn=Threads,cn=Monitor<br/>
&#160; &#160;subschemaSubentry: cn=Subschema<br/>
&#160; &#160;hasSubordinates: FALSE<br/>
193<br/>
<hr/>
<a name=208></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
<b>20.4.11. Time</b><br/>
It contains two child entries with the start time and the current time of the server.<br/>
e.g.<br/>
Start time:<br/>
&#160; &#160;dn: cn=Start,cn=Time,cn=Monitor<br/>
&#160; &#160;structuralObjectClass: monitoredObject<br/>
&#160; &#160;monitorTimestamp: 20061205124040Z<br/>
&#160; &#160;entryDN: cn=Start,cn=Time,cn=Monitor<br/>
&#160; &#160;subschemaSubentry: cn=Subschema<br/>
&#160; &#160;hasSubordinates: FALSE<br/>
Current time:<br/>
&#160; &#160;dn: cn=Current,cn=Time,cn=Monitor<br/>
&#160; &#160;structuralObjectClass: monitoredObject<br/>
&#160; &#160;monitorTimestamp: 20061207120624Z<br/>
&#160; &#160;entryDN: cn=Current,cn=Time,cn=Monitor<br/>
&#160; &#160;subschemaSubentry: cn=Subschema<br/>
&#160; &#160;hasSubordinates: FALSE<br/>
<b>20.4.12. TLS</b><br/>
Currently empty.<br/>
<b>20.4.13. Waiters</b><br/>
It contains the number of current read waiters.<br/>
e.g.<br/>
Read waiters:<br/>
&#160; &#160;dn: cn=Read,cn=Waiters,cn=Monitor<br/>
&#160; &#160;structuralObjectClass: monitorCounterObject<br/>
&#160; &#160;monitorCounter: 7<br/>
&#160; &#160;entryDN: cn=Read,cn=Waiters,cn=Monitor<br/>
&#160; &#160;subschemaSubentry: cn=Subschema<br/>
&#160; &#160;hasSubordinates: FALSE<br/>
Write waiters:<br/>
&#160; &#160;dn: cn=Write,cn=Waiters,cn=Monitor<br/>
&#160; &#160;structuralObjectClass: monitorCounterObject<br/>
&#160; &#160;monitorCounter: 0<br/>
&#160; &#160;entryDN: cn=Write,cn=Waiters,cn=Monitor<br/>
&#160; &#160;subschemaSubentry: cn=Subschema<br/>
&#160; &#160;hasSubordinates: FALSE<br/>
Add new monitored things here and discuss, referencing man pages and present examples<br/>
194<br/>
<hr/>
<a name=209></a><b>21. Tuning</b><br/>
This is perhaps one of the most important chapters in the guide, because if you have not tuned<i>&#160;slapd</i>(8)<br/>correctly or grasped how to design your directory and environment, you can expect very poor performance.<br/>
Reading, understanding and experimenting using the instructions and information in the following sections,<br/>will enable you to fully understand how to tailor your directory server to your specific requirements.<br/>
It should be noted that the following information has been collected over time from our community based<br/>FAQ. So obviously the benefit of this real world experience and advice should be of great value to the reader.<br/>
<b>21.1. Performance Factors</b><br/>
Various factors can play a part in how your directory performs on your chosen hardware and environment. We<br/>will attempt to discuss these here.<br/>
<b>21.1.1. Memory</b><br/>
Scale your cache to use available memory and increase system memory if you can.<br/>
<a href="OpenLDAP-Admin-Guides.html#211">See Caching for BDB cache tuning hints. Note that LMDB uses no cache of its own and has no tuning<br/></a>options, so the Caching section can be ignored when using LMDB.<br/>
<b>21.1.2. Disks</b><br/>
Use fast filesystems, and conduct your own testing to see which filesystem types perform best with your<br/>workload. (On our own Linux testing, EXT2 and JFS tend to provide better write performance than everything<br/>else, including newer filesystems like EXT4, BTRFS, etc.)<br/>
Use fast subsystems. Put each database and logs on separate disks (for BDB this is configurable via<br/><i>DB_CONFIG</i>):<br/>
&#160; &#160; &#160; &#160;# Data Directory<br/>
&#160; &#160; &#160; &#160;set_data_dir /data/db<br/>
&#160; &#160; &#160; &#160;# Transaction Log settings<br/>
&#160; &#160; &#160; &#160;set_lg_dir /logs<br/>
<b>21.1.3. Network Topology</b><br/>
http://www.openldap.org/faq/data/cache/363.html<br/>
Drawing here.<br/>
<b>21.1.4. Directory Layout Design</b><br/>
Reference to other sections and good/bad drawing here.<br/>
195<br/>
<hr/>
<a name=210></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
<b>21.1.5. Expected Usage</b><br/>
Discussion.<br/>
<b>21.2. Indexes</b><br/>
<b>21.2.1. Understanding how a search works</b><br/>
If you're searching on a filter that has been indexed, then the search reads the index and pulls exactly the<br/>entries that are referenced by the index. If the filter term has not been indexed, then the search must read every<br/>single entry in the target scope and test to see if each entry matches the filter. Obviously indexing can save a<br/>lot of work when it's used correctly.<br/>
<b>21.2.2. What to index</b><br/>
You should create indices to match the actual filter terms used in search queries.<br/>
&#160; &#160; &#160; &#160; index cn,sn,givenname,mail eq<br/>
Each attribute index can be tuned further by selecting the set of index types to generate. For example,<br/>substring and approximate search for organizations (o) may make little sense (and isn't like done very often).<br/>And searching for<i>&#160;userPassword</i>&#160;likely makes no sense what so ever.<br/>
General rule: don't go overboard with indexes. Unused indexes must be maintained and hence can only slow<br/>things down.<br/>
See<i>&#160;slapd.conf</i>(8) and<i>&#160;slapdindex</i>(8) for more information<br/>
<b>21.2.3. Presence indexing</b><br/>
If your client application uses presence filters and if the target attribute exists on the majority of entries in<br/>your target scope, then all of those entries are going to be read anyway, because they are valid members of the<br/>result set. In a subtree where 100% of the entries are going to contain the same attributes, the presence index<br/>does absolutely NOTHING to benefit the search, because 100% of the entries match that presence filter.<br/>
So the resource cost of generating the index is a complete waste of CPU time, disk, and memory. Don't do it<br/>unless you know that it will be used, and that the attribute in question occurs very infrequently in the target<br/>data.<br/>
Almost no applications use presence filters in their search queries. Presence indexing is pointless when the<br/>target attribute exists on the majority of entries in the database. In most LDAP deployments, presence<br/>indexing should not be done, it's just wasted overhead.<br/>
See the<i>&#160;Logging</i>&#160;section below on what to watch our for if you have a frequently searched for attribute that is<br/>unindexed.<br/>
<b>21.3. Logging</b><br/>
196<br/>
<hr/>
<a name=211></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
<b>21.3.1. What log level to use</b><br/>
The default of<i>&#160;loglevel stats</i>&#160;(256) is really the best bet. There's a corollary to this when problems *do* arise,<br/>don't try to trace them using syslog. Use the debug flag instead, and capture slapd's stderr output. syslog is too<br/>slow for debug tracing, and it's inherently lossy - it will throw away messages when it can't keep up.<br/>
Contrary to popular belief,<i>&#160;loglevel 0</i>&#160;is not ideal for production as you won't be able to track when problems<br/>first arise.<br/>
<b>21.3.2. What to watch out for</b><br/>
The most common message you'll see that you should pay attention to is:<br/>
&#160; &#160; &#160; &#160;&#34;&lt;= bdb_equality_candidates: (foo) index_param failed (18)&#34;<br/>
That means that some application tried to use an equality filter (<i>foo=&lt;somevalue&gt;</i>) and attribute<i>&#160;foo</i>&#160;does not<br/>have an equality index. If you see a lot of these messages, you should add the index. If you see one every<br/>month or so, it may be acceptable to ignore it.<br/>
The default syslog level is stats (256) which logs the basic parameters of each request; it usually produces 1-3<br/>lines of output. On Solaris and systems that only provide synchronous syslog, you may want to turn it off<br/>completely, but usually you want to leave it enabled so that you'll be able to see index messages whenever<br/>they arise. On Linux you can configure syslogd to run asynchronously, in which case the performance hit for<br/>moderate syslog traffic pretty much disappears.<br/>
<b>21.3.3. Improving throughput</b><br/>
You can improve logging performance on some systems by configuring syslog not to sync the file system<br/>with every write (<i>man syslogd/syslog.conf</i>). In Linux, you can prepend the log file name with a &#34;-&#34; in<br/><i>syslog.conf</i>. For example, if you are using the default LOCAL4 logging you could try:<br/>
&#160; &#160; &#160; &#160;# LDAP logs<br/>
&#160; &#160; &#160; &#160;LOCAL4.* &#160; &#160; &#160; &#160; -/var/log/ldap<br/>
For syslog-ng, add or modify the following line in<i>&#160;syslog-ng.conf</i>:<br/>
&#160; &#160; &#160; &#160;options { sync(n); };<br/>
where n is the number of lines which will be buffered before a write.<br/>
<b>21.4. Caching</b><br/>
We all know what caching is, don't we?<br/>
In brief, &#34;A cache is a block of memory for temporary storage of data likely to be used again&#34; -<br/><a href="http://en.wikipedia.org/wiki/Cache">http://en.wikipedia.org/wiki/Cache</a><br/>
There are 3 types of caches, BerkeleyDB's own cache,<i>&#160;slapd</i>(8) entry cache and IDL (IDL) cache.<br/>
197<br/>
<hr/>
<a name=212></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
<b>21.4.1. Berkeley DB Cache</b><br/>
There are two ways to tune for the BDB cachesize:<br/>
(a) BDB cache size necessary to load the database via slapadd in optimal time<br/>
(b) BDB cache size necessary to have a high performing running slapd once the data is loaded<br/>
For (a), the optimal cachesize is the size of the entire database. If you already have the database loaded, this is<br/>simply a<br/>
&#160; &#160; &#160; &#160;du -c -h *.bdb<br/>
in the directory containing the OpenLDAP (<i>/usr/local/var/openldap-data</i>) data.<br/>
For (b), the optimal cachesize is just the size of the<i>&#160;id2entry.bdb</i>&#160;file, plus about 10% for growth.<br/>
The tuning of<i>&#160;DB_CONFIG</i>&#160;should be done for each BDB type database instantiated (back-bdb, back-hdb).<br/>
Note that while the BDB cache is just raw chunks of memory and configured as a memory size, the<i>&#160;slapd</i>(8)<br/>entry cache holds parsed entries, and the size of each entry is variable.<br/>
There is also an IDL cache which is used for Index Data Lookups. If you can fit all of your database into<br/>slapd's entry cache, and all of your index lookups fit in the IDL cache, that will provide the maximum<br/>throughput.<br/>
If not, but you can fit the entire database into the BDB cache, then you should do that and shrink the slapd<br/>entry cache as appropriate.<br/>
Failing that, you should balance the BDB cache against the entry cache.<br/>
It is worth noting that it is not absolutely necessary to configure a BerkeleyDB cache equal in size to your<br/>entire database. All that you need is a cache that's large enough for your &#34;working set.&#34;<br/>
That means, large enough to hold all of the most frequently accessed data, plus a few less-frequently accessed<br/>items.<br/>
For more information, please see:<br/><a href="http://www.oracle.com/technology/documentation/berkeley-db/db/ref/am_conf/cachesize.html">http://www.oracle.com/technology/documentation/berkeley-db/db/ref/am_conf/cachesize.html</a><br/>
<b>21.4.1.1. Calculating Cachesize</b><br/>
The back-bdb database lives in two main files,&#160;dn2id.bdb&#160;and&#160;id2entry.bdb. These are B-tree<br/>databases. We have never documented the back-bdb internal layout before, because it didn't seem like<br/>something anyone should have to worry about, nor was it necessarily cast in stone. But here's how it works<br/>today, in OpenLDAP 2.4.<br/>
A B-tree is a balanced tree; it stores data in its leaf nodes and bookkeeping data in its interior nodes (If you<br/>don't know what tree data structures look like in general, Google for some references, because that's getting<br/>far too elementary for the purposes of this discussion).<br/>
198<br/>
<hr/>
<a name=213></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
For decent performance, you need enough cache memory to contain all the nodes along the path from the root<br/>of the tree down to the particular data item you're accessing. That's enough cache for a single search. For the<br/>general case, you want enough cache to contain all the internal nodes in the database.<br/>
&#160; &#160; &#160; &#160;db_stat -d<br/>
will tell you how many internal pages are present in a database. You should check this number for both dn2id<br/>and id2entry.<br/>
Also note that<i>&#160;id2entry</i>&#160;always uses 16KB per &#34;page&#34;, while<i>&#160;dn2id</i>&#160;uses whatever the underlying filesystem<br/>uses, typically 4 or 8KB. To avoid thrashing, your cache must be at least as large as the number of internal<br/>pages in both the<i>&#160;dn2id</i>&#160;and<i>&#160;id2entry</i>&#160;databases, plus some extra space to accommodate the actual leaf data<br/>pages.<br/>
For example, in my OpenLDAP 2.4 test database, I have an input LDIF file that's about 360MB. With the<br/>back-hdb backend this creates a<i>&#160;dn2id.bdb</i>&#160;that's 68MB, and an<i>&#160;id2entry</i>&#160;that's 800MB. db_stat tells me that<br/><i>dn2id</i>&#160;uses 4KB pages, has 433 internal pages, and 6378 leaf pages. The id2entry uses 16KB pages, has 52<br/>internal pages, and 45912 leaf pages. In order to efficiently retrieve any single entry in this database, the cache<br/>should be at least<br/>
&#160; &#160; &#160; &#160;(433+1) * 4KB + (52+1) * 16KB in size: 1736KB + 848KB =~ 2.5MB.<br/>
This doesn't take into account other library overhead, so this is even lower than the barest minimum. The<br/>default cache size, when nothing is configured, is only 256KB.<br/>
This 2.5MB number also doesn't take indexing into account. Each indexed attribute results in another database<br/>file. Earlier versions of OpenLDAP kept these index databases in Hash format, but from OpenLDAP 2.2<br/>onward the index databases are in B-tree format so the same procedure can be used to calculate the necessary<br/>amount of cache for each index database.<br/>
For example, if your only index is for the objectClass attribute and db_stat reveals that<i>&#160;objectClass.bdb</i>&#160;has<br/>339 internal pages and uses 4096 byte pages, the additional cache needed for just this attribute index is<br/>
&#160; &#160; &#160; &#160;(339+1) * 4KB =~ 1.3MB.<br/>
With only this index enabled, I'd figure at least a 4MB cache for this backend. (Of course you're using a single<br/>cache shared among all of the database files, so the cache pages will most likely get used for something other<br/>than what you accounted for, but this gives you a fighting chance.)<br/>
With this 4MB cache I can slapcat this entire database on my 1.3GHz PIII in 1 minute, 40 seconds. With the<br/>cache doubled to 8MB, it still takes the same 1:40s. Once you've got enough cache to fit the B-tree internal<br/>pages, increasing it further won't have any effect until the cache really is large enough to hold 100% of the<br/>data pages. I don't have enough free RAM to hold all the 800MB id2entry data, so 4MB is good enough.<br/>
With back-bdb and back-hdb you can use &#34;db_stat -m&#34; to check how well the database cache is performing.<br/>
For more information on<i>&#160;db_stat</i>:<br/><a href="http://www.oracle.com/technology/documentation/berkeley-db/db/utility/db_stat.html">http://www.oracle.com/technology/documentation/berkeley-db/db/utility/db_stat.html</a><br/>
199<br/>
<hr/>
<a name=214></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
<b>21.4.2.<i>&#160;slapd</i></b><b>(8) Entry Cache (cachesize)</b><br/>
The<i>&#160;slapd</i>(8) entry cache operates on decoded entries. The rationale - entries in the entry cache can be used<br/>directly, giving the fastest response. If an entry isn't in the entry cache but can be extracted from the BDB<br/>page cache, that will avoid an I/O but it will still require parsing, so this will be slower.<br/>
If the entry is in neither cache then BDB will have to flush some of its current cached pages and bring in the<br/>needed pages, resulting in a couple of expensive I/Os as well as parsing.<br/>
The most optimal value is of course, the entire number of entries in the database. However, most directory<br/>servers don't consistently serve out their entire database, so setting this to a lesser number that more closely<br/>matches the believed working set of data is sufficient. This is the second most important parameter for the<br/>DB.<br/>
As far as balancing the entry cache vs the BDB cache - parsed entries in memory are generally about twice as<br/>large as they are on disk.<br/>
As we have already mentioned, not having a proper database cache size will cause performance issues. These<br/>issues are not an indication of corruption occurring in the database. It is merely the fact that the cache is<br/>thrashing itself that causes performance/response time to slowdown.<br/>
<b>21.4.3. IDL Cache (idlcachesize)</b><br/>
Each IDL holds the search results from a given query, so the IDL cache will end up holding the most<br/>frequently requested search results. For back-bdb, it is generally recommended to match the &#34;cachesize&#34;<br/>setting. For back-hdb, it is generally recommended to be 3x&#34;cachesize&#34;.<br/>
{NOTE: The idlcachesize setting directly affects search performance}<br/>
<b>21.5.<i>&#160;slapd</i></b><b>(8) Threads</b><br/>
<i>slapd</i>(8) can process requests via a configurable number of threads, which in turn affects the in/out rate of<br/>connections.<br/>
This value should generally be a function of the number of &#34;real&#34; cores on the system, for example on a server<br/>with 2 CPUs with one core each, set this to 8, or 4 threads per real core. This is a &#34;read&#34; maximized value.<br/>The more threads that are configured per core, the slower<i>&#160;slapd</i>(8) responds for &#34;read&#34; operations. On the flip<br/>side, it appears to handle write operations faster in a heavy write/low read scenario.<br/>
The upper bound for good read performance appears to be 16 threads (which also happens to be the default<br/>setting).<br/>
200<br/>
<hr/>
<a name=215></a><b>22. Troubleshooting</b><br/>
If you're having trouble using OpenLDAP, get onto the OpenLDAP-Software mailing list, or:<br/>
<a href="http://www.openldap.org/lists/#archives">Browse the list archives at http://www.openldap.org/lists/#archives</a><br/>
&#160;<br/>
<a href="http://www.openldap.org/faq/">Search the FAQ at http://www.openldap.org/faq/</a><br/>
&#160;<br/>
<a href="http://www.openldap.org/its/">Search the Issue Tracking System at http://www.openldap.org/its/</a><br/>
&#160;<br/>
Chances are the problem has been solved and explained in detail many times before.<br/>
<b>22.1. User or Software errors?</b><br/>
More often than not, an error is caused by a configuration problem or a misunderstanding of what you are<br/>trying to implement and/or achieve.<br/>
We will now attempt to discuss common user errors.<br/>
<b>22.2. Checklist</b><br/>
The following checklist can help track down your problem. Please try to use if<b>&#160;before</b>&#160;posting to the list, or in<br/>the rare circumstances of reporting a bug.<br/>
<b>Use the</b><br/>
1.&#160;<br/>
<i><b>&#160;slaptest</b></i><b>&#160;tool to verify configurations before starting<i>&#160;slapd</i></b><br/>
<b>Verify that</b><br/>
2.&#160;<br/>
<i><b>&#160;slapd</b></i><b>&#160;is listening to the specified port(s) (389 and 636, generally) before trying the</b><br/>
<i><b>ldapsearch</b></i><br/>
<b>Can you issue an</b><br/>
3.&#160;<br/>
<i><b>&#160;ldapsearch</b></i><b>?</b><br/>
<b>If not, have you enabled complex ACLs without fully understanding them?</b><br/>
4.&#160;<br/>
<b>Do you have a system wide LDAP setting pointing to the wrong LDAP Directory?</b><br/>
5.&#160;<br/>
<b>Are you using TLS?</b><br/>
6.&#160;<br/>
<b>Have your certificates expired?</b><br/>
7.&#160;<br/>
<b>22.3. OpenLDAP Bugs</b><br/>
Sometimes you may encounter an actual OpenLDAP bug, in which case please visit our Issue Tracking<br/><a href="http://www.openldap.org/its/">system http://www.openldap.org/its/ and report it. However, make sure it's not already a known bug or a<br/></a>common user problem.<br/>
bugs in historic versions of OpenLDAP will not be considered;<br/>
&#160;<br/>
bugs in released versions that are no longer present in the Git master branch, either because they have<br/>
&#160;<br/>
been fixed or because they no longer apply, will not be considered as well;<br/>
201<br/>
<hr/>
<a name=216></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
bugs in distributions of OpenLDAP software that are not related to the software as provided by<br/>
&#160;<br/>
OpenLDAP will not be considered; in those cases please refer to the distributor.<br/>
<b>Note:</b>&#160;Our Issue Tracking system is<b>&#160;NOT</b>&#160;for OpenLDAP<b>&#160;Support</b>, please join our mailing Lists:<br/><a href="http://www.openldap.org/lists/">http://www.openldap.org/lists/ for that.</a><br/>
The information you should provide in your bug report is discussed in our FAQ-O-MATIC at<br/><a href="http://www.openldap.org/faq/data/cache/59.html">http://www.openldap.org/faq/data/cache/59.html</a><br/>
<b>22.4. 3rd party software error</b><br/>
The OpenLDAP Project only supports OpenLDAP software.<br/>
<a href="http://www.openldap.org/support/">You may however seek commercial support (http://www.openldap.org/support/) or join the general LDAP<br/></a>forum for non-commercial discussions and information relating to LDAP at:<br/><a href="http://www.umich.edu/~dirsvcs/ldap/mailinglist.html">http://www.umich.edu/~dirsvcs/ldap/mailinglist.html</a><br/>
<b>22.5. How to contact the OpenLDAP Project</b><br/>
<a href="http://www.openldap.org/lists/">Mailing Lists: http://www.openldap.org/lists/</a><br/>
&#160;<br/>
<a href="http://www.openldap.org/project/">Project: http://www.openldap.org/project/</a><br/>
&#160;<br/>
<a href="http://www.openldap.org/its/">Issue Tracking: http://www.openldap.org/its/</a><br/>
&#160;<br/>
<b>22.6. How to present your problem</b><br/>
<b>22.7. Debugging<i>&#160;slapd</i></b><b>(8)</b><br/>
After reading through the above sections and before e-mailing the OpenLDAP lists, you might want to try out<br/>some of the following to track down the cause of your problems:<br/>
Loglevel stats (256) is generally a good first loglevel to try for getting information useful to list<br/>
&#160;<br/>
members on issues<br/>Running<br/>
&#160;<br/>
<i>&#160;slapd -d -1</i>&#160;can often track down fairly simple issues, such as missing schemas and incorrect<br/>
file permissions for the<i>&#160;slapd</i>&#160;user to things like certs<br/><a href="http://www.openldap.org/faq/data/cache/358.html">Check your logs for errors, as discussed at http://www.openldap.org/faq/data/cache/358.html</a><br/>
&#160;<br/>
<b>22.8. Commercial Support</b><br/>
<a href="http://www.openldap.org/support/">The firms listed at http://www.openldap.org/support/ offer technical support services catering to OpenLDAP<br/></a>community.<br/>
The listing of any given firm should not be viewed as an endorsement or recommendation of any kind, nor as<br/>otherwise indicating there exists a business relationship or an affiliation between any listed firm and the<br/>OpenLDAP Foundation or the OpenLDAP Project or its contributors.<br/>
202<br/>
<hr/>
<a name=217></a><b>A. Changes Since Previous Release</b><br/>
The following sections attempt to summarize the new features and changes in OpenLDAP software since the<br/>2.3.x release and the OpenLDAP Admin Guide.<br/>
<b>A.1. New Guide Sections</b><br/>
In order to make the Admin Guide more thorough and cover the majority of questions asked on the<br/>OpenLDAP mailing lists and scenarios discussed there, we have added the following new sections:<br/>
<a href="OpenLDAP-Admin-Guides.html#20">When should I use LDAP?</a><br/>
&#160;<br/>
<a href="OpenLDAP-Admin-Guides.html#20">When should I not use LDAP?</a><br/>
&#160;<br/>
<a href="OpenLDAP-Admin-Guides.html#21">LDAP vs RDBMS</a><br/>
&#160;<br/>
<a href="OpenLDAP-Admin-Guides.html#71">Access Control</a><br/>
&#160;<br/>
<a href="OpenLDAP-Admin-Guides.html#204">Backends</a><br/>
&#160;<br/>
<a href="OpenLDAP-Admin-Guides.html#239">Overlays</a><br/>
&#160;<br/>
<a href="OpenLDAP-Admin-Guides.html#177">Replication</a><br/>
&#160;<br/>
<a href="OpenLDAP-Admin-Guides.html#197">Maintenance</a><br/>
&#160;<br/>
<a href="OpenLDAP-Admin-Guides.html#201">Monitoring</a><br/>
&#160;<br/>
<a href="OpenLDAP-Admin-Guides.html#209">Tuning</a><br/>
&#160;<br/>
<a href="OpenLDAP-Admin-Guides.html#215">Troubleshooting</a><br/>
&#160;<br/>
<a href="OpenLDAP-Admin-Guides.html#217">Changes Since Previous Release</a><br/>
&#160;<br/>
<a href="OpenLDAP-Admin-Guides.html#221">Upgrading from 2.3.x</a><br/>
&#160;<br/>
<a href="OpenLDAP-Admin-Guides.html#223">Common errors encountered when using OpenLDAP Software</a><br/>
&#160;<br/>
<a href="OpenLDAP-Admin-Guides.html#235">Recommended OpenLDAP Software Dependency Versions</a><br/>
&#160;<br/>
<a href="OpenLDAP-Admin-Guides.html#237">Real World OpenLDAP Deployments and Examples</a><br/>
&#160;<br/>
<a href="OpenLDAP-Admin-Guides.html#239">OpenLDAP Software Contributions</a><br/>
&#160;<br/>
<a href="OpenLDAP-Admin-Guides.html#243">Configuration File Examples</a><br/>
&#160;<br/>
<a href="OpenLDAP-Admin-Guides.html#245">LDAP Result Codes</a><br/>
&#160;<br/>
<a href="OpenLDAP-Admin-Guides.html#251">Glossary</a><br/>
&#160;<br/>
Also, the table of contents is now 3 levels deep to ease navigation.<br/>
<b>A.2. New Features and Enhancements in 2.4</b><br/>
<b>A.2.1. Better cn=config functionality</b><br/>
There is a new slapd-config(5) manpage for the<b>&#160;cn=config</b>&#160;backend. The original design called for<br/>auto-renaming of config entries when you insert or delete entries with ordered names, but that was not<br/>implemented in 2.3. It is now in 2.4. This means, e.g., if you have<br/>
&#160; &#160;olcDatabase={1}bdb,cn=config<br/>
&#160; &#160;olcSuffix: dc=example,dc=com<br/>
and you want to add a new subordinate, now you can ldapadd:<br/>
&#160; &#160;olcDatabase={1}bdb,cn=config<br/>
&#160; &#160;olcSuffix: dc=foo,dc=example,dc=com<br/>
203<br/>
<hr/>
<a name=218></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
This will insert a new BDB database in slot 1 and bump all following databases down one, so the original<br/>BDB database will now be named:<br/>
&#160; &#160;olcDatabase={2}bdb,cn=config<br/>
&#160; &#160;olcSuffix: dc=example,dc=com<br/>
<b>A.2.2. Better cn=schema functionality</b><br/>
In 2.3 you were only able to add new schema elements, not delete or modify existing elements. In 2.4 you can<br/>modify schema at will. (Except for the hardcoded system schema, of course.)<br/>
<b>A.2.3. More sophisticated Syncrepl configurations</b><br/>
The original implementation of Syncrepl in OpenLDAP 2.2 was intended to support multiple consumers<br/>within the same database, but that feature never worked and was removed from OpenLDAP 2.3; you could<br/>only configure a single consumer in any database.<br/>
In 2.4 you can configure multiple consumers in a single database. The configuration possibilities here are<br/>quite complex and numerous. You can configure consumers over arbitrary subtrees of a database (disjoint or<br/>overlapping). Any portion of the database may in turn be provided to other consumers using the Syncprov<br/>overlay. The Syncprov overlay works with any number of consumers over a single database or over arbitrarily<br/>many glued databases.<br/>
<b>A.2.4. N-Way Multimaster Replication</b><br/>
As a consequence of the work to support multiple consumer contexts, the syncrepl system now supports full<br/>N-Way multimaster replication with entry-level conflict resolution. There are some important constraints, of<br/>course: In order to maintain consistent results across all servers, you must maintain tightly synchronized<br/>clocks across all participating servers (e.g., you must use NTP on all servers).<br/>
The entryCSNs used for replication now record timestamps with microsecond resolution, instead of just<br/>seconds. The delta-syncrepl code has not been updated to support multimaster usage yet, that will come later<br/>in the 2.4 cycle.<br/>
<b>A.2.5. Replicating<i>&#160;slapd</i></b><b>&#160;Configuration (syncrepl and cn=config)</b><br/>
Syncrepl was explicitly disabled on cn=config in 2.3. It is now fully supported in 2.4; you can use syncrepl to<br/>replicate an entire server configuration from one server to arbitrarily many other servers. It's possible to clone<br/>an entire running slapd using just a small (less than 10 lines) seed configuration, or you can just replicate the<br/>schema subtrees, etc. Tests 049 and 050 in the test suite provide working examples of these capabilities.<br/>
<b>A.2.6. Push-Mode Replication</b><br/>
In 2.3 you could configure syncrepl as a full push-mode replicator by using it in conjunction with a back-ldap<br/>pointed at the target server. But because the back-ldap database needs to have a suffix corresponding to the<br/>target's suffix, you could only configure one instance per slapd.<br/>
In 2.4 you can define a database to be &#34;hidden&#34;, which means that its suffix is ignored when checking for<br/>name collisions, and the database will never be used to answer requests received by the frontend. Using this<br/>&#34;hidden&#34; database feature allows you to configure multiple databases with the same suffix, allowing you to set<br/>
204<br/>
<hr/>
<a name=219></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
up multiple back-ldap instances for pushing replication of a single database to multiple targets. There may be<br/>other uses for hidden databases as well (e.g., using a syncrepl consumer to maintain a *local* mirror of a<br/>database on a separate filesystem).<br/>
<b>A.2.7. More extensive TLS configuration control</b><br/>
In 2.3, the TLS configuration in slapd was only used by the slapd listeners. For outbound connections used by<br/>e.g. back-ldap or syncrepl their TLS parameters came from the system's ldap.conf file.<br/>
In 2.4 all of these sessions inherit their settings from the main slapd configuration, but settings can be<br/>individually overridden on a per-config-item basis. This is particularly helpful if you use certificate-based<br/>authentication and need to use a different client certificate for different destinations.<br/>
<b>A.2.8. Performance enhancements</b><br/>
Too many to list. Some notable changes - ldapadd used to be a couple of orders of magnitude slower than<br/>&#34;slapadd -q&#34;. It's now at worst only about half the speed of slapadd -q. Some comparisons of all the 2.x<br/><a href="http://www.openldap.org/pub/hyc/scale2007.pdf">OpenLDAP releases are available at http://www.openldap.org/pub/hyc/scale2007.pdf</a><br/>
That compared 2.0.27, 2.1.30, 2.2.30, 2.3.33, and CVS HEAD). Toward the latter end of the &#34;Cached Search<br/>Performance&#34; chart it gets hard to see the difference because the run times are so small, but the new code is<br/>about 25% faster than 2.3, which was about 20% faster than 2.2, which was about 100% faster than 2.1, which<br/>was about 100% faster than 2.0, in that particular search scenario. That test basically searched a 1.3GB DB of<br/>380836 entries (all in the slapd entry cache) in under 1 second. i.e., on a 2.4GHz CPU with DDR400<br/>ECC/Registered RAM we can search over 500 thousand entries per second. The search was on an unindexed<br/>attribute using a filter that would not match any entry, forcing slapd to examine every entry in the DB, testing<br/>the filter for a match.<br/>
Essentially the slapd entry cache in back-bdb/back-hdb is so efficient the search processing time is almost<br/>invisible; the runtime is limited only by the memory bandwidth of the machine. (The search data rate<br/>corresponds to about 3.5GB/sec; the memory bandwidth on the machine is only about 4GB/sec due to ECC<br/>and register latency.)<br/>
<b>A.2.9. New overlays</b><br/>
slapo-constraint (Attribute value constraints)<br/>
&#160;<br/>
slapo-dds (Dynamic Directory Services, RFC 2589)<br/>
&#160;<br/>
slapo-memberof (reverse group membership maintenance)<br/>
&#160;<br/>
<b>A.2.10. New features in existing Overlays</b><br/>
slapo-pcache<br/>
&#160;<br/>
Inspection/Maintenance<br/>
&#160;<br/>
the cache database can be directly accessed via LDAP by adding a specific control to<br/>
&#160;<br/>
each LDAP request; a specific extended operation allows to consistently remove<br/>cached entries and entire cached queries<br/>
Hot Restart<br/>
&#160;<br/>
cached queries are saved on disk at shutdown, and reloaded if not expired yet at<br/>
&#160;<br/>
subsequent restart<br/>
slapo-rwm can safely interoperate with other overlays<br/>
&#160;<br/>
205<br/>
<hr/>
<a name=220></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
Dyngroup/Dynlist merge, plus security enhancements<br/>
&#160;<br/>
added dgIdentity support (draft-haripriya-dynamicgroup)<br/>
&#160;<br/>
<b>A.2.11. New features in slapd</b><br/>
monitoring of back-{b,h}db: cache fill-in, non-indexed searches,<br/>
&#160;<br/>
session tracking control (draft-wahl-ldap-session)<br/>
&#160;<br/>
subtree delete in back-sql (draft-armijo-ldap-treedelete)<br/>
&#160;<br/>
sorted values in multivalued attributes for faster matching<br/>
&#160;<br/>
lightweight dispatcher for greater throughput under heavy load and on multiprocessor machines. (33%<br/>
&#160;<br/>
faster than 2.3 on AMD quad-socket dual-core server.)<br/>
<b>A.2.12. New features in libldap</b><br/>
ldap_sync client API (LDAP Content Sync Operation, RFC 4533)<br/>
&#160;<br/>
<b>A.2.13. New clients, tools and tool enhancements</b><br/>
ldapexop for arbitrary extended operations<br/>
&#160;<br/>
Complete support of controls in request/response for all clients<br/>
&#160;<br/>
LDAP Client tools now honor SRV records<br/>
&#160;<br/>
<b>A.2.14. New build options</b><br/>
Support for building against GnuTLS<br/>
&#160;<br/>
<b>A.3. Obsolete Features Removed From 2.4</b><br/>
These features were strongly deprecated in 2.3 and removed in 2.4.<br/>
<b>A.3.1. Slurpd</b><br/>
<a href="OpenLDAP-Admin-Guides.html#177">Please read the Replication section as to why this is no longer in OpenLDAP</a><br/>
<b>A.3.2. back-ldbm</b><br/>
back-ldbm was both slow and unreliable. Its byzantine indexing code was prone to spontaneous corruption, as<br/>were the underlying database libraries that were commonly used (e.g. GDBM or NDBM). back-bdb and<br/>back-hdb are superior in every aspect, with simplified indexing to avoid index corruption, fine-grained<br/>locking for greater concurrency, hierarchical caching for greater performance, streamlined on-disk format for<br/>greater efficiency and portability, and full transaction support for greater reliability.<br/>
206<br/>
<hr/>
<a name=221></a><b>B. Upgrading from 2.3.x</b><br/>
The following sections attempt to document the steps you will need to take in order to upgrade from the latest<br/>2.3.x OpenLDAP version.<br/>
<a href="OpenLDAP-Admin-Guides.html#197">The normal upgrade procedure, as discussed in the Maintenance section, should of course still be followed<br/></a>prior to doing any of this.<br/>
<b>B.1. cn=config olc* attributes</b><br/>
Quite a few<i>&#160;olc*</i>&#160;attributes have now become obsolete, if you see in your logs entries like below, just remove<br/>them from the relevant ldif file.<br/>
&#160; &#160; &#160; &#160; &#160; &#160;olcReplicationInterval: value #0: &lt;olcReplicationInterval&gt; keyword is obsolete (ignored)<br/>
<b>B.2. ACLs: searches require privileges on the search base</b><br/>
Search operations now require &#34;search&#34; privileges on the &#34;entry&#34; pseudo-attribute of the search base. While<br/>upgrading from 2.3.x, make sure your ACLs grant such privileges to all desired search bases.<br/>
For example, assuming you have the following ACL:<br/>
&#160; &#160; &#160; &#160; &#160; &#160;access to dn.sub=&#34;ou=people,dc=example,dc=com&#34; by * search<br/>
Searches using a base of &#34;dc=example,dc=com&#34; will only be allowed if you add the following ACL:<br/>
&#160; &#160; &#160; &#160; &#160; &#160;access to dn.base=&#34;dc=example,dc=com&#34; attrs=entry by * search<br/>
<b>Note:</b>&#160;The<i>&#160;slapd.access</i>(5) man page states that this requirement was introduced with OpenLDAP 2.3.<br/>However, it is the default behavior only since 2.4.<br/>
ADD MORE HERE<br/>
207<br/>
<hr/>
<a name=222></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
208<br/>
<hr/>
<a name=223></a><b>C. Common errors encountered when using<br/>OpenLDAP Software</b><br/>
The following sections attempt to summarize the most common causes of LDAP errors when using<br/>OpenLDAP<br/>
<b>C.1. Common causes of LDAP errors</b><br/>
<b>C.1.1. ldap_*: Can't contact LDAP server</b><br/>
The<b>&#160;Can't contact LDAP server</b>&#160;error is usually returned when the LDAP server cannot be contacted. This<br/>may occur for many reasons:<br/>
the LDAP server is not running; this can be checked by running, for example,<br/>
&#160;<br/>
&#160; &#160; &#160; telnet &lt;host&gt; &lt;port&gt;<br/>
replacing<i>&#160;&lt;host&gt;</i>&#160;and<i>&#160;&lt;port&gt;</i>&#160;with the hostname and the port the server is supposed to listen on.<br/>
the client has not been instructed to contact a running server; with OpenLDAP command-line tools<br/>
&#160;<br/>
this is accomplished by providing the -H switch, whose argument is a valid LDAP url corresponding<br/>to the interface the server is supposed to be listening on.<br/>
<b>C.1.2. ldap_*: No such object</b><br/>
The<b>&#160;no such object</b>&#160;error is generally returned when the target DN of the operation cannot be located. This<br/>section details reasons common to all operations. You should also look for answers specific to the operation<br/>(as indicated in the error message).<br/>
The most common reason for this error is non-existence of the named object. First, check for typos.<br/>
Also note that, by default, a new directory server holds no objects (except for a few system entries). So, if you<br/>are setting up a new directory server and get this message, it may simply be that you have yet to add the object<br/>you are trying to locate.<br/>
The error commonly occurs because a DN was not specified and a default was not properly configured.<br/>
If you have a suffix specified in slapd.conf eg.<br/>
&#160; &#160; &#160; suffix &#34;dc=example,dc=com&#34;<br/>
You should use<br/>
&#160; &#160; &#160; ldapsearch -b 'dc=example,dc=com' '(cn=jane*)'<br/>
to tell it where to start the search.<br/>
The&#160;-b&#160;should be specified for all LDAP commands unless you have an<i>&#160;ldap.conf</i>(5) default configured.<br/>
209<br/>
<hr/>
<a name=224></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
See<i>&#160;ldapsearch</i>(1),<i>&#160;ldapmodify</i>(1)<br/>
Also,<i>&#160;slapadd</i>(8) and its ancillary programs are very strict about the syntax of the LDIF file.<br/>
Some liberties in the LDIF file may result in an apparently successful creation of the database, but accessing<br/>some parts of it may be difficult.<br/>
One known common error in database creation is putting a blank line before the first entry in the LDIF file.<br/><b>There must be no leading blank lines in the LDIF file.</b><br/>
It is generally recommended that<i>&#160;ldapadd</i>(1) be used instead of<i>&#160;slapadd</i>(8) when adding new entries your<br/>directory.<i>&#160;slapadd</i>(8) should be used to bulk load entries known to be valid.<br/>
Another cause of this message is a referral ({SECT:Constructing a Distributed Directory Service}}) entry to<br/>an unpopulated directory.<br/>
Either remove the referral, or add a single record with the referral base DN to the empty directory.<br/>
This error may also occur when slapd is unable to access the contents of its database because of file<br/>permission problems. For instance, on a Red Hat Linux system, slapd runs as user 'ldap'. When slapadd is run<br/>as root to create a database from scratch, the contents of&#160;/var/lib/ldap&#160;are created with user and group<br/>root and with permission 600, making the contents inaccessible to the slapd server.<br/>
<b>C.1.3. ldap_*: Can't chase referral</b><br/>
This is caused by the line<br/>
&#160; &#160; &#160; referral &#160; &#160; &#160; &#160;ldap://root.openldap.org<br/>
In&#160;slapd.conf, it was provided as an example for how to use referrals in the original file. However if your<br/>machine is not permanently connected to the Internet, it will fail to find the server, and hence produce an error<br/>message.<br/>
To resolve, just place a # in front of line and restart slapd or point it to an available ldap server.<br/>
See also:<i>&#160;ldapadd</i>(1),<i>&#160;ldapmodify</i>(1) and<i>&#160;slapd.conf</i>(5)<br/>
<b>C.1.4. ldap_*: server is unwilling to perform</b><br/>
slapd will return an unwilling to perform error if the backend holding the target entry does not support the<br/>given operation.<br/>
The password backend is only willing to perform searches. It will return an unwilling to perform error for all<br/>other operations.<br/>
The shell backend is configurable and may support a limited subset of operations. Check for other errors<br/>indicating a shortage of resources required by the directory server. i.e. you may have a full disk etc<br/>
210<br/>
<hr/>
<a name=225></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
<b>C.1.5. ldap_*: Insufficient access</b><br/>
This error occurs when server denies the operation due to insufficient access. This is usually caused by<br/>binding to a DN with insufficient privileges (or binding anonymously) to perform the operation.<br/>
You can bind as the rootdn/rootpw specified in<i>&#160;slapd.conf</i>(5) to gain full access. Otherwise, you must bind to<br/>an entry which has been granted the appropriate rights through access controls.<br/>
<b>C.1.6. ldap_*: Invalid DN syntax</b><br/>
The target (or other) DN of the operation is invalid. This implies that either the string representation of the DN<br/>is not in the required form, one of the types in the attribute value assertions is not defined, or one of the values<br/>in the attribute value assertions does not conform to the appropriate syntax.<br/>
<b>C.1.7. ldap_*: Referral hop limit exceeded</b><br/>
This error generally occurs when the client chases a referral which refers itself back to a server it already<br/>contacted. The server responds as it did before and the client loops. This loop is detected when the hop limit is<br/>exceeded.<br/>
This is most often caused through misconfiguration of the server's default referral. The default referral should<br/>not be itself:<br/>
<a href="">That is, on ldap://myldap/ the default referral should not be ldap://myldap/ (or any hostname/ip which is<br/></a>equivalent to myldap).<br/>
<b>C.1.8. ldap_*: operations error</b><br/>
In some versions of<i>&#160;slapd</i>(8),<i>&#160;operationsError</i>&#160;was returned instead of other.<br/>
<b>C.1.9. ldap_*: other error</b><br/>
The other result code indicates an internal error has occurred. While the additional information provided with<br/>the result code might provide some hint as to the problem, often one will need to consult the server's log files.<br/>
<b>C.1.10. ldap_add/modify: Invalid syntax</b><br/>
This error is reported when a value of an attribute does not conform to syntax restrictions. Additional<br/>information is commonly provided stating which value of which attribute was found to be invalid. Double<br/>check this value and other values (the server will only report the first error it finds).<br/>
Common causes include:<br/>
extraneous whitespace (especially trailing whitespace)<br/>
&#160;<br/>
improperly encoded characters (LDAPv3 uses UTF-8 encoded Unicode)<br/>
&#160;<br/>
empty values (few syntaxes allow empty values)<br/>
&#160;<br/>
For certain syntax, like OBJECT IDENTIFIER (OID), this error can indicate that the OID descriptor (a &#34;short<br/>name&#34;) provided is unrecognized. For instance, this error is returned if the<i>&#160;objectClass</i>&#160;value provided is<br/>unrecognized.<br/>
211<br/>
<hr/>
<a name=226></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
<b>C.1.11. ldap_add/modify: Object class violation</b><br/>
This error is returned with the entry to be added or the entry as modified violates the object class schema<br/>rules. Normally additional information is returned the error detailing the violation. Some of these are detailed<br/>below.<br/>
Violations related to the entry's attributes:<br/>
&#160; &#160; &#160; Attribute not allowed<br/>
A provided attribute is not allowed by the entry's object class(es).<br/>
&#160; &#160; &#160; Missing required attribute<br/>
An attribute required by the entry's object class(es) was not provided.<br/>
Violations related to the entry's class(es):<br/>
&#160; &#160; &#160; Entry has no objectClass attribute<br/>
The entry did not state which object classes it belonged to.<br/>
&#160; &#160; &#160; Unrecognized objectClass<br/>
One (or more) of the listed objectClass values is not recognized.<br/>
&#160; &#160; &#160; No structural object class provided<br/>
None of the listed objectClass values is structural.<br/>
&#160; &#160; &#160; Invalid structural object class chain<br/>
Two or more structural objectClass values are not in same structural object class chain.<br/>
&#160; &#160; &#160; Structural object class modification<br/>
Modify operation attempts to change the structural class of the entry.<br/>
&#160; &#160; &#160; Instanstantiation of abstract objectClass.<br/>
An abstract class is not subordinate to any listed structural or auxiliary class.<br/>
&#160; &#160; &#160; Invalid structural object class<br/>
Other structural object class problem.<br/>
&#160; &#160; &#160; No structuralObjectClass operational attribute<br/>
This is commonly returned when a shadow server is provided an entry which does not contain the<br/>structuralObjectClass operational attribute.<br/>
212<br/>
<hr/>
<a name=227></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
Note that the above error messages as well as the above answer assumes basic knowledge of LDAP/X.500<br/>schema.<br/>
<b>C.1.12. ldap_add: No such object</b><br/>
The &#34;ldap_add: No such object&#34; error is commonly returned if parent of the entry being added does not exist.<br/>Add the parent entry first...<br/>
For example, if you are adding &#34;cn=bob,dc=domain,dc=com&#34; and you get:<br/>
&#160; &#160; &#160; ldap_add: No such object<br/>
The entry &#34;dc=domain,dc=com&#34; likely doesn't exist. You can use ldapsearch to see if does exist:<br/>
&#160; &#160; &#160; ldapsearch -b 'dc=domain,dc=com' -s base '(objectclass=*)'<br/>
<a href="OpenLDAP-Admin-Guides.html#25">If it doesn't, add it. See A Quick-Start Guide for assistance.</a><br/>
<b>Note:</b>&#160;if the entry being added is the same as database suffix, it's parent isn't required. i.e.: if your suffix is<br/>&#34;dc=domain,dc=com&#34;, &#34;dc=com&#34; doesn't need to exist to add &#34;dc=domain,dc=com&#34;.<br/>
This error will also occur if you try to add any entry that the server is not configured to hold.<br/>
For example, if your database suffix is &#34;dc=domain,dc=com&#34; and you attempt to add &#34;dc=domain2,dc=com&#34;,<br/>&#34;dc=com&#34;, &#34;dc=domain,dc=org&#34;, &#34;o=domain,c=us&#34;, or an other DN in the &#34;dc=domain,dc=com&#34; subtree, the<br/>server will return a &#34;No such object&#34; (or referral) error.<br/>
<i>slapd</i>(8) will generally return &#34;no global superior knowledge&#34; as additional information indicating its return<br/>noSuchObject instead of a referral as the server is not configured with knowledge of a global superior server.<br/>
<b>C.1.13. ldap add: invalid structural object class chain</b><br/>
This particular error refers to the rule about STRUCTURAL objectclasses, which states that an object is of<br/>one STRUCTURAL class, the structural class of the object. The object is said to belong to this class, zero or<br/>more auxiliaries classes, and their super classes.<br/>
While all of these classes are commonly listed in the objectClass attribute of the entry, one of these classes is<br/>the structural object class of the entry. Thus, it is OK for an objectClass attribute to contain inetOrgPerson,<br/>organizationalPerson, and person because they inherit one from another to form a single super class chain.<br/>That is, inetOrgPerson SUPs organizationPerson SUPs person. On the other hand, it is invalid for both<br/>inetOrgPerson and account to be listed in objectClass as inetOrgPerson and account are not part of the same<br/>super class chain (unless some other class is also listed with is a subclass of both).<br/>
To resolve this problem, one must determine which class will better serve structural object class for the entry,<br/>adding this class to the objectClass attribute (if not already present), and remove any other structural class<br/>from the entry's objectClass attribute which is not a super class of the structural object class.<br/>
Which object class is better depends on the particulars of the situation. One generally should consult the<br/>documentation for the applications one is using for help in making the determination.<br/>
213<br/>
<hr/>
<a name=228></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
<b>C.1.14. ldap_add: no structuralObjectClass operational attribute</b><br/>
ldapadd(1) may error:<br/>
&#160; &#160; &#160; adding new entry &#34;uid=XXX,ou=People,o=campus,c=ru&#34;<br/>
&#160; &#160; &#160; &#160; ldap_add: Internal (implementation specific) error (80)<br/>
&#160; &#160; &#160; &#160; &#160; &#160;additional info: no structuralObjectClass operational attribute<br/>
when slapd(8) cannot determine, based upon the contents of the objectClass attribute, what the structural class<br/>of the object should be.<br/>
<b>C.1.15. ldap_add/modify/rename: Naming violation</b><br/>
OpenLDAP's slapd checks for naming attributes and distinguished values consistency, according to RFC<br/>4512.<br/>
Naming attributes are those attributeTypes that appear in an entry's RDN; distinguished values are the values<br/>of the naming attributes that appear in an entry's RDN, e.g, in<br/>
&#160; &#160; &#160; cn=Someone+mail=someone@example.com,dc=example,dc=com<br/>
the naming attributes are cn and mail, and the distinguished values are Someone and someone@example.com.<br/>
OpenLDAP's slapd checks for consistency when:<br/>
adding an entry<br/>
&#160;<br/>
modifying an entry, if the values of the naming attributes are changed<br/>
&#160;<br/>
renaming an entry, if the RDN of the entry changes<br/>
&#160;<br/>
Possible causes of error are:<br/>
the naming attributes are not present in the entry; for example:<br/>
&#160;<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; dn: dc=example,dc=com<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; objectClass: organization<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; o: Example<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; # note: &#34;dc: example&#34; is missing<br/>
the naming attributes are present in the entry, but in the attributeType definition they are marked as:<br/>
&#160;<br/>
collective<br/>
&#160;<br/>
operational<br/>
&#160;<br/>
obsolete<br/>
&#160;<br/>
the naming attributes are present in the entry, but the distinguished values are not; for example:<br/>
&#160;<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; dn: dc=example,dc=com<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; objectClass: domain<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; dc: foobar<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; # note: &#34;dc&#34; is present, but the value is not &#34;example&#34;<br/>
the naming attributes are present in the entry, with the distinguished values, but the naming attributes:<br/>
&#160;<br/>
do not have an equality field, so equality cannot be asserted<br/>
&#160;<br/>
the matching rule is not supported (yet)<br/>
&#160;<br/>
214<br/>
<hr/>
<a name=229></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
the matching rule is not appropriate<br/>
&#160;<br/>
the given distinguished values do not comply with their syntax<br/>
&#160;<br/>
other errors occurred during the validation/normalization/match process; this is a catchall: look at<br/>
&#160;<br/>
previous logs for details in case none of the above apply to your case.<br/>
In any case, make sure that the attributeType definition for the naming attributes contains an appropriate<br/>EQUALITY field; or that of the superior, if they are defined based on a superior attributeType (look at the<br/>SUP field). See RFC 4512 for details.<br/>
<b>C.1.16. ldap_add/delete/modify/rename: no global superior knowledge</b><br/>
If the target entry name places is not within any of the databases the server is configured to hold and the<br/>server has no knowledge of a global superior, the server will indicate it is unwilling to perform the operation<br/>and provide the text &#34;no global superior knowledge&#34; as additional text.<br/>
Likely the entry name is incorrect, or the server is not properly configured to hold the named entry, or, in<br/>distributed directory environments, a default referral was not configured.<br/>
<b>C.1.17. ldap_bind: Insufficient access</b><br/>
Current versions of slapd(8) requires that clients have authentication permission to attribute types used for<br/>authentication purposes before accessing them to perform the bind operation. As all bind operations are done<br/>anonymously (regardless of previous bind success), the auth access must be granted to anonymous.<br/>
In the example ACL below grants the following access:<br/>
to anonymous users:<br/>
&#160;<br/>
permission to authenticate using values of userPassword<br/>
&#160;<br/>
to authenticated users:<br/>
&#160;<br/>
permission to update (but not read) their userPassword<br/>
&#160;<br/>
permission to read any object excepting values of userPassword<br/>
&#160;<br/>
All other access is denied.<br/>
&#160; &#160; &#160; &#160; access to attr=userPassword<br/>
&#160; &#160; &#160; &#160; &#160; by self =w<br/>
&#160; &#160; &#160; &#160; &#160; by anonymous auth<br/>
&#160; &#160; &#160; &#160; access *<br/>
&#160; &#160; &#160; &#160; &#160; by self write<br/>
&#160; &#160; &#160; &#160; &#160; by users read<br/>
<b>C.1.18. ldap_bind: Invalid credentials</b><br/>
The error usually occurs when the credentials (password) provided does not match the userPassword held in<br/>entry you are binding to.<br/>
The error can also occur when the bind DN specified is not known to the server.<br/>
Check both! In addition to the cases mentioned above you should check if the server denied access to<br/>userPassword on selected parts of the directory. In fact, slapd always returns &#34;Invalid credentials&#34; in case of<br/>failed bind, regardless of the failure reason, since other return codes could reveal the validity of the user's<br/>
215<br/>
<hr/>
<a name=230></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
name.<br/>
To debug access rules defined in slapd.conf, add &#34;ACL&#34; to log level.<br/>
<b>C.1.19. ldap_bind: Protocol error</b><br/>
There error is generally occurs when the LDAP version requested by the client is not supported by the server.<br/>
The OpenLDAP Software 2.x server, by default, only accepts version 3 LDAP Bind requests but can be<br/>configured to accept a version 2 LDAP Bind request.<br/>
<b>Note:</b>&#160;The 2.x server expects LDAPv3 [RFC4510] to be used when the client requests version 3 and expects a<br/>limited LDAPv3 variant (basically, LDAPv3 syntax and semantics in an LDAPv2 PDUs) to be used when<br/>version 2 is expected.<br/>
This variant is also sometimes referred to as LDAPv2+, but differs from the U-Mich LDAP variant in a<br/>number of ways.<br/>
<b>C.1.20. ldap_modify: cannot modify object class</b><br/>
This message is commonly returned when attempting to modify the objectClass attribute in a manner<br/>inconsistent with the LDAP/X.500 information model. In particular, it commonly occurs when one tries to<br/>change the structure of the object from one class to another, for instance, trying to change an 'apple' into a<br/>'pear' or a 'fruit' into a 'pear'.<br/>
Such changes are disallowed by the slapd(8) in accordance with LDAP and X.500 restrictions.<br/>
<b>C.1.21. ldap_sasl_interactive_bind_s: ...</b><br/>
If you intended to bind using a DN and password and get an error from ldap_sasl_interactive_bind_s, you<br/>likely forgot to provide a '-x' option to the command. By default, SASL authentication is used. '-x' is necessary<br/>to select &#34;simple&#34; authentication.<br/>
<b>C.1.22. ldap_sasl_interactive_bind_s: No such Object</b><br/>
This indicates that LDAP SASL authentication function could not read the Root DSE. The error will occur<br/>when the server doesn't provide a root DSE. This may be due to access controls.<br/>
<b>C.1.23. ldap_sasl_interactive_bind_s: No such attribute</b><br/>
This indicates that LDAP SASL authentication function could read the Root DSE but it contained no<br/>supportedSASLMechanism attribute.<br/>
The supportedSASLmechanism attribute lists mechanisms currently available. The list may be empty because<br/>none of the supported mechanisms are currently available. For example, EXTERNAL is listed only if the<br/>client has established its identity by authenticating at a lower level (e.g. TLS).<br/>
<b>Note:</b>&#160;the attribute may not be visible due to access controls<br/>
216<br/>
<hr/>
<a name=231></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
<b>Note:</b>&#160;SASL bind is the default for all OpenLDAP tools, e.g. ldapsearch(1), ldapmodify(1). To force use of<br/>&#34;simple&#34; bind, use the &#34;-x&#34; option. Use of &#34;simple&#34; bind is not recommended unless one has adequate<br/>confidentiality protection in place (e.g. TLS/SSL, IPSEC).<br/>
<b>C.1.24. ldap_sasl_interactive_bind_s: Unknown authentication method</b><br/>
This indicates that none of the SASL authentication supported by the server are supported by the client, or that<br/>they are too weak or otherwise inappropriate for use by the client. Note that the default security options<br/>disallows the use of certain mechanisms such as ANONYMOUS and PLAIN (without TLS).<br/>
<b>Note:</b>&#160;SASL bind is the default for all OpenLDAP tools. To force use of &#34;simple&#34; bind, use the &#34;-x&#34; option.<br/>Use of &#34;simple&#34; bind is not recommended unless one has adequate confidentiality protection in place (e.g.<br/>TLS/SSL, IPSEC).<br/>
<b>C.1.25. ldap_sasl_interactive_bind_s: Local error (82)</b><br/>
Apparently not having forward and reverse DNS entries for the LDAP server can result in this error.<br/>
<b>C.1.26. ldap_search: Partial results and referral received</b><br/>
This error is returned with the server responses to an LDAPv2 search query with both results (zero or more<br/>matched entries) and references (referrals to other servers). See also: ldapsearch(1).<br/>
If the updatedn on the replica does not exist, a referral will be returned. It may do this as well if the ACL<br/>needs tweaking.<br/>
<b>C.1.27. ldap_start_tls: Operations error</b><br/>
ldapsearch(1) and other tools will return<br/>
&#160; &#160; &#160; &#160; ldap_start_tls: Operations error (1)<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; additional info: TLS already started<br/>
When the user (though command line options and/or ldap.conf(5)) has requested TLS (SSL) be started twice.<br/>For instance, when specifying both &#34;-H ldaps://server.do.main&#34; and &#34;-ZZ&#34;.<br/>
<b>C.2. Other Errors</b><br/>
<b>C.2.1. ber_get_next on fd X failed errno=34 (Numerical result out of range)</b><br/>
This slapd error generally indicates that the client sent a message that exceeded an administrative limit. See<br/>sockbuf_max_incoming and sockbuf_max_incoming_auth configuration directives in slapd.conf(5).<br/>
<b>C.2.2. ber_get_next on fd X failed errno=11 (Resource temporarily<br/>unavailable)</b><br/>
This message is not indicative of abnormal behavior or error. It simply means that expected data is not yet<br/>available from the resource, in this context, a network socket. slapd(8) will process the data once it does<br/>
217<br/>
<hr/>
<a name=232></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
becomes available.<br/>
<b>C.2.3. daemon: socket() failed errno=97 (Address family not supported)</b><br/>
This message indicates that the operating system does not support one of the (protocol) address families which<br/>slapd(8) was configured to support. Most commonly, this occurs when slapd(8) was configured to support<br/>IPv6 yet the operating system kernel wasn't. In such cases, the message can be ignored.<br/>
<b>C.2.4. GSSAPI: gss_acquire_cred: Miscellaneous failure; Permission denied;</b><br/>
This message means that slapd is not running as root and, thus, it cannot get its Kerberos 5 key from the<br/>keytab, usually file /etc/krb5.keytab.<br/>
A keytab file is used to store keys that are to be used by services or daemons that are started at boot time. It is<br/>very important that these secrets are kept beyond reach of intruders.<br/>
That's why the default keytab file is owned by root and protected from being read by others. Do not mess with<br/>these permissions, build a different keytab file for slapd instead, and make sure it is owned by the user that<br/>slapd runs as.<br/>
To do this, start kadmin, and enter the following commands:<br/>
&#160; &#160; &#160;addprinc -randkey ldap/ldap.example.com@EXAMPLE.COM<br/>
&#160; &#160; &#160;ktadd -k /etc/openldap/ldap.keytab ldap/ldap.example.com@EXAMPLE.COM<br/>
Then, on the shell, do:<br/>
&#160; &#160; &#160;chown ldap:ldap /etc/openldap/ldap.keytab<br/>
&#160; &#160; &#160;chmod 600 /etc/openldap/ldap.keytab<br/>
Now you have to tell slapd (well, actually tell the gssapi library in Kerberos 5 that is invoked by Cyrus SASL)<br/>where to find the new keytab. You do this by setting the environment variable KRB5_KTNAME like this:<br/>
&#160; &#160; &#160;export KRB5_KTNAME=&#34;FILE:/etc/openldap/ldap.keytab&#34;<br/>
Set that environment variable on the slapd start script (Red Hat users might find /etc/sysconfig/ldap a perfect<br/>place).<br/>
This only works if you are using MIT kerberos. It doesn't work with Heimdal, for instance.<br/>
In Heimdal there is a function gsskrb5_register_acceptor_identity() that sets the path of the keytab file you<br/>want to use. In Cyrus SASL 2 you can add<br/>
&#160; &#160; keytab: /path/to/file<br/>
to your application's SASL config file to use this feature. This only works with Heimdal.<br/>
<b>C.2.5. access from unknown denied</b><br/>
This related to TCP wrappers. See hosts_access(5) for more information. in the log file: &#34;access from<br/>unknown denied&#34; This related to TCP wrappers. See hosts_access(5) for more information. for example: add<br/>
218<br/>
<hr/>
<a name=233></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
the line &#34;slapd: .hosts.you.want.to.allow&#34; in /etc/hosts.allow to get rid of the error.<br/>
<b>C.2.6. ldap_read: want=# error=Resource temporarily unavailable</b><br/>
This message occurs normally. It means that pending data is not yet available from the resource, a network<br/>socket. slapd(8) will process the data once it becomes available.<br/>
<b>C.2.7. `make test' fails</b><br/>
Some times, `make test' fails at the very first test with an obscure message like<br/>
&#160; &#160; make test<br/>
&#160; &#160; make[1]: Entering directory `/ldap_files/openldap-2.4.6/tests'<br/>
&#160; &#160; make[2]: Entering directory `/ldap_files/openldap-2.4.6/tests'<br/>
&#160; &#160; Initiating LDAP tests for BDB...<br/>
&#160; &#160; Cleaning up test run directory leftover from previous run.<br/>
&#160; &#160; &#160;Running ./scripts/all...<br/>
&#160; &#160; &gt;&gt;&gt;&gt;&gt; Executing all LDAP tests for bdb<br/>
&#160; &#160; &gt;&gt;&gt;&gt;&gt; Starting test000-rootdse ...<br/>
&#160; &#160; running defines.sh<br/>
&#160; &#160; Starting slapd on TCP/IP port 9011...<br/>
&#160; &#160; Using ldapsearch to retrieve the root DSE...<br/>
&#160; &#160; Waiting 5 seconds for slapd to start...<br/>
&#160; &#160; ./scripts/test000-rootdse: line 40: 10607 Segmentation fault $SLAPD -f $CONF1 -h $URI1 -d $LVL $TIMING &gt;$LOG1 2&gt;&amp;1<br/>
&#160; &#160; Waiting 5 seconds for slapd to start...<br/>
&#160; &#160; Waiting 5 seconds for slapd to start...<br/>
&#160; &#160; Waiting 5 seconds for slapd to start...<br/>
&#160; &#160; Waiting 5 seconds for slapd to start...<br/>
&#160; &#160; Waiting 5 seconds for slapd to start...<br/>
&#160; &#160; ./scripts/test000-rootdse: kill: (10607) - No such pid<br/>
&#160; &#160; ldap_sasl_bind_s: Can't contact LDAP server (-1)<br/>
&#160; &#160; &gt;&gt;&gt;&gt;&gt; Test failed<br/>
&#160; &#160; &gt;&gt;&gt;&gt;&gt; ./scripts/test000-rootdse failed (exit 1)<br/>
&#160; &#160; make[2]: *** [bdb-yes] Error 1<br/>
&#160; &#160; make[2]: Leaving directory `/ldap_files/openldap-2.4.6/tests'<br/>
&#160; &#160; make[1]: *** [test] Error 2<br/>
&#160; &#160; make[1]: Leaving directory `/ldap_files/openldap-2.4.6/tests'<br/>
&#160; &#160; make: *** [test] Error 2<br/>
or so. Usually, the five lines<br/>
Waiting 5 seconds for slapd to start...<br/>
indicate that slapd didn't start at all.<br/>
In tests/testrun/slapd.1.log there is a full log of what slapd wrote while trying to start. The log level can be<br/>increased by setting the environment variable SLAPD_DEBUG to the corresponding value; see loglevel in<br/>slapd.conf(5) for the meaning of log levels.<br/>
A typical reason for this behavior is a runtime link problem, i.e. slapd cannot find some dynamic libraries it<br/>was linked against. Try running ldd(1) on slapd (for those architectures that support runtime linking).<br/>
There might well be other reasons; the contents of the log file should help clarifying them.<br/>
219<br/>
<hr/>
<a name=234></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
Tests that fire up multiple instances of slapd typically log to tests/testrun/slapd.&lt;n&gt;.log, with a distinct &lt;n&gt;<br/>for each instance of slapd; list tests/testrun/ for possible values of &lt;n&gt;.<br/>
<b>C.2.8. ldap_*: Internal (implementation specific) error (80) - additional info:<br/>entry index delete failed</b><br/>
This seems to be related with wrong ownership of the BDB's dir (/var/lib/ldap) and files. The files must be<br/>owned by the user that slapd runs as.<br/>
&#160; &#160; chown -R ldap:ldap /var/lib/ldap<br/>
fixes it in Debian<br/>
<b>C.2.9. ldap_sasl_interactive_bind_s: Can't contact LDAP server (-1)</b><br/>
Using SASL, when a client contacts LDAP server, the slapd service dies immediately and client gets an error :<br/>
&#160; &#160; &#160;SASL/GSSAPI authentication started ldap_sasl_interactive_bind_s: Can't contact LDAP server (-1)<br/>
Then check the slapd service, it stopped.<br/>
This may come from incompatible of using different versions of BerkeleyDB for installing of SASL and<br/>installing of OpenLDAP. The problem arises in case of using multiple version of BerkeleyDB. Solution: -<br/>Check which version of BerkeleyDB when install Cyrus SASL.<br/>
Reinstall OpenLDAP with the version of BerkeleyDB above.<br/>
220<br/>
<hr/>
<a name=235></a><b>D. Recommended OpenLDAP Software Dependency<br/>Versions</b><br/>
This appendix details the recommended versions of the software that OpenLDAP depends on.<br/>
<a href="OpenLDAP-Admin-Guides.html#31">Please read the Prerequisite software section for more information on the following software dependencies.</a><br/>
<b>D.1. Dependency Versions</b><br/>
Table 8.5: OpenLDAP Software Dependency Versions<br/>
<b>Feature</b><br/>
<b>Software</b><br/>
<b>Version</b><br/>
&#160;Transport Layer Security:<br/>
<a href="http://www.openssl.org/">&#160;OpenSSL</a><br/>
0.9.7+<br/>
<a href="http://www.gnu.org/software/gnutls/">&#160;GnuTLS</a><br/>
2.12.0<br/>
<a href="http://developer.mozilla.org/en/NSS">&#160;MozNSS</a><br/>
3.12.9<br/>
&#160;Simple Authentication and&#160;<a href="http://asg.web.cmu.edu/sasl/sasl-library.html">&#160;Cyrus SASL&#160;</a>2.1.21+<br/>
Security Layer<br/>
&#160;Kerberos Authentication<br/>Service:<br/>
<a href="http://www.pdc.kth.se/heimdal/">&#160;Heimdal</a><br/>
Version<br/>
<a href="http://web.mit.edu/kerberos/www/">&#160;MIT</a><br/>
Version<br/>
<a href="http://web.mit.edu/kerberos/www/">Kerberos</a><br/>
<a href="http://www.oracle.com/database/berkeley-db/db/index.html">&#160;Berkeley</a><br/>
Database Software<br/>
5.3<br/>
<a href="http://www.oracle.com/database/berkeley-db/db/index.html">DB:</a><br/>
Note: It is highly recommended to apply<br/>
the patches from Oracle for a given<br/>
release.<br/>
Threads:<br/>
POSIX<br/>
Version<br/>
<i>pthreads</i><br/>
Mach<br/>
Version<br/>
<i>CThreads</i><br/>
TCP Wrappers<br/>
Name<br/>
Version<br/>
221<br/>
<hr/>
<a name=236></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
222<br/>
<hr/>
<a name=237></a><b>E. Real World OpenLDAP Deployments and Examples</b><br/>
Examples and discussions<br/>
223<br/>
<hr/>
<a name=238></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
224<br/>
<hr/>
<a name=239></a><b>F. OpenLDAP Software Contributions</b><br/>
The following sections attempt to summarize the various contributions in OpenLDAP software, as found in<br/>openldap_src/contrib<br/>
<b>F.1. Client APIs</b><br/>
Intro and discuss<br/>
<b>F.1.1. ldapc++</b><br/>
Intro and discuss<br/>
<b>F.1.2. ldaptcl</b><br/>
Intro and discuss<br/>
<b>F.2. Overlays</b><br/>
<b>F.2.1. acl</b><br/>
Plugins that implement access rules. Currently only posixGroup, which implements access control based on<br/>posixGroup membership.<br/>
<b>F.2.2. addpartial</b><br/>
Treat Add requests as Modify requests if the entry exists.<br/>
<b>F.2.3. allop</b><br/>
Return operational attributes for root DSE even when not requested, since some clients expect this.<br/>
<b>F.2.4. autogroup</b><br/>
Automated updates of group memberships.<br/>
<b>F.2.5. comp_match</b><br/>
Component Matching rules (RFC 3687).<br/>
<b>F.2.6. denyop</b><br/>
Deny selected operations, returning<i>&#160;unwillingToPerform</i>.<br/>
<b>F.2.7. dsaschema</b><br/>
Permit loading DSA-specific schema, including operational attrs.<br/>
225<br/>
<hr/>
<a name=240></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
<b>F.2.8. lastmod</b><br/>
Track the time of the last write operation to a database.<br/>
<b>F.2.9. nops</b><br/>
Remove null operations, e.g. changing a value to same as before.<br/>
<b>F.2.10. nssov</b><br/>
Handle NSS lookup requests through a local Unix Domain socket.<br/>
<b>F.2.11. passwd</b><br/>
Support additional password mechanisms.<br/>
<b>F.2.12. proxyOld</b><br/>
Proxy Authorization compatibility with obsolete internet-draft.<br/>
<b>F.2.13. smbk5pwd</b><br/>
Make the PasswordModify Extended Operation update Kerberos keys and Samba password hashes as well as<br/><i>userPassword</i>.<br/>
<b>F.2.14. trace</b><br/>
Trace overlay invocation.<br/>
<b>F.2.15. usn</b><br/>
Maintain<i>&#160;usnCreated</i>&#160;and<i>&#160;usnChanged</i>&#160;attrs similar to Microsoft AD.<br/>
<b>F.3. Tools</b><br/>
Intro and discuss<br/>
<b>F.3.1. Statistic Logging</b><br/>
statslog<br/>
<b>F.4. SLAPI Plugins</b><br/>
Intro and discuss<br/>
226<br/>
<hr/>
<a name=241></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
<b>F.4.1. addrdnvalues</b><br/>
More<br/>
227<br/>
<hr/>
<a name=242></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
228<br/>
<hr/>
<a name=243></a><b>G. Configuration File Examples</b><br/>
<b>G.1. slapd.conf</b><br/>
<b>G.2. ldap.conf</b><br/>
<b>G.3. a-n-other.conf</b><br/>
229<br/>
<hr/>
<a name=244></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
230<br/>
<hr/>
<a name=245></a><b>H. LDAP Result Codes</b><br/>
For the purposes of this guide, we have incorporated the standard LDAP result codes from<i>&#160;Appendix A. LDAP<br/>Result Codes</i><a href="http://www.rfc-editor.org/rfc/rfc4511.txt">&#160;of RFC4511, a copy of which can be found in&#160;</a>doc/rfc&#160;of the OpenLDAP source code.<br/>
We have expanded the description of each error in relation to the OpenLDAP toolsets. LDAP extensions may<br/>introduce extension-specific result codes, which are not part of RFC4511. OpenLDAP returns the result codes<br/>related to extensions it implements. Their meaning is documented in the extension they are related to.<br/>
<b>H.1. Non-Error Result Codes</b><br/>
These result codes (called &#34;non-error&#34; result codes) do not indicate an error condition:<br/>
&#160; &#160; &#160; &#160; success (0),<br/>
&#160; &#160; &#160; &#160; compareFalse (5),<br/>
&#160; &#160; &#160; &#160; compareTrue (6),<br/>
&#160; &#160; &#160; &#160; referral (10), and<br/>
&#160; &#160; &#160; &#160; saslBindInProgress (14).<br/>
The<i>&#160;success</i>,<i>&#160;compareTrue</i>, and<i>&#160;compareFalse</i>&#160;result codes indicate successful completion (and, hence, are<br/>referred to as &#34;successful&#34; result codes).<br/>
The<i>&#160;referral</i>&#160;and<i>&#160;saslBindInProgress</i>&#160;result codes indicate the client needs to take additional action to<br/>complete the operation.<br/>
<b>H.2. Result Codes</b><br/>
Existing LDAP result codes are described as follows:<br/>
<b>H.3. success (0)</b><br/>
Indicates the successful completion of an operation.<br/>
<b>Note:</b><a href="OpenLDAP-Admin-Guides.html#246">&#160;this code is not used with the Compare operation. See compareFalse (5) and compareTrue (6).</a><br/>
<b>H.4. operationsError (1)</b><br/>
Indicates that the operation is not properly sequenced with relation to other operations (of same or different<br/>type).<br/>
<a href="http://www.rfc-editor.org/rfc/rfc4511.txt">For example, this code is returned if the client attempts to StartTLS (RFC4511 Section 4.14) while there are<br/></a>other uncompleted operations or if a TLS layer was already installed.<br/>
<b>H.5. protocolError (2)</b><br/>
Indicates the server received data that is not well-formed.<br/>
231<br/>
<hr/>
<a name=246></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
For Bind operation only, this code is also used to indicate that the server does not support the requested<br/>protocol version.<br/>
For Extended operations only, this code is also used to indicate that the server does not support (by design or<br/>configuration) the Extended operation associated with the<i>&#160;requestName</i>.<br/>
For request operations specifying multiple controls, this may be used to indicate that the server cannot ignore<br/>the order of the controls as specified, or that the combination of the specified controls is invalid or<br/>unspecified.<br/>
<b>H.6. timeLimitExceeded (3)</b><br/>
Indicates that the time limit specified by the client was exceeded before the operation could be completed.<br/>
<b>H.7. sizeLimitExceeded (4)</b><br/>
Indicates that the size limit specified by the client was exceeded before the operation could be completed.<br/>
<b>H.8. compareFalse (5)</b><br/>
Indicates that the Compare operation has successfully completed and the assertion has evaluated to FALSE or<br/>Undefined.<br/>
<b>H.9. compareTrue (6)</b><br/>
Indicates that the Compare operation has successfully completed and the assertion has evaluated to TRUE.<br/>
<b>H.10. authMethodNotSupported (7)</b><br/>
Indicates that the authentication method or mechanism is not supported.<br/>
<b>H.11. strongerAuthRequired (8)</b><br/>
Indicates the server requires strong(er) authentication in order to complete the operation.<br/>
When used with the Notice of Disconnection operation, this code indicates that the server has detected that an<br/>established security association between the client and server has unexpectedly failed or been compromised.<br/>
<b>H.12. referral (10)</b><br/>
<a href="http://www.rfc-editor.org/rfc/rfc4511.txt">Indicates that a referral needs to be chased to complete the operation (see RFC4511 Section 4.1.10).</a><br/>
<b>H.13. adminLimitExceeded (11)</b><br/>
Indicates that an administrative limit has been exceeded.<br/>
232<br/>
<hr/>
<a name=247></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
<b>H.14. unavailableCriticalExtension (12)</b><br/>
<a href="http://www.rfc-editor.org/rfc/rfc4511.txt">Indicates a critical control is unrecognized (see RFC4511 Section 4.1.11).</a><br/>
<b>H.15. confidentialityRequired (13)</b><br/>
Indicates that data confidentiality protections are required.<br/>
<b>H.16. saslBindInProgress (14)</b><br/>
Indicates the server requires the client to send a new bind request, with the same SASL mechanism, to<br/><a href="http://www.rfc-editor.org/rfc/rfc4511.txt">continue the authentication process (see RFC4511 Section 4.2).</a><br/>
<b>H.17. noSuchAttribute (16)</b><br/>
Indicates that the named entry does not contain the specified attribute or attribute value.<br/>
<b>H.18. undefinedAttributeType (17)</b><br/>
Indicates that a request field contains an unrecognized attribute description.<br/>
<b>H.19. inappropriateMatching (18)</b><br/>
Indicates that an attempt was made (e.g., in an assertion) to use a matching rule not defined for the attribute<br/>type concerned.<br/>
<b>H.20. constraintViolation (19)</b><br/>
Indicates that the client supplied an attribute value that does not conform to the constraints placed upon it by<br/>the data model.<br/>
For example, this code is returned when multiple values are supplied to an attribute that has a<br/>SINGLE-VALUE constraint.<br/>
<b>H.21. attributeOrValueExists (20)</b><br/>
Indicates that the client supplied an attribute or value to be added to an entry, but the attribute or value already<br/>exists.<br/>
<b>H.22. invalidAttributeSyntax (21)</b><br/>
Indicates that a purported attribute value does not conform to the syntax of the attribute.<br/>
<b>H.23. noSuchObject (32)</b><br/>
Indicates that the object does not exist in the DIT.<br/>
233<br/>
<hr/>
<a name=248></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
<b>H.24. aliasProblem (33)</b><br/>
Indicates that an alias problem has occurred. For example, the code may used to indicate an alias has been<br/>dereferenced that names no object.<br/>
<b>H.25. invalidDNSyntax (34)</b><br/>
Indicates that an LDAPDN or RelativeLDAPDN field (e.g., search base, target entry, ModifyDN newrdn,<br/>etc.) of a request does not conform to the required syntax or contains attribute values that do not conform to<br/>the syntax of the attribute's type.<br/>
<b>H.26. aliasDereferencingProblem (36)</b><br/>
Indicates that a problem occurred while dereferencing an alias. Typically, an alias was encountered in a<br/>situation where it was not allowed or where access was denied.<br/>
<b>H.27. inappropriateAuthentication (48)</b><br/>
Indicates the server requires the client that had attempted to bind anonymously or without supplying<br/>credentials to provide some form of credentials.<br/>
<b>H.28. invalidCredentials (49)</b><br/>
Indicates that the provided credentials (e.g., the user's name and password) are invalid.<br/>
<b>H.29. insufficientAccessRights (50)</b><br/>
Indicates that the client does not have sufficient access rights to perform the operation.<br/>
<b>H.30. busy (51)</b><br/>
Indicates that the server is too busy to service the operation.<br/>
<b>H.31. unavailable (52)</b><br/>
Indicates that the server is shutting down or a subsystem necessary to complete the operation is offline.<br/>
<b>H.32. unwillingToPerform (53)</b><br/>
Indicates that the server is unwilling to perform the operation.<br/>
<b>H.33. loopDetect (54)</b><br/>
Indicates that the server has detected an internal loop (e.g., while dereferencing aliases or chaining an<br/>operation).<br/>
234<br/>
<hr/>
<a name=249></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
<b>H.34. namingViolation (64)</b><br/>
Indicates that the entry's name violates naming restrictions.<br/>
<b>H.35. objectClassViolation (65)</b><br/>
Indicates that the entry violates object class restrictions.<br/>
<b>H.36. notAllowedOnNonLeaf (66)</b><br/>
Indicates that the operation is inappropriately acting upon a non-leaf entry.<br/>
<b>H.37. notAllowedOnRDN (67)</b><br/>
Indicates that the operation is inappropriately attempting to remove a value that forms the entry's relative<br/>distinguished name.<br/>
<b>H.38. entryAlreadyExists (68)</b><br/>
Indicates that the request cannot be fulfilled (added, moved, or renamed) as the target entry already exists.<br/>
<b>H.39. objectClassModsProhibited (69)</b><br/>
Indicates that an attempt to modify the object class(es) of an entry's 'objectClass' attribute is prohibited.<br/>
For example, this code is returned when a client attempts to modify the structural object class of an entry.<br/>
<b>H.40. affectsMultipleDSAs (71)</b><br/>
Indicates that the operation cannot be performed as it would affect multiple servers (DSAs).<br/>
<b>H.41. other (80)</b><br/>
Indicates the server has encountered an internal error.<br/>
235<br/>
<hr/>
<a name=250></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
236<br/>
<hr/>
<a name=251></a><b>I. Glossary</b><br/>
<b>I.1. Terms</b><br/>
<b>Term</b><br/>
<b>Definition</b><br/>
3DES<br/>
Triple DES<br/>
ABNF<br/>
Augmented Backus-Naur Form<br/>
ACDF<br/>
Access Control Decision Function<br/>
ACE<br/>
ASCII Compatible Encoding<br/>
ASCII<br/>
American Standard Code for Information Interchange<br/>
ACID<br/>
Atomicity, Consistency, Isolation, and Durability<br/>
ACI<br/>
Access Control Information<br/>
ACL<br/>
Access Control List<br/>
AES<br/>
Advance Encryption Standard<br/>
ABI<br/>
Application Binary Interface<br/>
API<br/>
Application Program Interface<br/>
ASN.1<br/>
Abstract Syntax Notation - One<br/>
AVA<br/>
Attribute Value Assertion<br/>
AuthcDN<br/>
Authentication DN<br/>
AuthcId<br/>
Authentication Identity<br/>
AuthzDN<br/>
Authorization DN<br/>
AuthzId<br/>
Authorization Identity<br/>
BCP<br/>
Best Current Practice<br/>
BDB<br/>
Berkeley DB (Backend)<br/>
BER<br/>
Basic Encoding Rules<br/>
BNF<br/>
Backus-Naur Form<br/>
C<br/>
The C Programming Language<br/>
CA<br/>
Certificate Authority<br/>
CER<br/>
Canonical Encoding Rules<br/>
CLDAP<br/>
Connection-less LDAP<br/>
CN<br/>
Common Name<br/>
CRAM-MD5<br/>
SASL MD5 Challenge/Response Authentication Mechanism<br/>
CRL<br/>
Certificate Revocation List<br/>
DAP<br/>
Directory Access Protocol<br/>
DC<br/>
Domain Component<br/>
DER<br/>
Distinguished Encoding Rules<br/>
DES<br/>
Data Encryption Standard<br/>
DIB<br/>
Directory Information Base<br/>
DIGEST-MD5&#160;SASL Digest MD5 Authentication Mechanism<br/>
DISP<br/>
Directory Information Shadowing Protocol<br/>
DIT<br/>
Directory Information Tree<br/>
237<br/>
<hr/>
<a name=252></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
DNS<br/>
Domain Name System<br/>
DN<br/>
Distinguished Name<br/>
DOP<br/>
Directory Operational Binding Management Protocol<br/>
DSAIT<br/>
DSA Information Tree<br/>
DSA<br/>
Directory System Agent<br/>
DSE<br/>
DSA-specific Entry<br/>
DSP<br/>
Directory System Protocol<br/>
DS<br/>
Draft Standard<br/>
DUA<br/>
Directory User Agent<br/>
EXTERNAL<br/>
SASL External Authentication Mechanism<br/>
FAQ<br/>
Frequently Asked Questions<br/>
FTP<br/>
File Transfer Protocol<br/>
FYI<br/>
For Your Information<br/>
GSER<br/>
Generic String Encoding Rules<br/>
GSS-API<br/>
Generic Security Service Application Program Interface<br/>
GSSAPI<br/>
SASL Kerberos V GSS-API Authentication Mechanism<br/>
HDB<br/>
Hierarchical Database (Backend)<br/>
I-D<br/>
Internet-Draft<br/>
IA5<br/>
International Alphabet 5<br/>
IDNA<br/>
Internationalized Domain Names in Applications<br/>
IDN<br/>
Internationalized Domain Name<br/>
ID<br/>
Identifier<br/>
IDL<br/>
Index Data Lookups<br/>
IP<br/>
Internet Protocol<br/>
IPC<br/>
Inter-process communication<br/>
IPsec<br/>
Internet Protocol Security<br/>
IPv4<br/>
Internet Protocol, version 4<br/>
IPv6<br/>
Internet Protocol, version 6<br/>
ITS<br/>
Issue Tracking System<br/>
JPEG<br/>
Joint Photographic Experts Group<br/>
Kerberos<br/>
Kerberos Authentication Service<br/>
LBER<br/>
Lightweight BER<br/>
LDAP<br/>
Lightweight Directory Access Protocol<br/>
LDAP Sync<br/>
LDAP Content Synchronization<br/>
LDAPv3<br/>
LDAP, version 3<br/>
LDIF<br/>
LDAP Data Interchange Format<br/>
LMDB<br/>
Lightning Memory-Mapped Database<br/>
MD5<br/>
Message Digest 5<br/>
MDB<br/>
Memory-Mapped Database (Backend)<br/>
MIB<br/>
Management Information Base<br/>
MODDN<br/>
Modify DN<br/>
MODRDN<br/>
Modify RDN<br/>
238<br/>
<hr/>
<a name=253></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
NSSR<br/>
Non-specific Subordinate Reference<br/>
OID<br/>
Object Identifier<br/>
OSI<br/>
Open Systems Interconnect<br/>
OTP<br/>
One Time Password<br/>
PDU<br/>
Protocol Data Unit<br/>
PEM<br/>
Privacy Enhanced eMail<br/>
PEN<br/>
Private Enterprise Number<br/>
PKCS<br/>
Public Key Cryptosystem<br/>
PKI<br/>
Public Key Infrastructure<br/>
PKIX<br/>
Public Key Infrastructure (X.509)<br/>
PLAIN<br/>
SASL Plaintext Password Authentication Mechanism<br/>
POSIX<br/>
Portable Operating System Interface<br/>
PS<br/>
Proposed Standard<br/>
RDN<br/>
Relative Distinguished Name<br/>
RFC<br/>
Request for Comments<br/>
RPC<br/>
Remote Procedure Call<br/>
RXER<br/>
Robust XML Encoding Rules<br/>
SASL<br/>
Simple Authentication and Security Layer<br/>
SDF<br/>
Simple Document Format<br/>
SDSE<br/>
Shadowed DSE<br/>
SHA1<br/>
Secure Hash Algorithm 1<br/>
SLAPD<br/>
Standalone LDAP Daemon<br/>
SLURPD<br/>
Standalone LDAP Update Replication Daemon<br/>
SMTP<br/>
Simple Mail Transfer Protocol<br/>
SNMP<br/>
Simple Network Management Protocol<br/>
SQL<br/>
Structured Query Language<br/>
SRP<br/>
Secure Remote Password<br/>
SSF<br/>
Security Strength Factor<br/>
SSL<br/>
Secure Socket Layer<br/>
STD<br/>
Internet Standard<br/>
TCP<br/>
Transmission Control Protocol<br/>
TLS<br/>
Transport Layer Security<br/>
UCS<br/>
Universal Multiple-Octet Coded Character Set<br/>
UDP<br/>
User Datagram Protocol<br/>
UID<br/>
User Identifier<br/>
Unicode<br/>
The Unicode Standard<br/>
UNIX<br/>
Unix<br/>
URI<br/>
Uniform Resource Identifier<br/>
URL<br/>
Uniform Resource Locator<br/>
URN<br/>
Uniform Resource Name<br/>
UTF-8<br/>
8-bit UCS/Unicode Transformation Format<br/>
UTR<br/>
Unicode Technical Report<br/>
239<br/>
<hr/>
<a name=254></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
UUID<br/>
Universally Unique Identifier<br/>
WWW<br/>
World Wide Web<br/>
X.500<br/>
X.500 Directory Services<br/>
X.509<br/>
X.509 Public Key and Attribute Certificate Frameworks<br/>
XED<br/>
XML Enabled Directory<br/>
XER<br/>
XML Encoding Rules<br/>
XML<br/>
Extensible Markup Language<br/>
syncrepl<br/>
LDAP Sync-based Replication<br/>
<b>I.2. Related Organizations</b><br/>
<b>Name</b><br/>
<b>Long</b><br/>
<b>Jump</b><br/>
<a href="http://www.ansi.org/">ANSI</a><br/>
American National Standards Institute<br/>
<a href="http://www.ansi.org/">http://www.ansi.org/</a><br/>
<a href="http://www.bsi-global.com/">BSI</a><br/>
British Standards Institute<br/>
<a href="http://www.bsi-global.com/">http://www.bsi-global.com/</a><br/>
Co-operation and Open Systems<br/>
COSINE<br/>
Interconnection in Europe<br/>
<a href="http://cpan.org/">CPAN</a><br/>
Comprehensive Perl Archive Network<br/>
<a href="http://cpan.org/">http://cpan.org/</a><br/>
<a href="http://cyrusimap.web.cmu.edu/">Cyrus</a><br/>
Project Cyrus<br/>
<a href="http://cyrusimap.web.cmu.edu/">http://cyrusimap.web.cmu.edu/</a><br/>
<a href="http://www.fsf.org/">FSF</a><br/>
Free Software Foundation<br/>
<a href="http://www.fsf.org/">http://www.fsf.org/</a><br/>
<a href="http://www.gnu.org/">GNU</a><br/>
GNU Not Unix Project<br/>
<a href="http://www.gnu.org/">http://www.gnu.org/</a><br/>
<a href="http://www.iab.org/">IAB</a><br/>
Internet Architecture Board<br/>
<a href="http://www.iab.org/">http://www.iab.org/</a><br/>
<a href="http://www.iana.org/">IANA</a><br/>
Internet Assigned Numbers Authority<br/>
<a href="http://www.iana.org/">http://www.iana.org/</a><br/>
<a href="http://www.ieee.org">IEEE</a><br/>
Institute of Electrical and Electronics Engineers&#160;<a href="http://www.ieee.org">http://www.ieee.org</a><br/>
<a href="http://www.ietf.org/iesg/">IESG</a><br/>
Internet Engineering Steering Group<br/>
<a href="http://www.ietf.org/iesg/">http://www.ietf.org/iesg/</a><br/>
<a href="http://www.ietf.org/">IETF</a><br/>
Internet Engineering Task Force<br/>
<a href="http://www.ietf.org/">http://www.ietf.org/</a><br/>
<a href="http://www.irtf.org/">IRTF</a><br/>
Internet Research Task Force<br/>
<a href="http://www.irtf.org/">http://www.irtf.org/</a><br/>
<a href="http://www.iso.org/">ISO</a><br/>
International Standards Organisation<br/>
<a href="http://www.iso.org/">http://www.iso.org/</a><br/>
<a href="http://www.isoc.org/">ISOC</a><br/>
Internet Society<br/>
<a href="http://www.isoc.org/">http://www.isoc.org/</a><br/>
<a href="http://www.itu.int/">ITU</a><br/>
International Telephone Union<br/>
<a href="http://www.itu.int/">http://www.itu.int/</a><br/>
<a href="http://www.openldap.org/foundation/">OLF</a><br/>
OpenLDAP Foundation<br/>
<a href="http://www.openldap.org/foundation/">http://www.openldap.org/foundation/</a><br/>
<a href="http://www.openldap.org/project/">OLP</a><br/>
OpenLDAP Project<br/>
<a href="http://www.openldap.org/project/">http://www.openldap.org/project/</a><br/>
<a href="http://www.openssl.org/">OpenSSL</a><br/>
OpenSSL Project<br/>
<a href="http://www.openssl.org/">http://www.openssl.org/</a><br/>
<a href="http://www.rfc-editor.org/">RFC Editor&#160;</a>RFC Editor<br/>
<a href="http://www.rfc-editor.org/">http://www.rfc-editor.org/</a><br/>
<a href="http://www.oracle.com/">Oracle</a><br/>
Oracle Corporation<br/>
<a href="http://www.oracle.com/">http://www.oracle.com/</a><br/>
<a href="http://www.umich.edu/">UM</a><br/>
University of Michigan<br/>
<a href="http://www.umich.edu/">http://www.umich.edu/</a><br/>
<a href="http://www.umich.edu/~dirsvcs/ldap/ldap.html">UMLDAP</a><br/>
University of Michigan LDAP Team<br/>
<a href="http://www.umich.edu/~dirsvcs/ldap/ldap.html">http://www.umich.edu/~dirsvcs/ldap/ldap.html</a><br/>
<b>I.3. Related Products</b><br/>
<b>Name</b><br/>
<b>Jump</b><br/>
<a href="http://search.cpan.org/src/IANC/sdf-2.001/doc/catalog.html">SDF</a><br/>
<a href="http://search.cpan.org/src/IANC/sdf-2.001/doc/catalog.html">http://search.cpan.org/src/IANC/sdf-2.001/doc/catalog.html</a><br/>
<a href="http://www.oracle.com/database/berkeley-db/db/index.html">Berkeley DB</a><br/>
<a href="http://www.oracle.com/database/berkeley-db/db/index.html">http://www.oracle.com/database/berkeley-db/db/index.html</a><br/>
<a href="http://cyrusimap.web.cmu.edu/generalinfo.html">Cyrus</a><br/>
<a href="http://cyrusimap.web.cmu.edu/generalinfo.html">http://cyrusimap.web.cmu.edu/generalinfo.html</a><br/>
<a href="http://asg.web.cmu.edu/sasl/sasl-library.html">Cyrus SASL</a><br/>
<a href="http://asg.web.cmu.edu/sasl/sasl-library.html">http://asg.web.cmu.edu/sasl/sasl-library.html</a><br/>
240<br/>
<hr/>
<a name=255></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
<a href="http://git-scm.com/">Git</a><br/>
<a href="http://git-scm.com/">http://git-scm.com/</a><br/>
<a href="http://www.gnu.org/software/">GNU</a><br/>
<a href="http://www.gnu.org/software/">http://www.gnu.org/software/</a><br/>
<a href="http://www.gnu.org/software/gnutls/">GnuTLS</a><br/>
<a href="http://www.gnu.org/software/gnutls/">http://www.gnu.org/software/gnutls/</a><br/>
<a href="http://www.pdc.kth.se/heimdal/">Heimdal</a><br/>
<a href="http://www.pdc.kth.se/heimdal/">http://www.pdc.kth.se/heimdal/</a><br/>
<a href="http://www.openldap.org/jldap/">JLDAP</a><br/>
<a href="http://www.openldap.org/jldap/">http://www.openldap.org/jldap/</a><br/>
<a href="http://web.mit.edu/kerberos/www/">MIT Kerberos</a><br/>
<a href="http://web.mit.edu/kerberos/www/">http://web.mit.edu/kerberos/www/</a><br/>
<a href="http://developer.mozilla.org/en/NSS">MozNSS</a><br/>
<a href="http://developer.mozilla.org/en/NSS">http://developer.mozilla.org/en/NSS</a><br/>
<a href="http://www.openldap.org/">OpenLDAP</a><br/>
<a href="http://www.openldap.org/">http://www.openldap.org/</a><br/>
<a href="http://www.openldap.org/faq/">OpenLDAP FAQ</a><br/>
<a href="http://www.openldap.org/faq/">http://www.openldap.org/faq/</a><br/>
<a href="http://www.openldap.org/its/">OpenLDAP ITS</a><br/>
<a href="http://www.openldap.org/its/">http://www.openldap.org/its/</a><br/>
<a href="http://www.openldap.org/software/">OpenLDAP Software&#160;http://www.openldap.org/software/</a><br/>
<a href="http://www.openssl.org/">OpenSSL</a><br/>
<a href="http://www.openssl.org/">http://www.openssl.org/</a><br/>
<a href="http://www.perl.org/">Perl</a><br/>
<a href="http://www.perl.org/">http://www.perl.org/</a><br/>
<a href="http://www.umich.edu/~dirsvcs/ldap/ldap.html">UMLDAP</a><br/>
<a href="http://www.umich.edu/~dirsvcs/ldap/ldap.html">http://www.umich.edu/~dirsvcs/ldap/ldap.html</a><br/>
<b>I.4. References</b><br/>
<b>Reference</b><br/>
<b>Document</b><br/>
<b>Status&#160;Jump</b><br/>
The SLAPD and<br/>SLURPD<br/>
<a href="http://www.umich.edu/~dirsvcs/ldap/doc/guides/slapd/guide.pdf">UM-GUIDE</a><br/>
O<br/>
<a href="http://www.umich.edu/~dirsvcs/ldap/doc/guides/slapd/guide.pdf">http://www.umich.edu/~dirsvcs/ldap/doc/guides/slapd/guide.pdf</a><br/>
Administrators<br/>Guide<br/>
Definition of an<br/>X.500 Attribute<br/>Type and an Object<br/>
<a href="http://www.rfc-editor.org/rfc/rfc2079.txt">RFC2079</a><br/>
PS<br/>
<a href="http://www.rfc-editor.org/rfc/rfc2079.txt">http://www.rfc-editor.org/rfc/rfc2079.txt</a><br/>
Class to Hold<br/>Uniform Resource<br/>Identifers<br/>
Use of Language<br/>
<a href="http://www.rfc-editor.org/rfc/rfc2296.txt">RFC2296</a><br/>
PS<br/>
<a href="http://www.rfc-editor.org/rfc/rfc2296.txt">http://www.rfc-editor.org/rfc/rfc2296.txt</a><br/>
Codes in LDAP<br/>
An Approach for<br/>Using LDAP as a<br/>
<a href="http://www.rfc-editor.org/rfc/rfc2307.txt">RFC2307</a><br/>
X<br/>
<a href="http://www.rfc-editor.org/rfc/rfc2307.txt">http://www.rfc-editor.org/rfc/rfc2307.txt</a><br/>
Network Information<br/>Service<br/>
Lightweight<br/>Directory Access<br/>Protocol (v3):<br/>
<a href="http://www.rfc-editor.org/rfc/rfc2589.txt">RFC2589</a><br/>
PS<br/>
<a href="http://www.rfc-editor.org/rfc/rfc2589.txt">http://www.rfc-editor.org/rfc/rfc2589.txt</a><br/>
Extensions for<br/>Dynamic Directory<br/>Services<br/>
Definition of the<br/>
<a href="http://www.rfc-editor.org/rfc/rfc2798.txt">RFC2798</a><br/>
inetOrgPerson<br/>
I<br/>
<a href="http://www.rfc-editor.org/rfc/rfc2798.txt">http://www.rfc-editor.org/rfc/rfc2798.txt</a><br/>
LDAP Object Class<br/>
Using Digest<br/>
<a href="http://www.rfc-editor.org/rfc/rfc2831.txt">RFC2831</a><br/>
Authentication as a<br/>
PS<br/>
<a href="http://www.rfc-editor.org/rfc/rfc2831.txt">http://www.rfc-editor.org/rfc/rfc2831.txt</a><br/>
SASL Mechanism<br/>
241<br/>
<hr/>
<a name=256></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
The LDAP Data<br/>
<a href="http://www.rfc-editor.org/rfc/rfc2849.txt">RFC2849</a><br/>
PS<br/>
<a href="http://www.rfc-editor.org/rfc/rfc2849.txt">http://www.rfc-editor.org/rfc/rfc2849.txt</a><br/>
Interchange Format<br/>
OpenLDAP Root<br/>
<a href="http://www.rfc-editor.org/rfc/rfc3088.txt">RFC3088</a><br/>
X<br/>
<a href="http://www.rfc-editor.org/rfc/rfc3088.txt">http://www.rfc-editor.org/rfc/rfc3088.txt</a><br/>
Service<br/>
Named Subordinate<br/>
<a href="http://www.rfc-editor.org/rfc/rfc3296.txt">RFC3296</a><br/>
PS<br/>
<a href="http://www.rfc-editor.org/rfc/rfc3296.txt">http://www.rfc-editor.org/rfc/rfc3296.txt</a><br/>
References in LDAP<br/>
Lightweight<br/>Directory Access<br/>
<a href="http://www.rfc-editor.org/rfc/rfc3384.txt">RFC3384</a><br/>
Protocol (version 3)&#160;I<br/>
<a href="http://www.rfc-editor.org/rfc/rfc3384.txt">http://www.rfc-editor.org/rfc/rfc3384.txt</a><br/>
Replication<br/>Requirements<br/>
Lightweight<br/>Directory Access<br/>
<a href="http://www.rfc-editor.org/rfc/rfc3494.txt">RFC3494</a><br/>
Protocol version 2<br/>
I<br/>
<a href="http://www.rfc-editor.org/rfc/rfc3494.txt">http://www.rfc-editor.org/rfc/rfc3494.txt</a><br/>
(LDAPv2) to<br/>Historic Status<br/>
SASLprep:<br/>Stringprep Profile<br/>
<a href="http://www.rfc-editor.org/rfc/rfc4013.txt">RFC4013</a><br/>
PS<br/>
<a href="http://www.rfc-editor.org/rfc/rfc4013.txt">http://www.rfc-editor.org/rfc/rfc4013.txt</a><br/>
for User Names and<br/>Passwords<br/>
The Transport Layer<br/>
<a href="http://www.rfc-editor.org/rfc/rfc4346.txt">RFC4346</a><br/>
Security (TLS)<br/>
PS<br/>
<a href="http://www.rfc-editor.org/rfc/rfc4346.txt">http://www.rfc-editor.org/rfc/rfc4346.txt</a><br/>
Protocol, Version 1.1<br/>
Simple<br/>Authentication and<br/>
<a href="http://www.rfc-editor.org/rfc/rfc4422.txt">RFC4422</a><br/>
PS<br/>
<a href="http://www.rfc-editor.org/rfc/rfc4422.txt">http://www.rfc-editor.org/rfc/rfc4422.txt</a><br/>
Security Layer<br/>(SASL)<br/>
Lightweight<br/>Directory Access<br/>Protocol (LDAP):<br/>
<a href="http://www.rfc-editor.org/rfc/rfc4510.txt">RFC4510</a><br/>
PS<br/>
<a href="http://www.rfc-editor.org/rfc/rfc4510.txt">http://www.rfc-editor.org/rfc/rfc4510.txt</a><br/>
Technical<br/>Specification<br/>Roadmap<br/>
Lightweight<br/>Directory Access<br/>
<a href="http://www.rfc-editor.org/rfc/rfc4511.txt">RFC4511</a><br/>
PS<br/>
<a href="http://www.rfc-editor.org/rfc/rfc4511.txt">http://www.rfc-editor.org/rfc/rfc4511.txt</a><br/>
Protocol (LDAP):<br/>The Protocol<br/>
Lightweight<br/>Directory Access<br/>
<a href="http://www.rfc-editor.org/rfc/rfc4512.txt">RFC4512</a><br/>
Protocol (LDAP):<br/>
PS<br/>
<a href="http://www.rfc-editor.org/rfc/rfc4512.txt">http://www.rfc-editor.org/rfc/rfc4512.txt</a><br/>
Directory<br/>Information Models<br/>
<a href="http://www.rfc-editor.org/rfc/rfc4513.txt">RFC4513</a><br/>
Lightweight<br/>
PS<br/>
<a href="http://www.rfc-editor.org/rfc/rfc4513.txt">http://www.rfc-editor.org/rfc/rfc4513.txt</a><br/>
Directory Access<br/>Protocol (LDAP):<br/>Authentication<br/>Methods and<br/>Security<br/>
242<br/>
<hr/>
<a name=257></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
Mechanisms<br/>
Lightweight<br/>Directory Access<br/>Protocol (LDAP):<br/>
<a href="http://www.rfc-editor.org/rfc/rfc4514.txt">RFC4514</a><br/>
String<br/>
PS<br/>
<a href="http://www.rfc-editor.org/rfc/rfc4514.txt">http://www.rfc-editor.org/rfc/rfc4514.txt</a><br/>
Representation of<br/>Distinguished<br/>Names<br/>
Lightweight<br/>Directory Access<br/>Protocol (LDAP):<br/>
<a href="http://www.rfc-editor.org/rfc/rfc4515.txt">RFC4515</a><br/>
PS<br/>
<a href="http://www.rfc-editor.org/rfc/rfc4515.txt">http://www.rfc-editor.org/rfc/rfc4515.txt</a><br/>
String<br/>Representation of<br/>Search Filters<br/>
Lightweight<br/>Directory Access<br/>
<a href="http://www.rfc-editor.org/rfc/rfc4516.txt">RFC4516</a><br/>
Protocol (LDAP):<br/>
PS<br/>
<a href="http://www.rfc-editor.org/rfc/rfc4516.txt">http://www.rfc-editor.org/rfc/rfc4516.txt</a><br/>
Uniform Resource<br/>Locator<br/>
Lightweight<br/>Directory Access<br/>
<a href="http://www.rfc-editor.org/rfc/rfc4517.txt">RFC4517</a><br/>
Protocol (LDAP):<br/>
PS<br/>
<a href="http://www.rfc-editor.org/rfc/rfc4517.txt">http://www.rfc-editor.org/rfc/rfc4517.txt</a><br/>
Syntaxes and<br/>Matching Rules<br/>
Lightweight<br/>Directory Access<br/>
<a href="http://www.rfc-editor.org/rfc/rfc4518.txt">RFC4518</a><br/>
Protocol (LDAP):<br/>
PS<br/>
<a href="http://www.rfc-editor.org/rfc/rfc4518.txt">http://www.rfc-editor.org/rfc/rfc4518.txt</a><br/>
Internationalized<br/>String Preparation<br/>
Lightweight<br/>Directory Access<br/>
<a href="http://www.rfc-editor.org/rfc/rfc4519.txt">RFC4519</a><br/>
Protocol (LDAP):<br/>
PS<br/>
<a href="http://www.rfc-editor.org/rfc/rfc4519.txt">http://www.rfc-editor.org/rfc/rfc4519.txt</a><br/>
Schema for User<br/>Applications<br/>
IANA<br/>
<a href="http://www.rfc-editor.org/rfc/rfc4520.txt">RFC4520</a><br/>
Considerations for<br/>
BCP<br/>
<a href="http://www.rfc-editor.org/rfc/rfc4520.txt">http://www.rfc-editor.org/rfc/rfc4520.txt</a><br/>
LDAP<br/>
The Lightweight<br/>Directory Access<br/>Protocol (LDAP)<br/>
<a href="http://www.rfc-editor.org/rfc/rfc4533.txt">RFC4533</a><br/>
X<br/>
<a href="http://www.rfc-editor.org/rfc/rfc4533.txt">http://www.rfc-editor.org/rfc/rfc4533.txt</a><br/>
Content<br/>Synchronization<br/>Operation<br/>
Using LDAP Over<br/>
<a href="http://tools.ietf.org/html/draft-chu-ldap-ldapi-00">Chu-LDAPI</a><br/>
ID<br/>
<a href="http://tools.ietf.org/html/draft-chu-ldap-ldapi-00">http://tools.ietf.org/html/draft-chu-ldap-ldapi-00</a><br/>
IPC Mechanisms<br/>
243<br/>
<hr/>
<a name=258></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
244<br/>
<hr/>
<a name=259></a><b>J. Generic configure Instructions</b><br/>
Basic Installation<br/>
==================<br/>
&#160; &#160;These are generic installation instructions.<br/>
&#160; &#160;The `configure' shell script attempts to guess correct values for<br/>
various system-dependent variables used during compilation. &#160;It uses<br/>
those values to create a `Makefile' in each directory of the package.<br/>
It may also create one or more `.h' files containing system-dependent<br/>
definitions. &#160;Finally, it creates a shell script `config.status' that<br/>
you can run in the future to recreate the current configuration, a file<br/>
`config.cache' that saves the results of its tests to speed up<br/>
reconfiguring, and a file `config.log' containing compiler output<br/>
(useful mainly for debugging `configure').<br/>
&#160; &#160;If you need to do unusual things to compile the package, please try<br/>
to figure out how `configure' could check whether to do them, and mail<br/>
diffs or instructions to the address given in the `README' so they can<br/>
be considered for the next release. &#160;If at some point `config.cache'<br/>
contains results you don't want to keep, you may remove or edit it.<br/>
&#160; &#160;The file `configure.in' is used to create `configure' by a program<br/>
called `autoconf'. &#160;You only need `configure.in' if you want to change<br/>
it or regenerate `configure' using a newer version of `autoconf'.<br/>
The simplest way to compile this package is:<br/>
&#160; 1. `cd' to the directory containing the package's source code and type<br/>
&#160; &#160; &#160;`./configure' to configure the package for your system. &#160;If you're<br/>
&#160; &#160; &#160;using `csh' on an old version of System V, you might need to type<br/>
&#160; &#160; &#160;`sh ./configure' instead to prevent `csh' from trying to execute<br/>
&#160; &#160; &#160;`configure' itself.<br/>
&#160; &#160; &#160;Running `configure' takes awhile. &#160;While running, it prints some<br/>
&#160; &#160; &#160;messages telling which features it is checking for.<br/>
&#160; 2. Type `make' to compile the package.<br/>
&#160; 3. Optionally, type `make check' to run any self-tests that come with<br/>
&#160; &#160; &#160;the package.<br/>
&#160; 4. Type `make install' to install the programs and any data files and<br/>
&#160; &#160; &#160;documentation.<br/>
&#160; 5. You can remove the program binaries and object files from the<br/>
&#160; &#160; &#160;source code directory by typing `make clean'. &#160;To also remove the<br/>
&#160; &#160; &#160;files that `configure' created (so you can compile the package for<br/>
&#160; &#160; &#160;a different kind of computer), type `make distclean'. &#160;There is<br/>
&#160; &#160; &#160;also a `make maintainer-clean' target, but that is intended mainly<br/>
&#160; &#160; &#160;for the package's developers. &#160;If you use it, you may have to get<br/>
&#160; &#160; &#160;all sorts of other programs in order to regenerate files that came<br/>
&#160; &#160; &#160;with the distribution.<br/>
Compilers and Options<br/>
=====================<br/>
&#160; &#160;Some systems require unusual options for compilation or linking that<br/>
the `configure' script does not know about. &#160;You can give `configure'<br/>
245<br/>
<hr/>
<a name=260></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
initial values for variables by setting them in the environment. &#160;Using<br/>
a Bourne-compatible shell, you can do that on the command line like<br/>
this:<br/>
&#160; &#160; &#160;CC=c89 CFLAGS=-O2 LIBS=-lposix ./configure<br/>
Or on systems that have the `env' program, you can do it like this:<br/>
&#160; &#160; &#160;env CPPFLAGS=-I/usr/local/include LDFLAGS=-s ./configure<br/>
Compiling For Multiple Architectures<br/>
====================================<br/>
&#160; &#160;You can compile the package for more than one kind of computer at the<br/>
same time, by placing the object files for each architecture in their<br/>
own directory. &#160;To do this, you must use a version of `make' that<br/>
supports the `VPATH' variable, such as GNU `make'. &#160;`cd' to the<br/>
directory where you want the object files and executables to go and run<br/>
the `configure' script. &#160;`configure' automatically checks for the<br/>
source code in the directory that `configure' is in and in `..'.<br/>
&#160; &#160;If you have to use a `make' that does not supports the `VPATH'<br/>
variable, you have to compile the package for one architecture at a time<br/>
in the source code directory. &#160;After you have installed the package for<br/>
one architecture, use `make distclean' before reconfiguring for another<br/>
architecture.<br/>
Installation Names<br/>
==================<br/>
&#160; &#160;By default, `make install' will install the package's files in<br/>
`/usr/local/bin', `/usr/local/man', etc. &#160;You can specify an<br/>
installation prefix other than `/usr/local' by giving `configure' the<br/>
option `--prefix=PATH'.<br/>
&#160; &#160;You can specify separate installation prefixes for<br/>
architecture-specific files and architecture-independent files. &#160;If you<br/>
give `configure' the option `--exec-prefix=PATH', the package will use<br/>
PATH as the prefix for installing programs and libraries.<br/>
Documentation and other data files will still use the regular prefix.<br/>
&#160; &#160;In addition, if you use an unusual directory layout you can give<br/>
options like `--bindir=PATH' to specify different values for particular<br/>
kinds of files. &#160;Run `configure --help' for a list of the directories<br/>
you can set and what kinds of files go in them.<br/>
&#160; &#160;If the package supports it, you can cause programs to be installed<br/>
with an extra prefix or suffix on their names by giving `configure' the<br/>
option `--program-prefix=PREFIX' or `--program-suffix=SUFFIX'.<br/>
Optional Features<br/>
=================<br/>
&#160; &#160;Some packages pay attention to `--enable-FEATURE' options to<br/>
`configure', where FEATURE indicates an optional part of the package.<br/>
They may also pay attention to `--with-PACKAGE' options, where PACKAGE<br/>
is something like `gnu-as' or `x' (for the X Window System). &#160;The<br/>
`README' should mention any `--enable-' and `--with-' options that the<br/>
package recognizes.<br/>
&#160; &#160;For packages that use the X Window System, `configure' can usually<br/>
find the X include and library files automatically, but if it doesn't,<br/>
you can use the `configure' options `--x-includes=DIR' and<br/>
246<br/>
<hr/>
<a name=261></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
`--x-libraries=DIR' to specify their locations.<br/>
Specifying the System Type<br/>
==========================<br/>
&#160; &#160;There may be some features `configure' can not figure out<br/>
automatically, but needs to determine by the type of host the package<br/>
will run on. &#160;Usually `configure' can figure that out, but if it prints<br/>
a message saying it can not guess the host type, give it the<br/>
`--host=TYPE' option. &#160;TYPE can either be a short name for the system<br/>
type, such as `sun4', or a canonical name with three fields:<br/>
&#160; &#160; &#160;CPU-COMPANY-SYSTEM<br/>
See the file `config.sub' for the possible values of each field. &#160;If<br/>
`config.sub' isn't included in this package, then this package doesn't<br/>
need to know the host type.<br/>
&#160; &#160;If you are building compiler tools for cross-compiling, you can also<br/>
use the `--target=TYPE' option to select the type of system they will<br/>
produce code for and the `--build=TYPE' option to select the type of<br/>
system on which you are compiling the package.<br/>
Sharing Defaults<br/>
================<br/>
&#160; &#160;If you want to set default values for `configure' scripts to share,<br/>
you can create a site shell script called `config.site' that gives<br/>
default values for variables like `CC', `cache_file', and `prefix'.<br/>
`configure' looks for `PREFIX/share/config.site' if it exists, then<br/>
`PREFIX/etc/config.site' if it exists. &#160;Or, you can set the<br/>
`CONFIG_SITE' environment variable to the location of the site script.<br/>
A warning: not all `configure' scripts look for a site script.<br/>
Operation Controls<br/>
==================<br/>
&#160; &#160;`configure' recognizes the following options to control how it<br/>
operates.<br/>
`--cache-file=FILE'<br/>
&#160; &#160; &#160;Use and save the results of the tests in FILE instead of<br/>
&#160; &#160; &#160;`./config.cache'. &#160;Set FILE to `/dev/null' to disable caching, for<br/>
&#160; &#160; &#160;debugging `configure'.<br/>
`--help'<br/>
&#160; &#160; &#160;Print a summary of the options to `configure', and exit.<br/>
`--quiet'<br/>
`--silent'<br/>
`-q'<br/>
&#160; &#160; &#160;Do not print messages saying which checks are being made. &#160;To<br/>
&#160; &#160; &#160;suppress all normal output, redirect it to `/dev/null' (any error<br/>
&#160; &#160; &#160;messages will still be shown).<br/>
`--srcdir=DIR'<br/>
&#160; &#160; &#160;Look for the package's source code in directory DIR. &#160;Usually<br/>
&#160; &#160; &#160;`configure' can determine that directory automatically.<br/>
`--version'<br/>
&#160; &#160; &#160;Print the version of Autoconf used to generate the `configure'<br/>
&#160; &#160; &#160;script, and exit.<br/>
247<br/>
<hr/>
<a name=262></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
`configure' also accepts some other, not widely useful, options.<br/>
248<br/>
<hr/>
<a name=263></a><b>K. OpenLDAP Software Copyright Notices</b><br/>
<b>K.1. OpenLDAP Copyright Notice</b><br/>
Copyright 1998-2012 The OpenLDAP Foundation.<br/><i>All rights reserved.</i><br/>
Redistribution and use in source and binary forms, with or without modification, are permitted<i>&#160;only as<br/>authorized</i><a href="OpenLDAP-Admin-Guides.html#265">&#160;by the OpenLDAP Public License.</a><br/>
A copy of this license is available in file&#160;LICENSE&#160;in the top-level directory of the distribution or,<br/><a href="http://www.OpenLDAP.org/license.html">alternatively, at &lt;http://www.OpenLDAP.org/license.html&gt;.</a><br/>
OpenLDAP is a registered trademark of the OpenLDAP Foundation.<br/>
Individual files and/or contributed packages may be copyright by other parties and their use subject to<br/>additional restrictions.<br/>
This work is derived from the University of Michigan LDAP v3.3 distribution. Information concerning this<br/><a href="http://www.umich.edu/~dirsvcs/ldap/ldap.html">software is available at &lt;http://www.umich.edu/~dirsvcs/ldap/ldap.html&gt;.</a><br/>
This work also contains materials derived from public sources.<br/>
<a href="http://www.OpenLDAP.org/">Additional information about OpenLDAP software can be obtained at &lt;http://www.OpenLDAP.org/&gt;.</a><br/>
<b>K.2. Additional Copyright Notices</b><br/>
Portions Copyright 1998-2012 Kurt D. Zeilenga.<br/>Portions Copyright 1998-2006 Net Boolean Incorporated.<br/>Portions Copyright 2001-2006 IBM Corporation.<br/><i>All rights reserved.</i><br/>
Redistribution and use in source and binary forms, with or without modification, are permitted only as<br/><a href="OpenLDAP-Admin-Guides.html#265">authorized by the OpenLDAP Public License.</a><br/>
Portions Copyright 1999-2008 Howard Y.H. Chu.<br/>Portions Copyright 1999-2008 Symas Corporation.<br/>Portions Copyright 1998-2003 Hallvard B. Furuseth.<br/>Portions Copyright 2007-2011 Gavin Henry.<br/>Portions Copyright 2007-2011 Suretec Systems Limited.<br/><i>All rights reserved.</i><br/>
Redistribution and use in source and binary forms, with or without modification, are permitted provided that<br/>this notice is preserved. The names of the copyright holders may not be used to endorse or promote products<br/>derived from this software without their specific prior written permission. This software is provided ``as is''<br/>without express or implied warranty.<br/>
249<br/>
<hr/>
<a name=264></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
<b>K.3. University of Michigan Copyright Notice</b><br/>
Portions Copyright 1992-1996 Regents of the University of Michigan.<br/><i>All rights reserved.</i><br/>
Redistribution and use in source and binary forms are permitted provided that this notice is preserved and that<br/>due credit is given to the University of Michigan at Ann Arbor. The name of the University may not be used<br/>to endorse or promote products derived from this software without specific prior written permission. This<br/>software is provided ``as is'' without express or implied warranty.<br/>
250<br/>
<hr/>
<a name=265></a><b>L. OpenLDAP Public License</b><br/>
The OpenLDAP Public License<br/>
&#160; Version 2.8, 17 August 2003<br/>
Redistribution and use of this software and associated documentation<br/>
(&#34;Software&#34;), with or without modification, are permitted provided<br/>
that the following conditions are met:<br/>
1. Redistributions in source form must retain copyright statements<br/>
&#160; &#160;and notices,<br/>
2. Redistributions in binary form must reproduce applicable copyright<br/>
&#160; &#160;statements and notices, this list of conditions, and the following<br/>
&#160; &#160;disclaimer in the documentation and/or other materials provided<br/>
&#160; &#160;with the distribution, and<br/>
3. Redistributions must contain a verbatim copy of this document.<br/>
The OpenLDAP Foundation may revise this license from time to time.<br/>
Each revision is distinguished by a version number. &#160;You may use<br/>
this Software under terms of this license revision or under the<br/>
terms of any subsequent revision of the license.<br/>
THIS SOFTWARE IS PROVIDED BY THE OPENLDAP FOUNDATION AND ITS<br/>
CONTRIBUTORS ``AS IS'' AND ANY EXPRESSED OR IMPLIED WARRANTIES,<br/>
INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY<br/>
AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. &#160;IN NO EVENT<br/>
SHALL THE OPENLDAP FOUNDATION, ITS CONTRIBUTORS, OR THE AUTHOR(S)<br/>
OR OWNER(S) OF THE SOFTWARE BE LIABLE FOR ANY DIRECT, INDIRECT,<br/>
INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,<br/>
BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;<br/>
LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER<br/>
CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT<br/>
LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN<br/>
ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE<br/>
POSSIBILITY OF SUCH DAMAGE.<br/>
The names of the authors and copyright holders must not be used in<br/>
advertising or otherwise to promote the sale, use or other dealing<br/>
in this Software without specific, written prior permission. &#160;Title<br/>
to copyright in this Software shall at all times remain with copyright<br/>
holders.<br/>
OpenLDAP is a registered trademark of the OpenLDAP Foundation.<br/>
Copyright 1999-2003 The OpenLDAP Foundation, Redwood City,<br/>
California, USA. &#160;All Rights Reserved. &#160;Permission to copy and<br/>
distribute verbatim copies of this document is granted.<br/>
<a href="http://www.openldap.org/">Home | Catalog</a><br/>
<b>________________<br/> Copyright 2011,<a href="http://www.OpenLDAP.org/foundation/">&#160;OpenLDAP Foundation</a></b><b>,<a href="mailto:info@OpenLDAP.org">&#160;info@OpenLDAP.org</a></b><br/>
251<br/>
<hr/>
<a name=266></a>OpenLDAP Software 2.4 Administrator's Guide<br/>
252<br/>
<hr/>
<a name="outline"></a><h1>Document Outline</h1>
<ul>
<li><a href="OpenLDAP-Admin-Guides.html#3">Table of Contents</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#15">Preface</a>
<ul>
<li><a href="OpenLDAP-Admin-Guides.html#15">Copyright</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#15">Scope of this Document</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#15">Acknowledgments</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#16">Amendments</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#16">About this document</a></li>
</ul>
</li>
<li><a href="OpenLDAP-Admin-Guides.html#17">1. Introduction to OpenLDAP Directory Services</a>
<ul>
<li><a href="OpenLDAP-Admin-Guides.html#17">1.1. What is a directory service?</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#17">1.2. What is LDAP?</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#20">1.3. When should I use LDAP?</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#20">1.4. When should I not use LDAP?</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#20">1.5. How does LDAP work?</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#21">1.6. What about X.500?</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#21">1.7. What is the difference between LDAPv2 and LDAPv3?</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#21">1.8. LDAP vs RDBMS</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#23">1.9. What is slapd and what can it do?</a></li>
</ul>
</li>
<li><a href="OpenLDAP-Admin-Guides.html#25">2. A Quick-Start Guide</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#29">3. The Big Picture - Configuration Choices</a>
<ul>
<li><a href="OpenLDAP-Admin-Guides.html#29">3.1. Local Directory Service</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#29">3.2. Local Directory Service with Referrals</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#29">3.3. Replicated Directory Service</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#30">3.4. Distributed Local Directory Service</a></li>
</ul>
</li>
<li><a href="OpenLDAP-Admin-Guides.html#31">4. Building and Installing OpenLDAP Software</a>
<ul>
<li><a href="OpenLDAP-Admin-Guides.html#31">4.1. Obtaining and Extracting the Software</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#31">4.2. Prerequisite software</a>
<ul>
<li><a href="OpenLDAP-Admin-Guides.html#31">4.2.1. Transport Layer Security</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#32">4.2.2. Simple Authentication and Security Layer</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#32">4.2.3. Kerberos Authentication Service</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#32">4.2.4. Database Software</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#33">4.2.5. Threads</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#33">4.2.6. TCP Wrappers</a></li>
</ul>
</li>
<li><a href="OpenLDAP-Admin-Guides.html#33">4.3. Running configure</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#34">4.4. Building the Software</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#34">4.5. Testing the Software</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#34">4.6. Installing the Software</a></li>
</ul>
</li>
<li><a href="OpenLDAP-Admin-Guides.html#37">5. Configuring slapd</a>
<ul>
<li><a href="OpenLDAP-Admin-Guides.html#37">5.1. Configuration Layout</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#39">5.2. Configuration Directives</a>
<ul>
<li><a href="OpenLDAP-Admin-Guides.html#40">5.2.1. cn=config</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#41">5.2.2. cn=module</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#42">5.2.3. cn=schema</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#43">5.2.4. Backend-specific Directives</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#43">5.2.5. Database-specific Directives</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#48">5.2.6. BDB and HDB Database Directives</a></li>
</ul>
</li>
<li><a href="OpenLDAP-Admin-Guides.html#52">5.3. Configuration Example</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#54">5.4. Converting old style slapd.conf(5) file to cn=config format</a></li>
</ul>
</li>
<li><a href="OpenLDAP-Admin-Guides.html#57">6. The slapd Configuration File</a>
<ul>
<li><a href="OpenLDAP-Admin-Guides.html#57">6.1. Configuration File Format</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#58">6.2. Configuration File Directives</a>
<ul>
<li><a href="OpenLDAP-Admin-Guides.html#58">6.2.1. Global Directives</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#60">6.2.2. General Backend Directives</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#61">6.2.3. General Database Directives</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#65">6.2.4. BDB and HDB Database Directives</a></li>
</ul>
</li>
<li><a href="OpenLDAP-Admin-Guides.html#65">6.3. Configuration File Example</a></li>
</ul>
</li>
<li><a href="OpenLDAP-Admin-Guides.html#67">7. Running slapd</a>
<ul>
<li><a href="OpenLDAP-Admin-Guides.html#67">7.1. Command-Line Options</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#69">7.2. Starting slapd</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#69">7.3. Stopping slapd</a></li>
</ul>
</li>
<li><a href="OpenLDAP-Admin-Guides.html#71">8. Access Control</a>
<ul>
<li><a href="OpenLDAP-Admin-Guides.html#71">8.1. Introduction</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#71">8.2. Access Control via Static Configuration</a>
<ul>
<li><a href="OpenLDAP-Admin-Guides.html#72">8.2.1. What to control access to</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#73">8.2.2. Who to grant access to</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#74">8.2.3. The access to grant</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#74">8.2.4. Access Control Evaluation</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#75">8.2.5. Access Control Examples</a></li>
</ul>
</li>
<li><a href="OpenLDAP-Admin-Guides.html#76">8.3. Access Control via Dynamic Configuration</a>
<ul>
<li><a href="OpenLDAP-Admin-Guides.html#77">8.3.1. What to control access to</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#78">8.3.2. Who to grant access to</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#79">8.3.3. The access to grant</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#79">8.3.4. Access Control Evaluation</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#80">8.3.5. Access Control Examples</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#81">8.3.6. Access Control Ordering</a></li>
</ul>
</li>
<li><a href="OpenLDAP-Admin-Guides.html#82">8.4. Access Control Common Examples</a>
<ul>
<li><a href="OpenLDAP-Admin-Guides.html#82">8.4.1. Basic ACLs</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#83">8.4.2. Matching Anonymous and Authenticated users</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#83">8.4.3. Controlling rootdn access</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#84">8.4.4. Managing access with Groups</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#85">8.4.5. Granting access to a subset of attributes</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#85">8.4.6. Allowing a user write to all entries below theirs</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#86">8.4.7. Allowing entry creation</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#87">8.4.8. Tips for using regular expressions in Access Control</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#88">8.4.9. Granting and Denying access based on security strength factors (ssf)</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#88">8.4.10. When things aren't working as expected</a></li>
</ul>
</li>
<li><a href="OpenLDAP-Admin-Guides.html#89">8.5. Sets - Granting rights based on relationships</a>
<ul>
<li><a href="OpenLDAP-Admin-Guides.html#89">8.5.1. Groups of Groups</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#90">8.5.2. Group ACLs without DN syntax</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#91">8.5.3. Following references</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="OpenLDAP-Admin-Guides.html#93">9. Limits</a>
<ul>
<li><a href="OpenLDAP-Admin-Guides.html#93">9.1. Introduction</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#93">9.2. Soft and Hard limits</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#93">9.3. Global Limits</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#94">9.4. Per-Database Limits</a>
<ul>
<li><a href="OpenLDAP-Admin-Guides.html#94">9.4.1. Specify who the limits apply to</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#94">9.4.2. Specify time limits</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#95">9.4.3. Specifying size limits</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#95">9.4.4. Size limits and Paged Results</a></li>
</ul>
</li>
<li><a href="OpenLDAP-Admin-Guides.html#95">9.5. Example Limit Configurations</a>
<ul>
<li><a href="OpenLDAP-Admin-Guides.html#95">9.5.1. Simple Global Limits</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#96">9.5.2. Global Hard and Soft Limits</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#96">9.5.3. Giving specific users larger limits</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#96">9.5.4. Limiting who can do paged searches</a></li>
</ul>
</li>
<li><a href="OpenLDAP-Admin-Guides.html#96">9.6. Further Information</a></li>
</ul>
</li>
<li><a href="OpenLDAP-Admin-Guides.html#97">10. Database Creation and Maintenance Tools</a>
<ul>
<li><a href="OpenLDAP-Admin-Guides.html#97">10.1. Creating a database over LDAP</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#98">10.2. Creating a database off-line</a>
<ul>
<li><a href="OpenLDAP-Admin-Guides.html#99">10.2.1. The slapadd program</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#100">10.2.2. The slapindex program</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#100">10.2.3. The slapcat program</a></li>
</ul>
</li>
<li><a href="OpenLDAP-Admin-Guides.html#100">10.3. The LDIF text entry format</a></li>
</ul>
</li>
<li><a href="OpenLDAP-Admin-Guides.html#103">11. Backends</a>
<ul>
<li><a href="OpenLDAP-Admin-Guides.html#103">11.1. Berkeley DB Backends</a>
<ul>
<li><a href="OpenLDAP-Admin-Guides.html#103">11.1.1. Overview</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#103">11.1.2. back-bdb/back-hdb Configuration</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#103">11.1.3. Further Information</a></li>
</ul>
</li>
<li><a href="OpenLDAP-Admin-Guides.html#103">11.2. LDAP</a>
<ul>
<li><a href="OpenLDAP-Admin-Guides.html#103">11.2.1. Overview</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#104">11.2.2. back-ldap Configuration</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#105">11.2.3. Further Information</a></li>
</ul>
</li>
<li><a href="OpenLDAP-Admin-Guides.html#105">11.3. LDIF</a>
<ul>
<li><a href="OpenLDAP-Admin-Guides.html#105">11.3.1. Overview</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#105">11.3.2. back-ldif Configuration</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#106">11.3.3. Further Information</a></li>
</ul>
</li>
<li><a href="OpenLDAP-Admin-Guides.html#106">11.4. LMDB</a>
<ul>
<li><a href="OpenLDAP-Admin-Guides.html#106">11.4.1. Overview</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#106">11.4.2. back-mdb Configuration</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#106">11.4.3. Further Information</a></li>
</ul>
</li>
<li><a href="OpenLDAP-Admin-Guides.html#106">11.5. Metadirectory</a>
<ul>
<li><a href="OpenLDAP-Admin-Guides.html#107">11.5.1. Overview</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#107">11.5.2. back-meta Configuration</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#107">11.5.3. Further Information</a></li>
</ul>
</li>
<li><a href="OpenLDAP-Admin-Guides.html#107">11.6. Monitor</a>
<ul>
<li><a href="OpenLDAP-Admin-Guides.html#107">11.6.1. Overview</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#107">11.6.2. back-monitor Configuration</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#108">11.6.3. Further Information</a></li>
</ul>
</li>
<li><a href="OpenLDAP-Admin-Guides.html#108">11.7. Null</a>
<ul>
<li><a href="OpenLDAP-Admin-Guides.html#108">11.7.1. Overview</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#109">11.7.2. back-null Configuration</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#109">11.7.3. Further Information</a></li>
</ul>
</li>
<li><a href="OpenLDAP-Admin-Guides.html#109">11.8. Passwd</a>
<ul>
<li><a href="OpenLDAP-Admin-Guides.html#109">11.8.1. Overview</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#109">11.8.2. back-passwd Configuration</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#110">11.8.3. Further Information</a></li>
</ul>
</li>
<li><a href="OpenLDAP-Admin-Guides.html#110">11.9. Perl/Shell</a>
<ul>
<li><a href="OpenLDAP-Admin-Guides.html#110">11.9.1. Overview</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#110">11.9.2. back-perl/back-shell Configuration</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#110">11.9.3. Further Information</a></li>
</ul>
</li>
<li><a href="OpenLDAP-Admin-Guides.html#110">11.10. Relay</a>
<ul>
<li><a href="OpenLDAP-Admin-Guides.html#111">11.10.1. Overview</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#111">11.10.2. back-relay Configuration</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#111">11.10.3. Further Information</a></li>
</ul>
</li>
<li><a href="OpenLDAP-Admin-Guides.html#111">11.11. SQL</a>
<ul>
<li><a href="OpenLDAP-Admin-Guides.html#111">11.11.1. Overview</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#111">11.11.2. back-sql Configuration</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#113">11.11.3. Further Information</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="OpenLDAP-Admin-Guides.html#115">12. Overlays</a>
<ul>
<li><a href="OpenLDAP-Admin-Guides.html#116">12.1. Access Logging</a>
<ul>
<li><a href="OpenLDAP-Admin-Guides.html#116">12.1.1. Overview</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#116">12.1.2. Access Logging Configuration</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#117">12.1.3. Further Information</a></li>
</ul>
</li>
<li><a href="OpenLDAP-Admin-Guides.html#117">12.2. Audit Logging</a>
<ul>
<li><a href="OpenLDAP-Admin-Guides.html#117">12.2.1. Overview</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#118">12.2.2. Audit Logging Configuration</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#118">12.2.3. Further Information</a></li>
</ul>
</li>
<li><a href="OpenLDAP-Admin-Guides.html#118">12.3. Chaining</a>
<ul>
<li><a href="OpenLDAP-Admin-Guides.html#119">12.3.1. Overview</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#119">12.3.2. Chaining Configuration</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#120">12.3.3. Handling Chaining Errors</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#120">12.3.4. Read-Back of Chained Modifications</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#120">12.3.5. Further Information</a></li>
</ul>
</li>
<li><a href="OpenLDAP-Admin-Guides.html#120">12.4. Constraints</a>
<ul>
<li><a href="OpenLDAP-Admin-Guides.html#120">12.4.1. Overview</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#120">12.4.2. Constraint Configuration</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#121">12.4.3. Further Information</a></li>
</ul>
</li>
<li><a href="OpenLDAP-Admin-Guides.html#121">12.5. Dynamic Directory Services</a>
<ul>
<li><a href="OpenLDAP-Admin-Guides.html#121">12.5.1. Overview</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#121">12.5.2. Dynamic Directory Service Configuration</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#122">12.5.3. Further Information</a></li>
</ul>
</li>
<li><a href="OpenLDAP-Admin-Guides.html#123">12.6. Dynamic Groups</a>
<ul>
<li><a href="OpenLDAP-Admin-Guides.html#123">12.6.1. Overview</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#123">12.6.2. Dynamic Group Configuration</a></li>
</ul>
</li>
<li><a href="OpenLDAP-Admin-Guides.html#123">12.7. Dynamic Lists</a>
<ul>
<li><a href="OpenLDAP-Admin-Guides.html#123">12.7.1. Overview</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#123">12.7.2. Dynamic List Configuration</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#125">12.7.3. Further Information</a></li>
</ul>
</li>
<li><a href="OpenLDAP-Admin-Guides.html#125">12.8. Reverse Group Membership Maintenance</a>
<ul>
<li><a href="OpenLDAP-Admin-Guides.html#125">12.8.1. Overview</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#125">12.8.2. Member Of Configuration</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#126">12.8.3. Further Information</a></li>
</ul>
</li>
<li><a href="OpenLDAP-Admin-Guides.html#126">12.9. The Proxy Cache Engine</a>
<ul>
<li><a href="OpenLDAP-Admin-Guides.html#126">12.9.1. Overview</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#127">12.9.2. Proxy Cache Configuration</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#129">12.9.3. Further Information</a></li>
</ul>
</li>
<li><a href="OpenLDAP-Admin-Guides.html#129">12.10. Password Policies</a>
<ul>
<li><a href="OpenLDAP-Admin-Guides.html#129">12.10.1. Overview</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#130">12.10.2. Password Policy Configuration</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#131">12.10.3. Further Information</a></li>
</ul>
</li>
<li><a href="OpenLDAP-Admin-Guides.html#131">12.11. Referential Integrity</a>
<ul>
<li><a href="OpenLDAP-Admin-Guides.html#132">12.11.1. Overview</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#132">12.11.2. Referential Integrity Configuration</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#133">12.11.3. Further Information</a></li>
</ul>
</li>
<li><a href="OpenLDAP-Admin-Guides.html#133">12.12. Return Code</a>
<ul>
<li><a href="OpenLDAP-Admin-Guides.html#133">12.12.1. Overview</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#133">12.12.2. Return Code Configuration</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#134">12.12.3. Further Information</a></li>
</ul>
</li>
<li><a href="OpenLDAP-Admin-Guides.html#134">12.13. Rewrite/Remap</a>
<ul>
<li><a href="OpenLDAP-Admin-Guides.html#134">12.13.1. Overview</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#134">12.13.2. Rewrite/Remap Configuration</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#134">12.13.3. Further Information</a></li>
</ul>
</li>
<li><a href="OpenLDAP-Admin-Guides.html#134">12.14. Sync Provider</a>
<ul>
<li><a href="OpenLDAP-Admin-Guides.html#135">12.14.1. Overview</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#135">12.14.2. Sync Provider Configuration</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#135">12.14.3. Further Information</a></li>
</ul>
</li>
<li><a href="OpenLDAP-Admin-Guides.html#135">12.15. Translucent Proxy</a>
<ul>
<li><a href="OpenLDAP-Admin-Guides.html#135">12.15.1. Overview</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#135">12.15.2. Translucent Proxy Configuration</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#137">12.15.3. Further Information</a></li>
</ul>
</li>
<li><a href="OpenLDAP-Admin-Guides.html#137">12.16. Attribute Uniqueness</a>
<ul>
<li><a href="OpenLDAP-Admin-Guides.html#137">12.16.1. Overview</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#137">12.16.2. Attribute Uniqueness Configuration</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#138">12.16.3. Further Information</a></li>
</ul>
</li>
<li><a href="OpenLDAP-Admin-Guides.html#139">12.17. Value Sorting</a>
<ul>
<li><a href="OpenLDAP-Admin-Guides.html#139">12.17.1. Overview</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#139">12.17.2. Value Sorting Configuration</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#140">12.17.3. Further Information</a></li>
</ul>
</li>
<li><a href="OpenLDAP-Admin-Guides.html#140">12.18. Overlay Stacking</a>
<ul>
<li><a href="OpenLDAP-Admin-Guides.html#140">12.18.1. Overview</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#140">12.18.2. Example Scenarios</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="OpenLDAP-Admin-Guides.html#141">13. Schema Specification</a>
<ul>
<li><a href="OpenLDAP-Admin-Guides.html#141">13.1. Distributed Schema Files</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#141">13.2. Extending Schema</a>
<ul>
<li><a href="OpenLDAP-Admin-Guides.html#142">13.2.1. Object Identifiers</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#143">13.2.2. Naming Elements</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#143">13.2.3. Local schema file</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#143">13.2.4. Attribute Type Specification</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#146">13.2.5. Object Class Specification</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#147">13.2.6. OID Macros</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="OpenLDAP-Admin-Guides.html#149">14. Security Considerations</a>
<ul>
<li><a href="OpenLDAP-Admin-Guides.html#149">14.1. Network Security</a>
<ul>
<li><a href="OpenLDAP-Admin-Guides.html#149">14.1.1. Selective Listening</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#149">14.1.2. IP Firewall</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#149">14.1.3. TCP Wrappers</a></li>
</ul>
</li>
<li><a href="OpenLDAP-Admin-Guides.html#150">14.2. Data Integrity and Confidentiality Protection</a>
<ul>
<li><a href="OpenLDAP-Admin-Guides.html#150">14.2.1. Security Strength Factors</a></li>
</ul>
</li>
<li><a href="OpenLDAP-Admin-Guides.html#150">14.3. Authentication Methods</a>
<ul>
<li><a href="OpenLDAP-Admin-Guides.html#150">14.3.1. &#34;simple&#34; method</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#151">14.3.2. SASL method</a></li>
</ul>
</li>
<li><a href="OpenLDAP-Admin-Guides.html#151">14.4. Password Storage</a>
<ul>
<li><a href="OpenLDAP-Admin-Guides.html#152">14.4.1. SSHA password storage scheme</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#152">14.4.2. CRYPT password storage scheme</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#152">14.4.3. MD5 password storage scheme</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#152">14.4.4. SMD5 password storage scheme</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#153">14.4.5. SHA password storage scheme</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#153">14.4.6. SASL password storage scheme</a></li>
</ul>
</li>
<li><a href="OpenLDAP-Admin-Guides.html#153">14.5. Pass-Through authentication</a>
<ul>
<li><a href="OpenLDAP-Admin-Guides.html#153">14.5.1. Configuring slapd to use an authentication provider</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#154">14.5.2. Configuring saslauthd</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#154">14.5.3. Testing pass-through authentication</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="OpenLDAP-Admin-Guides.html#157">15. Using SASL</a>
<ul>
<li><a href="OpenLDAP-Admin-Guides.html#157">15.1. SASL Security Considerations</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#158">15.2. SASL Authentication</a>
<ul>
<li><a href="OpenLDAP-Admin-Guides.html#158">15.2.1. GSSAPI</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#159">15.2.2. KERBEROS_V4</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#160">15.2.3. DIGEST-MD5</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#161">15.2.4. EXTERNAL</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#161">15.2.5. Mapping Authentication Identities</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#162">15.2.6. Direct Mapping</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#163">15.2.7. Search-based mappings</a></li>
</ul>
</li>
<li><a href="OpenLDAP-Admin-Guides.html#164">15.3. SASL Proxy Authorization</a>
<ul>
<li><a href="OpenLDAP-Admin-Guides.html#165">15.3.1. Uses of Proxy Authorization</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#165">15.3.2. SASL Authorization Identities</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#166">15.3.3. Proxy Authorization Rules</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="OpenLDAP-Admin-Guides.html#169">16. Using TLS</a>
<ul>
<li><a href="OpenLDAP-Admin-Guides.html#169">16.1. TLS Certificates</a>
<ul>
<li><a href="OpenLDAP-Admin-Guides.html#169">16.1.1. Server Certificates</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#169">16.1.2. Client Certificates</a></li>
</ul>
</li>
<li><a href="OpenLDAP-Admin-Guides.html#169">16.2. TLS Configuration</a>
<ul>
<li><a href="OpenLDAP-Admin-Guides.html#169">16.2.1. Server Configuration</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#172">16.2.2. Client Configuration</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="OpenLDAP-Admin-Guides.html#175">17. Constructing a Distributed Directory Service</a>
<ul>
<li><a href="OpenLDAP-Admin-Guides.html#175">17.1. Subordinate Knowledge Information</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#175">17.2. Superior Knowledge Information</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#176">17.3. The ManageDsaIT Control</a></li>
</ul>
</li>
<li><a href="OpenLDAP-Admin-Guides.html#177">18. Replication</a>
<ul>
<li><a href="OpenLDAP-Admin-Guides.html#177">18.1. Replication Technology</a>
<ul>
<li><a href="OpenLDAP-Admin-Guides.html#177">18.1.1. LDAP Sync Replication</a></li>
</ul>
</li>
<li><a href="OpenLDAP-Admin-Guides.html#181">18.2. Deployment Alternatives</a>
<ul>
<li><a href="OpenLDAP-Admin-Guides.html#181">18.2.1. Delta-syncrepl replication</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#181">18.2.2. N-Way Multi-Master replication</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#182">18.2.3. MirrorMode replication</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#183">18.2.4. Syncrepl Proxy Mode</a></li>
</ul>
</li>
<li><a href="OpenLDAP-Admin-Guides.html#184">18.3. Configuring the different replication types</a>
<ul>
<li><a href="OpenLDAP-Admin-Guides.html#184">18.3.1. Syncrepl</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#186">18.3.2. Delta-syncrepl</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#188">18.3.3. N-Way Multi-Master</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#189">18.3.4. MirrorMode</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#191">18.3.5. Syncrepl Proxy</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="OpenLDAP-Admin-Guides.html#197">19. Maintenance</a>
<ul>
<li><a href="OpenLDAP-Admin-Guides.html#197">19.1. Directory Backups</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#197">19.2. Berkeley DB Logs</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#199">19.3. Checkpointing</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#199">19.4. Migration</a></li>
</ul>
</li>
<li><a href="OpenLDAP-Admin-Guides.html#201">20. Monitoring</a>
<ul>
<li><a href="OpenLDAP-Admin-Guides.html#201">20.1. Monitor configuration via cn=config(5)</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#201">20.2. Monitor configuration via slapd.conf(5)</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#202">20.3. Accessing Monitoring Information</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#203">20.4. Monitor Information</a>
<ul>
<li><a href="OpenLDAP-Admin-Guides.html#204">20.4.1. Backends</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#205">20.4.2. Connections</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#205">20.4.3. Databases</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#206">20.4.4. Listener</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#206">20.4.5. Log</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#206">20.4.6. Operations</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#207">20.4.7. Overlays</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#207">20.4.8. SASL</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#207">20.4.9. Statistics</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#207">20.4.10. Threads</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#208">20.4.11. Time</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#208">20.4.12. TLS</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#208">20.4.13. Waiters</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="OpenLDAP-Admin-Guides.html#209">21. Tuning</a>
<ul>
<li><a href="OpenLDAP-Admin-Guides.html#209">21.1. Performance Factors</a>
<ul>
<li><a href="OpenLDAP-Admin-Guides.html#209">21.1.1. Memory</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#209">21.1.2. Disks</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#209">21.1.3. Network Topology</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#209">21.1.4. Directory Layout Design</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#210">21.1.5. Expected Usage</a></li>
</ul>
</li>
<li><a href="OpenLDAP-Admin-Guides.html#210">21.2. Indexes</a>
<ul>
<li><a href="OpenLDAP-Admin-Guides.html#210">21.2.1. Understanding how a search works</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#210">21.2.2. What to index</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#210">21.2.3. Presence indexing</a></li>
</ul>
</li>
<li><a href="OpenLDAP-Admin-Guides.html#210">21.3. Logging</a>
<ul>
<li><a href="OpenLDAP-Admin-Guides.html#211">21.3.1. What log level to use</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#211">21.3.2. What to watch out for</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#211">21.3.3. Improving throughput</a></li>
</ul>
</li>
<li><a href="OpenLDAP-Admin-Guides.html#211">21.4. Caching</a>
<ul>
<li><a href="OpenLDAP-Admin-Guides.html#212">21.4.1. Berkeley DB Cache</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#214">21.4.2. slapd(8) Entry Cache (cachesize)</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#214">21.4.3. IDL Cache (idlcachesize)</a></li>
</ul>
</li>
<li><a href="OpenLDAP-Admin-Guides.html#214">21.5. slapd(8) Threads</a></li>
</ul>
</li>
<li><a href="OpenLDAP-Admin-Guides.html#215">22. Troubleshooting</a>
<ul>
<li><a href="OpenLDAP-Admin-Guides.html#215">22.1. User or Software errors?</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#215">22.2. Checklist</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#215">22.3. OpenLDAP Bugs</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#216">22.4. 3rd party software error</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#216">22.5. How to contact the OpenLDAP Project</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#216">22.6. How to present your problem</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#216">22.7. Debugging slapd(8)</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#216">22.8. Commercial Support</a></li>
</ul>
</li>
<li><a href="OpenLDAP-Admin-Guides.html#217">A. Changes Since Previous Release</a>
<ul>
<li><a href="OpenLDAP-Admin-Guides.html#217">A.1. New Guide Sections</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#217">A.2. New Features and Enhancements in 2.4</a>
<ul>
<li><a href="OpenLDAP-Admin-Guides.html#217">A.2.1. Better cn=config functionality</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#218">A.2.2. Better cn=schema functionality</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#218">A.2.3. More sophisticated Syncrepl configurations</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#218">A.2.4. N-Way Multimaster Replication</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#218">A.2.5. Replicating slapd Configuration (syncrepl and cn=config)</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#218">A.2.6. Push-Mode Replication</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#219">A.2.7. More extensive TLS configuration control</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#219">A.2.8. Performance enhancements</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#219">A.2.9. New overlays</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#219">A.2.10. New features in existing Overlays</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#220">A.2.11. New features in slapd</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#220">A.2.12. New features in libldap</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#220">A.2.13. New clients, tools and tool enhancements</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#220">A.2.14. New build options</a></li>
</ul>
</li>
<li><a href="OpenLDAP-Admin-Guides.html#220">A.3. Obsolete Features Removed From 2.4</a>
<ul>
<li><a href="OpenLDAP-Admin-Guides.html#220">A.3.1. Slurpd</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#220">A.3.2. back-ldbm</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="OpenLDAP-Admin-Guides.html#221">B. Upgrading from 2.3.x</a>
<ul>
<li><a href="OpenLDAP-Admin-Guides.html#221">B.1. cn=config olc* attributes</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#221">B.2. ACLs: searches require privileges on the search base</a></li>
</ul>
</li>
<li><a href="OpenLDAP-Admin-Guides.html#223">C. Common errors encountered when using OpenLDAP Software</a>
<ul>
<li><a href="OpenLDAP-Admin-Guides.html#223">C.1. Common causes of LDAP errors</a>
<ul>
<li><a href="OpenLDAP-Admin-Guides.html#223">C.1.1. ldap_*: Can't contact LDAP server</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#223">C.1.2. ldap_*: No such object</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#224">C.1.3. ldap_*: Can't chase referral</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#224">C.1.4. ldap_*: server is unwilling to perform</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#225">C.1.5. ldap_*: Insufficient access</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#225">C.1.6. ldap_*: Invalid DN syntax</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#225">C.1.7. ldap_*: Referral hop limit exceeded</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#225">C.1.8. ldap_*: operations error</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#225">C.1.9. ldap_*: other error</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#225">C.1.10. ldap_add/modify: Invalid syntax</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#226">C.1.11. ldap_add/modify: Object class violation</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#227">C.1.12. ldap_add: No such object</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#227">C.1.13. ldap add: invalid structural object class chain</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#228">C.1.14. ldap_add: no structuralObjectClass operational attribute</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#228">C.1.15. ldap_add/modify/rename: Naming violation</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#229">C.1.16. ldap_add/delete/modify/rename: no global superior knowledge</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#229">C.1.17. ldap_bind: Insufficient access</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#229">C.1.18. ldap_bind: Invalid credentials</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#230">C.1.19. ldap_bind: Protocol error</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#230">C.1.20. ldap_modify: cannot modify object class</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#230">C.1.21. ldap_sasl_interactive_bind_s: ...</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#230">C.1.22. ldap_sasl_interactive_bind_s: No such Object</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#230">C.1.23. ldap_sasl_interactive_bind_s: No such attribute</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#231">C.1.24. ldap_sasl_interactive_bind_s: Unknown authentication method</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#231">C.1.25. ldap_sasl_interactive_bind_s: Local error (82)</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#231">C.1.26. ldap_search: Partial results and referral received</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#231">C.1.27. ldap_start_tls: Operations error</a></li>
</ul>
</li>
<li><a href="OpenLDAP-Admin-Guides.html#231">C.2. Other Errors</a>
<ul>
<li><a href="OpenLDAP-Admin-Guides.html#231">C.2.1. ber_get_next on fd X failed errno=34 (Numerical result out of range)</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#231">C.2.2. ber_get_next on fd X failed errno=11 (Resource temporarily unavailable)</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#232">C.2.3. daemon: socket() failed errno=97 (Address family not supported)</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#232">C.2.4. GSSAPI: gss_acquire_cred: Miscellaneous failure; Permission denied;</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#232">C.2.5. access from unknown denied</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#233">C.2.6. ldap_read: want=# error=Resource temporarily unavailable</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#233">C.2.7. `make test' fails</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#234">C.2.8. ldap_*: Internal (implementation specific) error (80) - additional info: entry index delete failed</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#234">C.2.9. ldap_sasl_interactive_bind_s: Can't contact LDAP server (-1)</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="OpenLDAP-Admin-Guides.html#235">D. Recommended OpenLDAP Software Dependency Versions</a>
<ul>
<li><a href="OpenLDAP-Admin-Guides.html#235">D.1. Dependency Versions</a></li>
</ul>
</li>
<li><a href="OpenLDAP-Admin-Guides.html#237">E. Real World OpenLDAP Deployments and Examples</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#239">F. OpenLDAP Software Contributions</a>
<ul>
<li><a href="OpenLDAP-Admin-Guides.html#239">F.1. Client APIs</a>
<ul>
<li><a href="OpenLDAP-Admin-Guides.html#239">F.1.1. ldapc++</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#239">F.1.2. ldaptcl</a></li>
</ul>
</li>
<li><a href="OpenLDAP-Admin-Guides.html#239">F.2. Overlays</a>
<ul>
<li><a href="OpenLDAP-Admin-Guides.html#239">F.2.1. acl</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#239">F.2.2. addpartial</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#239">F.2.3. allop</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#239">F.2.4. autogroup</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#239">F.2.5. comp_match</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#239">F.2.6. denyop</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#239">F.2.7. dsaschema</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#240">F.2.8. lastmod</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#240">F.2.9. nops</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#240">F.2.10. nssov</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#240">F.2.11. passwd</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#240">F.2.12. proxyOld</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#240">F.2.13. smbk5pwd</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#240">F.2.14. trace</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#240">F.2.15. usn</a></li>
</ul>
</li>
<li><a href="OpenLDAP-Admin-Guides.html#240">F.3. Tools</a>
<ul>
<li><a href="OpenLDAP-Admin-Guides.html#240">F.3.1. Statistic Logging</a></li>
</ul>
</li>
<li><a href="OpenLDAP-Admin-Guides.html#240">F.4. SLAPI Plugins</a>
<ul>
<li><a href="OpenLDAP-Admin-Guides.html#241">F.4.1. addrdnvalues</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="OpenLDAP-Admin-Guides.html#243">G. Configuration File Examples</a>
<ul>
<li><a href="OpenLDAP-Admin-Guides.html#243">G.1. slapd.conf</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#243">G.2. ldap.conf</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#243">G.3. a-n-other.conf</a></li>
</ul>
</li>
<li><a href="OpenLDAP-Admin-Guides.html#245">H. LDAP Result Codes</a>
<ul>
<li><a href="OpenLDAP-Admin-Guides.html#245">H.1. Non-Error Result Codes</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#245">H.2. Result Codes</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#245">H.3. success (0)</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#245">H.4. operationsError (1)</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#245">H.5. protocolError (2)</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#246">H.6. timeLimitExceeded (3)</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#246">H.7. sizeLimitExceeded (4)</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#246">H.8. compareFalse (5)</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#246">H.9. compareTrue (6)</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#246">H.10. authMethodNotSupported (7)</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#246">H.11. strongerAuthRequired (8)</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#246">H.12. referral (10)</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#246">H.13. adminLimitExceeded (11)</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#247">H.14. unavailableCriticalExtension (12)</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#247">H.15. confidentialityRequired (13)</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#247">H.16. saslBindInProgress (14)</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#247">H.17. noSuchAttribute (16)</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#247">H.18. undefinedAttributeType (17)</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#247">H.19. inappropriateMatching (18)</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#247">H.20. constraintViolation (19)</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#247">H.21. attributeOrValueExists (20)</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#247">H.22. invalidAttributeSyntax (21)</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#247">H.23. noSuchObject (32)</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#248">H.24. aliasProblem (33)</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#248">H.25. invalidDNSyntax (34)</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#248">H.26. aliasDereferencingProblem (36)</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#248">H.27. inappropriateAuthentication (48)</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#248">H.28. invalidCredentials (49)</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#248">H.29. insufficientAccessRights (50)</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#248">H.30. busy (51)</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#248">H.31. unavailable (52)</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#248">H.32. unwillingToPerform (53)</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#248">H.33. loopDetect (54)</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#249">H.34. namingViolation (64)</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#249">H.35. objectClassViolation (65)</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#249">H.36. notAllowedOnNonLeaf (66)</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#249">H.37. notAllowedOnRDN (67)</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#249">H.38. entryAlreadyExists (68)</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#249">H.39. objectClassModsProhibited (69)</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#249">H.40. affectsMultipleDSAs (71)</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#249">H.41. other (80)</a></li>
</ul>
</li>
<li><a href="OpenLDAP-Admin-Guides.html#251">I. Glossary</a>
<ul>
<li><a href="OpenLDAP-Admin-Guides.html#251">I.1. Terms</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#254">I.2. Related Organizations</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#254">I.3. Related Products</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#255">I.4. References</a></li>
</ul>
</li>
<li><a href="OpenLDAP-Admin-Guides.html#259">J. Generic configure Instructions</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#263">K. OpenLDAP Software Copyright Notices</a>
<ul>
<li><a href="OpenLDAP-Admin-Guides.html#263">K.1. OpenLDAP Copyright Notice</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#263">K.2. Additional Copyright Notices</a></li>
<li><a href="OpenLDAP-Admin-Guides.html#264">K.3. University of Michigan Copyright Notice</a></li>
</ul>
</li>
<li><a href="OpenLDAP-Admin-Guides.html#265">L. OpenLDAP Public License</a></li>
</ul>
<hr/>
</body>
</html>
